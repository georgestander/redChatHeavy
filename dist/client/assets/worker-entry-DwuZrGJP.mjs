import wD,{EventEmitter as lf}from"node:events";import{env as tl}from"cloudflare:workers";import{ssrWebpackRequire as vD,createThenableFromReadableStream as bD,renderHtmlStream as t_,ssrLoadModule as Qt}from"/Users/georgestander/dev/tools/chatjs/node_modules/.pnpm/rwsdk@1.0.0-beta.53_@cloudflare+vite-plugin@1.23.0_bufferutil@4.1.0_vite@7.3.1_@types+node@22_zvk7ynha23nrady3r6nbat6zha/node_modules/rwsdk/dist/__intermediate_builds/ssr/ssr_bridge.js";import{AsyncLocalStorage as _D}from"async_hooks";import SD from"node:os";import xD from"node:diagnostics_channel";import kD from"fs";import bE from"events";import ED from"util";import _E from"path";import SE from"assert";import{Readable as fm}from"node:stream";import AD from"module";import TD from"node:path";import ID from"url";import ND from"buffer";import{randomFillSync as $D}from"crypto";import{createDecipheriv as CD,randomBytes as OD,createCipheriv as RD}from"node:crypto";function PD(e,t){for(var n=0;n<t.length;n++){const i=t[n];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in e)){const o=Object.getOwnPropertyDescriptor(i,r);o&&Object.defineProperty(e,r,o.get?o:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}const DD=Object.assign(function(t){const n=Date.now(),i=Math.trunc(n/1e3),r=n%1e3*1e6;if(t){let o=i-t[0],s=r-t[0];return s<0&&(o=o-1,s=1e9+s),[o,s]}return[i,r]},{bigint:function(){return BigInt(Date.now()*1e6)}});class UD{fd;isRaw=!1;isTTY=!1;constructor(t){this.fd=t}setRawMode(t){return this.isRaw=t,this}}class n_{fd;columns=80;rows=24;isTTY=!1;constructor(t){this.fd=t}clearLine(t,n){return n&&n(),!1}clearScreenDown(t){return t&&t(),!1}cursorTo(t,n,i){return i&&typeof i=="function"&&i(),!1}moveCursor(t,n,i){return i&&i(),!1}getColorDepth(t){return 1}hasColors(t,n){return!1}getWindowSize(){return[this.columns,this.rows]}write(t,n,i){t instanceof Uint8Array&&(t=new TextDecoder().decode(t));try{console.log(t)}catch{}return i&&typeof i=="function"&&i(),!1}}function un(e){return new Error(`[unenv] ${e} is not implemented yet!`)}function ys(e){return Object.assign(()=>{throw un(e)},{__unenv__:!0})}const r_="22.14.0";class Wy extends lf{env;hrtime;nextTick;constructor(t){super(),this.env=t.env,this.hrtime=t.hrtime,this.nextTick=t.nextTick;for(const n of[...Object.getOwnPropertyNames(Wy.prototype),...Object.getOwnPropertyNames(lf.prototype)]){const i=this[n];typeof i=="function"&&(this[n]=i.bind(this))}}emitWarning(t,n,i){console.warn(`${i?`[${i}] `:""}${n?`${n}: `:""}${t}`)}emit(...t){return super.emit(...t)}listeners(t){return super.listeners(t)}#e;#t;#n;get stdin(){return this.#e??=new UD(0)}get stdout(){return this.#t??=new n_(1)}get stderr(){return this.#n??=new n_(2)}#r="/";chdir(t){this.#r=t}cwd(){return this.#r}arch="";platform="";argv=[];argv0="";execArgv=[];execPath="";title="";pid=200;ppid=100;get version(){return`v${r_}`}get versions(){return{node:r_}}get allowedNodeEnvironmentFlags(){return new Set}get sourceMapsEnabled(){return!1}get debugPort(){return 0}get throwDeprecation(){return!1}get traceDeprecation(){return!1}get features(){return{}}get release(){return{}}get connected(){return!1}get config(){return{}}get moduleLoadList(){return[]}constrainedMemory(){return 0}availableMemory(){return 0}uptime(){return 0}resourceUsage(){return{}}ref(){}unref(){}umask(){throw un("process.umask")}getBuiltinModule(){}getActiveResourcesInfo(){throw un("process.getActiveResourcesInfo")}exit(){throw un("process.exit")}reallyExit(){throw un("process.reallyExit")}kill(){throw un("process.kill")}abort(){throw un("process.abort")}dlopen(){throw un("process.dlopen")}setSourceMapsEnabled(){throw un("process.setSourceMapsEnabled")}loadEnvFile(){throw un("process.loadEnvFile")}disconnect(){throw un("process.disconnect")}cpuUsage(){throw un("process.cpuUsage")}setUncaughtExceptionCaptureCallback(){throw un("process.setUncaughtExceptionCaptureCallback")}hasUncaughtExceptionCaptureCallback(){throw un("process.hasUncaughtExceptionCaptureCallback")}initgroups(){throw un("process.initgroups")}openStdin(){throw un("process.openStdin")}assert(){throw un("process.assert")}binding(){throw un("process.binding")}permission={has:ys("process.permission.has")};report={directory:"",filename:"",signal:"SIGUSR2",compact:!1,reportOnFatalError:!1,reportOnSignal:!1,reportOnUncaughtException:!1,getReport:ys("process.report.getReport"),writeReport:ys("process.report.writeReport")};finalization={register:ys("process.finalization.register"),unregister:ys("process.finalization.unregister"),registerBeforeExit:ys("process.finalization.registerBeforeExit")};memoryUsage=Object.assign(()=>({arrayBuffers:0,rss:0,external:0,heapTotal:0,heapUsed:0}),{rss:()=>0});mainModule=void 0;domain=void 0;send=void 0;exitCode=void 0;channel=void 0;getegid=void 0;geteuid=void 0;getgid=void 0;getgroups=void 0;getuid=void 0;setegid=void 0;seteuid=void 0;setgid=void 0;setgroups=void 0;setuid=void 0;_events=void 0;_eventsCount=void 0;_exiting=void 0;_maxListeners=void 0;_debugEnd=void 0;_debugProcess=void 0;_fatalException=void 0;_getActiveHandles=void 0;_getActiveRequests=void 0;_kill=void 0;_preload_modules=void 0;_rawDebug=void 0;_startProfilerIdleNotifier=void 0;_stopProfilerIdleNotifier=void 0;_tickCallback=void 0;_disconnect=void 0;_handleQueue=void 0;_pendingMessage=void 0;_channel=void 0;_send=void 0;_linkedBinding=void 0}const xE=globalThis.process,kE=xE.getBuiltinModule,uf=kE("node:process"),EE=globalThis.Cloudflare.compatibilityFlags.enable_nodejs_process_v2,Vy=new Wy({env:xE.env,hrtime:EE?uf.hrtime:DD,nextTick:uf.nextTick}),{exit:LD,features:MD,platform:jD}=uf,{env:zD,hrtime:BD,nextTick:FD}=Vy,{_channel:WD,_disconnect:VD,_events:qD,_eventsCount:HD,_handleQueue:KD,_maxListeners:JD,_pendingMessage:GD,_send:ZD,assert:QD,disconnect:YD,mainModule:XD}=Vy,{_debugEnd:eU,_debugProcess:tU,_exiting:nU,_fatalException:rU,_getActiveHandles:iU,_getActiveRequests:oU,_kill:sU,_linkedBinding:aU,_preload_modules:cU,_rawDebug:lU,_startProfilerIdleNotifier:uU,_stopProfilerIdleNotifier:dU,_tickCallback:fU,abort:pU,addListener:hU,allowedNodeEnvironmentFlags:mU,arch:gU,argv:yU,argv0:wU,availableMemory:vU,binding:bU,channel:_U,chdir:SU,config:xU,connected:kU,constrainedMemory:EU,cpuUsage:AU,cwd:TU,debugPort:IU,dlopen:NU,domain:$U,emit:CU,emitWarning:OU,eventNames:RU,execArgv:PU,execPath:DU,exitCode:UU,finalization:LU,getActiveResourcesInfo:MU,getegid:jU,geteuid:zU,getgid:BU,getgroups:FU,getMaxListeners:WU,getuid:VU,hasUncaughtExceptionCaptureCallback:qU,initgroups:HU,kill:KU,listenerCount:JU,listeners:GU,loadEnvFile:ZU,memoryUsage:QU,moduleLoadList:YU,off:XU,on:eL,once:tL,openStdin:nL,permission:rL,pid:iL,ppid:oL,prependListener:sL,prependOnceListener:aL,rawListeners:cL,reallyExit:lL,ref:nie,release:uL,removeAllListeners:dL,removeListener:fL,report:pL,resourceUsage:hL,send:mL,setegid:gL,seteuid:yL,setgid:wL,setgroups:vL,setMaxListeners:bL,setSourceMapsEnabled:_L,setuid:SL,setUncaughtExceptionCaptureCallback:xL,sourceMapsEnabled:kL,stderr:EL,stdin:AL,stdout:TL,throwDeprecation:IL,title:NL,traceDeprecation:$L,umask:CL,unref:rie,uptime:OL,version:RL,versions:PL}=EE?uf:Vy,DL={abort:pU,addListener:hU,allowedNodeEnvironmentFlags:mU,hasUncaughtExceptionCaptureCallback:qU,setUncaughtExceptionCaptureCallback:xL,loadEnvFile:ZU,sourceMapsEnabled:kL,arch:gU,argv:yU,argv0:wU,chdir:SU,config:xU,connected:kU,constrainedMemory:EU,availableMemory:vU,cpuUsage:AU,cwd:TU,debugPort:IU,dlopen:NU,disconnect:YD,emit:CU,emitWarning:OU,env:zD,eventNames:RU,execArgv:PU,execPath:DU,exit:LD,finalization:LU,features:MD,getBuiltinModule:kE,getActiveResourcesInfo:MU,getMaxListeners:WU,hrtime:BD,kill:KU,listeners:GU,listenerCount:JU,memoryUsage:QU,nextTick:FD,on:eL,off:XU,once:tL,pid:iL,platform:jD,ppid:oL,prependListener:sL,prependOnceListener:aL,rawListeners:cL,release:uL,removeAllListeners:dL,removeListener:fL,report:pL,resourceUsage:hL,setMaxListeners:bL,setSourceMapsEnabled:_L,stderr:EL,stdin:AL,stdout:TL,title:NL,throwDeprecation:IL,traceDeprecation:$L,umask:CL,uptime:OL,version:RL,versions:PL,domain:$U,initgroups:HU,moduleLoadList:YU,reallyExit:lL,openStdin:nL,assert:QD,binding:bU,send:mL,exitCode:UU,channel:_U,getegid:jU,geteuid:zU,getgid:BU,getgroups:FU,getuid:VU,setegid:gL,seteuid:yL,setgid:wL,setgroups:vL,setuid:SL,permission:rL,mainModule:XD,_events:qD,_eventsCount:HD,_exiting:nU,_maxListeners:JD,_debugEnd:eU,_debugProcess:tU,_fatalException:rU,_getActiveHandles:iU,_getActiveRequests:oU,_kill:sU,_preload_modules:cU,_rawDebug:lU,_startProfilerIdleNotifier:uU,_stopProfilerIdleNotifier:dU,_tickCallback:fU,_disconnect:VD,_handleQueue:KD,_pendingMessage:GD,_channel:WD,_send:ZD,_linkedBinding:aU};globalThis.process=DL;const Pg=globalThis.performance?.timeOrigin??Date.now(),Dg=globalThis.performance?.now?globalThis.performance.now.bind(globalThis.performance):()=>Date.now()-Pg,UL={name:"node",entryType:"node",startTime:0,duration:0,nodeStart:0,v8Start:0,bootstrapComplete:0,environment:0,loopStart:0,loopExit:0,idleTime:0,uvMetricsInfo:{loopCount:0,events:0,eventsWaiting:0},detail:void 0,toJSON(){return this}};class rp{__unenv__=!0;detail;entryType="event";name;startTime;constructor(t,n){this.name=t,this.startTime=n?.startTime||Dg(),this.detail=n?.detail}get duration(){return Dg()-this.startTime}toJSON(){return{name:this.name,entryType:this.entryType,startTime:this.startTime,duration:this.duration,detail:this.detail}}}const AE=class extends rp{entryType="mark";constructor(){super(...arguments)}get duration(){return 0}};class TE extends rp{entryType="measure"}class IE extends rp{entryType="resource";serverTiming=[];connectEnd=0;connectStart=0;decodedBodySize=0;domainLookupEnd=0;domainLookupStart=0;encodedBodySize=0;fetchStart=0;initiatorType="";name="";nextHopProtocol="";redirectEnd=0;redirectStart=0;requestStart=0;responseEnd=0;responseStart=0;secureConnectionStart=0;startTime=0;transferSize=0;workerStart=0;responseStatus=0}class LL{__unenv__=!0;getEntries(){return[]}getEntriesByName(t,n){return[]}getEntriesByType(t){return[]}}class NE{__unenv__=!0;timeOrigin=Pg;eventCounts=new Map;_entries=[];_resourceTimingBufferSize=0;navigation=void 0;timing=void 0;timerify(t,n){throw un("Performance.timerify")}get nodeTiming(){return UL}eventLoopUtilization(){return{}}markResourceTiming(){return new IE("")}onresourcetimingbufferfull=null;now(){return this.timeOrigin===Pg?Dg():Date.now()-this.timeOrigin}clearMarks(t){this._entries=t?this._entries.filter(n=>n.name!==t):this._entries.filter(n=>n.entryType!=="mark")}clearMeasures(t){this._entries=t?this._entries.filter(n=>n.name!==t):this._entries.filter(n=>n.entryType!=="measure")}clearResourceTimings(){this._entries=this._entries.filter(t=>t.entryType!=="resource"||t.entryType!=="navigation")}getEntries(){return this._entries}getEntriesByName(t,n){return this._entries.filter(i=>i.name===t&&(!n||i.entryType===n))}getEntriesByType(t){return this._entries.filter(n=>n.entryType===t)}mark(t,n){const i=new AE(t,n);return this._entries.push(i),i}measure(t,n,i){let r,o;typeof n=="string"?(r=this.getEntriesByName(n,"mark")[0]?.startTime,o=this.getEntriesByName(i,"mark")[0]?.startTime):(r=Number.parseFloat(n?.start)||this.now(),o=Number.parseFloat(n?.end)||this.now());const s=new TE(t,{startTime:r,detail:{start:r,end:o}});return this._entries.push(s),s}setResourceTimingBufferSize(t){this._resourceTimingBufferSize=t}addEventListener(t,n,i){throw un("Performance.addEventListener")}removeEventListener(t,n,i){throw un("Performance.removeEventListener")}dispatchEvent(t){throw un("Performance.dispatchEvent")}toJSON(){return this}}class ML{__unenv__=!0;static supportedEntryTypes=[];_callback=null;constructor(t){this._callback=t}takeRecords(){return[]}disconnect(){throw un("PerformanceObserver.disconnect")}observe(t){throw un("PerformanceObserver.observe")}bind(t){return t}runInAsyncScope(t,n,...i){return t.call(n,...i)}asyncId(){return 0}triggerAsyncId(){return 0}emitDestroy(){return this}}const jL=globalThis.performance&&"addEventListener"in globalThis.performance?globalThis.performance:new NE;globalThis.performance=jL;globalThis.Performance=NE;globalThis.PerformanceEntry=rp;globalThis.PerformanceMark=AE;globalThis.PerformanceMeasure=TE;globalThis.PerformanceObserver=ML;globalThis.PerformanceObserverEntryList=LL;globalThis.PerformanceResourceTiming=IE;var i_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function $E(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function zL(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var n=function i(){var r=!1;try{r=this instanceof i}catch{}return r?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(i){var r=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(n,i,r.get?r:{enumerable:!0,get:function(){return e[i]}})}),n}var pm={exports:{}},ma={},hm={exports:{}},rn={};var o_;function BL(){if(o_)return rn;o_=1;var e={H:null,A:null};function t(S){var T="https://react.dev/errors/"+S;if(1<arguments.length){T+="?args[]="+encodeURIComponent(arguments[1]);for(var z=2;z<arguments.length;z++)T+="&args[]="+encodeURIComponent(arguments[z])}return"Minified React error #"+S+"; visit "+T+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var n=Array.isArray;function i(){}var r=Symbol.for("react.transitional.element"),o=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),c=Symbol.for("react.profiler"),l=Symbol.for("react.forward_ref"),u=Symbol.for("react.suspense"),p=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),g=Symbol.iterator;function h(S){return S===null||typeof S!="object"?null:(S=g&&S[g]||S["@@iterator"],typeof S=="function"?S:null)}var d=Object.prototype.hasOwnProperty,y=Object.assign;function v(S,T,z){var L=z.ref;return{$$typeof:r,type:S,key:T,ref:L!==void 0?L:null,props:z}}function x(S,T){return v(S.type,T,S.props)}function E(S){return typeof S=="object"&&S!==null&&S.$$typeof===r}function N(S){var T={"=":"=0",":":"=2"};return"$"+S.replace(/[=:]/g,function(z){return T[z]})}var C=/\/+/g;function b(S,T){return typeof S=="object"&&S!==null&&S.key!=null?N(""+S.key):T.toString(36)}function P(S){switch(S.status){case"fulfilled":return S.value;case"rejected":throw S.reason;default:switch(typeof S.status=="string"?S.then(i,i):(S.status="pending",S.then(function(T){S.status==="pending"&&(S.status="fulfilled",S.value=T)},function(T){S.status==="pending"&&(S.status="rejected",S.reason=T)})),S.status){case"fulfilled":return S.value;case"rejected":throw S.reason}}throw S}function $(S,T,z,L,q){var V=typeof S;(V==="undefined"||V==="boolean")&&(S=null);var K=!1;if(S===null)K=!0;else switch(V){case"bigint":case"string":case"number":K=!0;break;case"object":switch(S.$$typeof){case r:case o:K=!0;break;case f:return K=S._init,$(K(S._payload),T,z,L,q)}}if(K)return q=q(S),K=L===""?"."+b(S,0):L,n(q)?(z="",K!=null&&(z=K.replace(C,"$&/")+"/"),$(q,T,z,"",function(X){return X})):q!=null&&(E(q)&&(q=x(q,z+(q.key==null||S&&S.key===q.key?"":(""+q.key).replace(C,"$&/")+"/")+K)),T.push(q)),1;K=0;var oe=L===""?".":L+":";if(n(S))for(var ne=0;ne<S.length;ne++)L=S[ne],V=oe+b(L,ne),K+=$(L,T,z,V,q);else if(ne=h(S),typeof ne=="function")for(S=ne.call(S),ne=0;!(L=S.next()).done;)L=L.value,V=oe+b(L,ne++),K+=$(L,T,z,V,q);else if(V==="object"){if(typeof S.then=="function")return $(P(S),T,z,L,q);throw T=String(S),Error(t(31,T==="[object Object]"?"object with keys {"+Object.keys(S).join(", ")+"}":T))}return K}function k(S,T,z){if(S==null)return S;var L=[],q=0;return $(S,L,"","",function(V){return T.call(z,V,q++)}),L}function D(S){if(S._status===-1){var T=S._result;T=T(),T.then(function(z){(S._status===0||S._status===-1)&&(S._status=1,S._result=z)},function(z){(S._status===0||S._status===-1)&&(S._status=2,S._result=z)}),S._status===-1&&(S._status=0,S._result=T)}if(S._status===1)return S._result.default;throw S._result}function B(){return new WeakMap}function J(){return{s:0,v:void 0,o:null,p:null}}return rn.Children={map:k,forEach:function(S,T,z){k(S,function(){T.apply(this,arguments)},z)},count:function(S){var T=0;return k(S,function(){T++}),T},toArray:function(S){return k(S,function(T){return T})||[]},only:function(S){if(!E(S))throw Error(t(143));return S}},rn.Fragment=s,rn.Profiler=c,rn.StrictMode=a,rn.Suspense=u,rn.__SERVER_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=e,rn.cache=function(S){return function(){var T=e.A;if(!T)return S.apply(null,arguments);var z=T.getCacheForType(B);T=z.get(S),T===void 0&&(T=J(),z.set(S,T)),z=0;for(var L=arguments.length;z<L;z++){var q=arguments[z];if(typeof q=="function"||typeof q=="object"&&q!==null){var V=T.o;V===null&&(T.o=V=new WeakMap),T=V.get(q),T===void 0&&(T=J(),V.set(q,T))}else V=T.p,V===null&&(T.p=V=new Map),T=V.get(q),T===void 0&&(T=J(),V.set(q,T))}if(T.s===1)return T.v;if(T.s===2)throw T.v;try{var K=S.apply(null,arguments);return z=T,z.s=1,z.v=K}catch(oe){throw K=T,K.s=2,K.v=oe,oe}}},rn.cacheSignal=function(){var S=e.A;return S?S.cacheSignal():null},rn.captureOwnerStack=function(){return null},rn.cloneElement=function(S,T,z){if(S==null)throw Error(t(267,S));var L=y({},S.props),q=S.key;if(T!=null)for(V in T.key!==void 0&&(q=""+T.key),T)!d.call(T,V)||V==="key"||V==="__self"||V==="__source"||V==="ref"&&T.ref===void 0||(L[V]=T[V]);var V=arguments.length-2;if(V===1)L.children=z;else if(1<V){for(var K=Array(V),oe=0;oe<V;oe++)K[oe]=arguments[oe+2];L.children=K}return v(S.type,q,L)},rn.createElement=function(S,T,z){var L,q={},V=null;if(T!=null)for(L in T.key!==void 0&&(V=""+T.key),T)d.call(T,L)&&L!=="key"&&L!=="__self"&&L!=="__source"&&(q[L]=T[L]);var K=arguments.length-2;if(K===1)q.children=z;else if(1<K){for(var oe=Array(K),ne=0;ne<K;ne++)oe[ne]=arguments[ne+2];q.children=oe}if(S&&S.defaultProps)for(L in K=S.defaultProps,K)q[L]===void 0&&(q[L]=K[L]);return v(S,V,q)},rn.createRef=function(){return{current:null}},rn.forwardRef=function(S){return{$$typeof:l,render:S}},rn.isValidElement=E,rn.lazy=function(S){return{$$typeof:f,_payload:{_status:-1,_result:S},_init:D}},rn.memo=function(S,T){return{$$typeof:p,type:S,compare:T===void 0?null:T}},rn.use=function(S){return e.H.use(S)},rn.useCallback=function(S,T){return e.H.useCallback(S,T)},rn.useDebugValue=function(){},rn.useId=function(){return e.H.useId()},rn.useMemo=function(S,T){return e.H.useMemo(S,T)},rn.version="19.2.3",rn}var s_;function ip(){return s_||(s_=1,hm.exports=BL()),hm.exports}var a_;function FL(){if(a_)return ma;a_=1;var e=ip(),t=Symbol.for("react.transitional.element"),n=Symbol.for("react.fragment");if(!e.__SERVER_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE)throw Error('The "react" package in this environment is not configured correctly. The "react-server" condition must be enabled in any environment that runs React Server Components.');function i(r,o,s){var a=null;if(s!==void 0&&(a=""+s),o.key!==void 0&&(a=""+o.key),"key"in o){s={};for(var c in o)c!=="key"&&(s[c]=o[c])}else s=o;return o=s.ref,{$$typeof:t,type:r,key:a,ref:o!==void 0?o:null,props:s}}return ma.Fragment=n,ma.jsx=i,ma.jsxDEV=void 0,ma.jsxs=i,ma}var c_;function WL(){return c_||(c_=1,pm.exports=FL()),pm.exports}var F=WL(),fn=ip();const df=$E(fn),VL=PD({__proto__:null,default:df},[fn]);var mm={exports:{}},Bt={};var l_;function qL(){if(l_)return Bt;l_=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),s=Symbol.for("react.context"),a=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),l=Symbol.for("react.suspense_list"),u=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),f=Symbol.for("react.view_transition"),g=Symbol.for("react.client.reference");function h(d){if(typeof d=="object"&&d!==null){var y=d.$$typeof;switch(y){case e:switch(d=d.type,d){case n:case r:case i:case c:case l:case f:return d;default:switch(d=d&&d.$$typeof,d){case s:case a:case p:case u:return d;case o:return d;default:return y}}case t:return y}}}return Bt.ContextConsumer=o,Bt.ContextProvider=s,Bt.Element=e,Bt.ForwardRef=a,Bt.Fragment=n,Bt.Lazy=p,Bt.Memo=u,Bt.Portal=t,Bt.Profiler=r,Bt.StrictMode=i,Bt.Suspense=c,Bt.SuspenseList=l,Bt.isContextConsumer=function(d){return h(d)===o},Bt.isContextProvider=function(d){return h(d)===s},Bt.isElement=function(d){return typeof d=="object"&&d!==null&&d.$$typeof===e},Bt.isForwardRef=function(d){return h(d)===a},Bt.isFragment=function(d){return h(d)===n},Bt.isLazy=function(d){return h(d)===p},Bt.isMemo=function(d){return h(d)===u},Bt.isPortal=function(d){return h(d)===t},Bt.isProfiler=function(d){return h(d)===r},Bt.isStrictMode=function(d){return h(d)===i},Bt.isSuspense=function(d){return h(d)===c},Bt.isSuspenseList=function(d){return h(d)===l},Bt.isValidElementType=function(d){return typeof d=="string"||typeof d=="function"||d===n||d===r||d===i||d===c||d===l||typeof d=="object"&&d!==null&&(d.$$typeof===p||d.$$typeof===u||d.$$typeof===s||d.$$typeof===o||d.$$typeof===a||d.$$typeof===g||d.getModuleId!==void 0)},Bt.typeOf=h,Bt}var u_;function HL(){return u_||(u_=1,mm.exports=qL()),mm.exports}var CE=HL();const OE=["delete","get","head","patch","post","put"],gm=new Map;function RE(e){const t=gm.get(e);if(t)return t;if(e.includes(":")){const l=e.split("/");for(const u of l)if((u.match(/:/g)||[]).length>1)throw new Error(`RedwoodSDK: Invalid route pattern: segment "${u}" in "${e}" contains multiple colons. Each route parameter should use a single colon (e.g., ":id"). Check for accidental double colons ("::").`)}if(e.indexOf("**")!==-1)throw new Error(`RedwoodSDK: Invalid route pattern: "${e}" contains "**". Use "*" for a single wildcard segment. Double wildcards are not supported.`);if(!e.includes(":")&&!e.includes("*")){const l={isStatic:!0,regex:null,paramMap:[]};return gm.set(e,l),l}const i=[];let r=0;const o=/:([a-zA-Z0-9_]+)|\*/g;let s;for(;(s=o.exec(e))!==null;)s[1]?i.push({name:s[1],isWildcard:!1}):i.push({name:`$${r++}`,isWildcard:!0});const a=e.replace(/:[a-zA-Z0-9_]+/g,"([^/]+)").replace(/\*/g,"(.*)"),c={isStatic:!1,regex:new RegExp(`^${a}$`),paramMap:i};return gm.set(e,c),c}function KL(e,t){const n=RE(e);if(n.isStatic)return e===t?{}:null;const i=t.match(n.regex);if(!i)return null;const r={};for(let o=0;o<n.paramMap.length;o++){const s=n.paramMap[o];r[s.name]=i[o+1]}return r}function PE(e){return e.reduce((t,n)=>Array.isArray(n)?[...t,...PE(n)]:[...t,n],[])}function DE(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}function UE(e){const t=new Set([...e.config?.disableOptions?[]:["OPTIONS"],...OE.filter(n=>e[n]).map(n=>n.toUpperCase()),...Object.keys(e.custom??{}).map(n=>n.toUpperCase())]);return new Response(null,{status:204,headers:{Allow:Array.from(t).sort().join(", ")}})}function JL(e){const t=UE(e);return new Response("Method Not Allowed",{status:405,headers:t.headers})}function GL(e,t){const n=t.toLowerCase();return OE.includes(n)?e[n]:e.custom?.[n]}function ZL(e){const t=PE(e),n=t.map(i=>{if(typeof i=="function")return{type:"middleware",handler:i};if(typeof i=="object"&&i!==null&&"__rwExcept"in i&&i.__rwExcept===!0)return{type:"except",handler:i};const r=i,o=RE(r.path);return{type:"definition",path:r.path,handler:r.handler,layouts:r.layouts,isStatic:o.isStatic,regex:o.regex??void 0,paramNames:o.paramMap.filter(s=>!s.isWildcard).map(s=>s.name),wildcardCount:o.paramMap.filter(s=>s.isWildcard).length}});return{routes:t,async handle({request:i,renderPage:r,getRequestInfo:o,onError:s,runWithRequestInfoOverrides:a,rscActionHandler:c}){const l=o();let p=new URL(i.url).pathname;p!=="/"&&!p.endsWith("/")&&(p=p+"/"),l.path=p;function f(N){const C=Array.isArray(N)?N:[N],b=C.slice(0,Math.max(C.length-1,0)),P=C[C.length-1];return{routeMiddlewares:b,componentHandler:P}}function g(N){const C=o(),b=N.type,P=typeof b=="function"&&b.name?b.name:"Element",$=()=>N;return Object.defineProperty($,"name",{value:P,configurable:!0}),r(C,$,s)}async function h(N){if(N instanceof Response)return N;if(N&&df.isValidElement(N))return await g(N)}function d(N){return N.type==="except"}async function y(N,C){for(let b=C;b>=0;b--){const P=n[b];if(d(P))try{const $=await P.handler.handler(N,o()),k=await h($);if(k)return k}catch($){return await y($,b-1)}}throw s(N),N}let v=!1,x=!1;const E=async()=>{x||(new URL(i.url).searchParams.has("__rsc_action_id")&&(l.rw.actionResult=await c(i)),x=!0)};try{let N=0;for(const C of n){if(C.type==="except"){N++;continue}if(C.type==="middleware"){try{const $=await C.handler(o()),k=await h($);if(k)return k}catch($){return await y($,N)}N++;continue}if(!v){v=!0;try{await E()}catch($){return await y($,N)}}let b=null;if(C.isStatic)C.path===p&&(b={});else if(C.regex){const $=p.match(C.regex);if($){b={};for(let k=0;k<C.paramNames.length;k++)b[C.paramNames[k]]=$[k+1];for(let k=0;k<C.wildcardCount;k++)b[`$${k}`]=$[C.paramNames.length+k+1]}}if(!b){N++;continue}let P;if(DE(C.handler)){const $=i.method;if($==="OPTIONS"&&!C.handler.config?.disableOptions)return UE(C.handler);if(P=GL(C.handler,$),!P){if(!C.handler.config?.disable405)return JL(C.handler);N++;continue}}else P=C.handler;try{return await a({params:b},async()=>{const{routeMiddlewares:$,componentHandler:k}=f(P);for(const T of $){const z=await T(o()),L=await h(z);if(L)return L}if(ME(k)){const T=o(),z=YL(XL(k),C.layouts||[],T);return!qy(k)&&!T.rw.pageRouteResolved&&(T.rw.pageRouteResolved=Promise.withResolvers()),await r(T,z,s)}const D=await k(o()),B=await h(D);if(B)return B;const J=typeof k=="function"&&k.name?k.name:"anonymous",S=`Route handler did not return a Response or React element.

Route: ${C.path}
Matched path: ${p}
Method: ${i.method}
Handler: ${J}

Route handlers must return one of:
  - A Response object (e.g., \`new Response("OK")\`)
  - A React element (e.g., \`<div>Hello</div>\`)
  - \`void\` (if handled by middleware earlier in the chain)`;return new Response(S,{status:500,headers:{"Content-Type":"text/plain"}})})}catch($){return await y($,N)}}if(!v)try{await E()}catch(C){return await y(C,n.length-1)}return new Response("Not Found",{status:404})}catch(N){return await y(N,n.length-1)}}}}function Ft(e,t){let n=e;return n.startsWith("/")||(n="/"+n),n!=="/*"&&!n.endsWith("/")&&(n=n+"/"),DE(t)&&t.custom&&(t={...t,custom:Object.fromEntries(Object.entries(t.custom).map(([i,r])=>[i.toLowerCase(),r]))}),{path:n,handler:t,__rwPath:n}}function QL(e,t){const n=e.endsWith("/")?e.slice(0,-1):e,i=t.startsWith("/")?t:`/${t}`;return n+i}function LE(e,t){let n=e;n.startsWith("/")||(n="/"+n),n.endsWith("/")||(n=n+"/");const i=n.includes(":")||n.includes("*"),r=i?n.endsWith("/")?n.slice(0,-1)+"/*":n+"/*":n;return t.map(s=>{if(typeof s=="function")return p=>{const f=p.path;let g=!1,h={};if(i){const d=KL(r,f);d&&(g=!0,h=d)}else(f===n||f.startsWith(n))&&(g=!0);if(g){const d={...p.params,...h},y={...p,params:d};return s(y)}};if(typeof s=="object"&&s!==null&&"__rwExcept"in s&&s.__rwExcept===!0)return s;if(Array.isArray(s))return LE(e,s);const a=s;return{path:QL(e,a.path).replace(/\/+/g,"/"),handler:a.handler,...a.layouts&&{layouts:a.layouts}}})}function YL(e,t=[],n){if(t.length===0)return e;const i=Object.prototype.hasOwnProperty.call(e,"$$isClientReference");return t.reduceRight((r,o)=>a=>{const c=Object.prototype.hasOwnProperty.call(o,"$$isClientReference");return df.createElement(o,{children:df.createElement(r,i?{}:a),...c?{}:{requestInfo:n}})},e)}const XL=e=>{if(qy(e)||!ME(e)||Object.prototype.hasOwnProperty.call(e,"__rwsdk_route_component"))return e;const t=async n=>{const i=await e(n);if(i instanceof Response)throw n.rw.pageRouteResolved?.reject(i),i;return n.rw.pageRouteResolved?.resolve(),i};return t.__rwsdk_route_component=!0,t};function Ug(e,t){return t.map(n=>{if(typeof n=="function"||typeof n=="object"&&n!==null&&"__rwExcept"in n&&n.__rwExcept===!0)return n;if(Array.isArray(n))return Ug(e,n);const i=n;return{...i,layouts:[e,...i.layouts||[]]}})}function eM(e,t,n={}){return n={rscPayload:!0,ssr:!0,...n},[({rw:r})=>{r.Document=e,r.rscPayload=n.rscPayload??!0,r.ssr=n.ssr??!0},...t]}function ME(e){return Object.prototype.hasOwnProperty.call(e,"__rwsdk_route_component")||CE.isValidElementType(e)&&e.toString().includes("jsx")||qy(e)}const qy=e=>Object.prototype.hasOwnProperty.call(e,"$$isClientReference");class tM extends Error{constructor(t,n){super(n),this.code=t,this.message=n,this.name="ErrorResponse"}}const nM=()=>btoa(crypto.getRandomValues(new Uint8Array(16)).join(""));var di={},Qr={},ym={exports:{}},ki={};var d_;function rM(){if(d_)return ki;d_=1;var e=ip();function t(){}var n={d:{f:t,r:function(){throw Error("Invalid form element. requestFormReset must be passed a form that was rendered by React.")},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null};if(!e.__SERVER_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE)throw Error('The "react" package in this environment is not configured correctly. The "react-server" condition must be enabled in any environment that runs React Server Components.');function i(r,o){if(r==="font")return"";if(typeof o=="string")return o==="use-credentials"?o:""}return ki.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,ki.preconnect=function(r,o){typeof r=="string"&&(o?(o=o.crossOrigin,o=typeof o=="string"?o==="use-credentials"?o:"":void 0):o=null,n.d.C(r,o))},ki.prefetchDNS=function(r){typeof r=="string"&&n.d.D(r)},ki.preinit=function(r,o){if(typeof r=="string"&&o&&typeof o.as=="string"){var s=o.as,a=i(s,o.crossOrigin),c=typeof o.integrity=="string"?o.integrity:void 0,l=typeof o.fetchPriority=="string"?o.fetchPriority:void 0;s==="style"?n.d.S(r,typeof o.precedence=="string"?o.precedence:void 0,{crossOrigin:a,integrity:c,fetchPriority:l}):s==="script"&&n.d.X(r,{crossOrigin:a,integrity:c,fetchPriority:l,nonce:typeof o.nonce=="string"?o.nonce:void 0})}},ki.preinitModule=function(r,o){if(typeof r=="string")if(typeof o=="object"&&o!==null){if(o.as==null||o.as==="script"){var s=i(o.as,o.crossOrigin);n.d.M(r,{crossOrigin:s,integrity:typeof o.integrity=="string"?o.integrity:void 0,nonce:typeof o.nonce=="string"?o.nonce:void 0})}}else o==null&&n.d.M(r)},ki.preload=function(r,o){if(typeof r=="string"&&typeof o=="object"&&o!==null&&typeof o.as=="string"){var s=o.as,a=i(s,o.crossOrigin);n.d.L(r,s,{crossOrigin:a,integrity:typeof o.integrity=="string"?o.integrity:void 0,nonce:typeof o.nonce=="string"?o.nonce:void 0,type:typeof o.type=="string"?o.type:void 0,fetchPriority:typeof o.fetchPriority=="string"?o.fetchPriority:void 0,referrerPolicy:typeof o.referrerPolicy=="string"?o.referrerPolicy:void 0,imageSrcSet:typeof o.imageSrcSet=="string"?o.imageSrcSet:void 0,imageSizes:typeof o.imageSizes=="string"?o.imageSizes:void 0,media:typeof o.media=="string"?o.media:void 0})}},ki.preloadModule=function(r,o){if(typeof r=="string")if(o){var s=i(o.as,o.crossOrigin);n.d.m(r,{as:typeof o.as=="string"&&o.as!=="script"?o.as:void 0,crossOrigin:s,integrity:typeof o.integrity=="string"?o.integrity:void 0})}else n.d.m(r)},ki.version="19.2.3",ki}var f_;function iM(){return f_||(f_=1,ym.exports=rM()),ym.exports}var p_;function oM(){if(p_)return Qr;p_=1;var e=iM(),t=ip(),n=Symbol.for("react.element"),i=Symbol.for("react.transitional.element"),r=Symbol.for("react.fragment"),o=Symbol.for("react.context"),s=Symbol.for("react.forward_ref"),a=Symbol.for("react.suspense"),c=Symbol.for("react.suspense_list"),l=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),p=Symbol.for("react.memo_cache_sentinel"),f=Symbol.iterator;function g(m){return m===null||typeof m!="object"?null:(m=f&&m[f]||m["@@iterator"],typeof m=="function"?m:null)}var h=Symbol.asyncIterator;function d(m){setTimeout(function(){throw m})}var y=Promise,v=typeof queueMicrotask=="function"?queueMicrotask:function(m){y.resolve(null).then(m).catch(d)},x=null,E=0;function N(m,_){if(_.byteLength!==0)if(2048<_.byteLength)0<E&&(m.enqueue(new Uint8Array(x.buffer,0,E)),x=new Uint8Array(2048),E=0),m.enqueue(_);else{var A=x.length-E;A<_.byteLength&&(A===0?m.enqueue(x):(x.set(_.subarray(0,A),E),m.enqueue(x),_=_.subarray(A)),x=new Uint8Array(2048),E=0),x.set(_,E),E+=_.byteLength}return!0}var C=new TextEncoder;function b(m){return C.encode(m)}function P(m){return m.byteLength}function $(m,_){typeof m.error=="function"?m.error(_):m.close()}var k=Symbol.for("react.client.reference"),D=Symbol.for("react.server.reference");function B(m,_,A){return Object.defineProperties(m,{$$typeof:{value:k},$$id:{value:_},$$async:{value:A}})}var J=Function.prototype.bind,S=Array.prototype.slice;function T(){var m=J.apply(this,arguments);if(this.$$typeof===D){var _=S.call(arguments,1),A={value:D},O={value:this.$$id};return _={value:this.$$bound?this.$$bound.concat(_):_},Object.defineProperties(m,{$$typeof:A,$$id:O,$$bound:_,bind:{value:T,configurable:!0}})}return m}var z={value:function(){return"function () { [omitted code] }"},configurable:!0,writable:!0},L=Promise.prototype,q={get:function(m,_){switch(_){case"$$typeof":return m.$$typeof;case"$$id":return m.$$id;case"$$async":return m.$$async;case"name":return m.name;case"displayName":return;case"defaultProps":return;case"_debugInfo":return;case"toJSON":return;case Symbol.toPrimitive:return Object.prototype[Symbol.toPrimitive];case Symbol.toStringTag:return Object.prototype[Symbol.toStringTag];case"Provider":throw Error("Cannot render a Client Context Provider on the Server. Instead, you can export a Client Component wrapper that itself renders a Client Context Provider.");case"then":throw Error("Cannot await or return from a thenable. You cannot await a client module from a server component.")}throw Error("Cannot access "+(String(m.name)+"."+String(_))+" on the server. You cannot dot into a client module from a server component. You can only pass the imported name through.")},set:function(){throw Error("Cannot assign to a client module from a server module.")}};function V(m,_){switch(_){case"$$typeof":return m.$$typeof;case"$$id":return m.$$id;case"$$async":return m.$$async;case"name":return m.name;case"defaultProps":return;case"_debugInfo":return;case"toJSON":return;case Symbol.toPrimitive:return Object.prototype[Symbol.toPrimitive];case Symbol.toStringTag:return Object.prototype[Symbol.toStringTag];case"__esModule":var A=m.$$id;return m.default=B(function(){throw Error("Attempted to call the default export of "+A+" from the server but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},m.$$id+"#",m.$$async),!0;case"then":if(m.then)return m.then;if(m.$$async)return;var O=B({},m.$$id,!0),j=new Proxy(O,K);return m.status="fulfilled",m.value=j,m.then=B(function(H){return Promise.resolve(H(j))},m.$$id+"#then",!1)}if(typeof _=="symbol")throw Error("Cannot read Symbol exports. Only named exports are supported on a client module imported on the server.");return O=m[_],O||(O=B(function(){throw Error("Attempted to call "+String(_)+"() from the server but "+String(_)+" is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},m.$$id+"#"+_,m.$$async),Object.defineProperty(O,"name",{value:_}),O=m[_]=new Proxy(O,q)),O}var K={get:function(m,_){return V(m,_)},getOwnPropertyDescriptor:function(m,_){var A=Object.getOwnPropertyDescriptor(m,_);return A||(A={value:V(m,_),writable:!1,configurable:!1,enumerable:!1},Object.defineProperty(m,_,A)),A},getPrototypeOf:function(){return L},set:function(){throw Error("Cannot assign to a client module from a server module.")}},oe=e.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ne=oe.d;oe.d={f:ne.f,r:ne.r,D:X,C:ae,L:he,m:ge,X:fe,S:pe,M:xe};function X(m){if(typeof m=="string"&&m){var _=Gr();if(_){var A=_.hints,O="D|"+m;A.has(O)||(A.add(O),zn(_,"D",m))}else ne.D(m)}}function ae(m,_){if(typeof m=="string"){var A=Gr();if(A){var O=A.hints,j="C|"+(_??"null")+"|"+m;O.has(j)||(O.add(j),typeof _=="string"?zn(A,"C",[m,_]):zn(A,"C",m))}else ne.C(m,_)}}function he(m,_,A){if(typeof m=="string"){var O=Gr();if(O){var j=O.hints,H="L";if(_==="image"&&A){var te=A.imageSrcSet,re=A.imageSizes,se="";typeof te=="string"&&te!==""?(se+="["+te+"]",typeof re=="string"&&(se+="["+re+"]")):se+="[][]"+m,H+="[image]"+se}else H+="["+_+"]"+m;j.has(H)||(j.add(H),(A=Ce(A))?zn(O,"L",[m,_,A]):zn(O,"L",[m,_]))}else ne.L(m,_,A)}}function ge(m,_){if(typeof m=="string"){var A=Gr();if(A){var O=A.hints,j="m|"+m;return O.has(j)?void 0:(O.add(j),(_=Ce(_))?zn(A,"m",[m,_]):zn(A,"m",m))}ne.m(m,_)}}function pe(m,_,A){if(typeof m=="string"){var O=Gr();if(O){var j=O.hints,H="S|"+m;return j.has(H)?void 0:(j.add(H),(A=Ce(A))?zn(O,"S",[m,typeof _=="string"?_:0,A]):typeof _=="string"?zn(O,"S",[m,_]):zn(O,"S",m))}ne.S(m,_,A)}}function fe(m,_){if(typeof m=="string"){var A=Gr();if(A){var O=A.hints,j="X|"+m;return O.has(j)?void 0:(O.add(j),(_=Ce(_))?zn(A,"X",[m,_]):zn(A,"X",m))}ne.X(m,_)}}function xe(m,_){if(typeof m=="string"){var A=Gr();if(A){var O=A.hints,j="M|"+m;return O.has(j)?void 0:(O.add(j),(_=Ce(_))?zn(A,"M",[m,_]):zn(A,"M",m))}ne.M(m,_)}}function Ce(m){if(m==null)return null;var _=!1,A={},O;for(O in m)m[O]!=null&&(_=!0,A[O]=m[O]);return _?A:null}function Ze(m,_,A){switch(_){case"img":_=A.src;var O=A.srcSet;if(!(A.loading==="lazy"||!_&&!O||typeof _!="string"&&_!=null||typeof O!="string"&&O!=null||A.fetchPriority==="low"||m&3)&&(typeof _!="string"||_[4]!==":"||_[0]!=="d"&&_[0]!=="D"||_[1]!=="a"&&_[1]!=="A"||_[2]!=="t"&&_[2]!=="T"||_[3]!=="a"&&_[3]!=="A")&&(typeof O!="string"||O[4]!==":"||O[0]!=="d"&&O[0]!=="D"||O[1]!=="a"&&O[1]!=="A"||O[2]!=="t"&&O[2]!=="T"||O[3]!=="a"&&O[3]!=="A")){var j=typeof A.sizes=="string"?A.sizes:void 0,H=A.crossOrigin;he(_||"","image",{imageSrcSet:O,imageSizes:j,crossOrigin:typeof H=="string"?H==="use-credentials"?H:"":void 0,integrity:A.integrity,type:A.type,fetchPriority:A.fetchPriority,referrerPolicy:A.referrerPolicy})}return m;case"link":if(_=A.rel,O=A.href,!(m&1||A.itemProp!=null||typeof _!="string"||typeof O!="string"||O===""))switch(_){case"preload":he(O,A.as,{crossOrigin:A.crossOrigin,integrity:A.integrity,nonce:A.nonce,type:A.type,fetchPriority:A.fetchPriority,referrerPolicy:A.referrerPolicy,imageSrcSet:A.imageSrcSet,imageSizes:A.imageSizes,media:A.media});break;case"modulepreload":ge(O,{as:A.as,crossOrigin:A.crossOrigin,integrity:A.integrity,nonce:A.nonce});break;case"stylesheet":he(O,"stylesheet",{crossOrigin:A.crossOrigin,integrity:A.integrity,nonce:A.nonce,type:A.type,fetchPriority:A.fetchPriority,referrerPolicy:A.referrerPolicy,media:A.media})}return m;case"picture":return m|2;case"noscript":return m|1;default:return m}}var st=typeof AsyncLocalStorage=="function",Ke=st?new AsyncLocalStorage:null,we=Symbol.for("react.temporary.reference"),Ue={get:function(m,_){switch(_){case"$$typeof":return m.$$typeof;case"name":return;case"displayName":return;case"defaultProps":return;case"_debugInfo":return;case"toJSON":return;case Symbol.toPrimitive:return Object.prototype[Symbol.toPrimitive];case Symbol.toStringTag:return Object.prototype[Symbol.toStringTag];case"Provider":throw Error("Cannot render a Client Context Provider on the Server. Instead, you can export a Client Component wrapper that itself renders a Client Context Provider.");case"then":return}throw Error("Cannot access "+String(_)+" on the server. You cannot dot into a temporary client reference from a server component. You can only pass the value through to the client.")},set:function(){throw Error("Cannot assign to a temporary client reference from a server module.")}};function Ct(m,_){var A=Object.defineProperties(function(){throw Error("Attempted to call a temporary Client Reference from the server but it is on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},{$$typeof:{value:we}});return A=new Proxy(A,Ue),m.set(A,_),A}function Ie(){}var We=Error("Suspense Exception: This is not a real error! It's an implementation detail of `use` to interrupt the current render. You must either rethrow it immediately, or move the `use` call outside of the `try/catch` block. Capturing without rethrowing will lead to unexpected behavior.\n\nTo handle async errors, wrap your component in an error boundary, or call the promise's `.catch` method and pass the result to `use`.");function Ge(m,_,A){switch(A=m[A],A===void 0?m.push(_):A!==_&&(_.then(Ie,Ie),_=A),_.status){case"fulfilled":return _.value;case"rejected":throw _.reason;default:switch(typeof _.status=="string"?_.then(Ie,Ie):(m=_,m.status="pending",m.then(function(O){if(_.status==="pending"){var j=_;j.status="fulfilled",j.value=O}},function(O){if(_.status==="pending"){var j=_;j.status="rejected",j.reason=O}})),_.status){case"fulfilled":return _.value;case"rejected":throw _.reason}throw _t=_,We}}var _t=null;function vt(){if(_t===null)throw Error("Expected a suspended thenable. This is a bug in React. Please file an issue.");var m=_t;return _t=null,m}var Le=null,Be=0,Oe=null;function kn(){var m=Oe||[];return Oe=null,m}var En={readContext:I,use:G,useCallback:function(m){return m},useContext:I,useEffect:Xt,useImperativeHandle:Xt,useLayoutEffect:Xt,useInsertionEffect:Xt,useMemo:function(m){return m()},useReducer:Xt,useRef:Xt,useState:Xt,useDebugValue:function(){},useDeferredValue:Xt,useTransition:Xt,useSyncExternalStore:Xt,useId:U,useHostTransitionStatus:Xt,useFormState:Xt,useActionState:Xt,useOptimistic:Xt,useMemoCache:function(m){for(var _=Array(m),A=0;A<m;A++)_[A]=p;return _},useCacheRefresh:function(){return w}};En.useEffectEvent=Xt;function Xt(){throw Error("This Hook is not supported in Server Components.")}function w(){throw Error("Refreshing the cache is not supported in Server Components.")}function I(){throw Error("Cannot read a Client Context from a Server Component.")}function U(){if(Le===null)throw Error("useId can only be used while React is rendering");var m=Le.identifierCount++;return"_"+Le.identifierPrefix+"S_"+m.toString(32)+"_"}function G(m){if(m!==null&&typeof m=="object"||typeof m=="function"){if(typeof m.then=="function"){var _=Be;return Be+=1,Oe===null&&(Oe=[]),Ge(Oe,m,_)}m.$$typeof===o&&I()}throw m.$$typeof===k?m.value!=null&&m.value.$$typeof===o?Error("Cannot read a Client Context from a Server Component."):Error("Cannot use() an already resolved Client Reference."):Error("An unsupported type was passed to use(): "+String(m))}var Q={getCacheForType:function(m){var _=(_=Gr())?_.cache:new Map,A=_.get(m);return A===void 0&&(A=m(),_.set(m,A)),A},cacheSignal:function(){var m=Gr();return m?m.cacheController.signal:null}},ee=t.__SERVER_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;if(!ee)throw Error('The "react" package in this environment is not configured correctly. The "react-server" condition must be enabled in any environment that runs React Server Components.');var de=Array.isArray,wt=Object.getPrototypeOf;function kt(m){return m=Object.prototype.toString.call(m),m.slice(8,m.length-1)}function Et(m){switch(typeof m){case"string":return JSON.stringify(10>=m.length?m:m.slice(0,10)+"...");case"object":return de(m)?"[...]":m!==null&&m.$$typeof===It?"client":(m=kt(m),m==="Object"?"{...}":m);case"function":return m.$$typeof===It?"client":(m=m.displayName||m.name)?"function "+m:"function";default:return String(m)}}function dt(m){if(typeof m=="string")return m;switch(m){case a:return"Suspense";case c:return"SuspenseList"}if(typeof m=="object")switch(m.$$typeof){case s:return dt(m.render);case l:return dt(m.type);case u:var _=m._payload;m=m._init;try{return dt(m(_))}catch{}}return""}var It=Symbol.for("react.client.reference");function Jr(m,_){var A=kt(m);if(A!=="Object"&&A!=="Array")return A;A=-1;var O=0;if(de(m)){for(var j="[",H=0;H<m.length;H++){0<H&&(j+=", ");var te=m[H];te=typeof te=="object"&&te!==null?Jr(te):Et(te),""+H===_?(A=j.length,O=te.length,j+=te):j=10>te.length&&40>j.length+te.length?j+te:j+"..."}j+="]"}else if(m.$$typeof===i)j="<"+dt(m.type)+"/>";else{if(m.$$typeof===It)return"client";for(j="{",H=Object.keys(m),te=0;te<H.length;te++){0<te&&(j+=", ");var re=H[te],se=JSON.stringify(re);j+=('"'+re+'"'===se?re:se)+": ",se=m[re],se=typeof se=="object"&&se!==null?Jr(se):Et(se),re===_?(A=j.length,O=se.length,j+=se):j=10>se.length&&40>j.length+se.length?j+se:j+"..."}j+="}"}return _===void 0?j:-1<A&&0<O?(m=" ".repeat(A)+"^".repeat(O),`
  `+j+`
  `+m):`
  `+j}var Hi=Object.prototype.hasOwnProperty,ca=Object.prototype,ui=JSON.stringify;function vn(m){console.error(m)}function Er(m,_,A,O,j,H,te,re,se){if(ee.A!==null&&ee.A!==Q)throw Error("Currently React only supports one RSC renderer at a time.");ee.A=Q;var be=new Set,At=[],vr=new Set;this.type=m,this.status=10,this.flushScheduled=!1,this.destination=this.fatalError=null,this.bundlerConfig=A,this.cache=new Map,this.cacheController=new AbortController,this.pendingChunks=this.nextChunkId=0,this.hints=vr,this.abortableTasks=be,this.pingedTasks=At,this.completedImportChunks=[],this.completedHintChunks=[],this.completedRegularChunks=[],this.completedErrorChunks=[],this.writtenSymbols=new Map,this.writtenClientReferences=new Map,this.writtenServerReferences=new Map,this.writtenObjects=new WeakMap,this.temporaryReferences=se,this.identifierPrefix=re||"",this.identifierCount=1,this.taintCleanupQueue=[],this.onError=O===void 0?vn:O,this.onPostpone=j===void 0?Ie:j,this.onAllReady=H,this.onFatalError=te,m=No(this,_,null,!1,0,be),At.push(m)}var gr=null;function Gr(){if(gr)return gr;if(st){var m=Ke.getStore();if(m)return m}return null}function la(m,_,A){var O=No(m,A,_.keyPath,_.implicitSlot,_.formatContext,m.abortableTasks);switch(A.status){case"fulfilled":return O.model=A.value,Cc(m,O),O.id;case"rejected":return Ji(m,O,A.reason),O.id;default:if(m.status===12)return m.abortableTasks.delete(O),m.type===21?(ua(O),da(O,m)):(_=m.fatalError,im(O),om(O,m,_)),O.id;typeof A.status!="string"&&(A.status="pending",A.then(function(j){A.status==="pending"&&(A.status="fulfilled",A.value=j)},function(j){A.status==="pending"&&(A.status="rejected",A.reason=j)}))}return A.then(function(j){O.model=j,Cc(m,O)},function(j){O.status===0&&(Ji(m,O,j),Zr(m))}),O.id}function tm(m,_,A){function O(be){if(se.status===0)if(be.done)se.status=1,be=se.id.toString(16)+`:C
`,m.completedRegularChunks.push(b(be)),m.abortableTasks.delete(se),m.cacheController.signal.removeEventListener("abort",H),Zr(m),ld(m);else try{se.model=be.value,m.pendingChunks++,M0(m,se),Zr(m),re.read().then(O,j)}catch(At){j(At)}}function j(be){se.status===0&&(m.cacheController.signal.removeEventListener("abort",H),Ji(m,se,be),Zr(m),re.cancel(be).then(j,j))}function H(){if(se.status===0){var be=m.cacheController.signal;be.removeEventListener("abort",H),be=be.reason,m.type===21?(m.abortableTasks.delete(se),ua(se),da(se,m)):(Ji(m,se,be),Zr(m)),re.cancel(be).then(j,j)}}var te=A.supportsBYOB;if(te===void 0)try{A.getReader({mode:"byob"}).releaseLock(),te=!0}catch{te=!1}var re=A.getReader(),se=No(m,_.model,_.keyPath,_.implicitSlot,_.formatContext,m.abortableTasks);return m.pendingChunks++,_=se.id.toString(16)+":"+(te?"r":"R")+`
`,m.completedRegularChunks.push(b(_)),m.cacheController.signal.addEventListener("abort",H),re.read().then(O,j),$n(se.id)}function nm(m,_,A,O){function j(se){if(re.status===0)if(se.done){if(re.status=1,se.value===void 0)var be=re.id.toString(16)+`:C
`;else try{var At=us(m,se.value,0);be=re.id.toString(16)+":C"+ui($n(At))+`
`}catch(vr){H(vr);return}m.completedRegularChunks.push(b(be)),m.abortableTasks.delete(re),m.cacheController.signal.removeEventListener("abort",te),Zr(m),ld(m)}else try{re.model=se.value,m.pendingChunks++,M0(m,re),Zr(m),O.next().then(j,H)}catch(vr){H(vr)}}function H(se){re.status===0&&(m.cacheController.signal.removeEventListener("abort",te),Ji(m,re,se),Zr(m),typeof O.throw=="function"&&O.throw(se).then(H,H))}function te(){if(re.status===0){var se=m.cacheController.signal;se.removeEventListener("abort",te);var be=se.reason;m.type===21?(m.abortableTasks.delete(re),ua(re),da(re,m)):(Ji(m,re,se.reason),Zr(m)),typeof O.throw=="function"&&O.throw(be).then(H,H)}}A=A===O;var re=No(m,_.model,_.keyPath,_.implicitSlot,_.formatContext,m.abortableTasks);return m.pendingChunks++,_=re.id.toString(16)+":"+(A?"x":"X")+`
`,m.completedRegularChunks.push(b(_)),m.cacheController.signal.addEventListener("abort",te),O.next().then(j,H),$n(re.id)}function zn(m,_,A){A=ui(A),_=b(":H"+_+A+`
`),m.completedHintChunks.push(_),Zr(m)}function $c(m){if(m.status==="fulfilled")return m.value;throw m.status==="rejected"?m.reason:m}function nd(m,_,A){switch(A.status){case"fulfilled":return A.value;case"rejected":break;default:typeof A.status!="string"&&(A.status="pending",A.then(function(O){A.status==="pending"&&(A.status="fulfilled",A.value=O)},function(O){A.status==="pending"&&(A.status="rejected",A.reason=O)}))}return{$$typeof:u,_payload:A,_init:$c}}function rd(){}function id(m,_,A,O){if(typeof O!="object"||O===null||O.$$typeof===k)return O;if(typeof O.then=="function")return nd(m,_,O);var j=g(O);return j?(m={},m[Symbol.iterator]=function(){return j.call(O)},m):typeof O[h]!="function"||typeof ReadableStream=="function"&&O instanceof ReadableStream?O:(m={},m[h]=function(){return O[h]()},m)}function od(m,_,A,O,j){var H=_.thenableState;if(_.thenableState=null,Be=0,Oe=H,j=O(j,void 0),m.status===12)throw typeof j=="object"&&j!==null&&typeof j.then=="function"&&j.$$typeof!==k&&j.then(rd,rd),null;return j=id(m,_,O,j),O=_.keyPath,H=_.implicitSlot,A!==null?_.keyPath=O===null?A:O+","+A:O===null&&(_.implicitSlot=!0),m=Oc(m,_,ad,"",j),_.keyPath=O,_.implicitSlot=H,m}function $0(m,_,A){return _.keyPath!==null?(m=[i,r,_.keyPath,{children:A}],_.implicitSlot?[m]:m):A}var Io=0;function C0(m,_){return _=No(m,_.model,_.keyPath,_.implicitSlot,_.formatContext,m.abortableTasks),Cc(m,_),ls(_.id)}function rm(m,_,A,O,j,H){if(j!=null)throw Error("Refs cannot be used in Server Components, nor passed to Client Components.");if(typeof A=="function"&&A.$$typeof!==k&&A.$$typeof!==we)return od(m,_,O,A,H);if(A===r&&O===null)return A=_.implicitSlot,_.keyPath===null&&(_.implicitSlot=!0),H=Oc(m,_,ad,"",H.children),_.implicitSlot=A,H;if(A!=null&&typeof A=="object"&&A.$$typeof!==k)switch(A.$$typeof){case u:var te=A._init;if(A=te(A._payload),m.status===12)throw null;return rm(m,_,A,O,j,H);case s:return od(m,_,O,A.render,H);case l:return rm(m,_,A.type,O,j,H)}else typeof A=="string"&&(j=_.formatContext,te=Ze(j,A,H),j!==te&&H.children!=null&&us(m,H.children,te));return m=O,O=_.keyPath,m===null?m=O:O!==null&&(m=O+","+m),H=[i,A,m,H],_=_.implicitSlot&&m!==null?[H]:H,_}function Cc(m,_){var A=m.pingedTasks;A.push(_),A.length===1&&(m.flushScheduled=m.destination!==null,m.type===21||m.status===10?v(function(){return cd(m)}):setTimeout(function(){return cd(m)},0))}function No(m,_,A,O,j,H){m.pendingChunks++;var te=m.nextChunkId++;typeof _!="object"||_===null||A!==null||O||m.writtenObjects.set(_,$n(te));var re={id:te,status:0,model:_,keyPath:A,implicitSlot:O,formatContext:j,ping:function(){return Cc(m,re)},toJSON:function(se,be){Io+=se.length;var At=re.keyPath,vr=re.implicitSlot;try{var sr=Oc(m,re,this,se,be)}catch(hd){if(se=re.model,se=typeof se=="object"&&se!==null&&(se.$$typeof===i||se.$$typeof===u),m.status===12)re.status=3,m.type===21?(At=m.nextChunkId++,At=se?ls(At):$n(At),sr=At):(At=m.fatalError,sr=se?ls(At):$n(At));else if(be=hd===We?vt():hd,typeof be=="object"&&be!==null&&typeof be.then=="function"){sr=No(m,re.model,re.keyPath,re.implicitSlot,re.formatContext,m.abortableTasks);var pd=sr.ping;be.then(pd,pd),sr.thenableState=kn(),re.keyPath=At,re.implicitSlot=vr,sr=se?ls(sr.id):$n(sr.id)}else re.keyPath=At,re.implicitSlot=vr,m.pendingChunks++,At=m.nextChunkId++,vr=Ki(m,be),sd(m,At,vr),sr=se?ls(At):$n(At)}return sr},thenableState:null};return H.add(re),re}function $n(m){return"$"+m.toString(16)}function ls(m){return"$L"+m.toString(16)}function O0(m,_,A){return m=ui(A),_=_.toString(16)+":"+m+`
`,b(_)}function R0(m,_,A,O){var j=O.$$async?O.$$id+"#async":O.$$id,H=m.writtenClientReferences,te=H.get(j);if(te!==void 0)return _[0]===i&&A==="1"?ls(te):$n(te);try{var re=m.bundlerConfig,se=O.$$id;te="";var be=re[se];if(be)te=be.name;else{var At=se.lastIndexOf("#");if(At!==-1&&(te=se.slice(At+1),be=re[se.slice(0,At)]),!be)throw Error('Could not find the module "'+se+'" in the React Client Manifest. This is probably a bug in the React Server Components bundler.')}if(be.async===!0&&O.$$async===!0)throw Error('The module "'+se+'" is marked as an async ESM module but was loaded as a CJS proxy. This is probably a bug in the React Server Components bundler.');var vr=be.async===!0||O.$$async===!0?[be.id,be.chunks,te,1]:[be.id,be.chunks,te];m.pendingChunks++;var sr=m.nextChunkId++,pd=ui(vr),hd=sr.toString(16)+":I"+pd+`
`,gD=b(hd);return m.completedImportChunks.push(gD),H.set(j,sr),_[0]===i&&A==="1"?ls(sr):$n(sr)}catch(yD){return m.pendingChunks++,_=m.nextChunkId++,A=Ki(m,yD),sd(m,_,A),$n(_)}}function us(m,_,A){return _=No(m,_,null,!1,A,m.abortableTasks),L0(m,_),_.id}function Ar(m,_,A){m.pendingChunks++;var O=m.nextChunkId++;return yr(m,O,_,A,!1),$n(O)}function iD(m,_){function A(se){if(te.status===0)if(se.done)m.cacheController.signal.removeEventListener("abort",j),Cc(m,te);else return H.push(se.value),re.read().then(A).catch(O)}function O(se){te.status===0&&(m.cacheController.signal.removeEventListener("abort",j),Ji(m,te,se),Zr(m),re.cancel(se).then(O,O))}function j(){if(te.status===0){var se=m.cacheController.signal;se.removeEventListener("abort",j),se=se.reason,m.type===21?(m.abortableTasks.delete(te),ua(te),da(te,m)):(Ji(m,te,se),Zr(m)),re.cancel(se).then(O,O)}}var H=[_.type],te=No(m,H,null,!1,0,m.abortableTasks),re=_.stream().getReader();return m.cacheController.signal.addEventListener("abort",j),re.read().then(A).catch(O),"$B"+te.id.toString(16)}var $o=!1;function Oc(m,_,A,O,j){if(_.model=j,j===i)return"$";if(j===null)return null;if(typeof j=="object"){switch(j.$$typeof){case i:var H=null,te=m.writtenObjects;if(_.keyPath===null&&!_.implicitSlot){var re=te.get(j);if(re!==void 0)if($o===j)$o=null;else return re;else O.indexOf(":")===-1&&(A=te.get(A),A!==void 0&&(H=A+":"+O,te.set(j,H)))}return 3200<Io?C0(m,_):(O=j.props,A=O.ref,m=rm(m,_,j.type,j.key,A!==void 0?A:null,O),typeof m=="object"&&m!==null&&H!==null&&(te.has(m)||te.set(m,H)),m);case u:if(3200<Io)return C0(m,_);if(_.thenableState=null,O=j._init,j=O(j._payload),m.status===12)throw null;return Oc(m,_,ad,"",j);case n:throw Error(`A React Element from an older version of React was rendered. This is not supported. It can happen if:
- Multiple copies of the "react" package is used.
- A library pre-bundled an old copy of "react" or "react/jsx-runtime".
- A compiler tries to "inline" JSX instead of using the runtime.`)}if(j.$$typeof===k)return R0(m,A,O,j);if(m.temporaryReferences!==void 0&&(H=m.temporaryReferences.get(j),H!==void 0))return"$T"+H;if(H=m.writtenObjects,te=H.get(j),typeof j.then=="function"){if(te!==void 0){if(_.keyPath!==null||_.implicitSlot)return"$@"+la(m,_,j).toString(16);if($o===j)$o=null;else return te}return m="$@"+la(m,_,j).toString(16),H.set(j,m),m}if(te!==void 0)if($o===j){if(te!==$n(_.id))return te;$o=null}else return te;else if(O.indexOf(":")===-1&&(te=H.get(A),te!==void 0)){if(re=O,de(A)&&A[0]===i)switch(O){case"1":re="type";break;case"2":re="key";break;case"3":re="props";break;case"4":re="_owner"}H.set(j,te+":"+re)}if(de(j))return $0(m,_,j);if(j instanceof Map)return j=Array.from(j),"$Q"+us(m,j,0).toString(16);if(j instanceof Set)return j=Array.from(j),"$W"+us(m,j,0).toString(16);if(typeof FormData=="function"&&j instanceof FormData)return j=Array.from(j.entries()),"$K"+us(m,j,0).toString(16);if(j instanceof Error)return"$Z";if(j instanceof ArrayBuffer)return Ar(m,"A",new Uint8Array(j));if(j instanceof Int8Array)return Ar(m,"O",j);if(j instanceof Uint8Array)return Ar(m,"o",j);if(j instanceof Uint8ClampedArray)return Ar(m,"U",j);if(j instanceof Int16Array)return Ar(m,"S",j);if(j instanceof Uint16Array)return Ar(m,"s",j);if(j instanceof Int32Array)return Ar(m,"L",j);if(j instanceof Uint32Array)return Ar(m,"l",j);if(j instanceof Float32Array)return Ar(m,"G",j);if(j instanceof Float64Array)return Ar(m,"g",j);if(j instanceof BigInt64Array)return Ar(m,"M",j);if(j instanceof BigUint64Array)return Ar(m,"m",j);if(j instanceof DataView)return Ar(m,"V",j);if(typeof Blob=="function"&&j instanceof Blob)return iD(m,j);if(H=g(j))return O=H.call(j),O===j?(j=Array.from(O),"$i"+us(m,j,0).toString(16)):$0(m,_,Array.from(O));if(typeof ReadableStream=="function"&&j instanceof ReadableStream)return tm(m,_,j);if(H=j[h],typeof H=="function")return _.keyPath!==null?(m=[i,r,_.keyPath,{children:j}],m=_.implicitSlot?[m]:m):(O=H.call(j),m=nm(m,_,j,O)),m;if(j instanceof Date)return"$D"+j.toJSON();if(m=wt(j),m!==ca&&(m===null||wt(m)!==null))throw Error("Only plain objects, and a few built-ins, can be passed to Client Components from Server Components. Classes or null prototypes are not supported."+Jr(A,O));return j}if(typeof j=="string")return Io+=j.length,j[j.length-1]==="Z"&&A[O]instanceof Date?"$D"+j:1024<=j.length&&P!==null?(m.pendingChunks++,_=m.nextChunkId++,D0(m,_,j,!1),$n(_)):(m=j[0]==="$"?"$"+j:j,m);if(typeof j=="boolean")return j;if(typeof j=="number")return Number.isFinite(j)?j===0&&1/j===-1/0?"$-0":j:j===1/0?"$Infinity":j===-1/0?"$-Infinity":"$NaN";if(typeof j>"u")return"$undefined";if(typeof j=="function"){if(j.$$typeof===k)return R0(m,A,O,j);if(j.$$typeof===D)return _=m.writtenServerReferences,O=_.get(j),O!==void 0?m="$h"+O.toString(16):(O=j.$$bound,O=O===null?null:Promise.resolve(O),m=us(m,{id:j.$$id,bound:O},0),_.set(j,m),m="$h"+m.toString(16)),m;if(m.temporaryReferences!==void 0&&(m=m.temporaryReferences.get(j),m!==void 0))return"$T"+m;throw j.$$typeof===we?Error("Could not reference an opaque temporary reference. This is likely due to misconfiguring the temporaryReferences options on the server."):/^on[A-Z]/.test(O)?Error("Event handlers cannot be passed to Client Component props."+Jr(A,O)+`
If you need interactivity, consider converting part of this to a Client Component.`):Error('Functions cannot be passed directly to Client Components unless you explicitly expose it by marking it with "use server". Or maybe you meant to call this function rather than return it.'+Jr(A,O))}if(typeof j=="symbol"){if(_=m.writtenSymbols,H=_.get(j),H!==void 0)return $n(H);if(H=j.description,Symbol.for(H)!==j)throw Error("Only global symbols received from Symbol.for(...) can be passed to Client Components. The symbol Symbol.for("+(j.description+") cannot be found among global symbols.")+Jr(A,O));return m.pendingChunks++,O=m.nextChunkId++,A=O0(m,O,"$S"+H),m.completedImportChunks.push(A),_.set(j,O),$n(O)}if(typeof j=="bigint")return"$n"+j.toString(10);throw Error("Type "+typeof j+" is not supported in Client Component props."+Jr(A,O))}function Ki(m,_){var A=gr;gr=null;try{var O=m.onError,j=st?Ke.run(void 0,O,_):O(_)}finally{gr=A}if(j!=null&&typeof j!="string")throw Error('onError returned something with a type other than "string". onError should return a string and may return null or undefined but must not return anything else. It received something of type "'+typeof j+'" instead');return j||""}function Rc(m,_){var A=m.onFatalError;A(_),m.destination!==null?(m.status=14,$(m.destination,_)):(m.status=13,m.fatalError=_),m.cacheController.abort(Error("The render was aborted due to a fatal error.",{cause:_}))}function sd(m,_,A){A={digest:A},_=_.toString(16)+":E"+ui(A)+`
`,_=b(_),m.completedErrorChunks.push(_)}function P0(m,_,A){_=_.toString(16)+":"+A+`
`,_=b(_),m.completedRegularChunks.push(_)}function yr(m,_,A,O,j){j?m.pendingDebugChunks++:m.pendingChunks++,j=new Uint8Array(O.buffer,O.byteOffset,O.byteLength),O=2048<O.byteLength?j.slice():j,j=O.byteLength,_=_.toString(16)+":"+A+j.toString(16)+",",_=b(_),m.completedRegularChunks.push(_,O)}function D0(m,_,A,O){if(P===null)throw Error("Existence of byteLengthOfChunk should have already been checked. This is a bug in React.");O?m.pendingDebugChunks++:m.pendingChunks++,A=b(A),O=A.byteLength,_=_.toString(16)+":T"+O.toString(16)+",",_=b(_),m.completedRegularChunks.push(_,A)}function U0(m,_,A){var O=_.id;typeof A=="string"&&P!==null?D0(m,O,A,!1):A instanceof ArrayBuffer?yr(m,O,"A",new Uint8Array(A),!1):A instanceof Int8Array?yr(m,O,"O",A,!1):A instanceof Uint8Array?yr(m,O,"o",A,!1):A instanceof Uint8ClampedArray?yr(m,O,"U",A,!1):A instanceof Int16Array?yr(m,O,"S",A,!1):A instanceof Uint16Array?yr(m,O,"s",A,!1):A instanceof Int32Array?yr(m,O,"L",A,!1):A instanceof Uint32Array?yr(m,O,"l",A,!1):A instanceof Float32Array?yr(m,O,"G",A,!1):A instanceof Float64Array?yr(m,O,"g",A,!1):A instanceof BigInt64Array?yr(m,O,"M",A,!1):A instanceof BigUint64Array?yr(m,O,"m",A,!1):A instanceof DataView?yr(m,O,"V",A,!1):(A=ui(A,_.toJSON),P0(m,_.id,A))}function Ji(m,_,A){_.status=4,A=Ki(m,A),sd(m,_.id,A),m.abortableTasks.delete(_),ld(m)}var ad={};function L0(m,_){if(_.status===0){_.status=5;var A=Io;try{$o=_.model;var O=Oc(m,_,ad,"",_.model);if($o=O,_.keyPath=null,_.implicitSlot=!1,typeof O=="object"&&O!==null)m.writtenObjects.set(O,$n(_.id)),U0(m,_,O);else{var j=ui(O);P0(m,_.id,j)}_.status=1,m.abortableTasks.delete(_),ld(m)}catch(se){if(m.status===12)if(m.abortableTasks.delete(_),_.status=0,m.type===21)ua(_),da(_,m);else{var H=m.fatalError;im(_),om(_,m,H)}else{var te=se===We?vt():se;if(typeof te=="object"&&te!==null&&typeof te.then=="function"){_.status=0,_.thenableState=kn();var re=_.ping;te.then(re,re)}else Ji(m,_,te)}}finally{Io=A}}}function M0(m,_){var A=Io;try{U0(m,_,_.model)}finally{Io=A}}function cd(m){var _=ee.H;ee.H=En;var A=gr;Le=gr=m;try{var O=m.pingedTasks;m.pingedTasks=[];for(var j=0;j<O.length;j++)L0(m,O[j]);fa(m)}catch(H){Ki(m,H),Rc(m,H)}finally{ee.H=_,Le=null,gr=A}}function im(m){m.status===0&&(m.status=3)}function om(m,_,A){m.status===3&&(A=$n(A),m=O0(_,m.id,A),_.completedErrorChunks.push(m))}function ua(m){m.status===0&&(m.status=3)}function da(m,_){m.status===3&&_.pendingChunks--}function fa(m){var _=m.destination;if(_!==null){x=new Uint8Array(2048),E=0;try{for(var A=m.completedImportChunks,O=0;O<A.length;O++)m.pendingChunks--,N(_,A[O]);A.splice(0,O);var j=m.completedHintChunks;for(O=0;O<j.length;O++)N(_,j[O]);j.splice(0,O);var H=m.completedRegularChunks;for(O=0;O<H.length;O++)m.pendingChunks--,N(_,H[O]);H.splice(0,O);var te=m.completedErrorChunks;for(O=0;O<te.length;O++)m.pendingChunks--,N(_,te[O]);te.splice(0,O)}finally{m.flushScheduled=!1,x&&0<E&&(_.enqueue(new Uint8Array(x.buffer,0,E)),x=null,E=0)}}m.pendingChunks===0&&(12>m.status&&m.cacheController.abort(Error("This render completed successfully. All cacheSignals are now aborted to allow clean up of any unused resources.")),m.destination!==null&&(m.status=14,m.destination.close(),m.destination=null))}function j0(m){m.flushScheduled=m.destination!==null,v(st?function(){Ke.run(m,cd,m)}:function(){return cd(m)}),setTimeout(function(){m.status===10&&(m.status=11)},0)}function Zr(m){m.flushScheduled===!1&&m.pingedTasks.length===0&&m.destination!==null&&(m.flushScheduled=!0,setTimeout(function(){m.flushScheduled=!1,fa(m)},0))}function ld(m){m.abortableTasks.size===0&&(m=m.onAllReady,m())}function z0(m,_){if(m.status===13)m.status=14,$(_,m.fatalError);else if(m.status!==14&&m.destination===null){m.destination=_;try{fa(m)}catch(A){Ki(m,A),Rc(m,A)}}}function oD(m,_){try{_.forEach(function(O){return da(O,m)});var A=m.onAllReady;A(),fa(m)}catch(O){Ki(m,O),Rc(m,O)}}function sD(m,_,A){try{_.forEach(function(j){return om(j,m,A)});var O=m.onAllReady;O(),fa(m)}catch(j){Ki(m,j),Rc(m,j)}}function pa(m,_){if(!(11<m.status))try{m.status=12,m.cacheController.abort(_);var A=m.abortableTasks;if(0<A.size)if(m.type===21)A.forEach(function(re){return ua(re,m)}),setTimeout(function(){return oD(m,A)},0);else{var O=_===void 0?Error("The render was aborted by the server without a reason."):typeof _=="object"&&_!==null&&typeof _.then=="function"?Error("The render was aborted by the server with a promise."):_,j=Ki(m,O,null),H=m.nextChunkId++;m.fatalError=H,m.pendingChunks++,sd(m,H,j,O,!1,null),A.forEach(function(re){return im(re,m,H)}),setTimeout(function(){return sD(m,A,H)},0)}else{var te=m.onAllReady;te(),fa(m)}}catch(re){Ki(m,re),Rc(m,re)}}function B0(m,_){var A="",O=m[_];if(O)A=O.name;else{var j=_.lastIndexOf("#");if(j!==-1&&(A=_.slice(j+1),O=m[_.slice(0,j)]),!O)throw Error('Could not find the module "'+_+'" in the React Server Manifest. This is probably a bug in the React Server Components bundler.')}return O.async?[O.id,O.chunks,A,1]:[O.id,O.chunks,A]}var ud=new Map;function F0(m){var _=__webpack_require__(m);return typeof _.then!="function"||_.status==="fulfilled"?null:(_.then(function(A){_.status="fulfilled",_.value=A},function(A){_.status="rejected",_.reason=A}),_)}function aD(){}function W0(m){for(var _=m[1],A=[],O=0;O<_.length;){var j=_[O++];_[O++];var H=ud.get(j);if(H===void 0){H=__webpack_chunk_load__(j),A.push(H);var te=ud.set.bind(ud,j,null);H.then(te,aD),ud.set(j,H)}else H!==null&&A.push(H)}return m.length===4?A.length===0?F0(m[0]):Promise.all(A).then(function(){return F0(m[0])}):0<A.length?Promise.all(A):null}function Pc(m){var _=__webpack_require__(m[0]);if(m.length===4&&typeof _.then=="function")if(_.status==="fulfilled")_=_.value;else throw _.reason;if(m[2]==="*")return _;if(m[2]==="")return _.__esModule?_.default:_;if(Hi.call(_,m[2]))return _[m[2]]}var dd=Symbol();function wr(m,_,A){this.status=m,this.value=_,this.reason=A}wr.prototype=Object.create(Promise.prototype),wr.prototype.then=function(m,_){switch(this.status==="resolved_model"&&fd(this),this.status){case"fulfilled":if(typeof m=="function"){for(var A=this.value,O=0;A instanceof wr;){if(O++,A===this||1e3<O){typeof _=="function"&&_(Error("Cannot have cyclic thenables."));return}if(A.status==="fulfilled")A=A.value;else break}m(this.value)}break;case"pending":case"blocked":typeof m=="function"&&(this.value===null&&(this.value=[]),this.value.push(m)),typeof _=="function"&&(this.reason===null&&(this.reason=[]),this.reason.push(_));break;default:typeof _=="function"&&_(this.reason)}};function ha(m,_,A){for(var O=0;O<_.length;O++){var j=_[O];typeof j=="function"?j(A):lm(m,j,A)}}function V0(m,_,A){for(var O=0;O<_.length;O++){var j=_[O];typeof j=="function"?j(A):G0(m,j.handler,A)}}function q0(m,_){var A=_.handler.chunk;if(A===null)return null;if(A===m)return _.handler;if(_=A.value,_!==null)for(A=0;A<_.length;A++){var O=_[A];if(typeof O!="function"&&(O=q0(m,O),O!==null))return O}return null}function Dc(m,_,A){if(_.status!=="pending"&&_.status!=="blocked")_.reason.error(A);else{var O=_.reason;_.status="rejected",_.reason=A,O!==null&&V0(m,O,A)}}function H0(m,_,A){var O={};return new wr("resolved_model",_,(O.id=A,O[dd]=m,O))}function sm(m,_,A,O){if(_.status!=="pending")_=_.reason,A[0]==="C"?_.close(A==="C"?'"$undefined"':A.slice(1)):_.enqueueModel(A);else{var j=_.value,H=_.reason;if(_.status="resolved_model",_.value=A,A={},_.reason=(A.id=O,A[dd]=m,A),j!==null)e:switch(fd(_),_.status){case"fulfilled":ha(m,j,_.value);break;case"blocked":for(A=0;A<j.length;A++)if(O=j[A],typeof O!="function"){var te=q0(_,O);if(te!==null)switch(lm(m,O,te.value),j.splice(A,1),A--,H!==null&&(O=H.indexOf(O),O!==-1&&H.splice(O,1)),_.status){case"fulfilled":ha(m,j,_.value);break e;case"rejected":H!==null&&V0(m,H,_.reason);break e}}case"pending":if(_.value)for(m=0;m<j.length;m++)_.value.push(j[m]);else _.value=j;if(_.reason){if(H)for(j=0;j<H.length;j++)_.reason.push(H[j])}else _.reason=H;break;case"rejected":H&&ha(m,H,_.reason)}}}function K0(m,_,A){var O={};return new wr("resolved_model",(A?'{"done":true,"value":':'{"done":false,"value":')+_+"}",(O.id=-1,O[dd]=m,O))}function am(m,_,A,O){sm(m,_,(O?'{"done":true,"value":':'{"done":false,"value":')+A+"}",-1)}function cD(m,_,A,O){var j=_.id;if(typeof j!="string"||O==="then")return null;var H=B0(m._bundlerConfig,j);j=_.bound;var te=W0(H);if(te)j instanceof wr&&(te=Promise.all([te,j]));else if(j instanceof wr)te=Promise.resolve(j);else return Pc(H);if(mn){var re=mn;re.deps++}else re=mn={chunk:null,value:null,reason:null,deps:1,errored:!1};return te.then(function(){var se=Pc(H);if(_.bound){var be=_.bound.value;be=Array.isArray(be)?be.slice(0):[],be.unshift(null),se=se.bind.apply(se,be)}A[O]=se,O===""&&re.value===null&&(re.value=se),re.deps--,re.deps===0&&(se=re.chunk,se!==null&&se.status==="blocked"&&(be=se.value,se.status="fulfilled",se.value=re.value,se.reason=null,be!==null&&ha(m,be,re.value)))},function(se){if(!re.errored){re.errored=!0,re.value=null,re.reason=se;var be=re.chunk;be!==null&&be.status==="blocked"&&Dc(m,be,se)}}),null}function cm(m,_,A,O,j){if(typeof O=="string")return mD(m,_,A,O,j);if(typeof O=="object"&&O!==null)if(j!==void 0&&m._temporaryReferences!==void 0&&m._temporaryReferences.set(O,j),Array.isArray(O))for(var H=0;H<O.length;H++)O[H]=cm(m,O,""+H,O[H],j!==void 0?j+":"+H:void 0);else for(H in O)Hi.call(O,H)&&(_=j!==void 0&&H.indexOf(":")===-1?j+":"+H:void 0,_=cm(m,O,H,O[H],_),_!==void 0||H==="__proto__"?O[H]=_:delete O[H]);return O}var mn=null;function fd(m){var _=mn;mn=null;var A=m.reason,O=A[dd];A=A.id,A=A===-1?void 0:A.toString(16);var j=m.value;m.status="blocked",m.value=null,m.reason=null;try{var H=JSON.parse(j),te=cm(O,{"":H},"",H,A),re=m.value;if(re!==null)for(m.value=null,m.reason=null,H=0;H<re.length;H++){var se=re[H];typeof se=="function"?se(te):lm(O,se,te)}if(mn!==null){if(mn.errored)throw mn.reason;if(0<mn.deps){mn.value=te,mn.chunk=m;return}}m.status="fulfilled",m.value=te,m.reason=null}catch(be){m.status="rejected",m.reason=be}finally{mn=_}}function J0(m,_){m._closed=!0,m._closedReason=_,m._chunks.forEach(function(A){A.status==="pending"?Dc(m,A,_):A.status==="fulfilled"&&A.reason!==null&&A.reason.error(_)})}function Uc(m,_){var A=m._chunks,O=A.get(_);return O||(O=m._formData.get(m._prefix+_),O=typeof O=="string"?H0(m,O,_):m._closed?new wr("rejected",null,m._closedReason):new wr("pending",null,null),A.set(_,O)),O}function lm(m,_,A){var O=_.handler,j=_.parentObject,H=_.key,te=_.map,re=_.path;try{for(var se=1;se<re.length;se++){var be=re[se];if(typeof A!="object"||!Hi.call(A,be)||A instanceof Promise)throw Error("Invalid reference.");A=A[be]}var At=te(m,A,j,H);j[H]=At,H===""&&O.value===null&&(O.value=At)}catch(vr){G0(m,_.handler,vr);return}O.deps--,O.deps===0&&(_=O.chunk,_!==null&&_.status==="blocked"&&(A=_.value,_.status="fulfilled",_.value=O.value,_.reason=O.reason,A!==null&&ha(m,A,O.value)))}function G0(m,_,A){_.errored||(_.errored=!0,_.value=null,_.reason=A,_=_.chunk,_!==null&&_.status==="blocked"&&Dc(m,_,A))}function Lc(m,_,A,O,j){_=_.split(":");var H=parseInt(_[0],16);switch(H=Uc(m,H),H.status==="resolved_model"&&fd(H),H.status){case"fulfilled":H=H.value;for(var te=1;te<_.length;te++){var re=_[te];if(typeof H!="object"||!Hi.call(H,re)||H instanceof Promise)throw Error("Invalid reference.");H=H[re]}return j(m,H,A,O);case"pending":case"blocked":return mn?(m=mn,m.deps++):m=mn={chunk:null,value:null,reason:null,deps:1,errored:!1},A={handler:m,parentObject:A,key:O,map:j,path:_},H.value===null?H.value=[A]:H.value.push(A),H.reason===null?H.reason=[A]:H.reason.push(A),null;default:return mn?(mn.errored=!0,mn.value=null,mn.reason=H.reason):mn={chunk:null,value:null,reason:H.reason,deps:0,errored:!0},null}}function lD(m,_){return new Map(_)}function uD(m,_){return new Set(_)}function dD(m,_){return _[Symbol.iterator]()}function fD(m,_,A,O){return O==="then"&&typeof _=="function"?null:_}function Tr(m,_,A,O,j,H){if(_=parseInt(_.slice(2),16),O=m._prefix+_,m._chunks.has(_))throw Error("Already initialized typed array.");if(_=m._formData.get(O).arrayBuffer(),mn){var te=mn;te.deps++}else te=mn={chunk:null,value:null,reason:null,deps:1,errored:!1};return _.then(function(re){if(re=A===ArrayBuffer?re:new A(re),j[H]=re,H===""&&te.value===null&&(te.value=re),te.deps--,te.deps===0&&(re=te.chunk,re!==null&&re.status==="blocked")){var se=re.value;re.status="fulfilled",re.value=te.value,re.reason=null,se!==null&&ha(m,se,te.value)}},function(re){if(!te.errored){te.errored=!0,te.value=null,te.reason=re;var se=te.chunk;se!==null&&se.status==="blocked"&&Dc(m,se,re)}}),null}function Z0(m,_,A,O){var j=m._chunks;for(A=new wr("fulfilled",A,O),j.set(_,A),m=m._formData.getAll(m._prefix+_),_=0;_<m.length;_++)j=m[_],typeof j=="string"&&(j[0]==="C"?O.close(j==="C"?'"$undefined"':j.slice(1)):O.enqueueModel(j))}function Q0(m,_,A){if(_=parseInt(_.slice(2),16),m._chunks.has(_))throw Error("Already initialized stream.");var O=null,j=!1;A=new ReadableStream({type:A,start:function(te){O=te}});var H=null;return Z0(m,_,A,{enqueueModel:function(te){if(H===null){var re=H0(m,te,-1);fd(re),re.status==="fulfilled"?O.enqueue(re.value):(re.then(function(be){return O.enqueue(be)},function(be){return O.error(be)}),H=re)}else{re=H;var se=new wr("pending",null,null);se.then(function(be){return O.enqueue(be)},function(be){return O.error(be)}),H=se,re.then(function(){H===se&&(H=null),sm(m,se,te,-1)})}},close:function(){if(!j)if(j=!0,H===null)O.close();else{var te=H;H=null,te.then(function(){return O.close()})}},error:function(te){if(!j)if(j=!0,H===null)O.error(te);else{var re=H;H=null,re.then(function(){return O.error(te)})}}}),A}function pD(){return this}function hD(m){return m={next:m},m[h]=pD,m}function Y0(m,_,A){if(_=parseInt(_.slice(2),16),m._chunks.has(_))throw Error("Already initialized stream.");var O=[],j=!1,H=0,te={};return te=(te[h]=function(){var re=0;return hD(function(se){if(se!==void 0)throw Error("Values cannot be passed to next() of AsyncIterables passed to Client Components.");if(re===O.length){if(j)return new wr("fulfilled",{done:!0,value:void 0},null);O[re]=new wr("pending",null,null)}return O[re++]})},te),A=A?te[h]():te,Z0(m,_,A,{enqueueModel:function(re){H===O.length?O[H]=K0(m,re,!1):am(m,O[H],re,!1),H++},close:function(re){if(!j)for(j=!0,H===O.length?O[H]=K0(m,re,!0):am(m,O[H],re,!0),H++;H<O.length;)am(m,O[H++],'"$undefined"',!0)},error:function(re){if(!j)for(j=!0,H===O.length&&(O[H]=new wr("pending",null,null));H<O.length;)Dc(m,O[H++],re)}}),A}function mD(m,_,A,O,j){if(O[0]==="$"){switch(O[1]){case"$":return O.slice(1);case"@":return _=parseInt(O.slice(2),16),Uc(m,_);case"h":return O=O.slice(2),Lc(m,O,_,A,cD);case"T":if(j===void 0||m._temporaryReferences===void 0)throw Error("Could not reference an opaque temporary reference. This is likely due to misconfiguring the temporaryReferences options on the server.");return Ct(m._temporaryReferences,j);case"Q":return O=O.slice(2),Lc(m,O,_,A,lD);case"W":return O=O.slice(2),Lc(m,O,_,A,uD);case"K":_=O.slice(2);var H=m._prefix+_+"_",te=new FormData;return m._formData.forEach(function(re,se){se.startsWith(H)&&te.append(se.slice(H.length),re)}),te;case"i":return O=O.slice(2),Lc(m,O,_,A,dD);case"I":return 1/0;case"-":return O==="$-0"?-0:-1/0;case"N":return NaN;case"u":return;case"D":return new Date(Date.parse(O.slice(2)));case"n":return BigInt(O.slice(2))}switch(O[1]){case"A":return Tr(m,O,ArrayBuffer,1,_,A);case"O":return Tr(m,O,Int8Array,1,_,A);case"o":return Tr(m,O,Uint8Array,1,_,A);case"U":return Tr(m,O,Uint8ClampedArray,1,_,A);case"S":return Tr(m,O,Int16Array,2,_,A);case"s":return Tr(m,O,Uint16Array,2,_,A);case"L":return Tr(m,O,Int32Array,4,_,A);case"l":return Tr(m,O,Uint32Array,4,_,A);case"G":return Tr(m,O,Float32Array,4,_,A);case"g":return Tr(m,O,Float64Array,8,_,A);case"M":return Tr(m,O,BigInt64Array,8,_,A);case"m":return Tr(m,O,BigUint64Array,8,_,A);case"V":return Tr(m,O,DataView,1,_,A);case"B":return _=parseInt(O.slice(2),16),m._formData.get(m._prefix+_)}switch(O[1]){case"R":return Q0(m,O,void 0);case"r":return Q0(m,O,"bytes");case"X":return Y0(m,O,!1);case"x":return Y0(m,O,!0)}return O=O.slice(1),Lc(m,O,_,A,fD)}return O}function um(m,_,A){var O=3<arguments.length&&arguments[3]!==void 0?arguments[3]:new FormData,j=new Map;return{_bundlerConfig:m,_prefix:_,_formData:O,_chunks:j,_closed:!1,_closedReason:null,_temporaryReferences:A}}function dm(m){J0(m,Error("Connection closed."))}function X0(m,_,A){var O=B0(m,_);return m=W0(O),A?Promise.all([A,m]).then(function(j){j=j[0];var H=Pc(O);return H.bind.apply(H,[null].concat(j))}):m?Promise.resolve(m).then(function(){return Pc(O)}):Promise.resolve(Pc(O))}function e_(m,_,A){if(m=um(_,A,void 0,m),dm(m),m=Uc(m,0),m.then(function(){}),m.status!=="fulfilled")throw m.reason;return m.value}return Qr.createClientModuleProxy=function(m){return m=B({},m,!1),new Proxy(m,K)},Qr.createTemporaryReferenceSet=function(){return new WeakMap},Qr.decodeAction=function(m,_){var A=new FormData,O=null;return m.forEach(function(j,H){H.startsWith("$ACTION_")?H.startsWith("$ACTION_REF_")?(j="$ACTION_"+H.slice(12)+":",j=e_(m,_,j),O=X0(_,j.id,j.bound)):H.startsWith("$ACTION_ID_")&&(j=H.slice(11),O=X0(_,j,null)):A.append(H,j)}),O===null?null:O.then(function(j){return j.bind(null,A)})},Qr.decodeFormState=function(m,_,A){var O=_.get("$ACTION_KEY");if(typeof O!="string")return Promise.resolve(null);var j=null;if(_.forEach(function(te,re){re.startsWith("$ACTION_REF_")&&(te="$ACTION_"+re.slice(12)+":",j=e_(_,A,te))}),j===null)return Promise.resolve(null);var H=j.id;return Promise.resolve(j.bound).then(function(te){return te===null?null:[m,O,H,te.length-1]})},Qr.decodeReply=function(m,_,A){if(typeof m=="string"){var O=new FormData;O.append("0",m),m=O}return m=um(_,"",A?A.temporaryReferences:void 0,m),_=Uc(m,0),dm(m),_},Qr.decodeReplyFromAsyncIterable=function(m,_,A){function O(re){if(re.done)dm(te);else{re=re.value;var se=re[0];if(re=re[1],typeof re=="string"){te._formData.append(se,re);var be=te._prefix;if(se.startsWith(be)){var At=te._chunks;se=+se.slice(be.length),(At=At.get(se))&&sm(te,At,re,se)}}else te._formData.append(se,re);H.next().then(O,j)}}function j(re){J0(te,re),typeof H.throw=="function"&&H.throw(re).then(j,j)}var H=m[h](),te=um(_,"",A?A.temporaryReferences:void 0);return H.next().then(O,j),Uc(te,0)},Qr.prerender=function(m,_,A){return new Promise(function(O,j){var H=new Er(21,m,_,A?A.onError:void 0,A?A.onPostpone:void 0,function(){var se=new ReadableStream({type:"bytes",pull:function(be){z0(H,be)},cancel:function(be){H.destination=null,pa(H,be)}},{highWaterMark:0});O({prelude:se})},j,A?A.identifierPrefix:void 0,A?A.temporaryReferences:void 0);if(A&&A.signal){var te=A.signal;if(te.aborted)pa(H,te.reason);else{var re=function(){pa(H,te.reason),te.removeEventListener("abort",re)};te.addEventListener("abort",re)}}j0(H)})},Qr.registerClientReference=function(m,_,A){return B(m,_+"#"+A,!1)},Qr.registerServerReference=function(m,_,A){return Object.defineProperties(m,{$$typeof:{value:D},$$id:{value:A===null?_:_+"#"+A,configurable:!0},$$bound:{value:null,configurable:!0},bind:{value:T,configurable:!0},toString:z})},Qr.renderToReadableStream=function(m,_,A){var O=new Er(20,m,_,A?A.onError:void 0,A?A.onPostpone:void 0,Ie,Ie,A?A.identifierPrefix:void 0,A?A.temporaryReferences:void 0);if(A&&A.signal){var j=A.signal;if(j.aborted)pa(O,j.reason);else{var H=function(){pa(O,j.reason),j.removeEventListener("abort",H)};j.addEventListener("abort",H)}}return new ReadableStream({type:"bytes",start:function(){j0(O)},pull:function(te){z0(O,te)},cancel:function(te){O.destination=null,pa(O,te)}},{highWaterMark:0})},Qr}var h_;function sM(){if(h_)return di;h_=1;var e;return e=oM(),di.renderToReadableStream=e.renderToReadableStream,di.decodeReply=e.decodeReply,di.decodeReplyFromAsyncIterable=e.decodeReplyFromAsyncIterable,di.decodeAction=e.decodeAction,di.decodeFormState=e.decodeFormState,di.registerServerReference=e.registerServerReference,di.registerClientReference=e.registerClientReference,di.createClientModuleProxy=e.createClientModuleProxy,di.createTemporaryReferenceSet=e.createTemporaryReferenceSet,di}var op=sM();const jE=e=>{const t=Object.prototype.hasOwnProperty,n={};return r=>t.call(n,r)?n[r]:n[r]=e(r)},wm={};function aM(e,t){return e in wm||(wm[e]=t()),wm[e]}const sp=aM("requestInfoStore",()=>new _D),zE={},cM=["request","params","ctx","rw","cf","response"];cM.forEach(e=>{Object.defineProperty(zE,e,{enumerable:!0,configurable:!1,get:function(){const t=sp.getStore();return t?t[e]:void 0}})});const nl=Object.freeze(zE);function lM(){const e=sp.getStore();if(!e)throw new Error(`RedwoodSDK: Request context not found. getRequestInfo() can only be called within the request lifecycle (e.g., in a route handler, middleware, or server action).

For detailed troubleshooting steps, see: https://docs.rwsdk.com/guides/troubleshooting#request-context-errors`);return e}function BE(e,t){return sp.run(e,t)}function uM(e,t){const i={...sp.getStore(),...e};return BE(i,t)}const dM={"/src/server/actions/settings.ts":()=>import("./settings-D5NWtBvo.mjs"),"/src/server/actions/vote.ts":()=>import("./vote-sJwKlae4.mjs"),"/src/server/actions/project.ts":()=>import("./project-Cwy3jbFk.mjs"),"/src/server/actions/credits.ts":()=>import("./credits-DDlQ3Ab6.mjs"),"/src/server/actions/chat.ts":()=>import("./chat-DSVyH--d.mjs"),"/src/server/actions/mcp.ts":()=>import("./mcp-CVNwIaLh.mjs"),"/src/server/actions/document.ts":()=>import("./document-Caj9SmU3.mjs"),"/lib/db/mcp-queries.ts":()=>import("./mcp-queries-Ch9BqnxD.mjs"),"/app/actions/get-chat-models.ts":()=>Promise.resolve().then(()=>rz)},fM=jE(async e=>{const t=dM[e];if(!t)throw new Error(`(worker) No module found for '${e}' in module lookup for "use server" directive`);return await t()}),pM=async e=>{const[t,n]=e.split("#");return(await fM(t))[n]},hM=jE(async e=>nl.rw.ssr?vD(e):{[e]:()=>null});function mM(e,t,n){return typeof e!="function"?e:op.registerServerReference(e,t,n)}function Ne(e,t,n){const i=e[n]??{};if(CE.isValidElementType(i)){const r=op.registerClientReference({},t,n),o=Object.getOwnPropertyDescriptors(r),s=o.$$id;if(s){const c=s.value;o.$$id={enumerable:s.enumerable,configurable:s.configurable,get(){return nl.rw.scriptsToBeLoaded.add(t),c}}}return o.$$async={value:!0},o.$$isClientReference={value:!0},Object.defineProperties(typeof i=="function"?(...c)=>i(...c):()=>null,o)}return i}async function gM(e){const t=new URL(e.url),n=e.headers.get("content-type");let i=[];if(e.method==="GET"){const s=t.searchParams.get("args");s&&(i=JSON.parse(s))}else{const s=n?.startsWith("multipart/form-data")?await e.formData():await e.text();i=await op.decodeReply(s,null)}const r=t.searchParams.get("__rsc_action_id"),o=await pM(r);if(typeof o!="function")throw new Error(`Action ${r} is not a function`);return o(...i)}const Md=new TextEncoder,Mc="</body></html>";function yM(e,t){let n=new TextDecoder,i,r=new Promise(u=>i=u),o=!1,s=t&&typeof t.nonce=="string"?t.nonce:void 0,a=[],c=null;function l(u){for(let f of a){let g=n.decode(f,{stream:!0});g.endsWith(Mc)&&(g=g.slice(0,-Mc.length)),u.enqueue(Md.encode(g))}let p=n.decode();p.length&&(p.endsWith(Mc)&&(p=p.slice(0,-Mc.length)),u.enqueue(Md.encode(p))),a.length=0,c=null}return new TransformStream({transform(u,p){a.push(u),!c&&(c=setTimeout(async()=>{try{l(p)}catch(f){p.error(f),i();return}o||(o=!0,wM(e,p,s).catch(f=>p.error(f)).then(i))},0))},async flush(u){await r,c&&(clearTimeout(c),l(u)),u.enqueue(Md.encode(Mc))}})}async function wM(e,t,n){let i=new TextDecoder("utf-8",{fatal:!0});for await(let o of e)try{vm(JSON.stringify(i.decode(o,{stream:!0})),t,n)}catch{let a=JSON.stringify(btoa(String.fromCodePoint(...o)));vm(`Uint8Array.from(atob(${a}), m => m.codePointAt(0))`,t,n)}let r=i.decode();r.length&&vm(JSON.stringify(r),t,n)}function vm(e,t,n){t.enqueue(Md.encode(`<script${n?` nonce="${n}"`:""}>${vM(`(self.__FLIGHT_DATA||=[]).push(${e})`)}<\/script>`))}function vM(e){return e.replace(/<!--/g,"<\\!--").replace(/<\/(script)/gi,"</\\$1")}let md;async function FE(){return md||(md="__RWSDK_MANIFEST_PLACEHOLDER__",md)}function bM(e,t){const n=new Set;function i(r){if(n.has(r))return;n.add(r);const o=t[r];if(o){if(o.isEntry||o.isDynamicEntry)return o;if(o.imports)for(const s of o.imports){const a=i(s);if(a)return a}}}return i(e)}const _M=async({requestInfo:e})=>{const t=await FE(),n=new Set;for(const i of e.rw.scriptsToBeLoaded){const r=bM(i,t);r&&n.add(r.file)}return F.jsx(F.Fragment,{children:Array.from(n).map(i=>F.jsx("link",{rel:"modulepreload",href:i},i))})},SM=(e,t)=>{const n=new Set,i=new Set;return(o=>{if(i.has(o))return;i.add(o);const s=t[o];if(s&&s.css)for(const a of s.css)n.add(a)})(e),Array.from(n)},xM=async({requestInfo:e})=>{const t=await FE(),n=new Set;for(const i of e.rw.scriptsToBeLoaded){const r=SM(i,t);for(const o of r)n.add(o)}return F.jsx(F.Fragment,{children:Array.from(n).map(i=>F.jsx("link",{rel:"stylesheet",href:i,precedence:"first"},i))})};function kM(e){const t=new TextDecoder,n=new TextEncoder,i=/<(?!(?:\/)?(?:title|meta|link|style|base)[\s>\/])(?![!?])/i;let r,o=null,s="",a=!1;const c=new ReadableStream({start(u){r=e.getReader();const p=async()=>{try{if(a){u.close();return}const{done:f,value:g}=await r.read();if(f){if(s){const d=s.match(i);if(d&&typeof d.index=="number"){const y=s.slice(0,d.index);u.enqueue(n.encode(y))}else u.enqueue(n.encode(s))}u.close(),a=!0,o&&o.close();return}s+=t.decode(g,{stream:!0});const h=s.match(i);if(h&&typeof h.index=="number"){const d=s.slice(0,h.index),y=s.slice(h.index);if(s="",u.enqueue(n.encode(d)),u.close(),a=!0,o)for(y&&o.enqueue(n.encode(y));;){const{done:v,value:x}=await r.read();if(v){o.close();return}o.enqueue(x)}}else{const d=s.lastIndexOf(`
`);d!==-1&&(u.enqueue(n.encode(s.slice(0,d+1))),s=s.slice(d+1)),await p()}}catch(f){u.error(f),o&&o.error(f)}};p().catch(f=>{u.error(f),o&&o.error(f)})}}),l=new ReadableStream({start(u){o=u}});return[c,l]}function EM(e,t,n,i){const[r,o]=kM(t),s=new TextDecoder,a=new TextEncoder;let c,l,u,p="",f="",g="",h="",d=!1,y="read-hoisted";const v=async x=>{const E=C=>{C&&x.enqueue(a.encode(C))},N=()=>{const C=p.lastIndexOf(`
`);C!==-1&&(E(p.slice(0,C+1)),p=p.slice(C+1))};try{if(y==="read-hoisted"){const{done:C,value:b}=await u.read();C?(d=!0,y="outer-head"):h+=s.decode(b,{stream:!0})}else if(y==="outer-head"){const{done:C,value:b}=await c.read();if(C){if(p){const P=p.indexOf("</head>");P!==-1&&d&&h&&(E(p.slice(0,P)),E(h),h="",E("</head>"),p=p.slice(P+7));const $=p.indexOf(n);$!==-1?(E(p.slice(0,$)),f=p.slice($+n.length)):E(p),p=""}else d&&h&&(E(h),h="");y="inner-shell"}else{p+=s.decode(b,{stream:!0});const P=p.indexOf("</head>");P!==-1&&d&&h&&(E(p.slice(0,P)),E(h),h="",E("</head>"),p=p.slice(P+7));const $=p.indexOf(n);$!==-1?(E(p.slice(0,$)),f=p.slice($+n.length),p="",y="inner-shell"):N()}}else if(y==="inner-shell"){const{done:C,value:b}=await l.read();if(C)p&&E(p),y="outer-tail";else{p+=s.decode(b,{stream:!0});const P=p.indexOf(i);if(P!==-1){const $=P+i.length;E(p.slice(0,$)),g=p.slice($),p="",y="outer-tail"}else N()}}else if(y==="outer-tail"){f&&(p=f,f="");const{done:C,value:b}=await c.read();if(C){if(p){const P=p.indexOf("</body>");P!==-1?(E(p.slice(0,P)),p=p.slice(P)):(E(p),p="")}y="inner-suspended"}else{p+=s.decode(b,{stream:!0});const P=p.indexOf("</body>");P!==-1?(E(p.slice(0,P)),p=p.slice(P),y="inner-suspended"):N()}}else if(y==="inner-suspended"){g&&(E(g),g="");const{done:C,value:b}=await l.read();C?y="outer-end":x.enqueue(b)}else if(y==="outer-end"){p&&(E(p),p="");const{done:C,value:b}=await c.read();if(C){x.close();return}x.enqueue(b)}await v(x)}catch(C){x.error(C)}};return new ReadableStream({start(x){c=e.getReader(),l=o.getReader(),u=r.getReader(),v(x).catch(E=>x.error(E))},cancel(x){c?.cancel(x),l?.cancel(x),u?.cancel(x)}})}const AM=async({rscPayloadStream:e,Document:t,requestInfo:n,shouldSSR:i,onError:r})=>{const o=bD(e),{node:s}=await o,a={rw:{ssr:i}},c=F.jsxs(t,{...n,children:[F.jsx("script",{nonce:n.rw.nonce,dangerouslySetInnerHTML:{__html:`globalThis.__RWSDK_CONTEXT = ${JSON.stringify(a)}`}}),F.jsx(xM,{requestInfo:n}),F.jsx(_M,{requestInfo:n}),F.jsx("div",{id:"hydrate-root",children:F.jsx("div",{id:"rwsdk-app-start"})})]}),l=await t_({node:c,requestInfo:n,onError:r,identifierPrefix:"__RWSDK_DOCUMENT__"}),u=await t_({node:s,requestInfo:n,onError:r});return EM(l,u,'<div id="rwsdk-app-start"></div>','<div id="rwsdk-app-end"></div>')},TM=()=>new Proxy({},{get(e,t){return{id:t,name:t,chunks:[]}}}),IM=({input:e,onError:t})=>{const{node:n,actionResult:i}=e,o={node:F.jsxs(F.Fragment,{children:[n,F.jsx("div",{id:"rwsdk-app-end"})]}),actionResult:i};return op.renderToReadableStream(o,TM(),{onError:t})};function NM(e,t=28){const n=e.getReader();return new ReadableStream({async pull(i){let r=new Uint8Array(0);try{for(;;){const{done:o,value:s}=await n.read();if(o&&r.length===0){i.close();return}for(s&&(r=new Uint8Array([...r,...s]));r.length>=t||o&&r.length>0;){const a=r.slice(0,t);r=r.slice(t),i.enqueue(a)}if(o){i.close();return}}}catch(o){i.error(o)}}})}const $M=e=>e instanceof Response?{__rw_action_response:{status:e.status,headers:{location:e.headers.get("location")}}}:e instanceof ReadableStream?NM(e):e,CM=e=>{const t=ZL(e);return{__rwRoutes:e,fetch:async(n,i,r)=>{if(globalThis.__webpack_require__=hM,n.url.includes("/assets/")){const o=new URL(n.url);return o.pathname=o.pathname.slice(8),i.ASSETS.fetch(new Request(o.toString(),n))}try{const o=new URL(n.url);let s=o.pathname;s!=="/"&&!s.endsWith("/")&&(s=s+"/");const a=o.searchParams.has("__rsc")||n.headers.get("accept")?.includes("text/x-component"),c=o.searchParams.has("__rsc_action_id"),l={Document:OM,nonce:nM(),rscPayload:!0,ssr:!0,databases:new Map,scriptsToBeLoaded:new Set,entryScripts:new Set,inlineScripts:new Set,pageRouteResolved:void 0},u={status:200,headers:new Headers},p={request:n,path:s,cf:r,params:{},ctx:{},rw:l,response:u,isAction:c},f=(y,v)=>{let x;if(m_(v)){const{ctx:E,params:N}=y;x=F.jsx(v,{ctx:E,params:N})}else x=F.jsx(v,{...y});return x},g=async(y,v,x)=>{if(m_(y.rw.Document))return new Response(null,{status:500});const E=$M(y.rw.actionResult),C=n.headers.get("x-rsc-data-only")==="true"&&E!==void 0?null:f(y,v);C===null&&l.pageRouteResolved?.resolve();const{rscPayload:b}=l;let P=IM({input:{node:C,actionResult:E},onError:x});if(a){const B=new Headers(u.headers);return B.set("content-type","text/x-component; charset=utf-8"),new Response(P,{status:u.status,statusText:u.statusText,headers:B})}let $;if(b){const[B,J]=P.tee();P=B,$=yM(J,{nonce:l.nonce})}let k=await AM({rscPayloadStream:P,Document:l.Document,requestInfo:y,onError:x,shouldSSR:l.ssr});$&&(k=k.pipeThrough($));const D=new Headers(u.headers);return D.set("content-type","text/html; charset=utf-8"),new Response(k,{status:u.status,statusText:u.statusText,headers:D})},h=await BE(p,async()=>new Promise(async(y,v)=>{try{y(await t.handle({request:n,renderPage:g,getRequestInfo:lM,runWithRequestInfoOverrides:uM,onError:v,rscActionHandler:gM}))}catch(x){v(x)}})),d=new Response(h.body,h);if(u.headers){const y=new Headers(u.headers);for(const[v,x]of y.entries())h.headers.has(v)||d.headers.set(v,x)}return await l.pageRouteResolved?.promise,d}catch(o){if(o instanceof tM)return new Response(o.message,{status:o.code});if(o instanceof Response)return o;throw console.error(`rwsdk: Received an unhandled error:

%s`,o),o}}}},OM=({children:e})=>F.jsxs("html",{lang:"en",children:[F.jsxs("head",{children:[F.jsx("meta",{charSet:"utf-8"}),F.jsx("meta",{name:"viewport",content:"width=device-width, initial-scale=1"})]}),F.jsx("body",{children:F.jsx("div",{id:"root",children:e})})]}),m_=e=>Object.prototype.hasOwnProperty.call(e,"$$isClientReference"),RM="/assets/styles-B1LHIbwB.css",PM="hsl(0 0% 100%)",DM="hsl(240deg 10% 3.92%)",UM=`(function() {
  var html = document.documentElement;
  var meta = document.querySelector('meta[name="theme-color"]');
  if (!meta) {
    meta = document.createElement('meta');
    meta.setAttribute('name', 'theme-color');
    document.head.appendChild(meta);
  }
  function updateThemeColor() {
    var isDark = html.classList.contains('dark');
    meta.setAttribute('content', isDark ? '${DM}' : '${PM}');
  }
  var observer = new MutationObserver(updateThemeColor);
  observer.observe(html, { attributes: true, attributeFilter: ['class'] });
  updateThemeColor();
})();`,LM=({rw:e,children:t})=>{const n=process.env.CF_WEB_ANALYTICS_TOKEN,i=e.nonce;return F.jsxs("html",{lang:"en",suppressHydrationWarning:!0,children:[F.jsxs("head",{children:[F.jsx("meta",{charSet:"utf-8"}),F.jsx("meta",{content:"width=device-width, initial-scale=1",name:"viewport"}),F.jsx("link",{href:RM,rel:"stylesheet"}),F.jsx("link",{href:"rwsdk_asset:/src/client.tsx",rel:"modulepreload"}),F.jsx("script",{id:"theme-color-script",nonce:i,children:UM}),null,n?F.jsx("script",{"data-cf-beacon":JSON.stringify({token:n}),defer:!0,src:"https://static.cloudflareinsights.com/beacon.min.js",nonce:nl.rw.nonce}):null]}),F.jsxs("body",{className:"antialiased",children:[F.jsx("div",{id:"root",children:t}),(nl.rw.scriptsToBeLoaded.add("/src/client.tsx"),F.jsx("script",{nonce:i,src:"rwsdk_asset:/src/client.tsx",type:"module",nonce:nl.rw.nonce}))]})]})},MM=await Qt("/app/(chat)/chat/[id]/chat-page.tsx"),jM=Ne(MM,"/app/(chat)/chat/[id]/chat-page.tsx","ChatPage");function zM(){return F.jsxs(F.Fragment,{children:[F.jsx("title",{children:"Chat"}),F.jsx(fn.Suspense,{children:F.jsx(jM,{})})]})}function BM(){const e="https://chatjs.mintlify.dev/docs";return F.jsxs(F.Fragment,{children:[F.jsx("title",{children:"Docs"}),F.jsxs("div",{className:"mx-auto flex min-h-dvh w-full max-w-3xl flex-col items-center justify-center px-6 text-center",children:[F.jsx("h1",{className:"font-semibold text-3xl",children:"Documentation"}),F.jsxs("p",{className:"mt-2 text-muted-foreground",children:["Docs are available at"," ",F.jsx("a",{className:"underline underline-offset-4",href:e,children:e}),"."]})]})]})}const FM=await Qt("/app/(chat)/chat-home.tsx"),WM=Ne(FM,"/app/(chat)/chat-home.tsx","ChatHome");function VM(){return F.jsxs(F.Fragment,{children:[F.jsx("title",{children:"ChatJS"}),F.jsx(WM,{})]})}const qM=await Qt("/app/(chat)/chat-providers.tsx"),HM=Ne(qM,"/app/(chat)/chat-providers.tsx","ChatProviders"),KM={githubUrl:"https://github.com/franciscomoretti/chatjs",appPrefix:"chatjs",appName:"ChatJS",appTitle:"ChatJS - The prod ready AI chat template",appDescription:"Build and deploy AI chat applications in minutes. ChatJS provides authentication, streaming, tool calling, and all the features you need for production-ready AI conversations.",appUrl:"https://chatjs.dev",organization:{name:"ChatJS",contact:{privacyEmail:"privacy@chatjs.dev",legalEmail:"legal@chatjs.dev"}},services:{hosting:"Vercel",aiProviders:["OpenAI","Anthropic","xAI","Google","Meta","Mistral","Alibaba","Amazon","Cohere","DeepSeek","Perplexity","Vercel","Inception","Moonshot","Morph","ZAI"],paymentProcessors:[]},integrations:{sandbox:!0,webSearch:!0,urlRetrieval:!0,mcp:!0,imageGeneration:!0,attachments:!0},legal:{minimumAge:13,governingLaw:"United States",refundPolicy:"no-refunds"},policies:{privacy:{title:"Privacy Policy",lastUpdated:"July 24, 2025"},terms:{title:"Terms of Service",lastUpdated:"July 24, 2025"}},authentication:{google:!0,github:!0,vercel:!0},models:{providerOrder:["openai","google","anthropic","xai"],disabledModels:["morph/morph-v3-large","morph/morph-v3-fast"],curatedDefaults:["openai/gpt-5-nano","openai/gpt-5-mini","openai/gpt-5.2","openai/gpt-5.2-chat-latest","openai/gpt-5.2-chat-latest-reasoning","google/gemini-2.5-flash-lite","google/gemini-3-flash","google/gemini-3-pro-preview","anthropic/claude-sonnet-4.5","anthropic/claude-sonnet-4.5-reasoning","anthropic/claude-opus-4.5","xai/grok-4","xai/grok-4-reasoning"],anonymousModels:["google/gemini-2.5-flash-lite","openai/gpt-5-mini","openai/gpt-5-nano","anthropic/claude-haiku-4.5"],defaults:{chat:"openai/gpt-5-nano",title:"google/gemini-2.5-flash-lite",pdf:"openai/gpt-5-mini",artifact:"openai/gpt-5-nano",artifactSuggestion:"openai/gpt-5-mini",followupSuggestions:"google/gemini-2.5-flash-lite",suggestions:"openai/gpt-5-mini",polishText:"openai/gpt-5-mini",formatSheet:"openai/gpt-5-mini",analyzeSheet:"openai/gpt-5-mini",codeEdits:"openai/gpt-5-mini",chatImageCompatible:"openai/gpt-4o-mini",image:"google/gemini-3-pro-image"}},anonymous:{credits:10,availableTools:[],rateLimit:{requestsPerMinute:5,requestsPerMonth:10}},attachments:{maxBytes:1024*1024,maxDimension:2048,acceptedTypes:{"image/png":[".png"],"image/jpeg":[".jpg",".jpeg"],"application/pdf":[".pdf"]}}},Hy=Object.freeze({status:"aborted"});function Y(e,t,n){function i(a,c){if(a._zod||Object.defineProperty(a,"_zod",{value:{def:c,constr:s,traits:new Set},enumerable:!1}),a._zod.traits.has(e))return;a._zod.traits.add(e),t(a,c);const l=s.prototype,u=Object.keys(l);for(let p=0;p<u.length;p++){const f=u[p];f in a||(a[f]=l[f].bind(a))}}const r=n?.Parent??Object;class o extends r{}Object.defineProperty(o,"name",{value:e});function s(a){var c;const l=n?.Parent?new o:this;i(l,a),(c=l._zod).deferred??(c.deferred=[]);for(const u of l._zod.deferred)u();return l}return Object.defineProperty(s,"init",{value:i}),Object.defineProperty(s,Symbol.hasInstance,{value:a=>n?.Parent&&a instanceof n.Parent?!0:a?._zod?.traits?.has(e)}),Object.defineProperty(s,"name",{value:e}),s}const Ky=Symbol("zod_brand");class Ns extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class ap extends Error{constructor(t){super(`Encountered unidirectional transform during encode: ${t}`),this.name="ZodEncodeError"}}const ff={};function Gn(e){return e&&Object.assign(ff,e),ff}function JM(e){return e}function GM(e){return e}function ZM(e){}function QM(e){throw new Error("Unexpected value in exhaustive check")}function YM(e){}function Jy(e){const t=Object.values(e).filter(i=>typeof i=="number");return Object.entries(e).filter(([i,r])=>t.indexOf(+i)===-1).map(([i,r])=>r)}function ye(e,t="|"){return e.map(n=>Ve(n)).join(t)}function pf(e,t){return typeof t=="bigint"?t.toString():t}function Wl(e){return{get value(){{const t=e();return Object.defineProperty(this,"value",{value:t}),t}}}}function Js(e){return e==null}function cp(e){const t=e.startsWith("^")?1:0,n=e.endsWith("$")?e.length-1:e.length;return e.slice(t,n)}function WE(e,t){const n=(e.toString().split(".")[1]||"").length,i=t.toString();let r=(i.split(".")[1]||"").length;if(r===0&&/\d?e-\d?/.test(i)){const c=i.match(/\d?e-(\d?)/);c?.[1]&&(r=Number.parseInt(c[1]))}const o=n>r?n:r,s=Number.parseInt(e.toFixed(o).replace(".","")),a=Number.parseInt(t.toFixed(o).replace(".",""));return s%a/10**o}const g_=Symbol("evaluating");function lt(e,t,n){let i;Object.defineProperty(e,t,{get(){if(i!==g_)return i===void 0&&(i=g_,i=n()),i},set(r){Object.defineProperty(e,t,{value:r})},configurable:!0})}function XM(e){return Object.create(Object.getPrototypeOf(e),Object.getOwnPropertyDescriptors(e))}function ss(e,t,n){Object.defineProperty(e,t,{value:n,writable:!0,enumerable:!0,configurable:!0})}function Bi(...e){const t={};for(const n of e){const i=Object.getOwnPropertyDescriptors(n);Object.assign(t,i)}return Object.defineProperties({},t)}function ej(e){return Bi(e._zod.def)}function tj(e,t){return t?t.reduce((n,i)=>n?.[i],e):e}function nj(e){const t=Object.keys(e),n=t.map(i=>e[i]);return Promise.all(n).then(i=>{const r={};for(let o=0;o<t.length;o++)r[t[o]]=i[o];return r})}function rj(e=10){const t="abcdefghijklmnopqrstuvwxyz";let n="";for(let i=0;i<e;i++)n+=t[Math.floor(Math.random()*t.length)];return n}function Lg(e){return JSON.stringify(e)}function VE(e){return e.toLowerCase().trim().replace(/[^\w\s-]/g,"").replace(/[\s_-]+/g,"-").replace(/^-+|-+$/g,"")}const Gy="captureStackTrace"in Error?Error.captureStackTrace:(...e)=>{};function La(e){return typeof e=="object"&&e!==null&&!Array.isArray(e)}const qE=Wl(()=>{if(typeof navigator<"u"&&navigator?.userAgent?.includes("Cloudflare"))return!1;try{const e=Function;return new e(""),!0}catch{return!1}});function Ds(e){if(La(e)===!1)return!1;const t=e.constructor;if(t===void 0||typeof t!="function")return!0;const n=t.prototype;return!(La(n)===!1||Object.prototype.hasOwnProperty.call(n,"isPrototypeOf")===!1)}function lp(e){return Ds(e)?{...e}:Array.isArray(e)?[...e]:e}function ij(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}const oj=e=>{const t=typeof e;switch(t){case"undefined":return"undefined";case"string":return"string";case"number":return Number.isNaN(e)?"nan":"number";case"boolean":return"boolean";case"function":return"function";case"bigint":return"bigint";case"symbol":return"symbol";case"object":return Array.isArray(e)?"array":e===null?"null":e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?"promise":typeof Map<"u"&&e instanceof Map?"map":typeof Set<"u"&&e instanceof Set?"set":typeof Date<"u"&&e instanceof Date?"date":typeof File<"u"&&e instanceof File?"file":"object";default:throw new Error(`Unknown data type: ${t}`)}},hf=new Set(["string","number","symbol"]),HE=new Set(["string","number","bigint","boolean","symbol","undefined"]);function po(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function Hr(e,t,n){const i=new e._zod.constr(t??e._zod.def);return(!t||n?.parent)&&(i._zod.parent=e),i}function ue(e){const t=e;if(!t)return{};if(typeof t=="string")return{error:()=>t};if(t?.message!==void 0){if(t?.error!==void 0)throw new Error("Cannot specify both `message` and `error` params");t.error=t.message}return delete t.message,typeof t.error=="string"?{...t,error:()=>t.error}:t}function sj(e){let t;return new Proxy({},{get(n,i,r){return t??(t=e()),Reflect.get(t,i,r)},set(n,i,r,o){return t??(t=e()),Reflect.set(t,i,r,o)},has(n,i){return t??(t=e()),Reflect.has(t,i)},deleteProperty(n,i){return t??(t=e()),Reflect.deleteProperty(t,i)},ownKeys(n){return t??(t=e()),Reflect.ownKeys(t)},getOwnPropertyDescriptor(n,i){return t??(t=e()),Reflect.getOwnPropertyDescriptor(t,i)},defineProperty(n,i,r){return t??(t=e()),Reflect.defineProperty(t,i,r)}})}function Ve(e){return typeof e=="bigint"?e.toString()+"n":typeof e=="string"?`"${e}"`:`${e}`}function KE(e){return Object.keys(e).filter(t=>e[t]._zod.optin==="optional"&&e[t]._zod.optout==="optional")}const JE={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]},GE={int64:[BigInt("-9223372036854775808"),BigInt("9223372036854775807")],uint64:[BigInt(0),BigInt("18446744073709551615")]};function ZE(e,t){const n=e._zod.def,i=n.checks;if(i&&i.length>0)throw new Error(".pick() cannot be used on object schemas containing refinements");const o=Bi(e._zod.def,{get shape(){const s={};for(const a in t){if(!(a in n.shape))throw new Error(`Unrecognized key: "${a}"`);t[a]&&(s[a]=n.shape[a])}return ss(this,"shape",s),s},checks:[]});return Hr(e,o)}function QE(e,t){const n=e._zod.def,i=n.checks;if(i&&i.length>0)throw new Error(".omit() cannot be used on object schemas containing refinements");const o=Bi(e._zod.def,{get shape(){const s={...e._zod.def.shape};for(const a in t){if(!(a in n.shape))throw new Error(`Unrecognized key: "${a}"`);t[a]&&delete s[a]}return ss(this,"shape",s),s},checks:[]});return Hr(e,o)}function YE(e,t){if(!Ds(t))throw new Error("Invalid input to extend: expected a plain object");const n=e._zod.def.checks;if(n&&n.length>0){const o=e._zod.def.shape;for(const s in t)if(Object.getOwnPropertyDescriptor(o,s)!==void 0)throw new Error("Cannot overwrite keys on object schemas containing refinements. Use `.safeExtend()` instead.")}const r=Bi(e._zod.def,{get shape(){const o={...e._zod.def.shape,...t};return ss(this,"shape",o),o}});return Hr(e,r)}function XE(e,t){if(!Ds(t))throw new Error("Invalid input to safeExtend: expected a plain object");const n=Bi(e._zod.def,{get shape(){const i={...e._zod.def.shape,...t};return ss(this,"shape",i),i}});return Hr(e,n)}function eA(e,t){const n=Bi(e._zod.def,{get shape(){const i={...e._zod.def.shape,...t._zod.def.shape};return ss(this,"shape",i),i},get catchall(){return t._zod.def.catchall},checks:[]});return Hr(e,n)}function tA(e,t,n){const r=t._zod.def.checks;if(r&&r.length>0)throw new Error(".partial() cannot be used on object schemas containing refinements");const s=Bi(t._zod.def,{get shape(){const a=t._zod.def.shape,c={...a};if(n)for(const l in n){if(!(l in a))throw new Error(`Unrecognized key: "${l}"`);n[l]&&(c[l]=e?new e({type:"optional",innerType:a[l]}):a[l])}else for(const l in a)c[l]=e?new e({type:"optional",innerType:a[l]}):a[l];return ss(this,"shape",c),c},checks:[]});return Hr(t,s)}function nA(e,t,n){const i=Bi(t._zod.def,{get shape(){const r=t._zod.def.shape,o={...r};if(n)for(const s in n){if(!(s in o))throw new Error(`Unrecognized key: "${s}"`);n[s]&&(o[s]=new e({type:"nonoptional",innerType:r[s]}))}else for(const s in r)o[s]=new e({type:"nonoptional",innerType:r[s]});return ss(this,"shape",o),o}});return Hr(t,i)}function Es(e,t=0){if(e.aborted===!0)return!0;for(let n=t;n<e.issues.length;n++)if(e.issues[n]?.continue!==!0)return!0;return!1}function wi(e,t){return t.map(n=>{var i;return(i=n).path??(i.path=[]),n.path.unshift(e),n})}function el(e){return typeof e=="string"?e:e?.message}function ai(e,t,n){const i={...e,path:e.path??[]};if(!e.message){const r=el(e.inst?._zod.def?.error?.(e))??el(t?.error?.(e))??el(n.customError?.(e))??el(n.localeError?.(e))??"Invalid input";i.message=r}return delete i.inst,delete i.continue,t?.reportInput||delete i.input,i}function up(e){return e instanceof Set?"set":e instanceof Map?"map":e instanceof File?"file":"unknown"}function dp(e){return Array.isArray(e)?"array":typeof e=="string"?"string":"unknown"}function He(e){const t=typeof e;switch(t){case"number":return Number.isNaN(e)?"nan":"number";case"object":{if(e===null)return"null";if(Array.isArray(e))return"array";const n=e;if(n&&Object.getPrototypeOf(n)!==Object.prototype&&"constructor"in n&&n.constructor)return n.constructor.name}}return t}function Ma(...e){const[t,n,i]=e;return typeof t=="string"?{message:t,code:"custom",input:n,inst:i}:{...t}}function aj(e){return Object.entries(e).filter(([t,n])=>Number.isNaN(Number.parseInt(t,10))).map(t=>t[1])}function rA(e){const t=atob(e),n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}function iA(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCharCode(e[n]);return btoa(t)}function cj(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),n="=".repeat((4-t.length%4)%4);return rA(t+n)}function lj(e){return iA(e).replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")}function uj(e){const t=e.replace(/^0x/,"");if(t.length%2!==0)throw new Error("Invalid hex string length");const n=new Uint8Array(t.length/2);for(let i=0;i<t.length;i+=2)n[i/2]=Number.parseInt(t.slice(i,i+2),16);return n}function dj(e){return Array.from(e).map(t=>t.toString(16).padStart(2,"0")).join("")}class fj{constructor(...t){}}const Zy=Object.freeze(Object.defineProperty({__proto__:null,BIGINT_FORMAT_RANGES:GE,Class:fj,NUMBER_FORMAT_RANGES:JE,aborted:Es,allowsEval:qE,assert:YM,assertEqual:JM,assertIs:ZM,assertNever:QM,assertNotEqual:GM,assignProp:ss,base64ToUint8Array:rA,base64urlToUint8Array:cj,cached:Wl,captureStackTrace:Gy,cleanEnum:aj,cleanRegex:cp,clone:Hr,cloneDef:ej,createTransparentProxy:sj,defineLazy:lt,esc:Lg,escapeRegex:po,extend:YE,finalizeIssue:ai,floatSafeRemainder:WE,getElementAtPath:tj,getEnumValues:Jy,getLengthableOrigin:dp,getParsedType:oj,getSizableOrigin:up,hexToUint8Array:uj,isObject:La,isPlainObject:Ds,issue:Ma,joinValues:ye,jsonStringifyReplacer:pf,merge:eA,mergeDefs:Bi,normalizeParams:ue,nullish:Js,numKeys:ij,objectClone:XM,omit:QE,optionalKeys:KE,parsedType:He,partial:tA,pick:ZE,prefixIssues:wi,primitiveTypes:HE,promiseAllObject:nj,propertyKeyTypes:hf,randomString:rj,required:nA,safeExtend:XE,shallowClone:lp,slugify:VE,stringifyPrimitive:Ve,uint8ArrayToBase64:iA,uint8ArrayToBase64url:lj,uint8ArrayToHex:dj,unwrapMessage:el},Symbol.toStringTag,{value:"Module"})),oA=(e,t)=>{e.name="$ZodError",Object.defineProperty(e,"_zod",{value:e._zod,enumerable:!1}),Object.defineProperty(e,"issues",{value:t,enumerable:!1}),e.message=JSON.stringify(t,pf,2),Object.defineProperty(e,"toString",{value:()=>e.message,enumerable:!1})},Qy=Y("$ZodError",oA),Kr=Y("$ZodError",oA,{Parent:Error});function fp(e,t=n=>n.message){const n={},i=[];for(const r of e.issues)r.path.length>0?(n[r.path[0]]=n[r.path[0]]||[],n[r.path[0]].push(t(r))):i.push(t(r));return{formErrors:i,fieldErrors:n}}function pp(e,t=n=>n.message){const n={_errors:[]},i=r=>{for(const o of r.issues)if(o.code==="invalid_union"&&o.errors.length)o.errors.map(s=>i({issues:s}));else if(o.code==="invalid_key")i({issues:o.issues});else if(o.code==="invalid_element")i({issues:o.issues});else if(o.path.length===0)n._errors.push(t(o));else{let s=n,a=0;for(;a<o.path.length;){const c=o.path[a];a===o.path.length-1?(s[c]=s[c]||{_errors:[]},s[c]._errors.push(t(o))):s[c]=s[c]||{_errors:[]},s=s[c],a++}}};return i(e),n}function Yy(e,t=n=>n.message){const n={errors:[]},i=(r,o=[])=>{var s,a;for(const c of r.issues)if(c.code==="invalid_union"&&c.errors.length)c.errors.map(l=>i({issues:l},c.path));else if(c.code==="invalid_key")i({issues:c.issues},c.path);else if(c.code==="invalid_element")i({issues:c.issues},c.path);else{const l=[...o,...c.path];if(l.length===0){n.errors.push(t(c));continue}let u=n,p=0;for(;p<l.length;){const f=l[p],g=p===l.length-1;typeof f=="string"?(u.properties??(u.properties={}),(s=u.properties)[f]??(s[f]={errors:[]}),u=u.properties[f]):(u.items??(u.items=[]),(a=u.items)[f]??(a[f]={errors:[]}),u=u.items[f]),g&&u.errors.push(t(c)),p++}}};return i(e),n}function sA(e){const t=[],n=e.map(i=>typeof i=="object"?i.key:i);for(const i of n)typeof i=="number"?t.push(`[${i}]`):typeof i=="symbol"?t.push(`[${JSON.stringify(String(i))}]`):/[^\w$]/.test(i)?t.push(`[${JSON.stringify(i)}]`):(t.length&&t.push("."),t.push(i));return t.join("")}function Xy(e){const t=[],n=[...e.issues].sort((i,r)=>(i.path??[]).length-(r.path??[]).length);for(const i of n)t.push(` ${i.message}`),i.path?.length&&t.push(`   at ${sA(i.path)}`);return t.join(`
`)}const Vl=e=>(t,n,i,r)=>{const o=i?Object.assign(i,{async:!1}):{async:!1},s=t._zod.run({value:n,issues:[]},o);if(s instanceof Promise)throw new Ns;if(s.issues.length){const a=new(r?.Err??e)(s.issues.map(c=>ai(c,o,Gn())));throw Gy(a,r?.callee),a}return s.value},Mg=Vl(Kr),ql=e=>async(t,n,i,r)=>{const o=i?Object.assign(i,{async:!0}):{async:!0};let s=t._zod.run({value:n,issues:[]},o);if(s instanceof Promise&&(s=await s),s.issues.length){const a=new(r?.Err??e)(s.issues.map(c=>ai(c,o,Gn())));throw Gy(a,r?.callee),a}return s.value},jg=ql(Kr),Hl=e=>(t,n,i)=>{const r=i?{...i,async:!1}:{async:!1},o=t._zod.run({value:n,issues:[]},r);if(o instanceof Promise)throw new Ns;return o.issues.length?{success:!1,error:new(e??Qy)(o.issues.map(s=>ai(s,r,Gn())))}:{success:!0,data:o.value}},aA=Hl(Kr),Kl=e=>async(t,n,i)=>{const r=i?Object.assign(i,{async:!0}):{async:!0};let o=t._zod.run({value:n,issues:[]},r);return o instanceof Promise&&(o=await o),o.issues.length?{success:!1,error:new e(o.issues.map(s=>ai(s,r,Gn())))}:{success:!0,data:o.value}},cA=Kl(Kr),ew=e=>(t,n,i)=>{const r=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return Vl(e)(t,n,r)},pj=ew(Kr),tw=e=>(t,n,i)=>Vl(e)(t,n,i),hj=tw(Kr),nw=e=>async(t,n,i)=>{const r=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return ql(e)(t,n,r)},mj=nw(Kr),rw=e=>async(t,n,i)=>ql(e)(t,n,i),gj=rw(Kr),iw=e=>(t,n,i)=>{const r=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return Hl(e)(t,n,r)},yj=iw(Kr),ow=e=>(t,n,i)=>Hl(e)(t,n,i),wj=ow(Kr),sw=e=>async(t,n,i)=>{const r=i?Object.assign(i,{direction:"backward"}):{direction:"backward"};return Kl(e)(t,n,r)},vj=sw(Kr),aw=e=>async(t,n,i)=>Kl(e)(t,n,i),bj=aw(Kr),lA=/^[cC][^\s-]{8,}$/,uA=/^[0-9a-z]+$/,dA=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,fA=/^[0-9a-vA-V]{20}$/,pA=/^[A-Za-z0-9]{27}$/,hA=/^[a-zA-Z0-9_-]{21}$/,mA=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,_j=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,gA=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,ja=e=>e?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${e}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,Sj=ja(4),xj=ja(6),kj=ja(7),yA=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,Ej=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Aj=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,wA=/^[^\s@"]{1,64}@[^\s@]{1,255}$/u,Tj=wA,Ij=/^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,Nj="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function vA(){return new RegExp(Nj,"u")}const bA=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,_A=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,SA=e=>{const t=po(e??":");return new RegExp(`^(?:[0-9A-F]{2}${t}){5}[0-9A-F]{2}$|^(?:[0-9a-f]{2}${t}){5}[0-9a-f]{2}$`)},xA=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,kA=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,EA=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,cw=/^[A-Za-z0-9_-]*$/,AA=/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,TA=/^([a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?\.)+[a-zA-Z]{2,}$/,IA=/^\+[1-9]\d{6,14}$/,NA="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",$A=new RegExp(`^${NA}$`);function CA(e){const t="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof e.precision=="number"?e.precision===-1?`${t}`:e.precision===0?`${t}:[0-5]\\d`:`${t}:[0-5]\\d\\.\\d{${e.precision}}`:`${t}(?::[0-5]\\d(?:\\.\\d+)?)?`}function OA(e){return new RegExp(`^${CA(e)}$`)}function RA(e){const t=CA({precision:e.precision}),n=["Z"];e.local&&n.push(""),e.offset&&n.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const i=`${t}(?:${n.join("|")})`;return new RegExp(`^${NA}T(?:${i})$`)}const PA=e=>{const t=e?`[\\s\\S]{${e?.minimum??0},${e?.maximum??""}}`:"[\\s\\S]*";return new RegExp(`^${t}$`)},DA=/^-?\d+n?$/,UA=/^-?\d+$/,lw=/^-?\d+(?:\.\d+)?$/,LA=/^(?:true|false)$/i,MA=/^null$/i,jA=/^undefined$/i,zA=/^[^A-Z]*$/,BA=/^[^a-z]*$/,FA=/^[0-9a-fA-F]*$/;function Jl(e,t){return new RegExp(`^[A-Za-z0-9+/]{${e}}${t}$`)}function Gl(e){return new RegExp(`^[A-Za-z0-9_-]{${e}}$`)}const $j=/^[0-9a-fA-F]{32}$/,Cj=Jl(22,"=="),Oj=Gl(22),Rj=/^[0-9a-fA-F]{40}$/,Pj=Jl(27,"="),Dj=Gl(27),Uj=/^[0-9a-fA-F]{64}$/,Lj=Jl(43,"="),Mj=Gl(43),jj=/^[0-9a-fA-F]{96}$/,zj=Jl(64,""),Bj=Gl(64),Fj=/^[0-9a-fA-F]{128}$/,Wj=Jl(86,"=="),Vj=Gl(86),hp=Object.freeze(Object.defineProperty({__proto__:null,base64:EA,base64url:cw,bigint:DA,boolean:LA,browserEmail:Ij,cidrv4:xA,cidrv6:kA,cuid:lA,cuid2:uA,date:$A,datetime:RA,domain:TA,duration:mA,e164:IA,email:yA,emoji:vA,extendedDuration:_j,guid:gA,hex:FA,hostname:AA,html5Email:Ej,idnEmail:Tj,integer:UA,ipv4:bA,ipv6:_A,ksuid:pA,lowercase:zA,mac:SA,md5_base64:Cj,md5_base64url:Oj,md5_hex:$j,nanoid:hA,null:MA,number:lw,rfc5322Email:Aj,sha1_base64:Pj,sha1_base64url:Dj,sha1_hex:Rj,sha256_base64:Lj,sha256_base64url:Mj,sha256_hex:Uj,sha384_base64:zj,sha384_base64url:Bj,sha384_hex:jj,sha512_base64:Wj,sha512_base64url:Vj,sha512_hex:Fj,string:PA,time:OA,ulid:dA,undefined:jA,unicodeEmail:wA,uppercase:BA,uuid:ja,uuid4:Sj,uuid6:xj,uuid7:kj,xid:fA},Symbol.toStringTag,{value:"Module"})),pn=Y("$ZodCheck",(e,t)=>{var n;e._zod??(e._zod={}),e._zod.def=t,(n=e._zod).onattach??(n.onattach=[])}),WA={number:"number",bigint:"bigint",object:"date"},uw=Y("$ZodCheckLessThan",(e,t)=>{pn.init(e,t);const n=WA[typeof t.value];e._zod.onattach.push(i=>{const r=i._zod.bag,o=(t.inclusive?r.maximum:r.exclusiveMaximum)??Number.POSITIVE_INFINITY;t.value<o&&(t.inclusive?r.maximum=t.value:r.exclusiveMaximum=t.value)}),e._zod.check=i=>{(t.inclusive?i.value<=t.value:i.value<t.value)||i.issues.push({origin:n,code:"too_big",maximum:typeof t.value=="object"?t.value.getTime():t.value,input:i.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),dw=Y("$ZodCheckGreaterThan",(e,t)=>{pn.init(e,t);const n=WA[typeof t.value];e._zod.onattach.push(i=>{const r=i._zod.bag,o=(t.inclusive?r.minimum:r.exclusiveMinimum)??Number.NEGATIVE_INFINITY;t.value>o&&(t.inclusive?r.minimum=t.value:r.exclusiveMinimum=t.value)}),e._zod.check=i=>{(t.inclusive?i.value>=t.value:i.value>t.value)||i.issues.push({origin:n,code:"too_small",minimum:typeof t.value=="object"?t.value.getTime():t.value,input:i.value,inclusive:t.inclusive,inst:e,continue:!t.abort})}}),VA=Y("$ZodCheckMultipleOf",(e,t)=>{pn.init(e,t),e._zod.onattach.push(n=>{var i;(i=n._zod.bag).multipleOf??(i.multipleOf=t.value)}),e._zod.check=n=>{if(typeof n.value!=typeof t.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof n.value=="bigint"?n.value%t.value===BigInt(0):WE(n.value,t.value)===0)||n.issues.push({origin:typeof n.value,code:"not_multiple_of",divisor:t.value,input:n.value,inst:e,continue:!t.abort})}}),qA=Y("$ZodCheckNumberFormat",(e,t)=>{pn.init(e,t),t.format=t.format||"float64";const n=t.format?.includes("int"),i=n?"int":"number",[r,o]=JE[t.format];e._zod.onattach.push(s=>{const a=s._zod.bag;a.format=t.format,a.minimum=r,a.maximum=o,n&&(a.pattern=UA)}),e._zod.check=s=>{const a=s.value;if(n){if(!Number.isInteger(a)){s.issues.push({expected:i,format:t.format,code:"invalid_type",continue:!1,input:a,inst:e});return}if(!Number.isSafeInteger(a)){a>0?s.issues.push({input:a,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:i,inclusive:!0,continue:!t.abort}):s.issues.push({input:a,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:e,origin:i,inclusive:!0,continue:!t.abort});return}}a<r&&s.issues.push({origin:"number",input:a,code:"too_small",minimum:r,inclusive:!0,inst:e,continue:!t.abort}),a>o&&s.issues.push({origin:"number",input:a,code:"too_big",maximum:o,inclusive:!0,inst:e,continue:!t.abort})}}),HA=Y("$ZodCheckBigIntFormat",(e,t)=>{pn.init(e,t);const[n,i]=GE[t.format];e._zod.onattach.push(r=>{const o=r._zod.bag;o.format=t.format,o.minimum=n,o.maximum=i}),e._zod.check=r=>{const o=r.value;o<n&&r.issues.push({origin:"bigint",input:o,code:"too_small",minimum:n,inclusive:!0,inst:e,continue:!t.abort}),o>i&&r.issues.push({origin:"bigint",input:o,code:"too_big",maximum:i,inclusive:!0,inst:e,continue:!t.abort})}}),KA=Y("$ZodCheckMaxSize",(e,t)=>{var n;pn.init(e,t),(n=e._zod.def).when??(n.when=i=>{const r=i.value;return!Js(r)&&r.size!==void 0}),e._zod.onattach.push(i=>{const r=i._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<r&&(i._zod.bag.maximum=t.maximum)}),e._zod.check=i=>{const r=i.value;r.size<=t.maximum||i.issues.push({origin:up(r),code:"too_big",maximum:t.maximum,inclusive:!0,input:r,inst:e,continue:!t.abort})}}),JA=Y("$ZodCheckMinSize",(e,t)=>{var n;pn.init(e,t),(n=e._zod.def).when??(n.when=i=>{const r=i.value;return!Js(r)&&r.size!==void 0}),e._zod.onattach.push(i=>{const r=i._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>r&&(i._zod.bag.minimum=t.minimum)}),e._zod.check=i=>{const r=i.value;r.size>=t.minimum||i.issues.push({origin:up(r),code:"too_small",minimum:t.minimum,inclusive:!0,input:r,inst:e,continue:!t.abort})}}),GA=Y("$ZodCheckSizeEquals",(e,t)=>{var n;pn.init(e,t),(n=e._zod.def).when??(n.when=i=>{const r=i.value;return!Js(r)&&r.size!==void 0}),e._zod.onattach.push(i=>{const r=i._zod.bag;r.minimum=t.size,r.maximum=t.size,r.size=t.size}),e._zod.check=i=>{const r=i.value,o=r.size;if(o===t.size)return;const s=o>t.size;i.issues.push({origin:up(r),...s?{code:"too_big",maximum:t.size}:{code:"too_small",minimum:t.size},inclusive:!0,exact:!0,input:i.value,inst:e,continue:!t.abort})}}),ZA=Y("$ZodCheckMaxLength",(e,t)=>{var n;pn.init(e,t),(n=e._zod.def).when??(n.when=i=>{const r=i.value;return!Js(r)&&r.length!==void 0}),e._zod.onattach.push(i=>{const r=i._zod.bag.maximum??Number.POSITIVE_INFINITY;t.maximum<r&&(i._zod.bag.maximum=t.maximum)}),e._zod.check=i=>{const r=i.value;if(r.length<=t.maximum)return;const s=dp(r);i.issues.push({origin:s,code:"too_big",maximum:t.maximum,inclusive:!0,input:r,inst:e,continue:!t.abort})}}),QA=Y("$ZodCheckMinLength",(e,t)=>{var n;pn.init(e,t),(n=e._zod.def).when??(n.when=i=>{const r=i.value;return!Js(r)&&r.length!==void 0}),e._zod.onattach.push(i=>{const r=i._zod.bag.minimum??Number.NEGATIVE_INFINITY;t.minimum>r&&(i._zod.bag.minimum=t.minimum)}),e._zod.check=i=>{const r=i.value;if(r.length>=t.minimum)return;const s=dp(r);i.issues.push({origin:s,code:"too_small",minimum:t.minimum,inclusive:!0,input:r,inst:e,continue:!t.abort})}}),YA=Y("$ZodCheckLengthEquals",(e,t)=>{var n;pn.init(e,t),(n=e._zod.def).when??(n.when=i=>{const r=i.value;return!Js(r)&&r.length!==void 0}),e._zod.onattach.push(i=>{const r=i._zod.bag;r.minimum=t.length,r.maximum=t.length,r.length=t.length}),e._zod.check=i=>{const r=i.value,o=r.length;if(o===t.length)return;const s=dp(r),a=o>t.length;i.issues.push({origin:s,...a?{code:"too_big",maximum:t.length}:{code:"too_small",minimum:t.length},inclusive:!0,exact:!0,input:i.value,inst:e,continue:!t.abort})}}),Zl=Y("$ZodCheckStringFormat",(e,t)=>{var n,i;pn.init(e,t),e._zod.onattach.push(r=>{const o=r._zod.bag;o.format=t.format,t.pattern&&(o.patterns??(o.patterns=new Set),o.patterns.add(t.pattern))}),t.pattern?(n=e._zod).check??(n.check=r=>{t.pattern.lastIndex=0,!t.pattern.test(r.value)&&r.issues.push({origin:"string",code:"invalid_format",format:t.format,input:r.value,...t.pattern?{pattern:t.pattern.toString()}:{},inst:e,continue:!t.abort})}):(i=e._zod).check??(i.check=()=>{})}),XA=Y("$ZodCheckRegex",(e,t)=>{Zl.init(e,t),e._zod.check=n=>{t.pattern.lastIndex=0,!t.pattern.test(n.value)&&n.issues.push({origin:"string",code:"invalid_format",format:"regex",input:n.value,pattern:t.pattern.toString(),inst:e,continue:!t.abort})}}),eT=Y("$ZodCheckLowerCase",(e,t)=>{t.pattern??(t.pattern=zA),Zl.init(e,t)}),tT=Y("$ZodCheckUpperCase",(e,t)=>{t.pattern??(t.pattern=BA),Zl.init(e,t)}),nT=Y("$ZodCheckIncludes",(e,t)=>{pn.init(e,t);const n=po(t.includes),i=new RegExp(typeof t.position=="number"?`^.{${t.position}}${n}`:n);t.pattern=i,e._zod.onattach.push(r=>{const o=r._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(i)}),e._zod.check=r=>{r.value.includes(t.includes,t.position)||r.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:t.includes,input:r.value,inst:e,continue:!t.abort})}}),rT=Y("$ZodCheckStartsWith",(e,t)=>{pn.init(e,t);const n=new RegExp(`^${po(t.prefix)}.*`);t.pattern??(t.pattern=n),e._zod.onattach.push(i=>{const r=i._zod.bag;r.patterns??(r.patterns=new Set),r.patterns.add(n)}),e._zod.check=i=>{i.value.startsWith(t.prefix)||i.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:t.prefix,input:i.value,inst:e,continue:!t.abort})}}),iT=Y("$ZodCheckEndsWith",(e,t)=>{pn.init(e,t);const n=new RegExp(`.*${po(t.suffix)}$`);t.pattern??(t.pattern=n),e._zod.onattach.push(i=>{const r=i._zod.bag;r.patterns??(r.patterns=new Set),r.patterns.add(n)}),e._zod.check=i=>{i.value.endsWith(t.suffix)||i.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:t.suffix,input:i.value,inst:e,continue:!t.abort})}});function y_(e,t,n){e.issues.length&&t.issues.push(...wi(n,e.issues))}const oT=Y("$ZodCheckProperty",(e,t)=>{pn.init(e,t),e._zod.check=n=>{const i=t.schema._zod.run({value:n.value[t.property],issues:[]},{});if(i instanceof Promise)return i.then(r=>y_(r,n,t.property));y_(i,n,t.property)}}),sT=Y("$ZodCheckMimeType",(e,t)=>{pn.init(e,t);const n=new Set(t.mime);e._zod.onattach.push(i=>{i._zod.bag.mime=t.mime}),e._zod.check=i=>{n.has(i.value.type)||i.issues.push({code:"invalid_value",values:t.mime,input:i.value.type,inst:e,continue:!t.abort})}}),aT=Y("$ZodCheckOverwrite",(e,t)=>{pn.init(e,t),e._zod.check=n=>{n.value=t.tx(n.value)}});class cT{constructor(t=[]){this.content=[],this.indent=0,this&&(this.args=t)}indented(t){this.indent+=1,t(this),this.indent-=1}write(t){if(typeof t=="function"){t(this,{execution:"sync"}),t(this,{execution:"async"});return}const i=t.split(`
`).filter(s=>s),r=Math.min(...i.map(s=>s.length-s.trimStart().length)),o=i.map(s=>s.slice(r)).map(s=>" ".repeat(this.indent*2)+s);for(const s of o)this.content.push(s)}compile(){const t=Function,n=this?.args,r=[...(this?.content??[""]).map(o=>`  ${o}`)];return new t(...n,r.join(`
`))}}const lT={major:4,minor:3,patch:6},Xe=Y("$ZodType",(e,t)=>{var n;e??(e={}),e._zod.def=t,e._zod.bag=e._zod.bag||{},e._zod.version=lT;const i=[...e._zod.def.checks??[]];e._zod.traits.has("$ZodCheck")&&i.unshift(e);for(const r of i)for(const o of r._zod.onattach)o(e);if(i.length===0)(n=e._zod).deferred??(n.deferred=[]),e._zod.deferred?.push(()=>{e._zod.run=e._zod.parse});else{const r=(s,a,c)=>{let l=Es(s),u;for(const p of a){if(p._zod.def.when){if(!p._zod.def.when(s))continue}else if(l)continue;const f=s.issues.length,g=p._zod.check(s);if(g instanceof Promise&&c?.async===!1)throw new Ns;if(u||g instanceof Promise)u=(u??Promise.resolve()).then(async()=>{await g,s.issues.length!==f&&(l||(l=Es(s,f)))});else{if(s.issues.length===f)continue;l||(l=Es(s,f))}}return u?u.then(()=>s):s},o=(s,a,c)=>{if(Es(s))return s.aborted=!0,s;const l=r(a,i,c);if(l instanceof Promise){if(c.async===!1)throw new Ns;return l.then(u=>e._zod.parse(u,c))}return e._zod.parse(l,c)};e._zod.run=(s,a)=>{if(a.skipChecks)return e._zod.parse(s,a);if(a.direction==="backward"){const l=e._zod.parse({value:s.value,issues:[]},{...a,skipChecks:!0});return l instanceof Promise?l.then(u=>o(u,s,a)):o(l,s,a)}const c=e._zod.parse(s,a);if(c instanceof Promise){if(a.async===!1)throw new Ns;return c.then(l=>r(l,i,a))}return r(c,i,a)}}lt(e,"~standard",()=>({validate:r=>{try{const o=aA(e,r);return o.success?{value:o.data}:{issues:o.error?.issues}}catch{return cA(e,r).then(s=>s.success?{value:s.data}:{issues:s.error?.issues})}},vendor:"zod",version:1}))}),Ql=Y("$ZodString",(e,t)=>{Xe.init(e,t),e._zod.pattern=[...e?._zod.bag?.patterns??[]].pop()??PA(e._zod.bag),e._zod.parse=(n,i)=>{if(t.coerce)try{n.value=String(n.value)}catch{}return typeof n.value=="string"||n.issues.push({expected:"string",code:"invalid_type",input:n.value,inst:e}),n}}),Yt=Y("$ZodStringFormat",(e,t)=>{Zl.init(e,t),Ql.init(e,t)}),uT=Y("$ZodGUID",(e,t)=>{t.pattern??(t.pattern=gA),Yt.init(e,t)}),dT=Y("$ZodUUID",(e,t)=>{if(t.version){const i={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[t.version];if(i===void 0)throw new Error(`Invalid UUID version: "${t.version}"`);t.pattern??(t.pattern=ja(i))}else t.pattern??(t.pattern=ja());Yt.init(e,t)}),fT=Y("$ZodEmail",(e,t)=>{t.pattern??(t.pattern=yA),Yt.init(e,t)}),pT=Y("$ZodURL",(e,t)=>{Yt.init(e,t),e._zod.check=n=>{try{const i=n.value.trim(),r=new URL(i);t.hostname&&(t.hostname.lastIndex=0,t.hostname.test(r.hostname)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:t.hostname.source,input:n.value,inst:e,continue:!t.abort})),t.protocol&&(t.protocol.lastIndex=0,t.protocol.test(r.protocol.endsWith(":")?r.protocol.slice(0,-1):r.protocol)||n.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:t.protocol.source,input:n.value,inst:e,continue:!t.abort})),t.normalize?n.value=r.href:n.value=i;return}catch{n.issues.push({code:"invalid_format",format:"url",input:n.value,inst:e,continue:!t.abort})}}}),hT=Y("$ZodEmoji",(e,t)=>{t.pattern??(t.pattern=vA()),Yt.init(e,t)}),mT=Y("$ZodNanoID",(e,t)=>{t.pattern??(t.pattern=hA),Yt.init(e,t)}),gT=Y("$ZodCUID",(e,t)=>{t.pattern??(t.pattern=lA),Yt.init(e,t)}),yT=Y("$ZodCUID2",(e,t)=>{t.pattern??(t.pattern=uA),Yt.init(e,t)}),wT=Y("$ZodULID",(e,t)=>{t.pattern??(t.pattern=dA),Yt.init(e,t)}),vT=Y("$ZodXID",(e,t)=>{t.pattern??(t.pattern=fA),Yt.init(e,t)}),bT=Y("$ZodKSUID",(e,t)=>{t.pattern??(t.pattern=pA),Yt.init(e,t)}),_T=Y("$ZodISODateTime",(e,t)=>{t.pattern??(t.pattern=RA(t)),Yt.init(e,t)}),ST=Y("$ZodISODate",(e,t)=>{t.pattern??(t.pattern=$A),Yt.init(e,t)}),xT=Y("$ZodISOTime",(e,t)=>{t.pattern??(t.pattern=OA(t)),Yt.init(e,t)}),kT=Y("$ZodISODuration",(e,t)=>{t.pattern??(t.pattern=mA),Yt.init(e,t)}),ET=Y("$ZodIPv4",(e,t)=>{t.pattern??(t.pattern=bA),Yt.init(e,t),e._zod.bag.format="ipv4"}),AT=Y("$ZodIPv6",(e,t)=>{t.pattern??(t.pattern=_A),Yt.init(e,t),e._zod.bag.format="ipv6",e._zod.check=n=>{try{new URL(`http://[${n.value}]`)}catch{n.issues.push({code:"invalid_format",format:"ipv6",input:n.value,inst:e,continue:!t.abort})}}}),TT=Y("$ZodMAC",(e,t)=>{t.pattern??(t.pattern=SA(t.delimiter)),Yt.init(e,t),e._zod.bag.format="mac"}),IT=Y("$ZodCIDRv4",(e,t)=>{t.pattern??(t.pattern=xA),Yt.init(e,t)}),NT=Y("$ZodCIDRv6",(e,t)=>{t.pattern??(t.pattern=kA),Yt.init(e,t),e._zod.check=n=>{const i=n.value.split("/");try{if(i.length!==2)throw new Error;const[r,o]=i;if(!o)throw new Error;const s=Number(o);if(`${s}`!==o)throw new Error;if(s<0||s>128)throw new Error;new URL(`http://[${r}]`)}catch{n.issues.push({code:"invalid_format",format:"cidrv6",input:n.value,inst:e,continue:!t.abort})}}});function fw(e){if(e==="")return!0;if(e.length%4!==0)return!1;try{return atob(e),!0}catch{return!1}}const $T=Y("$ZodBase64",(e,t)=>{t.pattern??(t.pattern=EA),Yt.init(e,t),e._zod.bag.contentEncoding="base64",e._zod.check=n=>{fw(n.value)||n.issues.push({code:"invalid_format",format:"base64",input:n.value,inst:e,continue:!t.abort})}});function CT(e){if(!cw.test(e))return!1;const t=e.replace(/[-_]/g,i=>i==="-"?"+":"/"),n=t.padEnd(Math.ceil(t.length/4)*4,"=");return fw(n)}const OT=Y("$ZodBase64URL",(e,t)=>{t.pattern??(t.pattern=cw),Yt.init(e,t),e._zod.bag.contentEncoding="base64url",e._zod.check=n=>{CT(n.value)||n.issues.push({code:"invalid_format",format:"base64url",input:n.value,inst:e,continue:!t.abort})}}),RT=Y("$ZodE164",(e,t)=>{t.pattern??(t.pattern=IA),Yt.init(e,t)});function PT(e,t=null){try{const n=e.split(".");if(n.length!==3)return!1;const[i]=n;if(!i)return!1;const r=JSON.parse(atob(i));return!("typ"in r&&r?.typ!=="JWT"||!r.alg||t&&(!("alg"in r)||r.alg!==t))}catch{return!1}}const DT=Y("$ZodJWT",(e,t)=>{Yt.init(e,t),e._zod.check=n=>{PT(n.value,t.alg)||n.issues.push({code:"invalid_format",format:"jwt",input:n.value,inst:e,continue:!t.abort})}}),UT=Y("$ZodCustomStringFormat",(e,t)=>{Yt.init(e,t),e._zod.check=n=>{t.fn(n.value)||n.issues.push({code:"invalid_format",format:t.format,input:n.value,inst:e,continue:!t.abort})}}),pw=Y("$ZodNumber",(e,t)=>{Xe.init(e,t),e._zod.pattern=e._zod.bag.pattern??lw,e._zod.parse=(n,i)=>{if(t.coerce)try{n.value=Number(n.value)}catch{}const r=n.value;if(typeof r=="number"&&!Number.isNaN(r)&&Number.isFinite(r))return n;const o=typeof r=="number"?Number.isNaN(r)?"NaN":Number.isFinite(r)?void 0:"Infinity":void 0;return n.issues.push({expected:"number",code:"invalid_type",input:r,inst:e,...o?{received:o}:{}}),n}}),LT=Y("$ZodNumberFormat",(e,t)=>{qA.init(e,t),pw.init(e,t)}),hw=Y("$ZodBoolean",(e,t)=>{Xe.init(e,t),e._zod.pattern=LA,e._zod.parse=(n,i)=>{if(t.coerce)try{n.value=!!n.value}catch{}const r=n.value;return typeof r=="boolean"||n.issues.push({expected:"boolean",code:"invalid_type",input:r,inst:e}),n}}),mw=Y("$ZodBigInt",(e,t)=>{Xe.init(e,t),e._zod.pattern=DA,e._zod.parse=(n,i)=>{if(t.coerce)try{n.value=BigInt(n.value)}catch{}return typeof n.value=="bigint"||n.issues.push({expected:"bigint",code:"invalid_type",input:n.value,inst:e}),n}}),MT=Y("$ZodBigIntFormat",(e,t)=>{HA.init(e,t),mw.init(e,t)}),jT=Y("$ZodSymbol",(e,t)=>{Xe.init(e,t),e._zod.parse=(n,i)=>{const r=n.value;return typeof r=="symbol"||n.issues.push({expected:"symbol",code:"invalid_type",input:r,inst:e}),n}}),zT=Y("$ZodUndefined",(e,t)=>{Xe.init(e,t),e._zod.pattern=jA,e._zod.values=new Set([void 0]),e._zod.optin="optional",e._zod.optout="optional",e._zod.parse=(n,i)=>{const r=n.value;return typeof r>"u"||n.issues.push({expected:"undefined",code:"invalid_type",input:r,inst:e}),n}}),BT=Y("$ZodNull",(e,t)=>{Xe.init(e,t),e._zod.pattern=MA,e._zod.values=new Set([null]),e._zod.parse=(n,i)=>{const r=n.value;return r===null||n.issues.push({expected:"null",code:"invalid_type",input:r,inst:e}),n}}),FT=Y("$ZodAny",(e,t)=>{Xe.init(e,t),e._zod.parse=n=>n}),WT=Y("$ZodUnknown",(e,t)=>{Xe.init(e,t),e._zod.parse=n=>n}),VT=Y("$ZodNever",(e,t)=>{Xe.init(e,t),e._zod.parse=(n,i)=>(n.issues.push({expected:"never",code:"invalid_type",input:n.value,inst:e}),n)}),qT=Y("$ZodVoid",(e,t)=>{Xe.init(e,t),e._zod.parse=(n,i)=>{const r=n.value;return typeof r>"u"||n.issues.push({expected:"void",code:"invalid_type",input:r,inst:e}),n}}),HT=Y("$ZodDate",(e,t)=>{Xe.init(e,t),e._zod.parse=(n,i)=>{if(t.coerce)try{n.value=new Date(n.value)}catch{}const r=n.value,o=r instanceof Date;return o&&!Number.isNaN(r.getTime())||n.issues.push({expected:"date",code:"invalid_type",input:r,...o?{received:"Invalid Date"}:{},inst:e}),n}});function w_(e,t,n){e.issues.length&&t.issues.push(...wi(n,e.issues)),t.value[n]=e.value}const KT=Y("$ZodArray",(e,t)=>{Xe.init(e,t),e._zod.parse=(n,i)=>{const r=n.value;if(!Array.isArray(r))return n.issues.push({expected:"array",code:"invalid_type",input:r,inst:e}),n;n.value=Array(r.length);const o=[];for(let s=0;s<r.length;s++){const a=r[s],c=t.element._zod.run({value:a,issues:[]},i);c instanceof Promise?o.push(c.then(l=>w_(l,n,s))):w_(c,n,s)}return o.length?Promise.all(o).then(()=>n):n}});function mf(e,t,n,i,r){if(e.issues.length){if(r&&!(n in i))return;t.issues.push(...wi(n,e.issues))}e.value===void 0?n in i&&(t.value[n]=void 0):t.value[n]=e.value}function JT(e){const t=Object.keys(e.shape);for(const i of t)if(!e.shape?.[i]?._zod?.traits?.has("$ZodType"))throw new Error(`Invalid element at key "${i}": expected a Zod schema`);const n=KE(e.shape);return{...e,keys:t,keySet:new Set(t),numKeys:t.length,optionalKeys:new Set(n)}}function GT(e,t,n,i,r,o){const s=[],a=r.keySet,c=r.catchall._zod,l=c.def.type,u=c.optout==="optional";for(const p in t){if(a.has(p))continue;if(l==="never"){s.push(p);continue}const f=c.run({value:t[p],issues:[]},i);f instanceof Promise?e.push(f.then(g=>mf(g,n,p,t,u))):mf(f,n,p,t,u)}return s.length&&n.issues.push({code:"unrecognized_keys",keys:s,input:t,inst:o}),e.length?Promise.all(e).then(()=>n):n}const ZT=Y("$ZodObject",(e,t)=>{if(Xe.init(e,t),!Object.getOwnPropertyDescriptor(t,"shape")?.get){const a=t.shape;Object.defineProperty(t,"shape",{get:()=>{const c={...a};return Object.defineProperty(t,"shape",{value:c}),c}})}const i=Wl(()=>JT(t));lt(e._zod,"propValues",()=>{const a=t.shape,c={};for(const l in a){const u=a[l]._zod;if(u.values){c[l]??(c[l]=new Set);for(const p of u.values)c[l].add(p)}}return c});const r=La,o=t.catchall;let s;e._zod.parse=(a,c)=>{s??(s=i.value);const l=a.value;if(!r(l))return a.issues.push({expected:"object",code:"invalid_type",input:l,inst:e}),a;a.value={};const u=[],p=s.shape;for(const f of s.keys){const g=p[f],h=g._zod.optout==="optional",d=g._zod.run({value:l[f],issues:[]},c);d instanceof Promise?u.push(d.then(y=>mf(y,a,f,l,h))):mf(d,a,f,l,h)}return o?GT(u,l,a,c,i.value,e):u.length?Promise.all(u).then(()=>a):a}}),QT=Y("$ZodObjectJIT",(e,t)=>{ZT.init(e,t);const n=e._zod.parse,i=Wl(()=>JT(t)),r=f=>{const g=new cT(["shape","payload","ctx"]),h=i.value,d=E=>{const N=Lg(E);return`shape[${N}]._zod.run({ value: input[${N}], issues: [] }, ctx)`};g.write("const input = payload.value;");const y=Object.create(null);let v=0;for(const E of h.keys)y[E]=`key_${v++}`;g.write("const newResult = {};");for(const E of h.keys){const N=y[E],C=Lg(E),P=f[E]?._zod?.optout==="optional";g.write(`const ${N} = ${d(E)};`),P?g.write(`
        if (${N}.issues.length) {
          if (${C} in input) {
            payload.issues = payload.issues.concat(${N}.issues.map(iss => ({
              ...iss,
              path: iss.path ? [${C}, ...iss.path] : [${C}]
            })));
          }
        }
        
        if (${N}.value === undefined) {
          if (${C} in input) {
            newResult[${C}] = undefined;
          }
        } else {
          newResult[${C}] = ${N}.value;
        }
        
      `):g.write(`
        if (${N}.issues.length) {
          payload.issues = payload.issues.concat(${N}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${C}, ...iss.path] : [${C}]
          })));
        }
        
        if (${N}.value === undefined) {
          if (${C} in input) {
            newResult[${C}] = undefined;
          }
        } else {
          newResult[${C}] = ${N}.value;
        }
        
      `)}g.write("payload.value = newResult;"),g.write("return payload;");const x=g.compile();return(E,N)=>x(f,E,N)};let o;const s=La,a=!ff.jitless,l=a&&qE.value,u=t.catchall;let p;e._zod.parse=(f,g)=>{p??(p=i.value);const h=f.value;return s(h)?a&&l&&g?.async===!1&&g.jitless!==!0?(o||(o=r(t.shape)),f=o(f,g),u?GT([],h,f,g,p,e):f):n(f,g):(f.issues.push({expected:"object",code:"invalid_type",input:h,inst:e}),f)}});function v_(e,t,n,i){for(const o of e)if(o.issues.length===0)return t.value=o.value,t;const r=e.filter(o=>!Es(o));return r.length===1?(t.value=r[0].value,r[0]):(t.issues.push({code:"invalid_union",input:t.value,inst:n,errors:e.map(o=>o.issues.map(s=>ai(s,i,Gn())))}),t)}const mp=Y("$ZodUnion",(e,t)=>{Xe.init(e,t),lt(e._zod,"optin",()=>t.options.some(r=>r._zod.optin==="optional")?"optional":void 0),lt(e._zod,"optout",()=>t.options.some(r=>r._zod.optout==="optional")?"optional":void 0),lt(e._zod,"values",()=>{if(t.options.every(r=>r._zod.values))return new Set(t.options.flatMap(r=>Array.from(r._zod.values)))}),lt(e._zod,"pattern",()=>{if(t.options.every(r=>r._zod.pattern)){const r=t.options.map(o=>o._zod.pattern);return new RegExp(`^(${r.map(o=>cp(o.source)).join("|")})$`)}});const n=t.options.length===1,i=t.options[0]._zod.run;e._zod.parse=(r,o)=>{if(n)return i(r,o);let s=!1;const a=[];for(const c of t.options){const l=c._zod.run({value:r.value,issues:[]},o);if(l instanceof Promise)a.push(l),s=!0;else{if(l.issues.length===0)return l;a.push(l)}}return s?Promise.all(a).then(c=>v_(c,r,e,o)):v_(a,r,e,o)}});function b_(e,t,n,i){const r=e.filter(o=>o.issues.length===0);return r.length===1?(t.value=r[0].value,t):(r.length===0?t.issues.push({code:"invalid_union",input:t.value,inst:n,errors:e.map(o=>o.issues.map(s=>ai(s,i,Gn())))}):t.issues.push({code:"invalid_union",input:t.value,inst:n,errors:[],inclusive:!1}),t)}const YT=Y("$ZodXor",(e,t)=>{mp.init(e,t),t.inclusive=!1;const n=t.options.length===1,i=t.options[0]._zod.run;e._zod.parse=(r,o)=>{if(n)return i(r,o);let s=!1;const a=[];for(const c of t.options){const l=c._zod.run({value:r.value,issues:[]},o);l instanceof Promise?(a.push(l),s=!0):a.push(l)}return s?Promise.all(a).then(c=>b_(c,r,e,o)):b_(a,r,e,o)}}),XT=Y("$ZodDiscriminatedUnion",(e,t)=>{t.inclusive=!1,mp.init(e,t);const n=e._zod.parse;lt(e._zod,"propValues",()=>{const r={};for(const o of t.options){const s=o._zod.propValues;if(!s||Object.keys(s).length===0)throw new Error(`Invalid discriminated union option at index "${t.options.indexOf(o)}"`);for(const[a,c]of Object.entries(s)){r[a]||(r[a]=new Set);for(const l of c)r[a].add(l)}}return r});const i=Wl(()=>{const r=t.options,o=new Map;for(const s of r){const a=s._zod.propValues?.[t.discriminator];if(!a||a.size===0)throw new Error(`Invalid discriminated union option at index "${t.options.indexOf(s)}"`);for(const c of a){if(o.has(c))throw new Error(`Duplicate discriminator value "${String(c)}"`);o.set(c,s)}}return o});e._zod.parse=(r,o)=>{const s=r.value;if(!La(s))return r.issues.push({code:"invalid_type",expected:"object",input:s,inst:e}),r;const a=i.value.get(s?.[t.discriminator]);return a?a._zod.run(r,o):t.unionFallback?n(r,o):(r.issues.push({code:"invalid_union",errors:[],note:"No matching discriminator",discriminator:t.discriminator,input:s,path:[t.discriminator],inst:e}),r)}}),e1=Y("$ZodIntersection",(e,t)=>{Xe.init(e,t),e._zod.parse=(n,i)=>{const r=n.value,o=t.left._zod.run({value:r,issues:[]},i),s=t.right._zod.run({value:r,issues:[]},i);return o instanceof Promise||s instanceof Promise?Promise.all([o,s]).then(([c,l])=>__(n,c,l)):__(n,o,s)}});function zg(e,t){if(e===t)return{valid:!0,data:e};if(e instanceof Date&&t instanceof Date&&+e==+t)return{valid:!0,data:e};if(Ds(e)&&Ds(t)){const n=Object.keys(t),i=Object.keys(e).filter(o=>n.indexOf(o)!==-1),r={...e,...t};for(const o of i){const s=zg(e[o],t[o]);if(!s.valid)return{valid:!1,mergeErrorPath:[o,...s.mergeErrorPath]};r[o]=s.data}return{valid:!0,data:r}}if(Array.isArray(e)&&Array.isArray(t)){if(e.length!==t.length)return{valid:!1,mergeErrorPath:[]};const n=[];for(let i=0;i<e.length;i++){const r=e[i],o=t[i],s=zg(r,o);if(!s.valid)return{valid:!1,mergeErrorPath:[i,...s.mergeErrorPath]};n.push(s.data)}return{valid:!0,data:n}}return{valid:!1,mergeErrorPath:[]}}function __(e,t,n){const i=new Map;let r;for(const a of t.issues)if(a.code==="unrecognized_keys"){r??(r=a);for(const c of a.keys)i.has(c)||i.set(c,{}),i.get(c).l=!0}else e.issues.push(a);for(const a of n.issues)if(a.code==="unrecognized_keys")for(const c of a.keys)i.has(c)||i.set(c,{}),i.get(c).r=!0;else e.issues.push(a);const o=[...i].filter(([,a])=>a.l&&a.r).map(([a])=>a);if(o.length&&r&&e.issues.push({...r,keys:o}),Es(e))return e;const s=zg(t.value,n.value);if(!s.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(s.mergeErrorPath)}`);return e.value=s.data,e}const gw=Y("$ZodTuple",(e,t)=>{Xe.init(e,t);const n=t.items;e._zod.parse=(i,r)=>{const o=i.value;if(!Array.isArray(o))return i.issues.push({input:o,inst:e,expected:"tuple",code:"invalid_type"}),i;i.value=[];const s=[],a=[...n].reverse().findIndex(u=>u._zod.optin!=="optional"),c=a===-1?0:n.length-a;if(!t.rest){const u=o.length>n.length,p=o.length<c-1;if(u||p)return i.issues.push({...u?{code:"too_big",maximum:n.length,inclusive:!0}:{code:"too_small",minimum:n.length},input:o,inst:e,origin:"array"}),i}let l=-1;for(const u of n){if(l++,l>=o.length&&l>=c)continue;const p=u._zod.run({value:o[l],issues:[]},r);p instanceof Promise?s.push(p.then(f=>gd(f,i,l))):gd(p,i,l)}if(t.rest){const u=o.slice(n.length);for(const p of u){l++;const f=t.rest._zod.run({value:p,issues:[]},r);f instanceof Promise?s.push(f.then(g=>gd(g,i,l))):gd(f,i,l)}}return s.length?Promise.all(s).then(()=>i):i}});function gd(e,t,n){e.issues.length&&t.issues.push(...wi(n,e.issues)),t.value[n]=e.value}const t1=Y("$ZodRecord",(e,t)=>{Xe.init(e,t),e._zod.parse=(n,i)=>{const r=n.value;if(!Ds(r))return n.issues.push({expected:"record",code:"invalid_type",input:r,inst:e}),n;const o=[],s=t.keyType._zod.values;if(s){n.value={};const a=new Set;for(const l of s)if(typeof l=="string"||typeof l=="number"||typeof l=="symbol"){a.add(typeof l=="number"?l.toString():l);const u=t.valueType._zod.run({value:r[l],issues:[]},i);u instanceof Promise?o.push(u.then(p=>{p.issues.length&&n.issues.push(...wi(l,p.issues)),n.value[l]=p.value})):(u.issues.length&&n.issues.push(...wi(l,u.issues)),n.value[l]=u.value)}let c;for(const l in r)a.has(l)||(c=c??[],c.push(l));c&&c.length>0&&n.issues.push({code:"unrecognized_keys",input:r,inst:e,keys:c})}else{n.value={};for(const a of Reflect.ownKeys(r)){if(a==="__proto__")continue;let c=t.keyType._zod.run({value:a,issues:[]},i);if(c instanceof Promise)throw new Error("Async schemas not supported in object keys currently");if(typeof a=="string"&&lw.test(a)&&c.issues.length){const p=t.keyType._zod.run({value:Number(a),issues:[]},i);if(p instanceof Promise)throw new Error("Async schemas not supported in object keys currently");p.issues.length===0&&(c=p)}if(c.issues.length){t.mode==="loose"?n.value[a]=r[a]:n.issues.push({code:"invalid_key",origin:"record",issues:c.issues.map(p=>ai(p,i,Gn())),input:a,path:[a],inst:e});continue}const u=t.valueType._zod.run({value:r[a],issues:[]},i);u instanceof Promise?o.push(u.then(p=>{p.issues.length&&n.issues.push(...wi(a,p.issues)),n.value[c.value]=p.value})):(u.issues.length&&n.issues.push(...wi(a,u.issues)),n.value[c.value]=u.value)}}return o.length?Promise.all(o).then(()=>n):n}}),n1=Y("$ZodMap",(e,t)=>{Xe.init(e,t),e._zod.parse=(n,i)=>{const r=n.value;if(!(r instanceof Map))return n.issues.push({expected:"map",code:"invalid_type",input:r,inst:e}),n;const o=[];n.value=new Map;for(const[s,a]of r){const c=t.keyType._zod.run({value:s,issues:[]},i),l=t.valueType._zod.run({value:a,issues:[]},i);c instanceof Promise||l instanceof Promise?o.push(Promise.all([c,l]).then(([u,p])=>{S_(u,p,n,s,r,e,i)})):S_(c,l,n,s,r,e,i)}return o.length?Promise.all(o).then(()=>n):n}});function S_(e,t,n,i,r,o,s){e.issues.length&&(hf.has(typeof i)?n.issues.push(...wi(i,e.issues)):n.issues.push({code:"invalid_key",origin:"map",input:r,inst:o,issues:e.issues.map(a=>ai(a,s,Gn()))})),t.issues.length&&(hf.has(typeof i)?n.issues.push(...wi(i,t.issues)):n.issues.push({origin:"map",code:"invalid_element",input:r,inst:o,key:i,issues:t.issues.map(a=>ai(a,s,Gn()))})),n.value.set(e.value,t.value)}const r1=Y("$ZodSet",(e,t)=>{Xe.init(e,t),e._zod.parse=(n,i)=>{const r=n.value;if(!(r instanceof Set))return n.issues.push({input:r,inst:e,expected:"set",code:"invalid_type"}),n;const o=[];n.value=new Set;for(const s of r){const a=t.valueType._zod.run({value:s,issues:[]},i);a instanceof Promise?o.push(a.then(c=>x_(c,n))):x_(a,n)}return o.length?Promise.all(o).then(()=>n):n}});function x_(e,t){e.issues.length&&t.issues.push(...e.issues),t.value.add(e.value)}const i1=Y("$ZodEnum",(e,t)=>{Xe.init(e,t);const n=Jy(t.entries),i=new Set(n);e._zod.values=i,e._zod.pattern=new RegExp(`^(${n.filter(r=>hf.has(typeof r)).map(r=>typeof r=="string"?po(r):r.toString()).join("|")})$`),e._zod.parse=(r,o)=>{const s=r.value;return i.has(s)||r.issues.push({code:"invalid_value",values:n,input:s,inst:e}),r}}),o1=Y("$ZodLiteral",(e,t)=>{if(Xe.init(e,t),t.values.length===0)throw new Error("Cannot create literal schema with no valid values");const n=new Set(t.values);e._zod.values=n,e._zod.pattern=new RegExp(`^(${t.values.map(i=>typeof i=="string"?po(i):i?po(i.toString()):String(i)).join("|")})$`),e._zod.parse=(i,r)=>{const o=i.value;return n.has(o)||i.issues.push({code:"invalid_value",values:t.values,input:o,inst:e}),i}}),s1=Y("$ZodFile",(e,t)=>{Xe.init(e,t),e._zod.parse=(n,i)=>{const r=n.value;return r instanceof File||n.issues.push({expected:"file",code:"invalid_type",input:r,inst:e}),n}}),a1=Y("$ZodTransform",(e,t)=>{Xe.init(e,t),e._zod.parse=(n,i)=>{if(i.direction==="backward")throw new ap(e.constructor.name);const r=t.transform(n.value,n);if(i.async)return(r instanceof Promise?r:Promise.resolve(r)).then(s=>(n.value=s,n));if(r instanceof Promise)throw new Ns;return n.value=r,n}});function k_(e,t){return e.issues.length&&t===void 0?{issues:[],value:void 0}:e}const yw=Y("$ZodOptional",(e,t)=>{Xe.init(e,t),e._zod.optin="optional",e._zod.optout="optional",lt(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,void 0]):void 0),lt(e._zod,"pattern",()=>{const n=t.innerType._zod.pattern;return n?new RegExp(`^(${cp(n.source)})?$`):void 0}),e._zod.parse=(n,i)=>{if(t.innerType._zod.optin==="optional"){const r=t.innerType._zod.run(n,i);return r instanceof Promise?r.then(o=>k_(o,n.value)):k_(r,n.value)}return n.value===void 0?n:t.innerType._zod.run(n,i)}}),c1=Y("$ZodExactOptional",(e,t)=>{yw.init(e,t),lt(e._zod,"values",()=>t.innerType._zod.values),lt(e._zod,"pattern",()=>t.innerType._zod.pattern),e._zod.parse=(n,i)=>t.innerType._zod.run(n,i)}),l1=Y("$ZodNullable",(e,t)=>{Xe.init(e,t),lt(e._zod,"optin",()=>t.innerType._zod.optin),lt(e._zod,"optout",()=>t.innerType._zod.optout),lt(e._zod,"pattern",()=>{const n=t.innerType._zod.pattern;return n?new RegExp(`^(${cp(n.source)}|null)$`):void 0}),lt(e._zod,"values",()=>t.innerType._zod.values?new Set([...t.innerType._zod.values,null]):void 0),e._zod.parse=(n,i)=>n.value===null?n:t.innerType._zod.run(n,i)}),u1=Y("$ZodDefault",(e,t)=>{Xe.init(e,t),e._zod.optin="optional",lt(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,i)=>{if(i.direction==="backward")return t.innerType._zod.run(n,i);if(n.value===void 0)return n.value=t.defaultValue,n;const r=t.innerType._zod.run(n,i);return r instanceof Promise?r.then(o=>E_(o,t)):E_(r,t)}});function E_(e,t){return e.value===void 0&&(e.value=t.defaultValue),e}const d1=Y("$ZodPrefault",(e,t)=>{Xe.init(e,t),e._zod.optin="optional",lt(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,i)=>(i.direction==="backward"||n.value===void 0&&(n.value=t.defaultValue),t.innerType._zod.run(n,i))}),f1=Y("$ZodNonOptional",(e,t)=>{Xe.init(e,t),lt(e._zod,"values",()=>{const n=t.innerType._zod.values;return n?new Set([...n].filter(i=>i!==void 0)):void 0}),e._zod.parse=(n,i)=>{const r=t.innerType._zod.run(n,i);return r instanceof Promise?r.then(o=>A_(o,e)):A_(r,e)}});function A_(e,t){return!e.issues.length&&e.value===void 0&&e.issues.push({code:"invalid_type",expected:"nonoptional",input:e.value,inst:t}),e}const p1=Y("$ZodSuccess",(e,t)=>{Xe.init(e,t),e._zod.parse=(n,i)=>{if(i.direction==="backward")throw new ap("ZodSuccess");const r=t.innerType._zod.run(n,i);return r instanceof Promise?r.then(o=>(n.value=o.issues.length===0,n)):(n.value=r.issues.length===0,n)}}),h1=Y("$ZodCatch",(e,t)=>{Xe.init(e,t),lt(e._zod,"optin",()=>t.innerType._zod.optin),lt(e._zod,"optout",()=>t.innerType._zod.optout),lt(e._zod,"values",()=>t.innerType._zod.values),e._zod.parse=(n,i)=>{if(i.direction==="backward")return t.innerType._zod.run(n,i);const r=t.innerType._zod.run(n,i);return r instanceof Promise?r.then(o=>(n.value=o.value,o.issues.length&&(n.value=t.catchValue({...n,error:{issues:o.issues.map(s=>ai(s,i,Gn()))},input:n.value}),n.issues=[]),n)):(n.value=r.value,r.issues.length&&(n.value=t.catchValue({...n,error:{issues:r.issues.map(o=>ai(o,i,Gn()))},input:n.value}),n.issues=[]),n)}}),m1=Y("$ZodNaN",(e,t)=>{Xe.init(e,t),e._zod.parse=(n,i)=>((typeof n.value!="number"||!Number.isNaN(n.value))&&n.issues.push({input:n.value,inst:e,expected:"nan",code:"invalid_type"}),n)}),g1=Y("$ZodPipe",(e,t)=>{Xe.init(e,t),lt(e._zod,"values",()=>t.in._zod.values),lt(e._zod,"optin",()=>t.in._zod.optin),lt(e._zod,"optout",()=>t.out._zod.optout),lt(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(n,i)=>{if(i.direction==="backward"){const o=t.out._zod.run(n,i);return o instanceof Promise?o.then(s=>yd(s,t.in,i)):yd(o,t.in,i)}const r=t.in._zod.run(n,i);return r instanceof Promise?r.then(o=>yd(o,t.out,i)):yd(r,t.out,i)}});function yd(e,t,n){return e.issues.length?(e.aborted=!0,e):t._zod.run({value:e.value,issues:e.issues},n)}const ww=Y("$ZodCodec",(e,t)=>{Xe.init(e,t),lt(e._zod,"values",()=>t.in._zod.values),lt(e._zod,"optin",()=>t.in._zod.optin),lt(e._zod,"optout",()=>t.out._zod.optout),lt(e._zod,"propValues",()=>t.in._zod.propValues),e._zod.parse=(n,i)=>{if((i.direction||"forward")==="forward"){const o=t.in._zod.run(n,i);return o instanceof Promise?o.then(s=>wd(s,t,i)):wd(o,t,i)}else{const o=t.out._zod.run(n,i);return o instanceof Promise?o.then(s=>wd(s,t,i)):wd(o,t,i)}}});function wd(e,t,n){if(e.issues.length)return e.aborted=!0,e;if((n.direction||"forward")==="forward"){const r=t.transform(e.value,e);return r instanceof Promise?r.then(o=>vd(e,o,t.out,n)):vd(e,r,t.out,n)}else{const r=t.reverseTransform(e.value,e);return r instanceof Promise?r.then(o=>vd(e,o,t.in,n)):vd(e,r,t.in,n)}}function vd(e,t,n,i){return e.issues.length?(e.aborted=!0,e):n._zod.run({value:t,issues:e.issues},i)}const y1=Y("$ZodReadonly",(e,t)=>{Xe.init(e,t),lt(e._zod,"propValues",()=>t.innerType._zod.propValues),lt(e._zod,"values",()=>t.innerType._zod.values),lt(e._zod,"optin",()=>t.innerType?._zod?.optin),lt(e._zod,"optout",()=>t.innerType?._zod?.optout),e._zod.parse=(n,i)=>{if(i.direction==="backward")return t.innerType._zod.run(n,i);const r=t.innerType._zod.run(n,i);return r instanceof Promise?r.then(T_):T_(r)}});function T_(e){return e.value=Object.freeze(e.value),e}const w1=Y("$ZodTemplateLiteral",(e,t)=>{Xe.init(e,t);const n=[];for(const i of t.parts)if(typeof i=="object"&&i!==null){if(!i._zod.pattern)throw new Error(`Invalid template literal part, no pattern found: ${[...i._zod.traits].shift()}`);const r=i._zod.pattern instanceof RegExp?i._zod.pattern.source:i._zod.pattern;if(!r)throw new Error(`Invalid template literal part: ${i._zod.traits}`);const o=r.startsWith("^")?1:0,s=r.endsWith("$")?r.length-1:r.length;n.push(r.slice(o,s))}else if(i===null||HE.has(typeof i))n.push(po(`${i}`));else throw new Error(`Invalid template literal part: ${i}`);e._zod.pattern=new RegExp(`^${n.join("")}$`),e._zod.parse=(i,r)=>typeof i.value!="string"?(i.issues.push({input:i.value,inst:e,expected:"string",code:"invalid_type"}),i):(e._zod.pattern.lastIndex=0,e._zod.pattern.test(i.value)||i.issues.push({input:i.value,inst:e,code:"invalid_format",format:t.format??"template_literal",pattern:e._zod.pattern.source}),i)}),v1=Y("$ZodFunction",(e,t)=>(Xe.init(e,t),e._def=t,e._zod.def=t,e.implement=n=>{if(typeof n!="function")throw new Error("implement() must be called with a function");return function(...i){const r=e._def.input?Mg(e._def.input,i):i,o=Reflect.apply(n,this,r);return e._def.output?Mg(e._def.output,o):o}},e.implementAsync=n=>{if(typeof n!="function")throw new Error("implementAsync() must be called with a function");return async function(...i){const r=e._def.input?await jg(e._def.input,i):i,o=await Reflect.apply(n,this,r);return e._def.output?await jg(e._def.output,o):o}},e._zod.parse=(n,i)=>typeof n.value!="function"?(n.issues.push({code:"invalid_type",expected:"function",input:n.value,inst:e}),n):(e._def.output&&e._def.output._zod.def.type==="promise"?n.value=e.implementAsync(n.value):n.value=e.implement(n.value),n),e.input=(...n)=>{const i=e.constructor;return Array.isArray(n[0])?new i({type:"function",input:new gw({type:"tuple",items:n[0],rest:n[1]}),output:e._def.output}):new i({type:"function",input:n[0],output:e._def.output})},e.output=n=>{const i=e.constructor;return new i({type:"function",input:e._def.input,output:n})},e)),b1=Y("$ZodPromise",(e,t)=>{Xe.init(e,t),e._zod.parse=(n,i)=>Promise.resolve(n.value).then(r=>t.innerType._zod.run({value:r,issues:[]},i))}),_1=Y("$ZodLazy",(e,t)=>{Xe.init(e,t),lt(e._zod,"innerType",()=>t.getter()),lt(e._zod,"pattern",()=>e._zod.innerType?._zod?.pattern),lt(e._zod,"propValues",()=>e._zod.innerType?._zod?.propValues),lt(e._zod,"optin",()=>e._zod.innerType?._zod?.optin??void 0),lt(e._zod,"optout",()=>e._zod.innerType?._zod?.optout??void 0),e._zod.parse=(n,i)=>e._zod.innerType._zod.run(n,i)}),S1=Y("$ZodCustom",(e,t)=>{pn.init(e,t),Xe.init(e,t),e._zod.parse=(n,i)=>n,e._zod.check=n=>{const i=n.value,r=t.fn(i);if(r instanceof Promise)return r.then(o=>I_(o,n,i,e));I_(r,n,i,e)}});function I_(e,t,n,i){if(!e){const r={code:"custom",input:n,inst:i,path:[...i._zod.def.path??[]],continue:!i._zod.def.abort};i._zod.def.params&&(r.params=i._zod.def.params),t.issues.push(Ma(r))}}const qj=()=>{const e={string:{unit:"",verb:" "},file:{unit:"",verb:" "},array:{unit:"",verb:" "},set:{unit:"",verb:" "}};function t(r){return e[r]??null}const n={regex:"",email:" ",url:"",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"   ISO",date:"  ISO",time:"  ISO",duration:"  ISO",ipv4:" IPv4",ipv6:" IPv6",cidrv4:"   IPv4",cidrv6:"   IPv6",base64:"  base64-encoded",base64url:"  base64url-encoded",json_string:"   JSON",e164:"   E.164",jwt:"JWT",template_literal:""},i={nan:"NaN"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`  :   instanceof ${r.expected}    ${a}`:`  :   ${o}    ${a}`}case"invalid_value":return r.values.length===1?`  :   ${Ve(r.values[0])}`:`  :     : ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?`   :    ${r.origin??""} ${o} ${r.maximum.toString()} ${s.unit??""}`:`  :    ${r.origin??""} ${o} ${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?`  :   ${r.origin}   ${o} ${r.minimum.toString()} ${s.unit}`:`  :   ${r.origin}   ${o} ${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?`  :     "${r.prefix}"`:o.format==="ends_with"?`  :     "${o.suffix}"`:o.format==="includes"?`  :    "${o.includes}"`:o.format==="regex"?`  :     ${o.pattern}`:`${n[o.format]??r.format}  `}case"not_multiple_of":return`  :      ${r.divisor}`;case"unrecognized_keys":return`${r.keys.length>1?"":""} ${r.keys.length>1?"":""}: ${ye(r.keys," ")}`;case"invalid_key":return`    ${r.origin}`;case"invalid_union":return"  ";case"invalid_element":return`    ${r.origin}`;default:return"  "}}};function Hj(){return{localeError:qj()}}const Kj=()=>{const e={string:{unit:"simvol",verb:"olmaldr"},file:{unit:"bayt",verb:"olmaldr"},array:{unit:"element",verb:"olmaldr"},set:{unit:"element",verb:"olmaldr"}};function t(r){return e[r]??null}const n={regex:"input",email:"email address",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datetime",date:"ISO date",time:"ISO time",duration:"ISO duration",ipv4:"IPv4 address",ipv6:"IPv6 address",cidrv4:"IPv4 range",cidrv6:"IPv6 range",base64:"base64-encoded string",base64url:"base64url-encoded string",json_string:"JSON string",e164:"E.164 number",jwt:"JWT",template_literal:"input"},i={nan:"NaN"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`Yanl dyr: gzlniln instanceof ${r.expected}, daxil olan ${a}`:`Yanl dyr: gzlniln ${o}, daxil olan ${a}`}case"invalid_value":return r.values.length===1?`Yanl dyr: gzlniln ${Ve(r.values[0])}`:`Yanl seim: aadaklardan biri olmaldr: ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?`ox byk: gzlniln ${r.origin??"dyr"} ${o}${r.maximum.toString()} ${s.unit??"element"}`:`ox byk: gzlniln ${r.origin??"dyr"} ${o}${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?`ox kiik: gzlniln ${r.origin} ${o}${r.minimum.toString()} ${s.unit}`:`ox kiik: gzlniln ${r.origin} ${o}${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?`Yanl mtn: "${o.prefix}" il balamaldr`:o.format==="ends_with"?`Yanl mtn: "${o.suffix}" il bitmlidir`:o.format==="includes"?`Yanl mtn: "${o.includes}" daxil olmaldr`:o.format==="regex"?`Yanl mtn: ${o.pattern} ablonuna uyun olmaldr`:`Yanl ${n[o.format]??r.format}`}case"not_multiple_of":return`Yanl dd: ${r.divisor} il bln biln olmaldr`;case"unrecognized_keys":return`Tannmayan aar${r.keys.length>1?"lar":""}: ${ye(r.keys,", ")}`;case"invalid_key":return`${r.origin} daxilind yanl aar`;case"invalid_union":return"Yanl dyr";case"invalid_element":return`${r.origin} daxilind yanl dyr`;default:return"Yanl dyr"}}};function Jj(){return{localeError:Kj()}}function N_(e,t,n,i){const r=Math.abs(e),o=r%10,s=r%100;return s>=11&&s<=19?i:o===1?t:o>=2&&o<=4?n:i}const Gj=()=>{const e={string:{unit:{one:"",few:"",many:""},verb:""},array:{unit:{one:"",few:"",many:""},verb:""},set:{unit:{one:"",few:"",many:""},verb:""},file:{unit:{one:"",few:"",many:""},verb:""}};function t(r){return e[r]??null}const n={regex:"",email:"email ",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO   ",date:"ISO ",time:"ISO ",duration:"ISO ",ipv4:"IPv4 ",ipv6:"IPv6 ",cidrv4:"IPv4 ",cidrv6:"IPv6 ",base64:"   base64",base64url:"   base64url",json_string:"JSON ",e164:" E.164",jwt:"JWT",template_literal:""},i={nan:"NaN",number:"",array:""};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?` :  instanceof ${r.expected},  ${a}`:` :  ${o},  ${a}`}case"invalid_value":return r.values.length===1?` :  ${Ve(r.values[0])}`:` :    ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);if(s){const a=Number(r.maximum),c=N_(a,s.unit.one,s.unit.few,s.unit.many);return` : ,  ${r.origin??""}  ${s.verb} ${o}${r.maximum.toString()} ${c}`}return` : ,  ${r.origin??""}   ${o}${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);if(s){const a=Number(r.minimum),c=N_(a,s.unit.one,s.unit.few,s.unit.many);return` : ,  ${r.origin}  ${s.verb} ${o}${r.minimum.toString()} ${c}`}return` : ,  ${r.origin}   ${o}${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?` :    "${o.prefix}"`:o.format==="ends_with"?` :    "${o.suffix}"`:o.format==="includes"?` :   "${o.includes}"`:o.format==="regex"?` :    ${o.pattern}`:` ${n[o.format]??r.format}`}case"not_multiple_of":return` :    ${r.divisor}`;case"unrecognized_keys":return` ${r.keys.length>1?"":""}: ${ye(r.keys,", ")}`;case"invalid_key":return`   ${r.origin}`;case"invalid_union":return" ";case"invalid_element":return`   ${r.origin}`;default:return" "}}};function Zj(){return{localeError:Gj()}}const Qj=()=>{const e={string:{unit:"",verb:" "},file:{unit:"",verb:" "},array:{unit:"",verb:" "},set:{unit:"",verb:" "}};function t(r){return e[r]??null}const n={regex:"",email:" ",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO ",date:"ISO ",time:"ISO ",duration:"ISO ",ipv4:"IPv4 ",ipv6:"IPv6 ",cidrv4:"IPv4 ",cidrv6:"IPv6 ",base64:"base64- ",base64url:"base64url- ",json_string:"JSON ",e164:"E.164 ",jwt:"JWT",template_literal:""},i={nan:"NaN",number:"",array:""};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?` :  instanceof ${r.expected},  ${a}`:` :  ${o},  ${a}`}case"invalid_value":return r.values.length===1?` :  ${Ve(r.values[0])}`:` :    ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?` :   ${r.origin??""}   ${o}${r.maximum.toString()} ${s.unit??""}`:` :   ${r.origin??""}   ${o}${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?` :   ${r.origin}   ${o}${r.minimum.toString()} ${s.unit}`:` :   ${r.origin}   ${o}${r.minimum.toString()}`}case"invalid_format":{const o=r;if(o.format==="starts_with")return` :     "${o.prefix}"`;if(o.format==="ends_with")return` :     "${o.suffix}"`;if(o.format==="includes")return` :    "${o.includes}"`;if(o.format==="regex")return` :     ${o.pattern}`;let s="";return o.format==="emoji"&&(s=""),o.format==="datetime"&&(s=""),o.format==="date"&&(s=""),o.format==="time"&&(s=""),o.format==="duration"&&(s=""),`${s} ${n[o.format]??r.format}`}case"not_multiple_of":return` :      ${r.divisor}`;case"unrecognized_keys":return`${r.keys.length>1?"":""} ${r.keys.length>1?"":""}: ${ye(r.keys,", ")}`;case"invalid_key":return`   ${r.origin}`;case"invalid_union":return" ";case"invalid_element":return`   ${r.origin}`;default:return" "}}};function Yj(){return{localeError:Qj()}}const Xj=()=>{const e={string:{unit:"carcters",verb:"contenir"},file:{unit:"bytes",verb:"contenir"},array:{unit:"elements",verb:"contenir"},set:{unit:"elements",verb:"contenir"}};function t(r){return e[r]??null}const n={regex:"entrada",email:"adrea electrnica",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"data i hora ISO",date:"data ISO",time:"hora ISO",duration:"durada ISO",ipv4:"adrea IPv4",ipv6:"adrea IPv6",cidrv4:"rang IPv4",cidrv6:"rang IPv6",base64:"cadena codificada en base64",base64url:"cadena codificada en base64url",json_string:"cadena JSON",e164:"nmero E.164",jwt:"JWT",template_literal:"entrada"},i={nan:"NaN"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`Tipus invlid: s'esperava instanceof ${r.expected}, s'ha rebut ${a}`:`Tipus invlid: s'esperava ${o}, s'ha rebut ${a}`}case"invalid_value":return r.values.length===1?`Valor invlid: s'esperava ${Ve(r.values[0])}`:`Opci invlida: s'esperava una de ${ye(r.values," o ")}`;case"too_big":{const o=r.inclusive?"com a mxim":"menys de",s=t(r.origin);return s?`Massa gran: s'esperava que ${r.origin??"el valor"} contingus ${o} ${r.maximum.toString()} ${s.unit??"elements"}`:`Massa gran: s'esperava que ${r.origin??"el valor"} fos ${o} ${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?"com a mnim":"ms de",s=t(r.origin);return s?`Massa petit: s'esperava que ${r.origin} contingus ${o} ${r.minimum.toString()} ${s.unit}`:`Massa petit: s'esperava que ${r.origin} fos ${o} ${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?`Format invlid: ha de comenar amb "${o.prefix}"`:o.format==="ends_with"?`Format invlid: ha d'acabar amb "${o.suffix}"`:o.format==="includes"?`Format invlid: ha d'incloure "${o.includes}"`:o.format==="regex"?`Format invlid: ha de coincidir amb el patr ${o.pattern}`:`Format invlid per a ${n[o.format]??r.format}`}case"not_multiple_of":return`Nmero invlid: ha de ser mltiple de ${r.divisor}`;case"unrecognized_keys":return`Clau${r.keys.length>1?"s":""} no reconeguda${r.keys.length>1?"s":""}: ${ye(r.keys,", ")}`;case"invalid_key":return`Clau invlida a ${r.origin}`;case"invalid_union":return"Entrada invlida";case"invalid_element":return`Element invlid a ${r.origin}`;default:return"Entrada invlida"}}};function e4(){return{localeError:Xj()}}const t4=()=>{const e={string:{unit:"znak",verb:"mt"},file:{unit:"bajt",verb:"mt"},array:{unit:"prvk",verb:"mt"},set:{unit:"prvk",verb:"mt"}};function t(r){return e[r]??null}const n={regex:"regulrn vraz",email:"e-mailov adresa",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"datum a as ve formtu ISO",date:"datum ve formtu ISO",time:"as ve formtu ISO",duration:"doba trvn ISO",ipv4:"IPv4 adresa",ipv6:"IPv6 adresa",cidrv4:"rozsah IPv4",cidrv6:"rozsah IPv6",base64:"etzec zakdovan ve formtu base64",base64url:"etzec zakdovan ve formtu base64url",json_string:"etzec ve formtu JSON",e164:"slo E.164",jwt:"JWT",template_literal:"vstup"},i={nan:"NaN",number:"slo",string:"etzec",function:"funkce",array:"pole"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`Neplatn vstup: oekvno instanceof ${r.expected}, obdreno ${a}`:`Neplatn vstup: oekvno ${o}, obdreno ${a}`}case"invalid_value":return r.values.length===1?`Neplatn vstup: oekvno ${Ve(r.values[0])}`:`Neplatn monost: oekvna jedna z hodnot ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?`Hodnota je pli velk: ${r.origin??"hodnota"} mus mt ${o}${r.maximum.toString()} ${s.unit??"prvk"}`:`Hodnota je pli velk: ${r.origin??"hodnota"} mus bt ${o}${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?`Hodnota je pli mal: ${r.origin??"hodnota"} mus mt ${o}${r.minimum.toString()} ${s.unit??"prvk"}`:`Hodnota je pli mal: ${r.origin??"hodnota"} mus bt ${o}${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?`Neplatn etzec: mus zanat na "${o.prefix}"`:o.format==="ends_with"?`Neplatn etzec: mus konit na "${o.suffix}"`:o.format==="includes"?`Neplatn etzec: mus obsahovat "${o.includes}"`:o.format==="regex"?`Neplatn etzec: mus odpovdat vzoru ${o.pattern}`:`Neplatn formt ${n[o.format]??r.format}`}case"not_multiple_of":return`Neplatn slo: mus bt nsobkem ${r.divisor}`;case"unrecognized_keys":return`Neznm kle: ${ye(r.keys,", ")}`;case"invalid_key":return`Neplatn kl v ${r.origin}`;case"invalid_union":return"Neplatn vstup";case"invalid_element":return`Neplatn hodnota v ${r.origin}`;default:return"Neplatn vstup"}}};function n4(){return{localeError:t4()}}const r4=()=>{const e={string:{unit:"tegn",verb:"havde"},file:{unit:"bytes",verb:"havde"},array:{unit:"elementer",verb:"indeholdt"},set:{unit:"elementer",verb:"indeholdt"}};function t(r){return e[r]??null}const n={regex:"input",email:"e-mailadresse",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO dato- og klokkeslt",date:"ISO-dato",time:"ISO-klokkeslt",duration:"ISO-varighed",ipv4:"IPv4-omrde",ipv6:"IPv6-omrde",cidrv4:"IPv4-spektrum",cidrv6:"IPv6-spektrum",base64:"base64-kodet streng",base64url:"base64url-kodet streng",json_string:"JSON-streng",e164:"E.164-nummer",jwt:"JWT",template_literal:"input"},i={nan:"NaN",string:"streng",number:"tal",boolean:"boolean",array:"liste",object:"objekt",set:"st",file:"fil"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`Ugyldigt input: forventede instanceof ${r.expected}, fik ${a}`:`Ugyldigt input: forventede ${o}, fik ${a}`}case"invalid_value":return r.values.length===1?`Ugyldig vrdi: forventede ${Ve(r.values[0])}`:`Ugyldigt valg: forventede en af flgende ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin),a=i[r.origin]??r.origin;return s?`For stor: forventede ${a??"value"} ${s.verb} ${o} ${r.maximum.toString()} ${s.unit??"elementer"}`:`For stor: forventede ${a??"value"} havde ${o} ${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin),a=i[r.origin]??r.origin;return s?`For lille: forventede ${a} ${s.verb} ${o} ${r.minimum.toString()} ${s.unit}`:`For lille: forventede ${a} havde ${o} ${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?`Ugyldig streng: skal starte med "${o.prefix}"`:o.format==="ends_with"?`Ugyldig streng: skal ende med "${o.suffix}"`:o.format==="includes"?`Ugyldig streng: skal indeholde "${o.includes}"`:o.format==="regex"?`Ugyldig streng: skal matche mnsteret ${o.pattern}`:`Ugyldig ${n[o.format]??r.format}`}case"not_multiple_of":return`Ugyldigt tal: skal vre deleligt med ${r.divisor}`;case"unrecognized_keys":return`${r.keys.length>1?"Ukendte ngler":"Ukendt ngle"}: ${ye(r.keys,", ")}`;case"invalid_key":return`Ugyldig ngle i ${r.origin}`;case"invalid_union":return"Ugyldigt input: matcher ingen af de tilladte typer";case"invalid_element":return`Ugyldig vrdi i ${r.origin}`;default:return"Ugyldigt input"}}};function i4(){return{localeError:r4()}}const o4=()=>{const e={string:{unit:"Zeichen",verb:"zu haben"},file:{unit:"Bytes",verb:"zu haben"},array:{unit:"Elemente",verb:"zu haben"},set:{unit:"Elemente",verb:"zu haben"}};function t(r){return e[r]??null}const n={regex:"Eingabe",email:"E-Mail-Adresse",url:"URL",emoji:"Emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO-Datum und -Uhrzeit",date:"ISO-Datum",time:"ISO-Uhrzeit",duration:"ISO-Dauer",ipv4:"IPv4-Adresse",ipv6:"IPv6-Adresse",cidrv4:"IPv4-Bereich",cidrv6:"IPv6-Bereich",base64:"Base64-codierter String",base64url:"Base64-URL-codierter String",json_string:"JSON-String",e164:"E.164-Nummer",jwt:"JWT",template_literal:"Eingabe"},i={nan:"NaN",number:"Zahl",array:"Array"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`Ungltige Eingabe: erwartet instanceof ${r.expected}, erhalten ${a}`:`Ungltige Eingabe: erwartet ${o}, erhalten ${a}`}case"invalid_value":return r.values.length===1?`Ungltige Eingabe: erwartet ${Ve(r.values[0])}`:`Ungltige Option: erwartet eine von ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?`Zu gro: erwartet, dass ${r.origin??"Wert"} ${o}${r.maximum.toString()} ${s.unit??"Elemente"} hat`:`Zu gro: erwartet, dass ${r.origin??"Wert"} ${o}${r.maximum.toString()} ist`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?`Zu klein: erwartet, dass ${r.origin} ${o}${r.minimum.toString()} ${s.unit} hat`:`Zu klein: erwartet, dass ${r.origin} ${o}${r.minimum.toString()} ist`}case"invalid_format":{const o=r;return o.format==="starts_with"?`Ungltiger String: muss mit "${o.prefix}" beginnen`:o.format==="ends_with"?`Ungltiger String: muss mit "${o.suffix}" enden`:o.format==="includes"?`Ungltiger String: muss "${o.includes}" enthalten`:o.format==="regex"?`Ungltiger String: muss dem Muster ${o.pattern} entsprechen`:`Ungltig: ${n[o.format]??r.format}`}case"not_multiple_of":return`Ungltige Zahl: muss ein Vielfaches von ${r.divisor} sein`;case"unrecognized_keys":return`${r.keys.length>1?"Unbekannte Schlssel":"Unbekannter Schlssel"}: ${ye(r.keys,", ")}`;case"invalid_key":return`Ungltiger Schlssel in ${r.origin}`;case"invalid_union":return"Ungltige Eingabe";case"invalid_element":return`Ungltiger Wert in ${r.origin}`;default:return"Ungltige Eingabe"}}};function s4(){return{localeError:o4()}}const a4=()=>{const e={string:{unit:"characters",verb:"to have"},file:{unit:"bytes",verb:"to have"},array:{unit:"items",verb:"to have"},set:{unit:"items",verb:"to have"},map:{unit:"entries",verb:"to have"}};function t(r){return e[r]??null}const n={regex:"input",email:"email address",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datetime",date:"ISO date",time:"ISO time",duration:"ISO duration",ipv4:"IPv4 address",ipv6:"IPv6 address",mac:"MAC address",cidrv4:"IPv4 range",cidrv6:"IPv6 range",base64:"base64-encoded string",base64url:"base64url-encoded string",json_string:"JSON string",e164:"E.164 number",jwt:"JWT",template_literal:"input"},i={nan:"NaN"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return`Invalid input: expected ${o}, received ${a}`}case"invalid_value":return r.values.length===1?`Invalid input: expected ${Ve(r.values[0])}`:`Invalid option: expected one of ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?`Too big: expected ${r.origin??"value"} to have ${o}${r.maximum.toString()} ${s.unit??"elements"}`:`Too big: expected ${r.origin??"value"} to be ${o}${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?`Too small: expected ${r.origin} to have ${o}${r.minimum.toString()} ${s.unit}`:`Too small: expected ${r.origin} to be ${o}${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?`Invalid string: must start with "${o.prefix}"`:o.format==="ends_with"?`Invalid string: must end with "${o.suffix}"`:o.format==="includes"?`Invalid string: must include "${o.includes}"`:o.format==="regex"?`Invalid string: must match pattern ${o.pattern}`:`Invalid ${n[o.format]??r.format}`}case"not_multiple_of":return`Invalid number: must be a multiple of ${r.divisor}`;case"unrecognized_keys":return`Unrecognized key${r.keys.length>1?"s":""}: ${ye(r.keys,", ")}`;case"invalid_key":return`Invalid key in ${r.origin}`;case"invalid_union":return"Invalid input";case"invalid_element":return`Invalid value in ${r.origin}`;default:return"Invalid input"}}};function x1(){return{localeError:a4()}}const c4=()=>{const e={string:{unit:"karaktrojn",verb:"havi"},file:{unit:"bajtojn",verb:"havi"},array:{unit:"elementojn",verb:"havi"},set:{unit:"elementojn",verb:"havi"}};function t(r){return e[r]??null}const n={regex:"enigo",email:"retadreso",url:"URL",emoji:"emoio",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO-datotempo",date:"ISO-dato",time:"ISO-tempo",duration:"ISO-daro",ipv4:"IPv4-adreso",ipv6:"IPv6-adreso",cidrv4:"IPv4-rango",cidrv6:"IPv6-rango",base64:"64-ume kodita karaktraro",base64url:"URL-64-ume kodita karaktraro",json_string:"JSON-karaktraro",e164:"E.164-nombro",jwt:"JWT",template_literal:"enigo"},i={nan:"NaN",number:"nombro",array:"tabelo",null:"senvalora"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`Nevalida enigo: atendiis instanceof ${r.expected}, riceviis ${a}`:`Nevalida enigo: atendiis ${o}, riceviis ${a}`}case"invalid_value":return r.values.length===1?`Nevalida enigo: atendiis ${Ve(r.values[0])}`:`Nevalida opcio: atendiis unu el ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?`Tro granda: atendiis ke ${r.origin??"valoro"} havu ${o}${r.maximum.toString()} ${s.unit??"elementojn"}`:`Tro granda: atendiis ke ${r.origin??"valoro"} havu ${o}${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?`Tro malgranda: atendiis ke ${r.origin} havu ${o}${r.minimum.toString()} ${s.unit}`:`Tro malgranda: atendiis ke ${r.origin} estu ${o}${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?`Nevalida karaktraro: devas komencii per "${o.prefix}"`:o.format==="ends_with"?`Nevalida karaktraro: devas finii per "${o.suffix}"`:o.format==="includes"?`Nevalida karaktraro: devas inkluzivi "${o.includes}"`:o.format==="regex"?`Nevalida karaktraro: devas kongrui kun la modelo ${o.pattern}`:`Nevalida ${n[o.format]??r.format}`}case"not_multiple_of":return`Nevalida nombro: devas esti oblo de ${r.divisor}`;case"unrecognized_keys":return`Nekonata${r.keys.length>1?"j":""} losilo${r.keys.length>1?"j":""}: ${ye(r.keys,", ")}`;case"invalid_key":return`Nevalida losilo en ${r.origin}`;case"invalid_union":return"Nevalida enigo";case"invalid_element":return`Nevalida valoro en ${r.origin}`;default:return"Nevalida enigo"}}};function l4(){return{localeError:c4()}}const u4=()=>{const e={string:{unit:"caracteres",verb:"tener"},file:{unit:"bytes",verb:"tener"},array:{unit:"elementos",verb:"tener"},set:{unit:"elementos",verb:"tener"}};function t(r){return e[r]??null}const n={regex:"entrada",email:"direccin de correo electrnico",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"fecha y hora ISO",date:"fecha ISO",time:"hora ISO",duration:"duracin ISO",ipv4:"direccin IPv4",ipv6:"direccin IPv6",cidrv4:"rango IPv4",cidrv6:"rango IPv6",base64:"cadena codificada en base64",base64url:"URL codificada en base64",json_string:"cadena JSON",e164:"nmero E.164",jwt:"JWT",template_literal:"entrada"},i={nan:"NaN",string:"texto",number:"nmero",boolean:"booleano",array:"arreglo",object:"objeto",set:"conjunto",file:"archivo",date:"fecha",bigint:"nmero grande",symbol:"smbolo",undefined:"indefinido",null:"nulo",function:"funcin",map:"mapa",record:"registro",tuple:"tupla",enum:"enumeracin",union:"unin",literal:"literal",promise:"promesa",void:"vaco",never:"nunca",unknown:"desconocido",any:"cualquiera"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`Entrada invlida: se esperaba instanceof ${r.expected}, recibido ${a}`:`Entrada invlida: se esperaba ${o}, recibido ${a}`}case"invalid_value":return r.values.length===1?`Entrada invlida: se esperaba ${Ve(r.values[0])}`:`Opcin invlida: se esperaba una de ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin),a=i[r.origin]??r.origin;return s?`Demasiado grande: se esperaba que ${a??"valor"} tuviera ${o}${r.maximum.toString()} ${s.unit??"elementos"}`:`Demasiado grande: se esperaba que ${a??"valor"} fuera ${o}${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin),a=i[r.origin]??r.origin;return s?`Demasiado pequeo: se esperaba que ${a} tuviera ${o}${r.minimum.toString()} ${s.unit}`:`Demasiado pequeo: se esperaba que ${a} fuera ${o}${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?`Cadena invlida: debe comenzar con "${o.prefix}"`:o.format==="ends_with"?`Cadena invlida: debe terminar en "${o.suffix}"`:o.format==="includes"?`Cadena invlida: debe incluir "${o.includes}"`:o.format==="regex"?`Cadena invlida: debe coincidir con el patrn ${o.pattern}`:`Invlido ${n[o.format]??r.format}`}case"not_multiple_of":return`Nmero invlido: debe ser mltiplo de ${r.divisor}`;case"unrecognized_keys":return`Llave${r.keys.length>1?"s":""} desconocida${r.keys.length>1?"s":""}: ${ye(r.keys,", ")}`;case"invalid_key":return`Llave invlida en ${i[r.origin]??r.origin}`;case"invalid_union":return"Entrada invlida";case"invalid_element":return`Valor invlido en ${i[r.origin]??r.origin}`;default:return"Entrada invlida"}}};function d4(){return{localeError:u4()}}const f4=()=>{const e={string:{unit:"",verb:" "},file:{unit:"",verb:" "},array:{unit:"",verb:" "},set:{unit:"",verb:" "}};function t(r){return e[r]??null}const n={regex:"",email:" ",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"   ",date:" ",time:" ",duration:"  ",ipv4:"IPv4 ",ipv6:"IPv6 ",cidrv4:"IPv4 ",cidrv6:"IPv6 ",base64:"base64-encoded ",base64url:"base64url-encoded ",json_string:"JSON ",e164:"E.164 ",jwt:"JWT",template_literal:""},i={nan:"NaN",number:"",array:""};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?` :  instanceof ${r.expected}  ${a}  `:` :  ${o}  ${a}  `}case"invalid_value":return r.values.length===1?` :  ${Ve(r.values[0])} `:` :    ${ye(r.values,"|")} `;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?` : ${r.origin??""}  ${o}${r.maximum.toString()} ${s.unit??""} `:` : ${r.origin??""}  ${o}${r.maximum.toString()} `}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?` : ${r.origin}  ${o}${r.minimum.toString()} ${s.unit} `:` : ${r.origin}  ${o}${r.minimum.toString()} `}case"invalid_format":{const o=r;return o.format==="starts_with"?` :   "${o.prefix}"  `:o.format==="ends_with"?` :   "${o.suffix}"  `:o.format==="includes"?` :   "${o.includes}" `:o.format==="regex"?` :    ${o.pattern}   `:`${n[o.format]??r.format} `}case"not_multiple_of":return` :   ${r.divisor} `;case"unrecognized_keys":return`${r.keys.length>1?"":""} : ${ye(r.keys,", ")}`;case"invalid_key":return`   ${r.origin}`;case"invalid_union":return" ";case"invalid_element":return`   ${r.origin}`;default:return" "}}};function p4(){return{localeError:f4()}}const h4=()=>{const e={string:{unit:"merkki",subject:"merkkijonon"},file:{unit:"tavua",subject:"tiedoston"},array:{unit:"alkiota",subject:"listan"},set:{unit:"alkiota",subject:"joukon"},number:{unit:"",subject:"luvun"},bigint:{unit:"",subject:"suuren kokonaisluvun"},int:{unit:"",subject:"kokonaisluvun"},date:{unit:"",subject:"pivmrn"}};function t(r){return e[r]??null}const n={regex:"snnllinen lauseke",email:"shkpostiosoite",url:"URL-osoite",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO-aikaleima",date:"ISO-pivmr",time:"ISO-aika",duration:"ISO-kesto",ipv4:"IPv4-osoite",ipv6:"IPv6-osoite",cidrv4:"IPv4-alue",cidrv6:"IPv6-alue",base64:"base64-koodattu merkkijono",base64url:"base64url-koodattu merkkijono",json_string:"JSON-merkkijono",e164:"E.164-luku",jwt:"JWT",template_literal:"templaattimerkkijono"},i={nan:"NaN"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`Virheellinen tyyppi: odotettiin instanceof ${r.expected}, oli ${a}`:`Virheellinen tyyppi: odotettiin ${o}, oli ${a}`}case"invalid_value":return r.values.length===1?`Virheellinen syte: tytyy olla ${Ve(r.values[0])}`:`Virheellinen valinta: tytyy olla yksi seuraavista: ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?`Liian suuri: ${s.subject} tytyy olla ${o}${r.maximum.toString()} ${s.unit}`.trim():`Liian suuri: arvon tytyy olla ${o}${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?`Liian pieni: ${s.subject} tytyy olla ${o}${r.minimum.toString()} ${s.unit}`.trim():`Liian pieni: arvon tytyy olla ${o}${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?`Virheellinen syte: tytyy alkaa "${o.prefix}"`:o.format==="ends_with"?`Virheellinen syte: tytyy loppua "${o.suffix}"`:o.format==="includes"?`Virheellinen syte: tytyy sislt "${o.includes}"`:o.format==="regex"?`Virheellinen syte: tytyy vastata snnllist lauseketta ${o.pattern}`:`Virheellinen ${n[o.format]??r.format}`}case"not_multiple_of":return`Virheellinen luku: tytyy olla luvun ${r.divisor} monikerta`;case"unrecognized_keys":return`${r.keys.length>1?"Tuntemattomat avaimet":"Tuntematon avain"}: ${ye(r.keys,", ")}`;case"invalid_key":return"Virheellinen avain tietueessa";case"invalid_union":return"Virheellinen unioni";case"invalid_element":return"Virheellinen arvo joukossa";default:return"Virheellinen syte"}}};function m4(){return{localeError:h4()}}const g4=()=>{const e={string:{unit:"caractres",verb:"avoir"},file:{unit:"octets",verb:"avoir"},array:{unit:"lments",verb:"avoir"},set:{unit:"lments",verb:"avoir"}};function t(r){return e[r]??null}const n={regex:"entre",email:"adresse e-mail",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"date et heure ISO",date:"date ISO",time:"heure ISO",duration:"dure ISO",ipv4:"adresse IPv4",ipv6:"adresse IPv6",cidrv4:"plage IPv4",cidrv6:"plage IPv6",base64:"chane encode en base64",base64url:"chane encode en base64url",json_string:"chane JSON",e164:"numro E.164",jwt:"JWT",template_literal:"entre"},i={nan:"NaN",number:"nombre",array:"tableau"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`Entre invalide : instanceof ${r.expected} attendu, ${a} reu`:`Entre invalide : ${o} attendu, ${a} reu`}case"invalid_value":return r.values.length===1?`Entre invalide : ${Ve(r.values[0])} attendu`:`Option invalide : une valeur parmi ${ye(r.values,"|")} attendue`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?`Trop grand : ${r.origin??"valeur"} doit ${s.verb} ${o}${r.maximum.toString()} ${s.unit??"lment(s)"}`:`Trop grand : ${r.origin??"valeur"} doit tre ${o}${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?`Trop petit : ${r.origin} doit ${s.verb} ${o}${r.minimum.toString()} ${s.unit}`:`Trop petit : ${r.origin} doit tre ${o}${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?`Chane invalide : doit commencer par "${o.prefix}"`:o.format==="ends_with"?`Chane invalide : doit se terminer par "${o.suffix}"`:o.format==="includes"?`Chane invalide : doit inclure "${o.includes}"`:o.format==="regex"?`Chane invalide : doit correspondre au modle ${o.pattern}`:`${n[o.format]??r.format} invalide`}case"not_multiple_of":return`Nombre invalide : doit tre un multiple de ${r.divisor}`;case"unrecognized_keys":return`Cl${r.keys.length>1?"s":""} non reconnue${r.keys.length>1?"s":""} : ${ye(r.keys,", ")}`;case"invalid_key":return`Cl invalide dans ${r.origin}`;case"invalid_union":return"Entre invalide";case"invalid_element":return`Valeur invalide dans ${r.origin}`;default:return"Entre invalide"}}};function y4(){return{localeError:g4()}}const w4=()=>{const e={string:{unit:"caractres",verb:"avoir"},file:{unit:"octets",verb:"avoir"},array:{unit:"lments",verb:"avoir"},set:{unit:"lments",verb:"avoir"}};function t(r){return e[r]??null}const n={regex:"entre",email:"adresse courriel",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"date-heure ISO",date:"date ISO",time:"heure ISO",duration:"dure ISO",ipv4:"adresse IPv4",ipv6:"adresse IPv6",cidrv4:"plage IPv4",cidrv6:"plage IPv6",base64:"chane encode en base64",base64url:"chane encode en base64url",json_string:"chane JSON",e164:"numro E.164",jwt:"JWT",template_literal:"entre"},i={nan:"NaN"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`Entre invalide : attendu instanceof ${r.expected}, reu ${a}`:`Entre invalide : attendu ${o}, reu ${a}`}case"invalid_value":return r.values.length===1?`Entre invalide : attendu ${Ve(r.values[0])}`:`Option invalide : attendu l'une des valeurs suivantes ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"":"<",s=t(r.origin);return s?`Trop grand : attendu que ${r.origin??"la valeur"} ait ${o}${r.maximum.toString()} ${s.unit}`:`Trop grand : attendu que ${r.origin??"la valeur"} soit ${o}${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?"":">",s=t(r.origin);return s?`Trop petit : attendu que ${r.origin} ait ${o}${r.minimum.toString()} ${s.unit}`:`Trop petit : attendu que ${r.origin} soit ${o}${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?`Chane invalide : doit commencer par "${o.prefix}"`:o.format==="ends_with"?`Chane invalide : doit se terminer par "${o.suffix}"`:o.format==="includes"?`Chane invalide : doit inclure "${o.includes}"`:o.format==="regex"?`Chane invalide : doit correspondre au motif ${o.pattern}`:`${n[o.format]??r.format} invalide`}case"not_multiple_of":return`Nombre invalide : doit tre un multiple de ${r.divisor}`;case"unrecognized_keys":return`Cl${r.keys.length>1?"s":""} non reconnue${r.keys.length>1?"s":""} : ${ye(r.keys,", ")}`;case"invalid_key":return`Cl invalide dans ${r.origin}`;case"invalid_union":return"Entre invalide";case"invalid_element":return`Valeur invalide dans ${r.origin}`;default:return"Entre invalide"}}};function v4(){return{localeError:w4()}}const b4=()=>{const e={string:{label:"",gender:"f"},number:{label:"",gender:"m"},boolean:{label:" ",gender:"m"},bigint:{label:"BigInt",gender:"m"},date:{label:"",gender:"m"},array:{label:"",gender:"m"},object:{label:"",gender:"m"},null:{label:"  (null)",gender:"m"},undefined:{label:"   (undefined)",gender:"m"},symbol:{label:" (Symbol)",gender:"m"},function:{label:"",gender:"f"},map:{label:" (Map)",gender:"f"},set:{label:" (Set)",gender:"f"},file:{label:"",gender:"m"},promise:{label:"Promise",gender:"m"},NaN:{label:"NaN",gender:"m"},unknown:{label:"  ",gender:"m"},value:{label:"",gender:"m"}},t={string:{unit:"",shortLabel:"",longLabel:""},file:{unit:"",shortLabel:"",longLabel:""},array:{unit:"",shortLabel:"",longLabel:""},set:{unit:"",shortLabel:"",longLabel:""},number:{unit:"",shortLabel:"",longLabel:""}},n=l=>l?e[l]:void 0,i=l=>{const u=n(l);return u?u.label:l??e.unknown.label},r=l=>`${i(l)}`,o=l=>(n(l)?.gender??"m")==="f"?" ":" ",s=l=>l?t[l]??null:null,a={regex:{label:"",gender:"m"},email:{label:" ",gender:"f"},url:{label:" ",gender:"f"},emoji:{label:"'",gender:"m"},uuid:{label:"UUID",gender:"m"},nanoid:{label:"nanoid",gender:"m"},guid:{label:"GUID",gender:"m"},cuid:{label:"cuid",gender:"m"},cuid2:{label:"cuid2",gender:"m"},ulid:{label:"ULID",gender:"m"},xid:{label:"XID",gender:"m"},ksuid:{label:"KSUID",gender:"m"},datetime:{label:"  ISO",gender:"m"},date:{label:" ISO",gender:"m"},time:{label:" ISO",gender:"m"},duration:{label:"  ISO",gender:"m"},ipv4:{label:" IPv4",gender:"f"},ipv6:{label:" IPv6",gender:"f"},cidrv4:{label:" IPv4",gender:"m"},cidrv6:{label:" IPv6",gender:"m"},base64:{label:"  64",gender:"f"},base64url:{label:"  64  ",gender:"f"},json_string:{label:" JSON",gender:"f"},e164:{label:" E.164",gender:"m"},jwt:{label:"JWT",gender:"m"},ends_with:{label:"",gender:"m"},includes:{label:"",gender:"m"},lowercase:{label:"",gender:"m"},starts_with:{label:"",gender:"m"},uppercase:{label:"",gender:"m"}},c={nan:"NaN"};return l=>{switch(l.code){case"invalid_type":{const u=l.expected,p=c[u??""]??i(u),f=He(l.input),g=c[f]??e[f]?.label??f;return/^[A-Z]/.test(l.expected)?`  :   instanceof ${l.expected},  ${g}`:`  :   ${p},  ${g}`}case"invalid_value":{if(l.values.length===1)return`  :    ${Ve(l.values[0])}`;const u=l.values.map(g=>Ve(g));if(l.values.length===2)return`  :    ${u[0]}  ${u[1]}`;const p=u[u.length-1];return`  :    ${u.slice(0,-1).join(", ")}  ${p}`}case"too_big":{const u=s(l.origin),p=r(l.origin??"value");if(l.origin==="string")return`${u?.longLabel??""} : ${p}   ${l.maximum.toString()} ${u?.unit??""} ${l.inclusive?" ":" "}`.trim();if(l.origin==="number"){const h=l.inclusive?`   -${l.maximum}`:` -${l.maximum}`;return` : ${p}   ${h}`}if(l.origin==="array"||l.origin==="set"){const h=l.origin==="set"?"":"",d=l.inclusive?`${l.maximum} ${u?.unit??""}  `:` -${l.maximum} ${u?.unit??""}`;return` : ${p} ${h}  ${d}`.trim()}const f=l.inclusive?"<=":"<",g=o(l.origin??"value");return u?.unit?`${u.longLabel} : ${p} ${g} ${f}${l.maximum.toString()} ${u.unit}`:`${u?.longLabel??""} : ${p} ${g} ${f}${l.maximum.toString()}`}case"too_small":{const u=s(l.origin),p=r(l.origin??"value");if(l.origin==="string")return`${u?.shortLabel??""} : ${p}   ${l.minimum.toString()} ${u?.unit??""} ${l.inclusive?" ":""}`.trim();if(l.origin==="number"){const h=l.inclusive?`   -${l.minimum}`:` -${l.minimum}`;return` : ${p}   ${h}`}if(l.origin==="array"||l.origin==="set"){const h=l.origin==="set"?"":"";if(l.minimum===1&&l.inclusive){const y=(l.origin==="set","  ");return` : ${p} ${h}  ${y}`}const d=l.inclusive?`${l.minimum} ${u?.unit??""}  `:` -${l.minimum} ${u?.unit??""}`;return` : ${p} ${h}  ${d}`.trim()}const f=l.inclusive?">=":">",g=o(l.origin??"value");return u?.unit?`${u.shortLabel} : ${p} ${g} ${f}${l.minimum.toString()} ${u.unit}`:`${u?.shortLabel??""} : ${p} ${g} ${f}${l.minimum.toString()}`}case"invalid_format":{const u=l;if(u.format==="starts_with")return`    "${u.prefix}"`;if(u.format==="ends_with")return`    "${u.suffix}"`;if(u.format==="includes")return`   "${u.includes}"`;if(u.format==="regex")return`    ${u.pattern}`;const p=a[u.format],f=p?.label??u.format,h=(p?.gender??"m")==="f"?"":"";return`${f}  ${h}`}case"not_multiple_of":return`  :     ${l.divisor}`;case"unrecognized_keys":return`${l.keys.length>1?"":""}  ${l.keys.length>1?"":""}: ${ye(l.keys,", ")}`;case"invalid_key":return"   ";case"invalid_union":return"  ";case"invalid_element":return`   ${r(l.origin??"array")}`;default:return"  "}}};function _4(){return{localeError:b4()}}const S4=()=>{const e={string:{unit:"karakter",verb:"legyen"},file:{unit:"byte",verb:"legyen"},array:{unit:"elem",verb:"legyen"},set:{unit:"elem",verb:"legyen"}};function t(r){return e[r]??null}const n={regex:"bemenet",email:"email cm",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO idblyeg",date:"ISO dtum",time:"ISO id",duration:"ISO idintervallum",ipv4:"IPv4 cm",ipv6:"IPv6 cm",cidrv4:"IPv4 tartomny",cidrv6:"IPv6 tartomny",base64:"base64-kdolt string",base64url:"base64url-kdolt string",json_string:"JSON string",e164:"E.164 szm",jwt:"JWT",template_literal:"bemenet"},i={nan:"NaN",number:"szm",array:"tmb"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`rvnytelen bemenet: a vrt rtk instanceof ${r.expected}, a kapott rtk ${a}`:`rvnytelen bemenet: a vrt rtk ${o}, a kapott rtk ${a}`}case"invalid_value":return r.values.length===1?`rvnytelen bemenet: a vrt rtk ${Ve(r.values[0])}`:`rvnytelen opci: valamelyik rtk vrt ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?`Tl nagy: ${r.origin??"rtk"} mrete tl nagy ${o}${r.maximum.toString()} ${s.unit??"elem"}`:`Tl nagy: a bemeneti rtk ${r.origin??"rtk"} tl nagy: ${o}${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?`Tl kicsi: a bemeneti rtk ${r.origin} mrete tl kicsi ${o}${r.minimum.toString()} ${s.unit}`:`Tl kicsi: a bemeneti rtk ${r.origin} tl kicsi ${o}${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?`rvnytelen string: "${o.prefix}" rtkkel kell kezddnie`:o.format==="ends_with"?`rvnytelen string: "${o.suffix}" rtkkel kell vgzdnie`:o.format==="includes"?`rvnytelen string: "${o.includes}" rtket kell tartalmaznia`:o.format==="regex"?`rvnytelen string: ${o.pattern} mintnak kell megfelelnie`:`rvnytelen ${n[o.format]??r.format}`}case"not_multiple_of":return`rvnytelen szm: ${r.divisor} tbbszrsnek kell lennie`;case"unrecognized_keys":return`Ismeretlen kulcs${r.keys.length>1?"s":""}: ${ye(r.keys,", ")}`;case"invalid_key":return`rvnytelen kulcs ${r.origin}`;case"invalid_union":return"rvnytelen bemenet";case"invalid_element":return`rvnytelen rtk: ${r.origin}`;default:return"rvnytelen bemenet"}}};function x4(){return{localeError:S4()}}function $_(e,t,n){return Math.abs(e)===1?t:n}function ga(e){if(!e)return"";const t=["","","","","","",""],n=e[e.length-1];return e+(t.includes(n)?"":"")}const k4=()=>{const e={string:{unit:{one:"",many:""},verb:""},file:{unit:{one:"",many:""},verb:""},array:{unit:{one:"",many:""},verb:""},set:{unit:{one:"",many:""},verb:""}};function t(r){return e[r]??null}const n={regex:"",email:". ",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO   ",date:"ISO ",time:"ISO ",duration:"ISO ",ipv4:"IPv4 ",ipv6:"IPv6 ",cidrv4:"IPv4 ",cidrv6:"IPv6 ",base64:"base64  ",base64url:"base64url  ",json_string:"JSON ",e164:"E.164 ",jwt:"JWT",template_literal:""},i={nan:"NaN",number:"",array:""};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`    instanceof ${r.expected},   ${a}`:`    ${o},   ${a}`}case"invalid_value":return r.values.length===1?`    ${Ve(r.values[1])}`:`      ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);if(s){const a=Number(r.maximum),c=$_(a,s.unit.one,s.unit.many);return`    ,  ${ga(r.origin??"")}  ${o}${r.maximum.toString()} ${c}`}return`    ,  ${ga(r.origin??"")}  ${o}${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);if(s){const a=Number(r.minimum),c=$_(a,s.unit.one,s.unit.many);return`    ,  ${ga(r.origin)}  ${o}${r.minimum.toString()} ${c}`}return`    ,  ${ga(r.origin)}  ${o}${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?`     "${o.prefix}"-`:o.format==="ends_with"?`     "${o.suffix}"-`:o.format==="includes"?`     "${o.includes}"`:o.format==="regex"?`     ${o.pattern} `:` ${n[o.format]??r.format}`}case"not_multiple_of":return`      ${r.divisor}-`;case"unrecognized_keys":return` ${r.keys.length>1?"":""}. ${ye(r.keys,", ")}`;case"invalid_key":return`  ${ga(r.origin)}-`;case"invalid_union":return" ";case"invalid_element":return`  ${ga(r.origin)}-`;default:return" "}}};function E4(){return{localeError:k4()}}const A4=()=>{const e={string:{unit:"karakter",verb:"memiliki"},file:{unit:"byte",verb:"memiliki"},array:{unit:"item",verb:"memiliki"},set:{unit:"item",verb:"memiliki"}};function t(r){return e[r]??null}const n={regex:"input",email:"alamat email",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"tanggal dan waktu format ISO",date:"tanggal format ISO",time:"jam format ISO",duration:"durasi format ISO",ipv4:"alamat IPv4",ipv6:"alamat IPv6",cidrv4:"rentang alamat IPv4",cidrv6:"rentang alamat IPv6",base64:"string dengan enkode base64",base64url:"string dengan enkode base64url",json_string:"string JSON",e164:"angka E.164",jwt:"JWT",template_literal:"input"},i={nan:"NaN"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`Input tidak valid: diharapkan instanceof ${r.expected}, diterima ${a}`:`Input tidak valid: diharapkan ${o}, diterima ${a}`}case"invalid_value":return r.values.length===1?`Input tidak valid: diharapkan ${Ve(r.values[0])}`:`Pilihan tidak valid: diharapkan salah satu dari ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?`Terlalu besar: diharapkan ${r.origin??"value"} memiliki ${o}${r.maximum.toString()} ${s.unit??"elemen"}`:`Terlalu besar: diharapkan ${r.origin??"value"} menjadi ${o}${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?`Terlalu kecil: diharapkan ${r.origin} memiliki ${o}${r.minimum.toString()} ${s.unit}`:`Terlalu kecil: diharapkan ${r.origin} menjadi ${o}${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?`String tidak valid: harus dimulai dengan "${o.prefix}"`:o.format==="ends_with"?`String tidak valid: harus berakhir dengan "${o.suffix}"`:o.format==="includes"?`String tidak valid: harus menyertakan "${o.includes}"`:o.format==="regex"?`String tidak valid: harus sesuai pola ${o.pattern}`:`${n[o.format]??r.format} tidak valid`}case"not_multiple_of":return`Angka tidak valid: harus kelipatan dari ${r.divisor}`;case"unrecognized_keys":return`Kunci tidak dikenali ${r.keys.length>1?"s":""}: ${ye(r.keys,", ")}`;case"invalid_key":return`Kunci tidak valid di ${r.origin}`;case"invalid_union":return"Input tidak valid";case"invalid_element":return`Nilai tidak valid di ${r.origin}`;default:return"Input tidak valid"}}};function T4(){return{localeError:A4()}}const I4=()=>{const e={string:{unit:"stafi",verb:"a hafa"},file:{unit:"bti",verb:"a hafa"},array:{unit:"hluti",verb:"a hafa"},set:{unit:"hluti",verb:"a hafa"}};function t(r){return e[r]??null}const n={regex:"gildi",email:"netfang",url:"vefsl",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO dagsetning og tmi",date:"ISO dagsetning",time:"ISO tmi",duration:"ISO tmalengd",ipv4:"IPv4 address",ipv6:"IPv6 address",cidrv4:"IPv4 range",cidrv6:"IPv6 range",base64:"base64-encoded strengur",base64url:"base64url-encoded strengur",json_string:"JSON strengur",e164:"E.164 tlugildi",jwt:"JWT",template_literal:"gildi"},i={nan:"NaN",number:"nmer",array:"fylki"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`Rangt gildi:  slst inn ${a} ar sem  a vera instanceof ${r.expected}`:`Rangt gildi:  slst inn ${a} ar sem  a vera ${o}`}case"invalid_value":return r.values.length===1?`Rangt gildi: gert r fyrir ${Ve(r.values[0])}`:`gilt val: m vera eitt af eftirfarandi ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?`Of strt: gert er r fyrir a ${r.origin??"gildi"} hafi ${o}${r.maximum.toString()} ${s.unit??"hluti"}`:`Of strt: gert er r fyrir a ${r.origin??"gildi"} s ${o}${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?`Of lti: gert er r fyrir a ${r.origin} hafi ${o}${r.minimum.toString()} ${s.unit}`:`Of lti: gert er r fyrir a ${r.origin} s ${o}${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?`gildur strengur: verur a byrja  "${o.prefix}"`:o.format==="ends_with"?`gildur strengur: verur a enda  "${o.suffix}"`:o.format==="includes"?`gildur strengur: verur a innihalda "${o.includes}"`:o.format==="regex"?`gildur strengur: verur a fylgja mynstri ${o.pattern}`:`Rangt ${n[o.format]??r.format}`}case"not_multiple_of":return`Rng tala: verur a vera margfeldi af ${r.divisor}`;case"unrecognized_keys":return`ekkt ${r.keys.length>1?"ir lyklar":"ur lykill"}: ${ye(r.keys,", ")}`;case"invalid_key":return`Rangur lykill  ${r.origin}`;case"invalid_union":return"Rangt gildi";case"invalid_element":return`Rangt gildi  ${r.origin}`;default:return"Rangt gildi"}}};function N4(){return{localeError:I4()}}const $4=()=>{const e={string:{unit:"caratteri",verb:"avere"},file:{unit:"byte",verb:"avere"},array:{unit:"elementi",verb:"avere"},set:{unit:"elementi",verb:"avere"}};function t(r){return e[r]??null}const n={regex:"input",email:"indirizzo email",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"data e ora ISO",date:"data ISO",time:"ora ISO",duration:"durata ISO",ipv4:"indirizzo IPv4",ipv6:"indirizzo IPv6",cidrv4:"intervallo IPv4",cidrv6:"intervallo IPv6",base64:"stringa codificata in base64",base64url:"URL codificata in base64",json_string:"stringa JSON",e164:"numero E.164",jwt:"JWT",template_literal:"input"},i={nan:"NaN",number:"numero",array:"vettore"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`Input non valido: atteso instanceof ${r.expected}, ricevuto ${a}`:`Input non valido: atteso ${o}, ricevuto ${a}`}case"invalid_value":return r.values.length===1?`Input non valido: atteso ${Ve(r.values[0])}`:`Opzione non valida: atteso uno tra ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?`Troppo grande: ${r.origin??"valore"} deve avere ${o}${r.maximum.toString()} ${s.unit??"elementi"}`:`Troppo grande: ${r.origin??"valore"} deve essere ${o}${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?`Troppo piccolo: ${r.origin} deve avere ${o}${r.minimum.toString()} ${s.unit}`:`Troppo piccolo: ${r.origin} deve essere ${o}${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?`Stringa non valida: deve iniziare con "${o.prefix}"`:o.format==="ends_with"?`Stringa non valida: deve terminare con "${o.suffix}"`:o.format==="includes"?`Stringa non valida: deve includere "${o.includes}"`:o.format==="regex"?`Stringa non valida: deve corrispondere al pattern ${o.pattern}`:`Invalid ${n[o.format]??r.format}`}case"not_multiple_of":return`Numero non valido: deve essere un multiplo di ${r.divisor}`;case"unrecognized_keys":return`Chiav${r.keys.length>1?"i":"e"} non riconosciut${r.keys.length>1?"e":"a"}: ${ye(r.keys,", ")}`;case"invalid_key":return`Chiave non valida in ${r.origin}`;case"invalid_union":return"Input non valido";case"invalid_element":return`Valore non valido in ${r.origin}`;default:return"Input non valido"}}};function C4(){return{localeError:$4()}}const O4=()=>{const e={string:{unit:"",verb:""},file:{unit:"",verb:""},array:{unit:"",verb:""},set:{unit:"",verb:""}};function t(r){return e[r]??null}const n={regex:"",email:"",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO",date:"ISO",time:"ISO",duration:"ISO",ipv4:"IPv4",ipv6:"IPv6",cidrv4:"IPv4",cidrv6:"IPv6",base64:"base64",base64url:"base64url",json_string:"JSON",e164:"E.164",jwt:"JWT",template_literal:""},i={nan:"NaN",number:"",array:""};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`: instanceof ${r.expected}${a}`:`: ${o}${a}`}case"invalid_value":return r.values.length===1?`: ${Ve(r.values[0])}`:`: ${ye(r.values,"")}`;case"too_big":{const o=r.inclusive?"":"",s=t(r.origin);return s?`: ${r.origin??""}${r.maximum.toString()}${s.unit??""}${o}`:`: ${r.origin??""}${r.maximum.toString()}${o}`}case"too_small":{const o=r.inclusive?"":"",s=t(r.origin);return s?`: ${r.origin}${r.minimum.toString()}${s.unit}${o}`:`: ${r.origin}${r.minimum.toString()}${o}`}case"invalid_format":{const o=r;return o.format==="starts_with"?`: "${o.prefix}"`:o.format==="ends_with"?`: "${o.suffix}"`:o.format==="includes"?`: "${o.includes}"`:o.format==="regex"?`: ${o.pattern}`:`${n[o.format]??r.format}`}case"not_multiple_of":return`: ${r.divisor}`;case"unrecognized_keys":return`${r.keys.length>1?"":""}: ${ye(r.keys,"")}`;case"invalid_key":return`${r.origin}`;case"invalid_union":return"";case"invalid_element":return`${r.origin}`;default:return""}}};function R4(){return{localeError:O4()}}const P4=()=>{const e={string:{unit:"",verb:" "},file:{unit:"",verb:" "},array:{unit:"",verb:" "},set:{unit:"",verb:" "}};function t(r){return e[r]??null}const n={regex:"",email:"- ",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"-",date:"",time:"",duration:"",ipv4:"IPv4 ",ipv6:"IPv6 ",cidrv4:"IPv4 ",cidrv6:"IPv6 ",base64:"base64- ",base64url:"base64url- ",json_string:"JSON ",e164:"E.164 ",jwt:"JWT",template_literal:""},i={nan:"NaN",number:"",string:"",boolean:"",function:"",array:""};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?` :  instanceof ${r.expected},  ${a}`:` :  ${o},  ${a}`}case"invalid_value":return r.values.length===1?` :  ${Ve(r.values[0])}`:` :  - ${ye(r.values,"|")}-`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?` :  ${r.origin??""} ${s.verb} ${o}${r.maximum.toString()} ${s.unit}`:` :  ${r.origin??""}  ${o}${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?` :  ${r.origin} ${s.verb} ${o}${r.minimum.toString()} ${s.unit}`:` :  ${r.origin}  ${o}${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?` :   "${o.prefix}"-`:o.format==="ends_with"?` :   "${o.suffix}"-`:o.format==="includes"?` :   "${o.includes}"-`:o.format==="regex"?` :    ${o.pattern}`:` ${n[o.format]??r.format}`}case"not_multiple_of":return` :   ${r.divisor}- `;case"unrecognized_keys":return` ${r.keys.length>1?"":""}: ${ye(r.keys,", ")}`;case"invalid_key":return`  ${r.origin}-`;case"invalid_union":return" ";case"invalid_element":return`  ${r.origin}-`;default:return" "}}};function D4(){return{localeError:P4()}}const U4=()=>{const e={string:{unit:"",verb:""},file:{unit:"",verb:""},array:{unit:"",verb:""},set:{unit:"",verb:""}};function t(r){return e[r]??null}const n={regex:"",email:"",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"  ISO",date:" ISO",time:" ISO",duration:" ISO",ipv4:" IPv4",ipv6:" IPv6",cidrv4:" IPv4",cidrv6:" IPv6",base64:" base64",base64url:" base64url",json_string:" JSON",e164:" E.164",jwt:"JWT",template_literal:""},i={nan:"NaN",number:"",array:" (Array)",null:" (null)"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`  instanceof ${r.expected}  ${a}`:`  ${o}  ${a}`}case"invalid_value":return r.values.length===1?`  ${Ve(r.values[0])}`:`  ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?`  ${r.origin??""} ${o} ${r.maximum.toString()} ${s.unit??""}`:`  ${r.origin??""} ${o} ${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?`  ${r.origin} ${o} ${r.minimum.toString()} ${s.unit}`:`  ${r.origin} ${o} ${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?`  "${o.prefix}"`:o.format==="ends_with"?`  "${o.suffix}"`:o.format==="includes"?`  "${o.includes}"`:o.format==="regex"?`  ${o.pattern}`:` ${n[o.format]??r.format}`}case"not_multiple_of":return`  ${r.divisor}`;case"unrecognized_keys":return` ${ye(r.keys,", ")}`;case"invalid_key":return` ${r.origin}`;case"invalid_union":return"";case"invalid_element":return` ${r.origin}`;default:return""}}};function k1(){return{localeError:U4()}}function L4(){return k1()}const M4=()=>{const e={string:{unit:"",verb:"to have"},file:{unit:"",verb:"to have"},array:{unit:"",verb:"to have"},set:{unit:"",verb:"to have"}};function t(r){return e[r]??null}const n={regex:"",email:" ",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO ",date:"ISO ",time:"ISO ",duration:"ISO ",ipv4:"IPv4 ",ipv6:"IPv6 ",cidrv4:"IPv4 ",cidrv6:"IPv6 ",base64:"base64  ",base64url:"base64url  ",json_string:"JSON ",e164:"E.164 ",jwt:"JWT",template_literal:""},i={nan:"NaN"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?` :   instanceof ${r.expected},   ${a}`:` :   ${o},   ${a}`}case"invalid_value":return r.values.length===1?` :  ${Ve(r.values[0])}  `:` : ${ye(r.values," ")}   `;case"too_big":{const o=r.inclusive?"":"",s=o===""?" ":" ",a=t(r.origin),c=a?.unit??"";return a?`${r.origin??""}  : ${r.maximum.toString()}${c} ${o}${s}`:`${r.origin??""}  : ${r.maximum.toString()} ${o}${s}`}case"too_small":{const o=r.inclusive?"":"",s=o===""?" ":" ",a=t(r.origin),c=a?.unit??"";return a?`${r.origin??""}  : ${r.minimum.toString()}${c} ${o}${s}`:`${r.origin??""}  : ${r.minimum.toString()} ${o}${s}`}case"invalid_format":{const o=r;return o.format==="starts_with"?` : "${o.prefix}"()  `:o.format==="ends_with"?` : "${o.suffix}"()  `:o.format==="includes"?` : "${o.includes}"()  `:o.format==="regex"?` :  ${o.pattern}   `:` ${n[o.format]??r.format}`}case"not_multiple_of":return` : ${r.divisor}  `;case"unrecognized_keys":return`   : ${ye(r.keys,", ")}`;case"invalid_key":return` : ${r.origin}`;case"invalid_union":return" ";case"invalid_element":return` : ${r.origin}`;default:return" "}}};function j4(){return{localeError:M4()}}const jc=e=>e.charAt(0).toUpperCase()+e.slice(1);function C_(e){const t=Math.abs(e),n=t%10,i=t%100;return i>=11&&i<=19||n===0?"many":n===1?"one":"few"}const z4=()=>{const e={string:{unit:{one:"simbolis",few:"simboliai",many:"simboli"},verb:{smaller:{inclusive:"turi bti ne ilgesn kaip",notInclusive:"turi bti trumpesn kaip"},bigger:{inclusive:"turi bti ne trumpesn kaip",notInclusive:"turi bti ilgesn kaip"}}},file:{unit:{one:"baitas",few:"baitai",many:"bait"},verb:{smaller:{inclusive:"turi bti ne didesnis kaip",notInclusive:"turi bti maesnis kaip"},bigger:{inclusive:"turi bti ne maesnis kaip",notInclusive:"turi bti didesnis kaip"}}},array:{unit:{one:"element",few:"elementus",many:"element"},verb:{smaller:{inclusive:"turi turti ne daugiau kaip",notInclusive:"turi turti maiau kaip"},bigger:{inclusive:"turi turti ne maiau kaip",notInclusive:"turi turti daugiau kaip"}}},set:{unit:{one:"element",few:"elementus",many:"element"},verb:{smaller:{inclusive:"turi turti ne daugiau kaip",notInclusive:"turi turti maiau kaip"},bigger:{inclusive:"turi turti ne maiau kaip",notInclusive:"turi turti daugiau kaip"}}}};function t(r,o,s,a){const c=e[r]??null;return c===null?c:{unit:c.unit[o],verb:c.verb[a][s?"inclusive":"notInclusive"]}}const n={regex:"vestis",email:"el. pato adresas",url:"URL",emoji:"jaustukas",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO data ir laikas",date:"ISO data",time:"ISO laikas",duration:"ISO trukm",ipv4:"IPv4 adresas",ipv6:"IPv6 adresas",cidrv4:"IPv4 tinklo prefiksas (CIDR)",cidrv6:"IPv6 tinklo prefiksas (CIDR)",base64:"base64 ukoduota eilut",base64url:"base64url ukoduota eilut",json_string:"JSON eilut",e164:"E.164 numeris",jwt:"JWT",template_literal:"vestis"},i={nan:"NaN",number:"skaiius",bigint:"sveikasis skaiius",string:"eilut",boolean:"login reikm",undefined:"neapibrta reikm",function:"funkcija",symbol:"simbolis",array:"masyvas",object:"objektas",null:"nulin reikm"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`Gautas tipas ${a}, o tiktasi - instanceof ${r.expected}`:`Gautas tipas ${a}, o tiktasi - ${o}`}case"invalid_value":return r.values.length===1?`Privalo bti ${Ve(r.values[0])}`:`Privalo bti vienas i ${ye(r.values,"|")} pasirinkim`;case"too_big":{const o=i[r.origin]??r.origin,s=t(r.origin,C_(Number(r.maximum)),r.inclusive??!1,"smaller");if(s?.verb)return`${jc(o??r.origin??"reikm")} ${s.verb} ${r.maximum.toString()} ${s.unit??"element"}`;const a=r.inclusive?"ne didesnis kaip":"maesnis kaip";return`${jc(o??r.origin??"reikm")} turi bti ${a} ${r.maximum.toString()} ${s?.unit}`}case"too_small":{const o=i[r.origin]??r.origin,s=t(r.origin,C_(Number(r.minimum)),r.inclusive??!1,"bigger");if(s?.verb)return`${jc(o??r.origin??"reikm")} ${s.verb} ${r.minimum.toString()} ${s.unit??"element"}`;const a=r.inclusive?"ne maesnis kaip":"didesnis kaip";return`${jc(o??r.origin??"reikm")} turi bti ${a} ${r.minimum.toString()} ${s?.unit}`}case"invalid_format":{const o=r;return o.format==="starts_with"?`Eilut privalo prasidti "${o.prefix}"`:o.format==="ends_with"?`Eilut privalo pasibaigti "${o.suffix}"`:o.format==="includes"?`Eilut privalo traukti "${o.includes}"`:o.format==="regex"?`Eilut privalo atitikti ${o.pattern}`:`Neteisingas ${n[o.format]??r.format}`}case"not_multiple_of":return`Skaiius privalo bti ${r.divisor} kartotinis.`;case"unrecognized_keys":return`Neatpaint${r.keys.length>1?"i":"as"} rakt${r.keys.length>1?"ai":"as"}: ${ye(r.keys,", ")}`;case"invalid_key":return"Rastas klaidingas raktas";case"invalid_union":return"Klaidinga vestis";case"invalid_element":{const o=i[r.origin]??r.origin;return`${jc(o??r.origin??"reikm")} turi klaiding vest`}default:return"Klaidinga vestis"}}};function B4(){return{localeError:z4()}}const F4=()=>{const e={string:{unit:"",verb:" "},file:{unit:"",verb:" "},array:{unit:"",verb:" "},set:{unit:"",verb:" "}};function t(r){return e[r]??null}const n={regex:"",email:"  -",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO   ",date:"ISO ",time:"ISO ",duration:"ISO ",ipv4:"IPv4 ",ipv6:"IPv6 ",cidrv4:"IPv4 ",cidrv6:"IPv6 ",base64:"base64- ",base64url:"base64url- ",json_string:"JSON ",e164:"E.164 ",jwt:"JWT",template_literal:""},i={nan:"NaN",number:"",array:""};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?` :   instanceof ${r.expected},  ${a}`:` :   ${o},  ${a}`}case"invalid_value":return r.values.length===1?`Invalid input: expected ${Ve(r.values[0])}`:` :    ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?` :   ${r.origin??""}   ${o}${r.maximum.toString()} ${s.unit??""}`:` :   ${r.origin??""}   ${o}${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?` :   ${r.origin}   ${o}${r.minimum.toString()} ${s.unit}`:` :   ${r.origin}   ${o}${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?` :     "${o.prefix}"`:o.format==="ends_with"?` :     "${o.suffix}"`:o.format==="includes"?` :    "${o.includes}"`:o.format==="regex"?` :      ${o.pattern}`:`Invalid ${n[o.format]??r.format}`}case"not_multiple_of":return` :      ${r.divisor}`;case"unrecognized_keys":return`${r.keys.length>1?" ":" "}: ${ye(r.keys,", ")}`;case"invalid_key":return`   ${r.origin}`;case"invalid_union":return" ";case"invalid_element":return`   ${r.origin}`;default:return" "}}};function W4(){return{localeError:F4()}}const V4=()=>{const e={string:{unit:"aksara",verb:"mempunyai"},file:{unit:"bait",verb:"mempunyai"},array:{unit:"elemen",verb:"mempunyai"},set:{unit:"elemen",verb:"mempunyai"}};function t(r){return e[r]??null}const n={regex:"input",email:"alamat e-mel",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"tarikh masa ISO",date:"tarikh ISO",time:"masa ISO",duration:"tempoh ISO",ipv4:"alamat IPv4",ipv6:"alamat IPv6",cidrv4:"julat IPv4",cidrv6:"julat IPv6",base64:"string dikodkan base64",base64url:"string dikodkan base64url",json_string:"string JSON",e164:"nombor E.164",jwt:"JWT",template_literal:"input"},i={nan:"NaN",number:"nombor"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`Input tidak sah: dijangka instanceof ${r.expected}, diterima ${a}`:`Input tidak sah: dijangka ${o}, diterima ${a}`}case"invalid_value":return r.values.length===1?`Input tidak sah: dijangka ${Ve(r.values[0])}`:`Pilihan tidak sah: dijangka salah satu daripada ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?`Terlalu besar: dijangka ${r.origin??"nilai"} ${s.verb} ${o}${r.maximum.toString()} ${s.unit??"elemen"}`:`Terlalu besar: dijangka ${r.origin??"nilai"} adalah ${o}${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?`Terlalu kecil: dijangka ${r.origin} ${s.verb} ${o}${r.minimum.toString()} ${s.unit}`:`Terlalu kecil: dijangka ${r.origin} adalah ${o}${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?`String tidak sah: mesti bermula dengan "${o.prefix}"`:o.format==="ends_with"?`String tidak sah: mesti berakhir dengan "${o.suffix}"`:o.format==="includes"?`String tidak sah: mesti mengandungi "${o.includes}"`:o.format==="regex"?`String tidak sah: mesti sepadan dengan corak ${o.pattern}`:`${n[o.format]??r.format} tidak sah`}case"not_multiple_of":return`Nombor tidak sah: perlu gandaan ${r.divisor}`;case"unrecognized_keys":return`Kunci tidak dikenali: ${ye(r.keys,", ")}`;case"invalid_key":return`Kunci tidak sah dalam ${r.origin}`;case"invalid_union":return"Input tidak sah";case"invalid_element":return`Nilai tidak sah dalam ${r.origin}`;default:return"Input tidak sah"}}};function q4(){return{localeError:V4()}}const H4=()=>{const e={string:{unit:"tekens",verb:"heeft"},file:{unit:"bytes",verb:"heeft"},array:{unit:"elementen",verb:"heeft"},set:{unit:"elementen",verb:"heeft"}};function t(r){return e[r]??null}const n={regex:"invoer",email:"emailadres",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datum en tijd",date:"ISO datum",time:"ISO tijd",duration:"ISO duur",ipv4:"IPv4-adres",ipv6:"IPv6-adres",cidrv4:"IPv4-bereik",cidrv6:"IPv6-bereik",base64:"base64-gecodeerde tekst",base64url:"base64 URL-gecodeerde tekst",json_string:"JSON string",e164:"E.164-nummer",jwt:"JWT",template_literal:"invoer"},i={nan:"NaN",number:"getal"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`Ongeldige invoer: verwacht instanceof ${r.expected}, ontving ${a}`:`Ongeldige invoer: verwacht ${o}, ontving ${a}`}case"invalid_value":return r.values.length===1?`Ongeldige invoer: verwacht ${Ve(r.values[0])}`:`Ongeldige optie: verwacht n van ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin),a=r.origin==="date"?"laat":r.origin==="string"?"lang":"groot";return s?`Te ${a}: verwacht dat ${r.origin??"waarde"} ${o}${r.maximum.toString()} ${s.unit??"elementen"} ${s.verb}`:`Te ${a}: verwacht dat ${r.origin??"waarde"} ${o}${r.maximum.toString()} is`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin),a=r.origin==="date"?"vroeg":r.origin==="string"?"kort":"klein";return s?`Te ${a}: verwacht dat ${r.origin} ${o}${r.minimum.toString()} ${s.unit} ${s.verb}`:`Te ${a}: verwacht dat ${r.origin} ${o}${r.minimum.toString()} is`}case"invalid_format":{const o=r;return o.format==="starts_with"?`Ongeldige tekst: moet met "${o.prefix}" beginnen`:o.format==="ends_with"?`Ongeldige tekst: moet op "${o.suffix}" eindigen`:o.format==="includes"?`Ongeldige tekst: moet "${o.includes}" bevatten`:o.format==="regex"?`Ongeldige tekst: moet overeenkomen met patroon ${o.pattern}`:`Ongeldig: ${n[o.format]??r.format}`}case"not_multiple_of":return`Ongeldig getal: moet een veelvoud van ${r.divisor} zijn`;case"unrecognized_keys":return`Onbekende key${r.keys.length>1?"s":""}: ${ye(r.keys,", ")}`;case"invalid_key":return`Ongeldige key in ${r.origin}`;case"invalid_union":return"Ongeldige invoer";case"invalid_element":return`Ongeldige waarde in ${r.origin}`;default:return"Ongeldige invoer"}}};function K4(){return{localeError:H4()}}const J4=()=>{const e={string:{unit:"tegn",verb:" ha"},file:{unit:"bytes",verb:" ha"},array:{unit:"elementer",verb:" inneholde"},set:{unit:"elementer",verb:" inneholde"}};function t(r){return e[r]??null}const n={regex:"input",email:"e-postadresse",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO dato- og klokkeslett",date:"ISO-dato",time:"ISO-klokkeslett",duration:"ISO-varighet",ipv4:"IPv4-omrde",ipv6:"IPv6-omrde",cidrv4:"IPv4-spekter",cidrv6:"IPv6-spekter",base64:"base64-enkodet streng",base64url:"base64url-enkodet streng",json_string:"JSON-streng",e164:"E.164-nummer",jwt:"JWT",template_literal:"input"},i={nan:"NaN",number:"tall",array:"liste"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`Ugyldig input: forventet instanceof ${r.expected}, fikk ${a}`:`Ugyldig input: forventet ${o}, fikk ${a}`}case"invalid_value":return r.values.length===1?`Ugyldig verdi: forventet ${Ve(r.values[0])}`:`Ugyldig valg: forventet en av ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?`For stor(t): forventet ${r.origin??"value"} til  ha ${o}${r.maximum.toString()} ${s.unit??"elementer"}`:`For stor(t): forventet ${r.origin??"value"} til  ha ${o}${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?`For lite(n): forventet ${r.origin} til  ha ${o}${r.minimum.toString()} ${s.unit}`:`For lite(n): forventet ${r.origin} til  ha ${o}${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?`Ugyldig streng: m starte med "${o.prefix}"`:o.format==="ends_with"?`Ugyldig streng: m ende med "${o.suffix}"`:o.format==="includes"?`Ugyldig streng: m inneholde "${o.includes}"`:o.format==="regex"?`Ugyldig streng: m matche mnsteret ${o.pattern}`:`Ugyldig ${n[o.format]??r.format}`}case"not_multiple_of":return`Ugyldig tall: m vre et multiplum av ${r.divisor}`;case"unrecognized_keys":return`${r.keys.length>1?"Ukjente nkler":"Ukjent nkkel"}: ${ye(r.keys,", ")}`;case"invalid_key":return`Ugyldig nkkel i ${r.origin}`;case"invalid_union":return"Ugyldig input";case"invalid_element":return`Ugyldig verdi i ${r.origin}`;default:return"Ugyldig input"}}};function G4(){return{localeError:J4()}}const Z4=()=>{const e={string:{unit:"harf",verb:"olmaldr"},file:{unit:"bayt",verb:"olmaldr"},array:{unit:"unsur",verb:"olmaldr"},set:{unit:"unsur",verb:"olmaldr"}};function t(r){return e[r]??null}const n={regex:"giren",email:"epostagh",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO hengm",date:"ISO tarihi",time:"ISO zaman",duration:"ISO mddeti",ipv4:"IPv4 nin",ipv6:"IPv6 nin",cidrv4:"IPv4 menzili",cidrv6:"IPv6 menzili",base64:"base64-ifreli metin",base64url:"base64url-ifreli metin",json_string:"JSON metin",e164:"E.164 says",jwt:"JWT",template_literal:"giren"},i={nan:"NaN",number:"numara",array:"saf",null:"gayb"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`Fsit giren: umulan instanceof ${r.expected}, alnan ${a}`:`Fsit giren: umulan ${o}, alnan ${a}`}case"invalid_value":return r.values.length===1?`Fsit giren: umulan ${Ve(r.values[0])}`:`Fsit tercih: mteberler ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?`Fazla byk: ${r.origin??"value"}, ${o}${r.maximum.toString()} ${s.unit??"elements"} sahip olmalyd.`:`Fazla byk: ${r.origin??"value"}, ${o}${r.maximum.toString()} olmalyd.`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?`Fazla kk: ${r.origin}, ${o}${r.minimum.toString()} ${s.unit} sahip olmalyd.`:`Fazla kk: ${r.origin}, ${o}${r.minimum.toString()} olmalyd.`}case"invalid_format":{const o=r;return o.format==="starts_with"?`Fsit metin: "${o.prefix}" ile balamal.`:o.format==="ends_with"?`Fsit metin: "${o.suffix}" ile bitmeli.`:o.format==="includes"?`Fsit metin: "${o.includes}" ihtiv etmeli.`:o.format==="regex"?`Fsit metin: ${o.pattern} nakna uymal.`:`Fsit ${n[o.format]??r.format}`}case"not_multiple_of":return`Fsit say: ${r.divisor} kat olmalyd.`;case"unrecognized_keys":return`Tannmayan anahtar ${r.keys.length>1?"s":""}: ${ye(r.keys,", ")}`;case"invalid_key":return`${r.origin} iin tannmayan anahtar var.`;case"invalid_union":return"Giren tannamad.";case"invalid_element":return`${r.origin} iin tannmayan kymet var.`;default:return"Kymet tannamad."}}};function Q4(){return{localeError:Z4()}}const Y4=()=>{const e={string:{unit:"",verb:""},file:{unit:"",verb:""},array:{unit:"",verb:""},set:{unit:"",verb:""}};function t(r){return e[r]??null}const n={regex:"",email:"",url:"  ",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"  ",date:"",time:"",duration:"",ipv4:" IPv4 ",ipv6:" IPv6 ",cidrv4:" IPv4 ",cidrv6:" IPv6 ",base64:"base64-encoded ",base64url:"base64url-encoded ",json_string:"JSON ",e164:" E.164 ",jwt:"JWT",template_literal:""},i={nan:"NaN",number:"",array:""};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?` :  instanceof ${r.expected} ,  ${a}  `:` :  ${o} ,  ${a}  `}case"invalid_value":return r.values.length===1?` :  ${Ve(r.values[0])} `:` :    ${ye(r.values,"|")}  `;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?` : ${r.origin??""}  ${o}${r.maximum.toString()} ${s.unit??""} `:` : ${r.origin??""}  ${o}${r.maximum.toString()} `}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?` : ${r.origin}  ${o}${r.minimum.toString()} ${s.unit} `:` : ${r.origin}  ${o}${r.minimum.toString()} `}case"invalid_format":{const o=r;return o.format==="starts_with"?` :   "${o.prefix}"   `:o.format==="ends_with"?` :   "${o.suffix}"    `:o.format==="includes"?` :  "${o.includes}" `:o.format==="regex"?` :   ${o.pattern}   `:`${n[o.format]??r.format}  `}case"not_multiple_of":return` :   ${r.divisor}  `;case"unrecognized_keys":return` ${r.keys.length>1?"":""}: ${ye(r.keys,", ")}`;case"invalid_key":return`   ${r.origin} `;case"invalid_union":return" ";case"invalid_element":return`   ${r.origin} `;default:return" "}}};function X4(){return{localeError:Y4()}}const e5=()=>{const e={string:{unit:"znakw",verb:"mie"},file:{unit:"bajtw",verb:"mie"},array:{unit:"elementw",verb:"mie"},set:{unit:"elementw",verb:"mie"}};function t(r){return e[r]??null}const n={regex:"wyraenie",email:"adres email",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"data i godzina w formacie ISO",date:"data w formacie ISO",time:"godzina w formacie ISO",duration:"czas trwania ISO",ipv4:"adres IPv4",ipv6:"adres IPv6",cidrv4:"zakres IPv4",cidrv6:"zakres IPv6",base64:"cig znakw zakodowany w formacie base64",base64url:"cig znakw zakodowany w formacie base64url",json_string:"cig znakw w formacie JSON",e164:"liczba E.164",jwt:"JWT",template_literal:"wejcie"},i={nan:"NaN",number:"liczba",array:"tablica"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`Nieprawidowe dane wejciowe: oczekiwano instanceof ${r.expected}, otrzymano ${a}`:`Nieprawidowe dane wejciowe: oczekiwano ${o}, otrzymano ${a}`}case"invalid_value":return r.values.length===1?`Nieprawidowe dane wejciowe: oczekiwano ${Ve(r.values[0])}`:`Nieprawidowa opcja: oczekiwano jednej z wartoci ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?`Za dua warto: oczekiwano, e ${r.origin??"warto"} bdzie mie ${o}${r.maximum.toString()} ${s.unit??"elementw"}`:`Zbyt du(y/a/e): oczekiwano, e ${r.origin??"warto"} bdzie wynosi ${o}${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?`Za maa warto: oczekiwano, e ${r.origin??"warto"} bdzie mie ${o}${r.minimum.toString()} ${s.unit??"elementw"}`:`Zbyt ma(y/a/e): oczekiwano, e ${r.origin??"warto"} bdzie wynosi ${o}${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?`Nieprawidowy cig znakw: musi zaczyna si od "${o.prefix}"`:o.format==="ends_with"?`Nieprawidowy cig znakw: musi koczy si na "${o.suffix}"`:o.format==="includes"?`Nieprawidowy cig znakw: musi zawiera "${o.includes}"`:o.format==="regex"?`Nieprawidowy cig znakw: musi odpowiada wzorcowi ${o.pattern}`:`Nieprawidow(y/a/e) ${n[o.format]??r.format}`}case"not_multiple_of":return`Nieprawidowa liczba: musi by wielokrotnoci ${r.divisor}`;case"unrecognized_keys":return`Nierozpoznane klucze${r.keys.length>1?"s":""}: ${ye(r.keys,", ")}`;case"invalid_key":return`Nieprawidowy klucz w ${r.origin}`;case"invalid_union":return"Nieprawidowe dane wejciowe";case"invalid_element":return`Nieprawidowa warto w ${r.origin}`;default:return"Nieprawidowe dane wejciowe"}}};function t5(){return{localeError:e5()}}const n5=()=>{const e={string:{unit:"caracteres",verb:"ter"},file:{unit:"bytes",verb:"ter"},array:{unit:"itens",verb:"ter"},set:{unit:"itens",verb:"ter"}};function t(r){return e[r]??null}const n={regex:"padro",email:"endereo de e-mail",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"data e hora ISO",date:"data ISO",time:"hora ISO",duration:"durao ISO",ipv4:"endereo IPv4",ipv6:"endereo IPv6",cidrv4:"faixa de IPv4",cidrv6:"faixa de IPv6",base64:"texto codificado em base64",base64url:"URL codificada em base64",json_string:"texto JSON",e164:"nmero E.164",jwt:"JWT",template_literal:"entrada"},i={nan:"NaN",number:"nmero",null:"nulo"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`Tipo invlido: esperado instanceof ${r.expected}, recebido ${a}`:`Tipo invlido: esperado ${o}, recebido ${a}`}case"invalid_value":return r.values.length===1?`Entrada invlida: esperado ${Ve(r.values[0])}`:`Opo invlida: esperada uma das ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?`Muito grande: esperado que ${r.origin??"valor"} tivesse ${o}${r.maximum.toString()} ${s.unit??"elementos"}`:`Muito grande: esperado que ${r.origin??"valor"} fosse ${o}${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?`Muito pequeno: esperado que ${r.origin} tivesse ${o}${r.minimum.toString()} ${s.unit}`:`Muito pequeno: esperado que ${r.origin} fosse ${o}${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?`Texto invlido: deve comear com "${o.prefix}"`:o.format==="ends_with"?`Texto invlido: deve terminar com "${o.suffix}"`:o.format==="includes"?`Texto invlido: deve incluir "${o.includes}"`:o.format==="regex"?`Texto invlido: deve corresponder ao padro ${o.pattern}`:`${n[o.format]??r.format} invlido`}case"not_multiple_of":return`Nmero invlido: deve ser mltiplo de ${r.divisor}`;case"unrecognized_keys":return`Chave${r.keys.length>1?"s":""} desconhecida${r.keys.length>1?"s":""}: ${ye(r.keys,", ")}`;case"invalid_key":return`Chave invlida em ${r.origin}`;case"invalid_union":return"Entrada invlida";case"invalid_element":return`Valor invlido em ${r.origin}`;default:return"Campo invlido"}}};function r5(){return{localeError:n5()}}function O_(e,t,n,i){const r=Math.abs(e),o=r%10,s=r%100;return s>=11&&s<=19?i:o===1?t:o>=2&&o<=4?n:i}const i5=()=>{const e={string:{unit:{one:"",few:"",many:""},verb:""},file:{unit:{one:"",few:"",many:""},verb:""},array:{unit:{one:"",few:"",many:""},verb:""},set:{unit:{one:"",few:"",many:""},verb:""}};function t(r){return e[r]??null}const n={regex:"",email:"email ",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO   ",date:"ISO ",time:"ISO ",duration:"ISO ",ipv4:"IPv4 ",ipv6:"IPv6 ",cidrv4:"IPv4 ",cidrv6:"IPv6 ",base64:"   base64",base64url:"   base64url",json_string:"JSON ",e164:" E.164",jwt:"JWT",template_literal:""},i={nan:"NaN",number:"",array:""};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?` :  instanceof ${r.expected},  ${a}`:` :  ${o},  ${a}`}case"invalid_value":return r.values.length===1?` :  ${Ve(r.values[0])}`:` :    ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);if(s){const a=Number(r.maximum),c=O_(a,s.unit.one,s.unit.few,s.unit.many);return`  : ,  ${r.origin??""}   ${o}${r.maximum.toString()} ${c}`}return`  : ,  ${r.origin??""}  ${o}${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);if(s){const a=Number(r.minimum),c=O_(a,s.unit.one,s.unit.few,s.unit.many);return`  : ,  ${r.origin}   ${o}${r.minimum.toString()} ${c}`}return`  : ,  ${r.origin}  ${o}${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?` :    "${o.prefix}"`:o.format==="ends_with"?` :    "${o.suffix}"`:o.format==="includes"?` :   "${o.includes}"`:o.format==="regex"?` :    ${o.pattern}`:` ${n[o.format]??r.format}`}case"not_multiple_of":return` :    ${r.divisor}`;case"unrecognized_keys":return`${r.keys.length>1?"":""} ${r.keys.length>1?"":""}: ${ye(r.keys,", ")}`;case"invalid_key":return`   ${r.origin}`;case"invalid_union":return"  ";case"invalid_element":return`   ${r.origin}`;default:return"  "}}};function o5(){return{localeError:i5()}}const s5=()=>{const e={string:{unit:"znakov",verb:"imeti"},file:{unit:"bajtov",verb:"imeti"},array:{unit:"elementov",verb:"imeti"},set:{unit:"elementov",verb:"imeti"}};function t(r){return e[r]??null}const n={regex:"vnos",email:"e-potni naslov",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO datum in as",date:"ISO datum",time:"ISO as",duration:"ISO trajanje",ipv4:"IPv4 naslov",ipv6:"IPv6 naslov",cidrv4:"obseg IPv4",cidrv6:"obseg IPv6",base64:"base64 kodiran niz",base64url:"base64url kodiran niz",json_string:"JSON niz",e164:"E.164 tevilka",jwt:"JWT",template_literal:"vnos"},i={nan:"NaN",number:"tevilo",array:"tabela"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`Neveljaven vnos: priakovano instanceof ${r.expected}, prejeto ${a}`:`Neveljaven vnos: priakovano ${o}, prejeto ${a}`}case"invalid_value":return r.values.length===1?`Neveljaven vnos: priakovano ${Ve(r.values[0])}`:`Neveljavna monost: priakovano eno izmed ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?`Preveliko: priakovano, da bo ${r.origin??"vrednost"} imelo ${o}${r.maximum.toString()} ${s.unit??"elementov"}`:`Preveliko: priakovano, da bo ${r.origin??"vrednost"} ${o}${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?`Premajhno: priakovano, da bo ${r.origin} imelo ${o}${r.minimum.toString()} ${s.unit}`:`Premajhno: priakovano, da bo ${r.origin} ${o}${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?`Neveljaven niz: mora se zaeti z "${o.prefix}"`:o.format==="ends_with"?`Neveljaven niz: mora se konati z "${o.suffix}"`:o.format==="includes"?`Neveljaven niz: mora vsebovati "${o.includes}"`:o.format==="regex"?`Neveljaven niz: mora ustrezati vzorcu ${o.pattern}`:`Neveljaven ${n[o.format]??r.format}`}case"not_multiple_of":return`Neveljavno tevilo: mora biti vekratnik ${r.divisor}`;case"unrecognized_keys":return`Neprepoznan${r.keys.length>1?"i kljui":" klju"}: ${ye(r.keys,", ")}`;case"invalid_key":return`Neveljaven klju v ${r.origin}`;case"invalid_union":return"Neveljaven vnos";case"invalid_element":return`Neveljavna vrednost v ${r.origin}`;default:return"Neveljaven vnos"}}};function a5(){return{localeError:s5()}}const c5=()=>{const e={string:{unit:"tecken",verb:"att ha"},file:{unit:"bytes",verb:"att ha"},array:{unit:"objekt",verb:"att innehlla"},set:{unit:"objekt",verb:"att innehlla"}};function t(r){return e[r]??null}const n={regex:"reguljrt uttryck",email:"e-postadress",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO-datum och tid",date:"ISO-datum",time:"ISO-tid",duration:"ISO-varaktighet",ipv4:"IPv4-intervall",ipv6:"IPv6-intervall",cidrv4:"IPv4-spektrum",cidrv6:"IPv6-spektrum",base64:"base64-kodad strng",base64url:"base64url-kodad strng",json_string:"JSON-strng",e164:"E.164-nummer",jwt:"JWT",template_literal:"mall-literal"},i={nan:"NaN",number:"antal",array:"lista"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`Ogiltig inmatning: frvntat instanceof ${r.expected}, fick ${a}`:`Ogiltig inmatning: frvntat ${o}, fick ${a}`}case"invalid_value":return r.values.length===1?`Ogiltig inmatning: frvntat ${Ve(r.values[0])}`:`Ogiltigt val: frvntade en av ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?`Fr stor(t): frvntade ${r.origin??"vrdet"} att ha ${o}${r.maximum.toString()} ${s.unit??"element"}`:`Fr stor(t): frvntat ${r.origin??"vrdet"} att ha ${o}${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?`Fr lite(t): frvntade ${r.origin??"vrdet"} att ha ${o}${r.minimum.toString()} ${s.unit}`:`Fr lite(t): frvntade ${r.origin??"vrdet"} att ha ${o}${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?`Ogiltig strng: mste brja med "${o.prefix}"`:o.format==="ends_with"?`Ogiltig strng: mste sluta med "${o.suffix}"`:o.format==="includes"?`Ogiltig strng: mste innehlla "${o.includes}"`:o.format==="regex"?`Ogiltig strng: mste matcha mnstret "${o.pattern}"`:`Ogiltig(t) ${n[o.format]??r.format}`}case"not_multiple_of":return`Ogiltigt tal: mste vara en multipel av ${r.divisor}`;case"unrecognized_keys":return`${r.keys.length>1?"Oknda nycklar":"Oknd nyckel"}: ${ye(r.keys,", ")}`;case"invalid_key":return`Ogiltig nyckel i ${r.origin??"vrdet"}`;case"invalid_union":return"Ogiltig input";case"invalid_element":return`Ogiltigt vrde i ${r.origin??"vrdet"}`;default:return"Ogiltig input"}}};function l5(){return{localeError:c5()}}const u5=()=>{const e={string:{unit:"",verb:" "},file:{unit:"",verb:" "},array:{unit:"",verb:" "},set:{unit:"",verb:" "}};function t(r){return e[r]??null}const n={regex:"",email:" ",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO  ",date:"ISO ",time:"ISO ",duration:"ISO  ",ipv4:"IPv4 ",ipv6:"IPv6 ",cidrv4:"IPv4 ",cidrv6:"IPv6 ",base64:"base64-encoded ",base64url:"base64url-encoded ",json_string:"JSON ",e164:"E.164 ",jwt:"JWT",template_literal:"input"},i={nan:"NaN",number:"",array:"",null:""};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?` :  instanceof ${r.expected},  ${a}`:` :  ${o},  ${a}`}case"invalid_value":return r.values.length===1?` :  ${Ve(r.values[0])}`:` :  ${ye(r.values,"|")}  `;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?` :  ${r.origin??""} ${o}${r.maximum.toString()} ${s.unit??""}   `:` :  ${r.origin??""} ${o}${r.maximum.toString()}   `}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?` :  ${r.origin} ${o}${r.minimum.toString()} ${s.unit}   `:` :  ${r.origin} ${o}${r.minimum.toString()}   `}case"invalid_format":{const o=r;return o.format==="starts_with"?` : "${o.prefix}"   `:o.format==="ends_with"?` : "${o.suffix}"   `:o.format==="includes"?` : "${o.includes}"   `:o.format==="regex"?` : ${o.pattern}   `:` ${n[o.format]??r.format}`}case"not_multiple_of":return` : ${r.divisor}    `;case"unrecognized_keys":return`  ${r.keys.length>1?"":""}: ${ye(r.keys,", ")}`;case"invalid_key":return`${r.origin}   `;case"invalid_union":return" ";case"invalid_element":return`${r.origin}   `;default:return" "}}};function d5(){return{localeError:u5()}}const f5=()=>{const e={string:{unit:"",verb:""},file:{unit:"",verb:""},array:{unit:"",verb:""},set:{unit:"",verb:""}};function t(r){return e[r]??null}const n={regex:"",email:"",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:" ISO",date:" ISO",time:" ISO",duration:" ISO",ipv4:" IPv4",ipv6:" IPv6",cidrv4:" IP  IPv4",cidrv6:" IP  IPv6",base64:" Base64",base64url:" Base64  URL",json_string:" JSON",e164:" (E.164)",jwt:" JWT",template_literal:""},i={nan:"NaN",number:"",array:" (Array)",null:" (null)"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`:  instanceof ${r.expected}  ${a}`:`:  ${o}  ${a}`}case"invalid_value":return r.values.length===1?`:  ${Ve(r.values[0])}`:`:  ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"":"",s=t(r.origin);return s?`: ${r.origin??""} ${o} ${r.maximum.toString()} ${s.unit??""}`:`: ${r.origin??""} ${o} ${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?"":"",s=t(r.origin);return s?`: ${r.origin} ${o} ${r.minimum.toString()} ${s.unit}`:`: ${r.origin} ${o} ${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?`:  "${o.prefix}"`:o.format==="ends_with"?`:  "${o.suffix}"`:o.format==="includes"?`:  "${o.includes}" `:o.format==="regex"?`:  ${o.pattern}`:`: ${n[o.format]??r.format}`}case"not_multiple_of":return`:  ${r.divisor} `;case"unrecognized_keys":return`: ${ye(r.keys,", ")}`;case"invalid_key":return` ${r.origin}`;case"invalid_union":return": ";case"invalid_element":return` ${r.origin}`;default:return""}}};function p5(){return{localeError:f5()}}const h5=()=>{const e={string:{unit:"karakter",verb:"olmal"},file:{unit:"bayt",verb:"olmal"},array:{unit:"e",verb:"olmal"},set:{unit:"e",verb:"olmal"}};function t(r){return e[r]??null}const n={regex:"girdi",email:"e-posta adresi",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO tarih ve saat",date:"ISO tarih",time:"ISO saat",duration:"ISO sre",ipv4:"IPv4 adresi",ipv6:"IPv6 adresi",cidrv4:"IPv4 aral",cidrv6:"IPv6 aral",base64:"base64 ile ifrelenmi metin",base64url:"base64url ile ifrelenmi metin",json_string:"JSON dizesi",e164:"E.164 says",jwt:"JWT",template_literal:"ablon dizesi"},i={nan:"NaN"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`Geersiz deer: beklenen instanceof ${r.expected}, alnan ${a}`:`Geersiz deer: beklenen ${o}, alnan ${a}`}case"invalid_value":return r.values.length===1?`Geersiz deer: beklenen ${Ve(r.values[0])}`:`Geersiz seenek: aadakilerden biri olmal: ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?`ok byk: beklenen ${r.origin??"deer"} ${o}${r.maximum.toString()} ${s.unit??"e"}`:`ok byk: beklenen ${r.origin??"deer"} ${o}${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?`ok kk: beklenen ${r.origin} ${o}${r.minimum.toString()} ${s.unit}`:`ok kk: beklenen ${r.origin} ${o}${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?`Geersiz metin: "${o.prefix}" ile balamal`:o.format==="ends_with"?`Geersiz metin: "${o.suffix}" ile bitmeli`:o.format==="includes"?`Geersiz metin: "${o.includes}" iermeli`:o.format==="regex"?`Geersiz metin: ${o.pattern} desenine uymal`:`Geersiz ${n[o.format]??r.format}`}case"not_multiple_of":return`Geersiz say: ${r.divisor} ile tam blnebilmeli`;case"unrecognized_keys":return`Tannmayan anahtar${r.keys.length>1?"lar":""}: ${ye(r.keys,", ")}`;case"invalid_key":return`${r.origin} iinde geersiz anahtar`;case"invalid_union":return"Geersiz deer";case"invalid_element":return`${r.origin} iinde geersiz deer`;default:return"Geersiz deer"}}};function m5(){return{localeError:h5()}}const g5=()=>{const e={string:{unit:"",verb:""},file:{unit:"",verb:""},array:{unit:"",verb:""},set:{unit:"",verb:""}};function t(r){return e[r]??null}const n={regex:" ",email:"  ",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"   ISO",date:" ISO",time:" ISO",duration:" ISO",ipv4:" IPv4",ipv6:" IPv6",cidrv4:" IPv4",cidrv6:" IPv6",base64:"   base64",base64url:"   base64url",json_string:" JSON",e164:" E.164",jwt:"JWT",template_literal:" "},i={nan:"NaN",number:"",array:""};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`  :  instanceof ${r.expected},  ${a}`:`  :  ${o},  ${a}`}case"invalid_value":return r.values.length===1?`  :  ${Ve(r.values[0])}`:` :    ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?` : ,  ${r.origin??""} ${s.verb} ${o}${r.maximum.toString()} ${s.unit??""}`:` : ,  ${r.origin??""}  ${o}${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?` : ,  ${r.origin} ${s.verb} ${o}${r.minimum.toString()} ${s.unit}`:` : ,  ${r.origin}  ${o}${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?` :    "${o.prefix}"`:o.format==="ends_with"?` :    "${o.suffix}"`:o.format==="includes"?` :   "${o.includes}"`:o.format==="regex"?` :    ${o.pattern}`:` ${n[o.format]??r.format}`}case"not_multiple_of":return` :    ${r.divisor}`;case"unrecognized_keys":return` ${r.keys.length>1?"":""}: ${ye(r.keys,", ")}`;case"invalid_key":return`   ${r.origin}`;case"invalid_union":return"  ";case"invalid_element":return`   ${r.origin}`;default:return"  "}}};function E1(){return{localeError:g5()}}function y5(){return E1()}const w5=()=>{const e={string:{unit:"",verb:""},file:{unit:"",verb:""},array:{unit:"",verb:""},set:{unit:"",verb:""}};function t(r){return e[r]??null}const n={regex:" ",email:"  ",url:"  ",emoji:"",uuid:"   ",uuidv4:"     4",uuidv6:"     6",nanoid:"  ",guid:"   ",cuid:"   ",cuid2:"    2",ulid:"   ",xid:"  ",ksuid:"    ",datetime:"    ",date:"   ",time:"   ",duration:"   ",ipv4:"   4 ",ipv6:"   6 ",cidrv4:"   4 ",cidrv6:"   6 ",base64:" 64   ",base64url:" 64      ",json_string:"    ",e164:" 164 ",jwt:"  ",template_literal:" "},i={nan:"NaN",number:"",array:"",null:""};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`  : instanceof ${r.expected}   ${a}  `:`  : ${o}   ${a}  `}case"invalid_value":return r.values.length===1?`  : ${Ve(r.values[0])}  `:` : ${ye(r.values,"|")}     `;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?` : ${r.origin??""}  ${o}${r.maximum.toString()} ${s.unit??""}   `:` : ${r.origin??""}  ${o}${r.maximum.toString()}   `}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?` : ${r.origin}  ${o}${r.minimum.toString()} ${s.unit}   `:` : ${r.origin}  ${o}${r.minimum.toString()}   `}case"invalid_format":{const o=r;return o.format==="starts_with"?` : "${o.prefix}"    `:o.format==="ends_with"?` : "${o.suffix}"    `:o.format==="includes"?` : "${o.includes}"   `:o.format==="regex"?` :  ${o.pattern}    `:` ${n[o.format]??r.format}`}case"not_multiple_of":return` : ${r.divisor}    `;case"unrecognized_keys":return`   ${r.keys.length>1?"":""}: ${ye(r.keys," ")}`;case"invalid_key":return`${r.origin}   `;case"invalid_union":return"  ";case"invalid_element":return`${r.origin}   `;default:return"  "}}};function v5(){return{localeError:w5()}}const b5=()=>{const e={string:{unit:"belgi",verb:"bolishi kerak"},file:{unit:"bayt",verb:"bolishi kerak"},array:{unit:"element",verb:"bolishi kerak"},set:{unit:"element",verb:"bolishi kerak"}};function t(r){return e[r]??null}const n={regex:"kirish",email:"elektron pochta manzili",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO sana va vaqti",date:"ISO sana",time:"ISO vaqt",duration:"ISO davomiylik",ipv4:"IPv4 manzil",ipv6:"IPv6 manzil",mac:"MAC manzil",cidrv4:"IPv4 diapazon",cidrv6:"IPv6 diapazon",base64:"base64 kodlangan satr",base64url:"base64url kodlangan satr",json_string:"JSON satr",e164:"E.164 raqam",jwt:"JWT",template_literal:"kirish"},i={nan:"NaN",number:"raqam",array:"massiv"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`Notogri kirish: kutilgan instanceof ${r.expected}, qabul qilingan ${a}`:`Notogri kirish: kutilgan ${o}, qabul qilingan ${a}`}case"invalid_value":return r.values.length===1?`Notogri kirish: kutilgan ${Ve(r.values[0])}`:`Notogri variant: quyidagilardan biri kutilgan ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?`Juda katta: kutilgan ${r.origin??"qiymat"} ${o}${r.maximum.toString()} ${s.unit} ${s.verb}`:`Juda katta: kutilgan ${r.origin??"qiymat"} ${o}${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?`Juda kichik: kutilgan ${r.origin} ${o}${r.minimum.toString()} ${s.unit} ${s.verb}`:`Juda kichik: kutilgan ${r.origin} ${o}${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?`Notogri satr: "${o.prefix}" bilan boshlanishi kerak`:o.format==="ends_with"?`Notogri satr: "${o.suffix}" bilan tugashi kerak`:o.format==="includes"?`Notogri satr: "${o.includes}" ni oz ichiga olishi kerak`:o.format==="regex"?`Notogri satr: ${o.pattern} shabloniga mos kelishi kerak`:`Notogri ${n[o.format]??r.format}`}case"not_multiple_of":return`Notogri raqam: ${r.divisor} ning karralisi bolishi kerak`;case"unrecognized_keys":return`Nomalum kalit${r.keys.length>1?"lar":""}: ${ye(r.keys,", ")}`;case"invalid_key":return`${r.origin} dagi kalit notogri`;case"invalid_union":return"Notogri kirish";case"invalid_element":return`${r.origin} da notogri qiymat`;default:return"Notogri kirish"}}};function _5(){return{localeError:b5()}}const S5=()=>{const e={string:{unit:"k t",verb:"c"},file:{unit:"byte",verb:"c"},array:{unit:"phn t",verb:"c"},set:{unit:"phn t",verb:"c"}};function t(r){return e[r]??null}const n={regex:"u vo",email:"a ch email",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ngy gi ISO",date:"ngy ISO",time:"gi ISO",duration:"khong thi gian ISO",ipv4:"a ch IPv4",ipv6:"a ch IPv6",cidrv4:"di IPv4",cidrv6:"di IPv6",base64:"chui m ha base64",base64url:"chui m ha base64url",json_string:"chui JSON",e164:"s E.164",jwt:"JWT",template_literal:"u vo"},i={nan:"NaN",number:"s",array:"mng"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`u vo khng hp l: mong i instanceof ${r.expected}, nhn c ${a}`:`u vo khng hp l: mong i ${o}, nhn c ${a}`}case"invalid_value":return r.values.length===1?`u vo khng hp l: mong i ${Ve(r.values[0])}`:`Ty chn khng hp l: mong i mt trong cc gi tr ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?`Qu ln: mong i ${r.origin??"gi tr"} ${s.verb} ${o}${r.maximum.toString()} ${s.unit??"phn t"}`:`Qu ln: mong i ${r.origin??"gi tr"} ${o}${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?`Qu nh: mong i ${r.origin} ${s.verb} ${o}${r.minimum.toString()} ${s.unit}`:`Qu nh: mong i ${r.origin} ${o}${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?`Chui khng hp l: phi bt u bng "${o.prefix}"`:o.format==="ends_with"?`Chui khng hp l: phi kt thc bng "${o.suffix}"`:o.format==="includes"?`Chui khng hp l: phi bao gm "${o.includes}"`:o.format==="regex"?`Chui khng hp l: phi khp vi mu ${o.pattern}`:`${n[o.format]??r.format} khng hp l`}case"not_multiple_of":return`S khng hp l: phi l bi s ca ${r.divisor}`;case"unrecognized_keys":return`Kha khng c nhn dng: ${ye(r.keys,", ")}`;case"invalid_key":return`Kha khng hp l trong ${r.origin}`;case"invalid_union":return"u vo khng hp l";case"invalid_element":return`Gi tr khng hp l trong ${r.origin}`;default:return"u vo khng hp l"}}};function x5(){return{localeError:S5()}}const k5=()=>{const e={string:{unit:"",verb:""},file:{unit:"",verb:""},array:{unit:"",verb:""},set:{unit:"",verb:""}};function t(r){return e[r]??null}const n={regex:"",email:"",url:"URL",emoji:"",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO",date:"ISO",time:"ISO",duration:"ISO",ipv4:"IPv4",ipv6:"IPv6",cidrv4:"IPv4",cidrv6:"IPv6",base64:"base64",base64url:"base64url",json_string:"JSON",e164:"E.164",jwt:"JWT",template_literal:""},i={nan:"NaN",number:"",array:"",null:"(null)"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?` instanceof ${r.expected} ${a}`:` ${o} ${a}`}case"invalid_value":return r.values.length===1?` ${Ve(r.values[0])}`:` ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?` ${r.origin??""} ${o}${r.maximum.toString()} ${s.unit??""}`:` ${r.origin??""} ${o}${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?` ${r.origin} ${o}${r.minimum.toString()} ${s.unit}`:` ${r.origin} ${o}${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?` "${o.prefix}" `:o.format==="ends_with"?` "${o.suffix}" `:o.format==="includes"?` "${o.includes}"`:o.format==="regex"?` ${o.pattern}`:`${n[o.format]??r.format}`}case"not_multiple_of":return` ${r.divisor} `;case"unrecognized_keys":return`(key): ${ye(r.keys,", ")}`;case"invalid_key":return`${r.origin} (key)`;case"invalid_union":return"";case"invalid_element":return`${r.origin} (value)`;default:return""}}};function E5(){return{localeError:k5()}}const A5=()=>{const e={string:{unit:"",verb:""},file:{unit:"",verb:""},array:{unit:"",verb:""},set:{unit:"",verb:""}};function t(r){return e[r]??null}const n={regex:"",email:"",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"ISO ",date:"ISO ",time:"ISO ",duration:"ISO ",ipv4:"IPv4 ",ipv6:"IPv6 ",cidrv4:"IPv4 ",cidrv6:"IPv6 ",base64:"base64 ",base64url:"base64url ",json_string:"JSON ",e164:"E.164 ",jwt:"JWT",template_literal:""},i={nan:"NaN"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?` instanceof ${r.expected} ${a}`:` ${o} ${a}`}case"invalid_value":return r.values.length===1?` ${Ve(r.values[0])}`:` ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?` ${r.origin??""}  ${o}${r.maximum.toString()} ${s.unit??""}`:` ${r.origin??""}  ${o}${r.maximum.toString()}`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?` ${r.origin}  ${o}${r.minimum.toString()} ${s.unit}`:` ${r.origin}  ${o}${r.minimum.toString()}`}case"invalid_format":{const o=r;return o.format==="starts_with"?` "${o.prefix}" `:o.format==="ends_with"?` "${o.suffix}" `:o.format==="includes"?` "${o.includes}"`:o.format==="regex"?` ${o.pattern}`:` ${n[o.format]??r.format}`}case"not_multiple_of":return` ${r.divisor} `;case"unrecognized_keys":return`${r.keys.length>1?"":""}${ye(r.keys,"")}`;case"invalid_key":return`${r.origin} `;case"invalid_union":return"";case"invalid_element":return`${r.origin} `;default:return""}}};function T5(){return{localeError:A5()}}const I5=()=>{const e={string:{unit:"mi",verb:"n"},file:{unit:"bytes",verb:"n"},array:{unit:"nkan",verb:"n"},set:{unit:"nkan",verb:"n"}};function t(r){return e[r]??null}const n={regex:"r bwl",email:"drs ml",url:"URL",emoji:"emoji",uuid:"UUID",uuidv4:"UUIDv4",uuidv6:"UUIDv6",nanoid:"nanoid",guid:"GUID",cuid:"cuid",cuid2:"cuid2",ulid:"ULID",xid:"XID",ksuid:"KSUID",datetime:"kk ISO",date:"j ISO",time:"kk ISO",duration:"kk t p ISO",ipv4:"drs IPv4",ipv6:"drs IPv6",cidrv4:"gbgb IPv4",cidrv6:"gbgb IPv6",base64:"r t a k n base64",base64url:"r base64url",json_string:"r JSON",e164:"nmb E.164",jwt:"JWT",template_literal:"r bwl"},i={nan:"NaN",number:"nmb",array:"akop"};return r=>{switch(r.code){case"invalid_type":{const o=i[r.expected]??r.expected,s=He(r.input),a=i[s]??s;return/^[A-Z]/.test(r.expected)?`bwl ae: a n lti fi instanceof ${r.expected}, m a r ${a}`:`bwl ae: a n lti fi ${o}, m a r ${a}`}case"invalid_value":return r.values.length===1?`bwl ae: a n lti fi ${Ve(r.values[0])}`:`yn ae: yan kan lra ${ye(r.values,"|")}`;case"too_big":{const o=r.inclusive?"<=":"<",s=t(r.origin);return s?`T p j: a n lti j p ${r.origin??"iye"} ${s.verb} ${o}${r.maximum} ${s.unit}`:`T p j: a n lti j ${o}${r.maximum}`}case"too_small":{const o=r.inclusive?">=":">",s=t(r.origin);return s?`Kr ju: a n lti j p ${r.origin} ${s.verb} ${o}${r.minimum} ${s.unit}`:`Kr ju: a n lti j ${o}${r.minimum}`}case"invalid_format":{const o=r;return o.format==="starts_with"?`r ae: gbd br pl "${o.prefix}"`:o.format==="ends_with"?`r ae: gbd par pl "${o.suffix}"`:o.format==="includes"?`r ae: gbd n "${o.includes}"`:o.format==="regex"?`r ae: gbd b pr mu ${o.pattern}`:`Ae: ${n[o.format]??r.format}`}case"not_multiple_of":return`Nmb ae: gbd j y ppn ti ${r.divisor}`;case"unrecognized_keys":return`Btn m: ${ye(r.keys,", ")}`;case"invalid_key":return`Btn ae nn ${r.origin}`;case"invalid_union":return"bwl ae";case"invalid_element":return`Iye ae nn ${r.origin}`;default:return"bwl ae"}}};function N5(){return{localeError:I5()}}const vw=Object.freeze(Object.defineProperty({__proto__:null,ar:Hj,az:Jj,be:Zj,bg:Yj,ca:e4,cs:n4,da:i4,de:s4,en:x1,eo:l4,es:d4,fa:p4,fi:m4,fr:y4,frCA:v4,he:_4,hu:x4,hy:E4,id:T4,is:N4,it:C4,ja:R4,ka:D4,kh:L4,km:k1,ko:j4,lt:B4,mk:W4,ms:q4,nl:K4,no:G4,ota:Q4,pl:t5,ps:X4,pt:r5,ru:o5,sl:a5,sv:l5,ta:d5,th:p5,tr:m5,ua:y5,uk:E1,ur:v5,uz:_5,vi:x5,yo:N5,zhCN:E5,zhTW:T5},Symbol.toStringTag,{value:"Module"}));var R_;const bw=Symbol("ZodOutput"),_w=Symbol("ZodInput");class A1{constructor(){this._map=new WeakMap,this._idmap=new Map}add(t,...n){const i=n[0];return this._map.set(t,i),i&&typeof i=="object"&&"id"in i&&this._idmap.set(i.id,t),this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(t){const n=this._map.get(t);return n&&typeof n=="object"&&"id"in n&&this._idmap.delete(n.id),this._map.delete(t),this}get(t){const n=t._zod.parent;if(n){const i={...this.get(n)??{}};delete i.id;const r={...i,...this._map.get(t)};return Object.keys(r).length?r:void 0}return this._map.get(t)}has(t){return this._map.has(t)}}function gp(){return new A1}(R_=globalThis).__zod_globalRegistry??(R_.__zod_globalRegistry=gp());const zr=globalThis.__zod_globalRegistry;function T1(e,t){return new e({type:"string",...ue(t)})}function I1(e,t){return new e({type:"string",coerce:!0,...ue(t)})}function Sw(e,t){return new e({type:"string",format:"email",check:"string_format",abort:!1,...ue(t)})}function gf(e,t){return new e({type:"string",format:"guid",check:"string_format",abort:!1,...ue(t)})}function xw(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,...ue(t)})}function kw(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...ue(t)})}function Ew(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...ue(t)})}function Aw(e,t){return new e({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...ue(t)})}function yp(e,t){return new e({type:"string",format:"url",check:"string_format",abort:!1,...ue(t)})}function Tw(e,t){return new e({type:"string",format:"emoji",check:"string_format",abort:!1,...ue(t)})}function Iw(e,t){return new e({type:"string",format:"nanoid",check:"string_format",abort:!1,...ue(t)})}function Nw(e,t){return new e({type:"string",format:"cuid",check:"string_format",abort:!1,...ue(t)})}function $w(e,t){return new e({type:"string",format:"cuid2",check:"string_format",abort:!1,...ue(t)})}function Cw(e,t){return new e({type:"string",format:"ulid",check:"string_format",abort:!1,...ue(t)})}function Ow(e,t){return new e({type:"string",format:"xid",check:"string_format",abort:!1,...ue(t)})}function Rw(e,t){return new e({type:"string",format:"ksuid",check:"string_format",abort:!1,...ue(t)})}function Pw(e,t){return new e({type:"string",format:"ipv4",check:"string_format",abort:!1,...ue(t)})}function Dw(e,t){return new e({type:"string",format:"ipv6",check:"string_format",abort:!1,...ue(t)})}function N1(e,t){return new e({type:"string",format:"mac",check:"string_format",abort:!1,...ue(t)})}function Uw(e,t){return new e({type:"string",format:"cidrv4",check:"string_format",abort:!1,...ue(t)})}function Lw(e,t){return new e({type:"string",format:"cidrv6",check:"string_format",abort:!1,...ue(t)})}function Mw(e,t){return new e({type:"string",format:"base64",check:"string_format",abort:!1,...ue(t)})}function jw(e,t){return new e({type:"string",format:"base64url",check:"string_format",abort:!1,...ue(t)})}function zw(e,t){return new e({type:"string",format:"e164",check:"string_format",abort:!1,...ue(t)})}function Bw(e,t){return new e({type:"string",format:"jwt",check:"string_format",abort:!1,...ue(t)})}const Fw={Any:null,Minute:-1,Second:0,Millisecond:3,Microsecond:6};function $1(e,t){return new e({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...ue(t)})}function C1(e,t){return new e({type:"string",format:"date",check:"string_format",...ue(t)})}function O1(e,t){return new e({type:"string",format:"time",check:"string_format",precision:null,...ue(t)})}function R1(e,t){return new e({type:"string",format:"duration",check:"string_format",...ue(t)})}function P1(e,t){return new e({type:"number",checks:[],...ue(t)})}function D1(e,t){return new e({type:"number",coerce:!0,checks:[],...ue(t)})}function U1(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"safeint",...ue(t)})}function L1(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"float32",...ue(t)})}function M1(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"float64",...ue(t)})}function j1(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"int32",...ue(t)})}function z1(e,t){return new e({type:"number",check:"number_format",abort:!1,format:"uint32",...ue(t)})}function B1(e,t){return new e({type:"boolean",...ue(t)})}function F1(e,t){return new e({type:"boolean",coerce:!0,...ue(t)})}function W1(e,t){return new e({type:"bigint",...ue(t)})}function V1(e,t){return new e({type:"bigint",coerce:!0,...ue(t)})}function q1(e,t){return new e({type:"bigint",check:"bigint_format",abort:!1,format:"int64",...ue(t)})}function H1(e,t){return new e({type:"bigint",check:"bigint_format",abort:!1,format:"uint64",...ue(t)})}function K1(e,t){return new e({type:"symbol",...ue(t)})}function J1(e,t){return new e({type:"undefined",...ue(t)})}function G1(e,t){return new e({type:"null",...ue(t)})}function Z1(e){return new e({type:"any"})}function Q1(e){return new e({type:"unknown"})}function Y1(e,t){return new e({type:"never",...ue(t)})}function X1(e,t){return new e({type:"void",...ue(t)})}function eI(e,t){return new e({type:"date",...ue(t)})}function tI(e,t){return new e({type:"date",coerce:!0,...ue(t)})}function nI(e,t){return new e({type:"nan",...ue(t)})}function ho(e,t){return new uw({check:"less_than",...ue(t),value:e,inclusive:!1})}function Br(e,t){return new uw({check:"less_than",...ue(t),value:e,inclusive:!0})}function mo(e,t){return new dw({check:"greater_than",...ue(t),value:e,inclusive:!1})}function ur(e,t){return new dw({check:"greater_than",...ue(t),value:e,inclusive:!0})}function wp(e){return mo(0,e)}function vp(e){return ho(0,e)}function bp(e){return Br(0,e)}function _p(e){return ur(0,e)}function Us(e,t){return new VA({check:"multiple_of",...ue(t),value:e})}function Gs(e,t){return new KA({check:"max_size",...ue(t),maximum:e})}function go(e,t){return new JA({check:"min_size",...ue(t),minimum:e})}function oc(e,t){return new GA({check:"size_equals",...ue(t),size:e})}function sc(e,t){return new ZA({check:"max_length",...ue(t),maximum:e})}function Xo(e,t){return new QA({check:"min_length",...ue(t),minimum:e})}function ac(e,t){return new YA({check:"length_equals",...ue(t),length:e})}function Yl(e,t){return new XA({check:"string_format",format:"regex",...ue(t),pattern:e})}function Xl(e){return new eT({check:"string_format",format:"lowercase",...ue(e)})}function eu(e){return new tT({check:"string_format",format:"uppercase",...ue(e)})}function tu(e,t){return new nT({check:"string_format",format:"includes",...ue(t),includes:e})}function nu(e,t){return new rT({check:"string_format",format:"starts_with",...ue(t),prefix:e})}function ru(e,t){return new iT({check:"string_format",format:"ends_with",...ue(t),suffix:e})}function Sp(e,t,n){return new oT({check:"property",property:e,schema:t,...ue(n)})}function iu(e,t){return new sT({check:"mime_type",mime:e,...ue(t)})}function Fi(e){return new aT({check:"overwrite",tx:e})}function ou(e){return Fi(t=>t.normalize(e))}function su(){return Fi(e=>e.trim())}function au(){return Fi(e=>e.toLowerCase())}function cu(){return Fi(e=>e.toUpperCase())}function lu(){return Fi(e=>VE(e))}function rI(e,t,n){return new e({type:"array",element:t,...ue(n)})}function $5(e,t,n){return new e({type:"union",options:t,...ue(n)})}function C5(e,t,n){return new e({type:"union",options:t,inclusive:!1,...ue(n)})}function O5(e,t,n,i){return new e({type:"union",options:n,discriminator:t,...ue(i)})}function R5(e,t,n){return new e({type:"intersection",left:t,right:n})}function P5(e,t,n,i){const r=n instanceof Xe,o=r?i:n,s=r?n:null;return new e({type:"tuple",items:t,rest:s,...ue(o)})}function D5(e,t,n,i){return new e({type:"record",keyType:t,valueType:n,...ue(i)})}function U5(e,t,n,i){return new e({type:"map",keyType:t,valueType:n,...ue(i)})}function L5(e,t,n){return new e({type:"set",valueType:t,...ue(n)})}function M5(e,t,n){const i=Array.isArray(t)?Object.fromEntries(t.map(r=>[r,r])):t;return new e({type:"enum",entries:i,...ue(n)})}function j5(e,t,n){return new e({type:"enum",entries:t,...ue(n)})}function z5(e,t,n){return new e({type:"literal",values:Array.isArray(t)?t:[t],...ue(n)})}function iI(e,t){return new e({type:"file",...ue(t)})}function B5(e,t){return new e({type:"transform",transform:t})}function F5(e,t){return new e({type:"optional",innerType:t})}function W5(e,t){return new e({type:"nullable",innerType:t})}function V5(e,t,n){return new e({type:"default",innerType:t,get defaultValue(){return typeof n=="function"?n():lp(n)}})}function q5(e,t,n){return new e({type:"nonoptional",innerType:t,...ue(n)})}function H5(e,t){return new e({type:"success",innerType:t})}function K5(e,t,n){return new e({type:"catch",innerType:t,catchValue:typeof n=="function"?n:()=>n})}function J5(e,t,n){return new e({type:"pipe",in:t,out:n})}function G5(e,t){return new e({type:"readonly",innerType:t})}function Z5(e,t,n){return new e({type:"template_literal",parts:t,...ue(n)})}function Q5(e,t){return new e({type:"lazy",getter:t})}function Y5(e,t){return new e({type:"promise",innerType:t})}function oI(e,t,n){const i=ue(n);return i.abort??(i.abort=!0),new e({type:"custom",check:"custom",fn:t,...i})}function sI(e,t,n){return new e({type:"custom",check:"custom",fn:t,...ue(n)})}function aI(e){const t=cI(n=>(n.addIssue=i=>{if(typeof i=="string")n.issues.push(Ma(i,n.value,t._zod.def));else{const r=i;r.fatal&&(r.continue=!1),r.code??(r.code="custom"),r.input??(r.input=n.value),r.inst??(r.inst=t),r.continue??(r.continue=!t._zod.def.abort),n.issues.push(Ma(r))}},e(n.value,n)));return t}function cI(e,t){const n=new pn({check:"custom",...ue(t)});return n._zod.check=e,n}function lI(e){const t=new pn({check:"describe"});return t._zod.onattach=[n=>{const i=zr.get(n)??{};zr.add(n,{...i,description:e})}],t._zod.check=()=>{},t}function uI(e){const t=new pn({check:"meta"});return t._zod.onattach=[n=>{const i=zr.get(n)??{};zr.add(n,{...i,...e})}],t._zod.check=()=>{},t}function dI(e,t){const n=ue(t);let i=n.truthy??["true","1","yes","on","y","enabled"],r=n.falsy??["false","0","no","off","n","disabled"];n.case!=="sensitive"&&(i=i.map(g=>typeof g=="string"?g.toLowerCase():g),r=r.map(g=>typeof g=="string"?g.toLowerCase():g));const o=new Set(i),s=new Set(r),a=e.Codec??ww,c=e.Boolean??hw,l=e.String??Ql,u=new l({type:"string",error:n.error}),p=new c({type:"boolean",error:n.error}),f=new a({type:"pipe",in:u,out:p,transform:((g,h)=>{let d=g;return n.case!=="sensitive"&&(d=d.toLowerCase()),o.has(d)?!0:s.has(d)?!1:(h.issues.push({code:"invalid_value",expected:"stringbool",values:[...o,...s],input:h.value,inst:f,continue:!1}),{})}),reverseTransform:((g,h)=>g===!0?i[0]||"true":r[0]||"false"),error:n.error});return f}function uu(e,t,n,i={}){const r=ue(i),o={...ue(i),check:"string_format",type:"string",format:t,fn:typeof n=="function"?n:a=>n.test(a),...r};return n instanceof RegExp&&(o.pattern=n),new e(o)}function za(e){let t=e?.target??"draft-2020-12";return t==="draft-4"&&(t="draft-04"),t==="draft-7"&&(t="draft-07"),{processors:e.processors??{},metadataRegistry:e?.metadata??zr,target:t,unrepresentable:e?.unrepresentable??"throw",override:e?.override??(()=>{}),io:e?.io??"output",counter:0,seen:new Map,cycles:e?.cycles??"ref",reused:e?.reused??"inline",external:e?.external??void 0}}function Ht(e,t,n={path:[],schemaPath:[]}){var i;const r=e._zod.def,o=t.seen.get(e);if(o)return o.count++,n.schemaPath.includes(e)&&(o.cycle=n.path),o.schema;const s={schema:{},count:1,cycle:void 0,path:n.path};t.seen.set(e,s);const a=e._zod.toJSONSchema?.();if(a)s.schema=a;else{const u={...n,schemaPath:[...n.schemaPath,e],path:n.path};if(e._zod.processJSONSchema)e._zod.processJSONSchema(t,s.schema,u);else{const f=s.schema,g=t.processors[r.type];if(!g)throw new Error(`[toJSONSchema]: Non-representable type encountered: ${r.type}`);g(e,t,f,u)}const p=e._zod.parent;p&&(s.ref||(s.ref=p),Ht(p,t,u),t.seen.get(p).isParent=!0)}const c=t.metadataRegistry.get(e);return c&&Object.assign(s.schema,c),t.io==="input"&&lr(e)&&(delete s.schema.examples,delete s.schema.default),t.io==="input"&&s.schema._prefault&&((i=s.schema).default??(i.default=s.schema._prefault)),delete s.schema._prefault,t.seen.get(e).schema}function Ba(e,t){const n=e.seen.get(t);if(!n)throw new Error("Unprocessed schema. This is a bug in Zod.");const i=new Map;for(const s of e.seen.entries()){const a=e.metadataRegistry.get(s[0])?.id;if(a){const c=i.get(a);if(c&&c!==s[0])throw new Error(`Duplicate schema id "${a}" detected during JSON Schema conversion. Two different schemas cannot share the same id when converted together.`);i.set(a,s[0])}}const r=s=>{const a=e.target==="draft-2020-12"?"$defs":"definitions";if(e.external){const p=e.external.registry.get(s[0])?.id,f=e.external.uri??(h=>h);if(p)return{ref:f(p)};const g=s[1].defId??s[1].schema.id??`schema${e.counter++}`;return s[1].defId=g,{defId:g,ref:`${f("__shared")}#/${a}/${g}`}}if(s[1]===n)return{ref:"#"};const l=`#/${a}/`,u=s[1].schema.id??`__schema${e.counter++}`;return{defId:u,ref:l+u}},o=s=>{if(s[1].schema.$ref)return;const a=s[1],{ref:c,defId:l}=r(s);a.def={...a.schema},l&&(a.defId=l);const u=a.schema;for(const p in u)delete u[p];u.$ref=c};if(e.cycles==="throw")for(const s of e.seen.entries()){const a=s[1];if(a.cycle)throw new Error(`Cycle detected: #/${a.cycle?.join("/")}/<root>

Set the \`cycles\` parameter to \`"ref"\` to resolve cyclical schemas with defs.`)}for(const s of e.seen.entries()){const a=s[1];if(t===s[0]){o(s);continue}if(e.external){const l=e.external.registry.get(s[0])?.id;if(t!==s[0]&&l){o(s);continue}}if(e.metadataRegistry.get(s[0])?.id){o(s);continue}if(a.cycle){o(s);continue}if(a.count>1&&e.reused==="ref"){o(s);continue}}}function Fa(e,t){const n=e.seen.get(t);if(!n)throw new Error("Unprocessed schema. This is a bug in Zod.");const i=s=>{const a=e.seen.get(s);if(a.ref===null)return;const c=a.def??a.schema,l={...c},u=a.ref;if(a.ref=null,u){i(u);const f=e.seen.get(u),g=f.schema;if(g.$ref&&(e.target==="draft-07"||e.target==="draft-04"||e.target==="openapi-3.0")?(c.allOf=c.allOf??[],c.allOf.push(g)):Object.assign(c,g),Object.assign(c,l),s._zod.parent===u)for(const d in c)d==="$ref"||d==="allOf"||d in l||delete c[d];if(g.$ref&&f.def)for(const d in c)d==="$ref"||d==="allOf"||d in f.def&&JSON.stringify(c[d])===JSON.stringify(f.def[d])&&delete c[d]}const p=s._zod.parent;if(p&&p!==u){i(p);const f=e.seen.get(p);if(f?.schema.$ref&&(c.$ref=f.schema.$ref,f.def))for(const g in c)g==="$ref"||g==="allOf"||g in f.def&&JSON.stringify(c[g])===JSON.stringify(f.def[g])&&delete c[g]}e.override({zodSchema:s,jsonSchema:c,path:a.path??[]})};for(const s of[...e.seen.entries()].reverse())i(s[0]);const r={};if(e.target==="draft-2020-12"?r.$schema="https://json-schema.org/draft/2020-12/schema":e.target==="draft-07"?r.$schema="http://json-schema.org/draft-07/schema#":e.target==="draft-04"?r.$schema="http://json-schema.org/draft-04/schema#":e.target,e.external?.uri){const s=e.external.registry.get(t)?.id;if(!s)throw new Error("Schema is missing an `id` property");r.$id=e.external.uri(s)}Object.assign(r,n.def??n.schema);const o=e.external?.defs??{};for(const s of e.seen.entries()){const a=s[1];a.def&&a.defId&&(o[a.defId]=a.def)}e.external||Object.keys(o).length>0&&(e.target==="draft-2020-12"?r.$defs=o:r.definitions=o);try{const s=JSON.parse(JSON.stringify(r));return Object.defineProperty(s,"~standard",{value:{...t["~standard"],jsonSchema:{input:Sl(t,"input",e.processors),output:Sl(t,"output",e.processors)}},enumerable:!1,writable:!1}),s}catch{throw new Error("Error converting schema to JSON.")}}function lr(e,t){const n=t??{seen:new Set};if(n.seen.has(e))return!1;n.seen.add(e);const i=e._zod.def;if(i.type==="transform")return!0;if(i.type==="array")return lr(i.element,n);if(i.type==="set")return lr(i.valueType,n);if(i.type==="lazy")return lr(i.getter(),n);if(i.type==="promise"||i.type==="optional"||i.type==="nonoptional"||i.type==="nullable"||i.type==="readonly"||i.type==="default"||i.type==="prefault")return lr(i.innerType,n);if(i.type==="intersection")return lr(i.left,n)||lr(i.right,n);if(i.type==="record"||i.type==="map")return lr(i.keyType,n)||lr(i.valueType,n);if(i.type==="pipe")return lr(i.in,n)||lr(i.out,n);if(i.type==="object"){for(const r in i.shape)if(lr(i.shape[r],n))return!0;return!1}if(i.type==="union"){for(const r of i.options)if(lr(r,n))return!0;return!1}if(i.type==="tuple"){for(const r of i.items)if(lr(r,n))return!0;return!!(i.rest&&lr(i.rest,n))}return!1}const fI=(e,t={})=>n=>{const i=za({...n,processors:t});return Ht(e,i),Ba(i,e),Fa(i,e)},Sl=(e,t,n={})=>i=>{const{libraryOptions:r,target:o}=i??{},s=za({...r??{},target:o,io:t,processors:n});return Ht(e,s),Ba(s,e),Fa(s,e)},X5={guid:"uuid",url:"uri",datetime:"date-time",json_string:"json-string",regex:""},pI=(e,t,n,i)=>{const r=n;r.type="string";const{minimum:o,maximum:s,format:a,patterns:c,contentEncoding:l}=e._zod.bag;if(typeof o=="number"&&(r.minLength=o),typeof s=="number"&&(r.maxLength=s),a&&(r.format=X5[a]??a,r.format===""&&delete r.format,a==="time"&&delete r.format),l&&(r.contentEncoding=l),c&&c.size>0){const u=[...c];u.length===1?r.pattern=u[0].source:u.length>1&&(r.allOf=[...u.map(p=>({...t.target==="draft-07"||t.target==="draft-04"||t.target==="openapi-3.0"?{type:"string"}:{},pattern:p.source}))])}},hI=(e,t,n,i)=>{const r=n,{minimum:o,maximum:s,format:a,multipleOf:c,exclusiveMaximum:l,exclusiveMinimum:u}=e._zod.bag;typeof a=="string"&&a.includes("int")?r.type="integer":r.type="number",typeof u=="number"&&(t.target==="draft-04"||t.target==="openapi-3.0"?(r.minimum=u,r.exclusiveMinimum=!0):r.exclusiveMinimum=u),typeof o=="number"&&(r.minimum=o,typeof u=="number"&&t.target!=="draft-04"&&(u>=o?delete r.minimum:delete r.exclusiveMinimum)),typeof l=="number"&&(t.target==="draft-04"||t.target==="openapi-3.0"?(r.maximum=l,r.exclusiveMaximum=!0):r.exclusiveMaximum=l),typeof s=="number"&&(r.maximum=s,typeof l=="number"&&t.target!=="draft-04"&&(l<=s?delete r.maximum:delete r.exclusiveMaximum)),typeof c=="number"&&(r.multipleOf=c)},mI=(e,t,n,i)=>{n.type="boolean"},gI=(e,t,n,i)=>{if(t.unrepresentable==="throw")throw new Error("BigInt cannot be represented in JSON Schema")},yI=(e,t,n,i)=>{if(t.unrepresentable==="throw")throw new Error("Symbols cannot be represented in JSON Schema")},wI=(e,t,n,i)=>{t.target==="openapi-3.0"?(n.type="string",n.nullable=!0,n.enum=[null]):n.type="null"},vI=(e,t,n,i)=>{if(t.unrepresentable==="throw")throw new Error("Undefined cannot be represented in JSON Schema")},bI=(e,t,n,i)=>{if(t.unrepresentable==="throw")throw new Error("Void cannot be represented in JSON Schema")},_I=(e,t,n,i)=>{n.not={}},SI=(e,t,n,i)=>{},xI=(e,t,n,i)=>{},kI=(e,t,n,i)=>{if(t.unrepresentable==="throw")throw new Error("Date cannot be represented in JSON Schema")},EI=(e,t,n,i)=>{const r=e._zod.def,o=Jy(r.entries);o.every(s=>typeof s=="number")&&(n.type="number"),o.every(s=>typeof s=="string")&&(n.type="string"),n.enum=o},AI=(e,t,n,i)=>{const r=e._zod.def,o=[];for(const s of r.values)if(s===void 0){if(t.unrepresentable==="throw")throw new Error("Literal `undefined` cannot be represented in JSON Schema")}else if(typeof s=="bigint"){if(t.unrepresentable==="throw")throw new Error("BigInt literals cannot be represented in JSON Schema");o.push(Number(s))}else o.push(s);if(o.length!==0)if(o.length===1){const s=o[0];n.type=s===null?"null":typeof s,t.target==="draft-04"||t.target==="openapi-3.0"?n.enum=[s]:n.const=s}else o.every(s=>typeof s=="number")&&(n.type="number"),o.every(s=>typeof s=="string")&&(n.type="string"),o.every(s=>typeof s=="boolean")&&(n.type="boolean"),o.every(s=>s===null)&&(n.type="null"),n.enum=o},TI=(e,t,n,i)=>{if(t.unrepresentable==="throw")throw new Error("NaN cannot be represented in JSON Schema")},II=(e,t,n,i)=>{const r=n,o=e._zod.pattern;if(!o)throw new Error("Pattern not found in template literal");r.type="string",r.pattern=o.source},NI=(e,t,n,i)=>{const r=n,o={type:"string",format:"binary",contentEncoding:"binary"},{minimum:s,maximum:a,mime:c}=e._zod.bag;s!==void 0&&(o.minLength=s),a!==void 0&&(o.maxLength=a),c?c.length===1?(o.contentMediaType=c[0],Object.assign(r,o)):(Object.assign(r,o),r.anyOf=c.map(l=>({contentMediaType:l}))):Object.assign(r,o)},$I=(e,t,n,i)=>{n.type="boolean"},CI=(e,t,n,i)=>{if(t.unrepresentable==="throw")throw new Error("Custom types cannot be represented in JSON Schema")},OI=(e,t,n,i)=>{if(t.unrepresentable==="throw")throw new Error("Function types cannot be represented in JSON Schema")},RI=(e,t,n,i)=>{if(t.unrepresentable==="throw")throw new Error("Transforms cannot be represented in JSON Schema")},PI=(e,t,n,i)=>{if(t.unrepresentable==="throw")throw new Error("Map cannot be represented in JSON Schema")},DI=(e,t,n,i)=>{if(t.unrepresentable==="throw")throw new Error("Set cannot be represented in JSON Schema")},UI=(e,t,n,i)=>{const r=n,o=e._zod.def,{minimum:s,maximum:a}=e._zod.bag;typeof s=="number"&&(r.minItems=s),typeof a=="number"&&(r.maxItems=a),r.type="array",r.items=Ht(o.element,t,{...i,path:[...i.path,"items"]})},LI=(e,t,n,i)=>{const r=n,o=e._zod.def;r.type="object",r.properties={};const s=o.shape;for(const l in s)r.properties[l]=Ht(s[l],t,{...i,path:[...i.path,"properties",l]});const a=new Set(Object.keys(s)),c=new Set([...a].filter(l=>{const u=o.shape[l]._zod;return t.io==="input"?u.optin===void 0:u.optout===void 0}));c.size>0&&(r.required=Array.from(c)),o.catchall?._zod.def.type==="never"?r.additionalProperties=!1:o.catchall?o.catchall&&(r.additionalProperties=Ht(o.catchall,t,{...i,path:[...i.path,"additionalProperties"]})):t.io==="output"&&(r.additionalProperties=!1)},Ww=(e,t,n,i)=>{const r=e._zod.def,o=r.inclusive===!1,s=r.options.map((a,c)=>Ht(a,t,{...i,path:[...i.path,o?"oneOf":"anyOf",c]}));o?n.oneOf=s:n.anyOf=s},MI=(e,t,n,i)=>{const r=e._zod.def,o=Ht(r.left,t,{...i,path:[...i.path,"allOf",0]}),s=Ht(r.right,t,{...i,path:[...i.path,"allOf",1]}),a=l=>"allOf"in l&&Object.keys(l).length===1,c=[...a(o)?o.allOf:[o],...a(s)?s.allOf:[s]];n.allOf=c},jI=(e,t,n,i)=>{const r=n,o=e._zod.def;r.type="array";const s=t.target==="draft-2020-12"?"prefixItems":"items",a=t.target==="draft-2020-12"||t.target==="openapi-3.0"?"items":"additionalItems",c=o.items.map((f,g)=>Ht(f,t,{...i,path:[...i.path,s,g]})),l=o.rest?Ht(o.rest,t,{...i,path:[...i.path,a,...t.target==="openapi-3.0"?[o.items.length]:[]]}):null;t.target==="draft-2020-12"?(r.prefixItems=c,l&&(r.items=l)):t.target==="openapi-3.0"?(r.items={anyOf:c},l&&r.items.anyOf.push(l),r.minItems=c.length,l||(r.maxItems=c.length)):(r.items=c,l&&(r.additionalItems=l));const{minimum:u,maximum:p}=e._zod.bag;typeof u=="number"&&(r.minItems=u),typeof p=="number"&&(r.maxItems=p)},zI=(e,t,n,i)=>{const r=n,o=e._zod.def;r.type="object";const s=o.keyType,c=s._zod.bag?.patterns;if(o.mode==="loose"&&c&&c.size>0){const u=Ht(o.valueType,t,{...i,path:[...i.path,"patternProperties","*"]});r.patternProperties={};for(const p of c)r.patternProperties[p.source]=u}else(t.target==="draft-07"||t.target==="draft-2020-12")&&(r.propertyNames=Ht(o.keyType,t,{...i,path:[...i.path,"propertyNames"]})),r.additionalProperties=Ht(o.valueType,t,{...i,path:[...i.path,"additionalProperties"]});const l=s._zod.values;if(l){const u=[...l].filter(p=>typeof p=="string"||typeof p=="number");u.length>0&&(r.required=u)}},BI=(e,t,n,i)=>{const r=e._zod.def,o=Ht(r.innerType,t,i),s=t.seen.get(e);t.target==="openapi-3.0"?(s.ref=r.innerType,n.nullable=!0):n.anyOf=[o,{type:"null"}]},FI=(e,t,n,i)=>{const r=e._zod.def;Ht(r.innerType,t,i);const o=t.seen.get(e);o.ref=r.innerType},WI=(e,t,n,i)=>{const r=e._zod.def;Ht(r.innerType,t,i);const o=t.seen.get(e);o.ref=r.innerType,n.default=JSON.parse(JSON.stringify(r.defaultValue))},VI=(e,t,n,i)=>{const r=e._zod.def;Ht(r.innerType,t,i);const o=t.seen.get(e);o.ref=r.innerType,t.io==="input"&&(n._prefault=JSON.parse(JSON.stringify(r.defaultValue)))},qI=(e,t,n,i)=>{const r=e._zod.def;Ht(r.innerType,t,i);const o=t.seen.get(e);o.ref=r.innerType;let s;try{s=r.catchValue(void 0)}catch{throw new Error("Dynamic catch values are not supported in JSON Schema")}n.default=s},HI=(e,t,n,i)=>{const r=e._zod.def,o=t.io==="input"?r.in._zod.def.type==="transform"?r.out:r.in:r.out;Ht(o,t,i);const s=t.seen.get(e);s.ref=o},KI=(e,t,n,i)=>{const r=e._zod.def;Ht(r.innerType,t,i);const o=t.seen.get(e);o.ref=r.innerType,n.readOnly=!0},JI=(e,t,n,i)=>{const r=e._zod.def;Ht(r.innerType,t,i);const o=t.seen.get(e);o.ref=r.innerType},Vw=(e,t,n,i)=>{const r=e._zod.def;Ht(r.innerType,t,i);const o=t.seen.get(e);o.ref=r.innerType},GI=(e,t,n,i)=>{const r=e._zod.innerType;Ht(r,t,i);const o=t.seen.get(e);o.ref=r},Bg={string:pI,number:hI,boolean:mI,bigint:gI,symbol:yI,null:wI,undefined:vI,void:bI,never:_I,any:SI,unknown:xI,date:kI,enum:EI,literal:AI,nan:TI,template_literal:II,file:NI,success:$I,custom:CI,function:OI,transform:RI,map:PI,set:DI,array:UI,object:LI,union:Ww,intersection:MI,tuple:jI,record:zI,nullable:BI,nonoptional:FI,default:WI,prefault:VI,catch:qI,pipe:HI,readonly:KI,promise:JI,optional:Vw,lazy:GI};function xp(e,t){if("_idmap"in e){const i=e,r=za({...t,processors:Bg}),o={};for(const c of i._idmap.entries()){const[l,u]=c;Ht(u,r)}const s={},a={registry:i,uri:t?.uri,defs:o};r.external=a;for(const c of i._idmap.entries()){const[l,u]=c;Ba(r,u),s[l]=Fa(r,u)}if(Object.keys(o).length>0){const c=r.target==="draft-2020-12"?"$defs":"definitions";s.__shared={[c]:o}}return{schemas:s}}const n=za({...t,processors:Bg});return Ht(e,n),Ba(n,e),Fa(n,e)}class e6{get metadataRegistry(){return this.ctx.metadataRegistry}get target(){return this.ctx.target}get unrepresentable(){return this.ctx.unrepresentable}get override(){return this.ctx.override}get io(){return this.ctx.io}get counter(){return this.ctx.counter}set counter(t){this.ctx.counter=t}get seen(){return this.ctx.seen}constructor(t){let n=t?.target??"draft-2020-12";n==="draft-4"&&(n="draft-04"),n==="draft-7"&&(n="draft-07"),this.ctx=za({processors:Bg,target:n,...t?.metadata&&{metadata:t.metadata},...t?.unrepresentable&&{unrepresentable:t.unrepresentable},...t?.override&&{override:t.override},...t?.io&&{io:t.io}})}process(t,n={path:[],schemaPath:[]}){return Ht(t,this.ctx,n)}emit(t,n){n&&(n.cycles&&(this.ctx.cycles=n.cycles),n.reused&&(this.ctx.reused=n.reused),n.external&&(this.ctx.external=n.external)),Ba(this.ctx,t);const i=Fa(this.ctx,t),{"~standard":r,...o}=i;return o}}const t6=Object.freeze(Object.defineProperty({__proto__:null},Symbol.toStringTag,{value:"Module"})),ZI=Object.freeze(Object.defineProperty({__proto__:null,$ZodAny:FT,$ZodArray:KT,$ZodAsyncError:Ns,$ZodBase64:$T,$ZodBase64URL:OT,$ZodBigInt:mw,$ZodBigIntFormat:MT,$ZodBoolean:hw,$ZodCIDRv4:IT,$ZodCIDRv6:NT,$ZodCUID:gT,$ZodCUID2:yT,$ZodCatch:h1,$ZodCheck:pn,$ZodCheckBigIntFormat:HA,$ZodCheckEndsWith:iT,$ZodCheckGreaterThan:dw,$ZodCheckIncludes:nT,$ZodCheckLengthEquals:YA,$ZodCheckLessThan:uw,$ZodCheckLowerCase:eT,$ZodCheckMaxLength:ZA,$ZodCheckMaxSize:KA,$ZodCheckMimeType:sT,$ZodCheckMinLength:QA,$ZodCheckMinSize:JA,$ZodCheckMultipleOf:VA,$ZodCheckNumberFormat:qA,$ZodCheckOverwrite:aT,$ZodCheckProperty:oT,$ZodCheckRegex:XA,$ZodCheckSizeEquals:GA,$ZodCheckStartsWith:rT,$ZodCheckStringFormat:Zl,$ZodCheckUpperCase:tT,$ZodCodec:ww,$ZodCustom:S1,$ZodCustomStringFormat:UT,$ZodDate:HT,$ZodDefault:u1,$ZodDiscriminatedUnion:XT,$ZodE164:RT,$ZodEmail:fT,$ZodEmoji:hT,$ZodEncodeError:ap,$ZodEnum:i1,$ZodError:Qy,$ZodExactOptional:c1,$ZodFile:s1,$ZodFunction:v1,$ZodGUID:uT,$ZodIPv4:ET,$ZodIPv6:AT,$ZodISODate:ST,$ZodISODateTime:_T,$ZodISODuration:kT,$ZodISOTime:xT,$ZodIntersection:e1,$ZodJWT:DT,$ZodKSUID:bT,$ZodLazy:_1,$ZodLiteral:o1,$ZodMAC:TT,$ZodMap:n1,$ZodNaN:m1,$ZodNanoID:mT,$ZodNever:VT,$ZodNonOptional:f1,$ZodNull:BT,$ZodNullable:l1,$ZodNumber:pw,$ZodNumberFormat:LT,$ZodObject:ZT,$ZodObjectJIT:QT,$ZodOptional:yw,$ZodPipe:g1,$ZodPrefault:d1,$ZodPromise:b1,$ZodReadonly:y1,$ZodRealError:Kr,$ZodRecord:t1,$ZodRegistry:A1,$ZodSet:r1,$ZodString:Ql,$ZodStringFormat:Yt,$ZodSuccess:p1,$ZodSymbol:jT,$ZodTemplateLiteral:w1,$ZodTransform:a1,$ZodTuple:gw,$ZodType:Xe,$ZodULID:wT,$ZodURL:pT,$ZodUUID:dT,$ZodUndefined:zT,$ZodUnion:mp,$ZodUnknown:WT,$ZodVoid:qT,$ZodXID:vT,$ZodXor:YT,$brand:Ky,$constructor:Y,$input:_w,$output:bw,Doc:cT,JSONSchema:t6,JSONSchemaGenerator:e6,NEVER:Hy,TimePrecision:Fw,_any:Z1,_array:rI,_base64:Mw,_base64url:jw,_bigint:W1,_boolean:B1,_catch:K5,_check:cI,_cidrv4:Uw,_cidrv6:Lw,_coercedBigint:V1,_coercedBoolean:F1,_coercedDate:tI,_coercedNumber:D1,_coercedString:I1,_cuid:Nw,_cuid2:$w,_custom:oI,_date:eI,_decode:tw,_decodeAsync:rw,_default:V5,_discriminatedUnion:O5,_e164:zw,_email:Sw,_emoji:Tw,_encode:ew,_encodeAsync:nw,_endsWith:ru,_enum:M5,_file:iI,_float32:L1,_float64:M1,_gt:mo,_gte:ur,_guid:gf,_includes:tu,_int:U1,_int32:j1,_int64:q1,_intersection:R5,_ipv4:Pw,_ipv6:Dw,_isoDate:C1,_isoDateTime:$1,_isoDuration:R1,_isoTime:O1,_jwt:Bw,_ksuid:Rw,_lazy:Q5,_length:ac,_literal:z5,_lowercase:Xl,_lt:ho,_lte:Br,_mac:N1,_map:U5,_max:Br,_maxLength:sc,_maxSize:Gs,_mime:iu,_min:ur,_minLength:Xo,_minSize:go,_multipleOf:Us,_nan:nI,_nanoid:Iw,_nativeEnum:j5,_negative:vp,_never:Y1,_nonnegative:_p,_nonoptional:q5,_nonpositive:bp,_normalize:ou,_null:G1,_nullable:W5,_number:P1,_optional:F5,_overwrite:Fi,_parse:Vl,_parseAsync:ql,_pipe:J5,_positive:wp,_promise:Y5,_property:Sp,_readonly:G5,_record:D5,_refine:sI,_regex:Yl,_safeDecode:ow,_safeDecodeAsync:aw,_safeEncode:iw,_safeEncodeAsync:sw,_safeParse:Hl,_safeParseAsync:Kl,_set:L5,_size:oc,_slugify:lu,_startsWith:nu,_string:T1,_stringFormat:uu,_stringbool:dI,_success:H5,_superRefine:aI,_symbol:K1,_templateLiteral:Z5,_toLowerCase:au,_toUpperCase:cu,_transform:B5,_trim:su,_tuple:P5,_uint32:z1,_uint64:H1,_ulid:Cw,_undefined:J1,_union:$5,_unknown:Q1,_uppercase:eu,_url:yp,_uuid:xw,_uuidv4:kw,_uuidv6:Ew,_uuidv7:Aw,_void:X1,_xid:Ow,_xor:C5,clone:Hr,config:Gn,createStandardJSONSchemaMethod:Sl,createToJSONSchemaMethod:fI,decode:hj,decodeAsync:gj,describe:lI,encode:pj,encodeAsync:mj,extractDefs:Ba,finalize:Fa,flattenError:fp,formatError:pp,globalConfig:ff,globalRegistry:zr,initializeContext:za,isValidBase64:fw,isValidBase64URL:CT,isValidJWT:PT,locales:vw,meta:uI,parse:Mg,parseAsync:jg,prettifyError:Xy,process:Ht,regexes:hp,registry:gp,safeDecode:wj,safeDecodeAsync:bj,safeEncode:yj,safeEncodeAsync:vj,safeParse:aA,safeParseAsync:cA,toDotPath:sA,toJSONSchema:xp,treeifyError:Yy,util:Zy,version:lT},Symbol.toStringTag,{value:"Module"})),n6=Object.freeze(Object.defineProperty({__proto__:null,endsWith:ru,gt:mo,gte:ur,includes:tu,length:ac,lowercase:Xl,lt:ho,lte:Br,maxLength:sc,maxSize:Gs,mime:iu,minLength:Xo,minSize:go,multipleOf:Us,negative:vp,nonnegative:_p,nonpositive:bp,normalize:ou,overwrite:Fi,positive:wp,property:Sp,regex:Yl,size:oc,slugify:lu,startsWith:nu,toLowerCase:au,toUpperCase:cu,trim:su,uppercase:eu},Symbol.toStringTag,{value:"Module"})),kp=Y("ZodISODateTime",(e,t)=>{_T.init(e,t),Kt.init(e,t)});function QI(e){return $1(kp,e)}const Ep=Y("ZodISODate",(e,t)=>{ST.init(e,t),Kt.init(e,t)});function YI(e){return C1(Ep,e)}const Ap=Y("ZodISOTime",(e,t)=>{xT.init(e,t),Kt.init(e,t)});function XI(e){return O1(Ap,e)}const Tp=Y("ZodISODuration",(e,t)=>{kT.init(e,t),Kt.init(e,t)});function eN(e){return R1(Tp,e)}const qw=Object.freeze(Object.defineProperty({__proto__:null,ZodISODate:Ep,ZodISODateTime:kp,ZodISODuration:Tp,ZodISOTime:Ap,date:YI,datetime:QI,duration:eN,time:XI},Symbol.toStringTag,{value:"Module"})),tN=(e,t)=>{Qy.init(e,t),e.name="ZodError",Object.defineProperties(e,{format:{value:n=>pp(e,n)},flatten:{value:n=>fp(e,n)},addIssue:{value:n=>{e.issues.push(n),e.message=JSON.stringify(e.issues,pf,2)}},addIssues:{value:n=>{e.issues.push(...n),e.message=JSON.stringify(e.issues,pf,2)}},isEmpty:{get(){return e.issues.length===0}}})},nN=Y("ZodError",tN),xr=Y("ZodError",tN,{Parent:Error}),Hw=Vl(xr),Kw=ql(xr),Jw=Hl(xr),Ip=Kl(xr),Gw=ew(xr),Zw=tw(xr),Qw=nw(xr),Yw=rw(xr),Xw=iw(xr),ev=ow(xr),tv=sw(xr),nv=aw(xr),it=Y("ZodType",(e,t)=>(Xe.init(e,t),Object.assign(e["~standard"],{jsonSchema:{input:Sl(e,"input"),output:Sl(e,"output")}}),e.toJSONSchema=fI(e,{}),e.def=t,e.type=t.type,Object.defineProperty(e,"_def",{value:t}),e.check=(...n)=>e.clone(Bi(t,{checks:[...t.checks??[],...n.map(i=>typeof i=="function"?{_zod:{check:i,def:{check:"custom"},onattach:[]}}:i)]}),{parent:!0}),e.with=e.check,e.clone=(n,i)=>Hr(e,n,i),e.brand=()=>e,e.register=((n,i)=>(n.add(e,i),e)),e.parse=(n,i)=>Hw(e,n,i,{callee:e.parse}),e.safeParse=(n,i)=>Jw(e,n,i),e.parseAsync=async(n,i)=>Kw(e,n,i,{callee:e.parseAsync}),e.safeParseAsync=async(n,i)=>Ip(e,n,i),e.spa=e.safeParseAsync,e.encode=(n,i)=>Gw(e,n,i),e.decode=(n,i)=>Zw(e,n,i),e.encodeAsync=async(n,i)=>Qw(e,n,i),e.decodeAsync=async(n,i)=>Yw(e,n,i),e.safeEncode=(n,i)=>Xw(e,n,i),e.safeDecode=(n,i)=>ev(e,n,i),e.safeEncodeAsync=async(n,i)=>tv(e,n,i),e.safeDecodeAsync=async(n,i)=>nv(e,n,i),e.refine=(n,i)=>e.check(gh(n,i)),e.superRefine=n=>e.check(yh(n)),e.overwrite=n=>e.check(Fi(n)),e.optional=()=>wo(e),e.exactOptional=()=>Xp(e),e.nullable=()=>Va(e),e.nullish=()=>wo(Va(e)),e.nonoptional=n=>oh(e,n),e.array=()=>yt(e),e.or=n=>nn([e,n]),e.and=n=>Vp(e,n),e.transform=n=>qa(e,Ou(n)),e.default=n=>nh(e,n),e.prefault=n=>ih(e,n),e.catch=n=>ch(e,n),e.pipe=n=>qa(e,n),e.readonly=()=>dh(e),e.describe=n=>{const i=e.clone();return zr.add(i,{description:n}),i},Object.defineProperty(e,"description",{get(){return zr.get(e)?.description},configurable:!0}),e.meta=(...n)=>{if(n.length===0)return zr.get(e);const i=e.clone();return zr.add(i,n[0]),i},e.isOptional=()=>e.safeParse(void 0).success,e.isNullable=()=>e.safeParse(null).success,e.apply=n=>n(e),e)),du=Y("_ZodString",(e,t)=>{Ql.init(e,t),it.init(e,t),e._zod.processJSONSchema=(i,r,o)=>pI(e,i,r);const n=e._zod.bag;e.format=n.format??null,e.minLength=n.minimum??null,e.maxLength=n.maximum??null,e.regex=(...i)=>e.check(Yl(...i)),e.includes=(...i)=>e.check(tu(...i)),e.startsWith=(...i)=>e.check(nu(...i)),e.endsWith=(...i)=>e.check(ru(...i)),e.min=(...i)=>e.check(Xo(...i)),e.max=(...i)=>e.check(sc(...i)),e.length=(...i)=>e.check(ac(...i)),e.nonempty=(...i)=>e.check(Xo(1,...i)),e.lowercase=i=>e.check(Xl(i)),e.uppercase=i=>e.check(eu(i)),e.trim=()=>e.check(su()),e.normalize=(...i)=>e.check(ou(...i)),e.toLowerCase=()=>e.check(au()),e.toUpperCase=()=>e.check(cu()),e.slugify=()=>e.check(lu())}),cc=Y("ZodString",(e,t)=>{Ql.init(e,t),du.init(e,t),e.email=n=>e.check(Sw(fu,n)),e.url=n=>e.check(yp(lc,n)),e.jwt=n=>e.check(Bw(Iu,n)),e.emoji=n=>e.check(Tw(pu,n)),e.guid=n=>e.check(gf(Wa,n)),e.uuid=n=>e.check(xw(vi,n)),e.uuidv4=n=>e.check(kw(vi,n)),e.uuidv6=n=>e.check(Ew(vi,n)),e.uuidv7=n=>e.check(Aw(vi,n)),e.nanoid=n=>e.check(Iw(hu,n)),e.guid=n=>e.check(gf(Wa,n)),e.cuid=n=>e.check(Nw(mu,n)),e.cuid2=n=>e.check($w(gu,n)),e.ulid=n=>e.check(Cw(yu,n)),e.base64=n=>e.check(Mw(Eu,n)),e.base64url=n=>e.check(jw(Au,n)),e.xid=n=>e.check(Ow(wu,n)),e.ksuid=n=>e.check(Rw(vu,n)),e.ipv4=n=>e.check(Pw(bu,n)),e.ipv6=n=>e.check(Dw(_u,n)),e.cidrv4=n=>e.check(Uw(xu,n)),e.cidrv6=n=>e.check(Lw(ku,n)),e.e164=n=>e.check(zw(Tu,n)),e.datetime=n=>e.check(QI(n)),e.date=n=>e.check(YI(n)),e.time=n=>e.check(XI(n)),e.duration=n=>e.check(eN(n))});function W(e){return T1(cc,e)}const Kt=Y("ZodStringFormat",(e,t)=>{Yt.init(e,t),du.init(e,t)}),fu=Y("ZodEmail",(e,t)=>{fT.init(e,t),Kt.init(e,t)});function Wi(e){return Sw(fu,e)}const Wa=Y("ZodGUID",(e,t)=>{uT.init(e,t),Kt.init(e,t)});function rv(e){return gf(Wa,e)}const vi=Y("ZodUUID",(e,t)=>{dT.init(e,t),Kt.init(e,t)});function iv(e){return xw(vi,e)}function ov(e){return kw(vi,e)}function sv(e){return Ew(vi,e)}function av(e){return Aw(vi,e)}const lc=Y("ZodURL",(e,t)=>{pT.init(e,t),Kt.init(e,t)});function Np(e){return yp(lc,e)}function cv(e){return yp(lc,{protocol:/^https?$/,hostname:TA,...ue(e)})}const pu=Y("ZodEmoji",(e,t)=>{hT.init(e,t),Kt.init(e,t)});function lv(e){return Tw(pu,e)}const hu=Y("ZodNanoID",(e,t)=>{mT.init(e,t),Kt.init(e,t)});function uv(e){return Iw(hu,e)}const mu=Y("ZodCUID",(e,t)=>{gT.init(e,t),Kt.init(e,t)});function dv(e){return Nw(mu,e)}const gu=Y("ZodCUID2",(e,t)=>{yT.init(e,t),Kt.init(e,t)});function fv(e){return $w(gu,e)}const yu=Y("ZodULID",(e,t)=>{wT.init(e,t),Kt.init(e,t)});function pv(e){return Cw(yu,e)}const wu=Y("ZodXID",(e,t)=>{vT.init(e,t),Kt.init(e,t)});function hv(e){return Ow(wu,e)}const vu=Y("ZodKSUID",(e,t)=>{bT.init(e,t),Kt.init(e,t)});function mv(e){return Rw(vu,e)}const bu=Y("ZodIPv4",(e,t)=>{ET.init(e,t),Kt.init(e,t)});function Ls(e){return Pw(bu,e)}const $p=Y("ZodMAC",(e,t)=>{TT.init(e,t),Kt.init(e,t)});function gv(e){return N1($p,e)}const _u=Y("ZodIPv6",(e,t)=>{AT.init(e,t),Kt.init(e,t)});function Su(e){return Dw(_u,e)}const xu=Y("ZodCIDRv4",(e,t)=>{IT.init(e,t),Kt.init(e,t)});function yv(e){return Uw(xu,e)}const ku=Y("ZodCIDRv6",(e,t)=>{NT.init(e,t),Kt.init(e,t)});function wv(e){return Lw(ku,e)}const Eu=Y("ZodBase64",(e,t)=>{$T.init(e,t),Kt.init(e,t)});function vv(e){return Mw(Eu,e)}const Au=Y("ZodBase64URL",(e,t)=>{OT.init(e,t),Kt.init(e,t)});function bv(e){return jw(Au,e)}const Tu=Y("ZodE164",(e,t)=>{RT.init(e,t),Kt.init(e,t)});function _v(e){return zw(Tu,e)}const Iu=Y("ZodJWT",(e,t)=>{DT.init(e,t),Kt.init(e,t)});function Sv(e){return Bw(Iu,e)}const Zs=Y("ZodCustomStringFormat",(e,t)=>{UT.init(e,t),Kt.init(e,t)});function xv(e,t,n={}){return uu(Zs,e,t,n)}function kv(e){return uu(Zs,"hostname",AA,e)}function Ev(e){return uu(Zs,"hex",FA,e)}function Av(e,t){const n=t?.enc??"hex",i=`${e}_${n}`,r=hp[i];if(!r)throw new Error(`Unrecognized hash format: ${i}`);return uu(Zs,i,r,t)}const uc=Y("ZodNumber",(e,t)=>{pw.init(e,t),it.init(e,t),e._zod.processJSONSchema=(i,r,o)=>hI(e,i,r),e.gt=(i,r)=>e.check(mo(i,r)),e.gte=(i,r)=>e.check(ur(i,r)),e.min=(i,r)=>e.check(ur(i,r)),e.lt=(i,r)=>e.check(ho(i,r)),e.lte=(i,r)=>e.check(Br(i,r)),e.max=(i,r)=>e.check(Br(i,r)),e.int=i=>e.check(xl(i)),e.safe=i=>e.check(xl(i)),e.positive=i=>e.check(mo(0,i)),e.nonnegative=i=>e.check(ur(0,i)),e.negative=i=>e.check(ho(0,i)),e.nonpositive=i=>e.check(Br(0,i)),e.multipleOf=(i,r)=>e.check(Us(i,r)),e.step=(i,r)=>e.check(Us(i,r)),e.finite=()=>e;const n=e._zod.bag;e.minValue=Math.max(n.minimum??Number.NEGATIVE_INFINITY,n.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,e.maxValue=Math.min(n.maximum??Number.POSITIVE_INFINITY,n.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,e.isInt=(n.format??"").includes("int")||Number.isSafeInteger(n.multipleOf??.5),e.isFinite=!0,e.format=n.format??null});function Lt(e){return P1(uc,e)}const as=Y("ZodNumberFormat",(e,t)=>{LT.init(e,t),uc.init(e,t)});function xl(e){return U1(as,e)}function Tv(e){return L1(as,e)}function Iv(e){return M1(as,e)}function Nv(e){return j1(as,e)}function $v(e){return z1(as,e)}const dc=Y("ZodBoolean",(e,t)=>{hw.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>mI(e,n,i)});function nt(e){return B1(dc,e)}const fc=Y("ZodBigInt",(e,t)=>{mw.init(e,t),it.init(e,t),e._zod.processJSONSchema=(i,r,o)=>gI(e,i),e.gte=(i,r)=>e.check(ur(i,r)),e.min=(i,r)=>e.check(ur(i,r)),e.gt=(i,r)=>e.check(mo(i,r)),e.gte=(i,r)=>e.check(ur(i,r)),e.min=(i,r)=>e.check(ur(i,r)),e.lt=(i,r)=>e.check(ho(i,r)),e.lte=(i,r)=>e.check(Br(i,r)),e.max=(i,r)=>e.check(Br(i,r)),e.positive=i=>e.check(mo(BigInt(0),i)),e.negative=i=>e.check(ho(BigInt(0),i)),e.nonpositive=i=>e.check(Br(BigInt(0),i)),e.nonnegative=i=>e.check(ur(BigInt(0),i)),e.multipleOf=(i,r)=>e.check(Us(i,r));const n=e._zod.bag;e.minValue=n.minimum??null,e.maxValue=n.maximum??null,e.format=n.format??null});function Cv(e){return W1(fc,e)}const Nu=Y("ZodBigIntFormat",(e,t)=>{MT.init(e,t),fc.init(e,t)});function Ov(e){return q1(Nu,e)}function Rv(e){return H1(Nu,e)}const Cp=Y("ZodSymbol",(e,t)=>{jT.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>yI(e,n)});function Pv(e){return K1(Cp,e)}const Op=Y("ZodUndefined",(e,t)=>{zT.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>vI(e,n)});function Dv(e){return J1(Op,e)}const Rp=Y("ZodNull",(e,t)=>{BT.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>wI(e,n,i)});function $u(e){return G1(Rp,e)}const Pp=Y("ZodAny",(e,t)=>{FT.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>SI()});function Hn(){return Z1(Pp)}const Dp=Y("ZodUnknown",(e,t)=>{WT.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>xI()});function Nt(){return Q1(Dp)}const Up=Y("ZodNever",(e,t)=>{VT.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>_I(e,n,i)});function gt(e){return Y1(Up,e)}const Lp=Y("ZodVoid",(e,t)=>{qT.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>bI(e,n)});function Uv(e){return X1(Lp,e)}const Cu=Y("ZodDate",(e,t)=>{HT.init(e,t),it.init(e,t),e._zod.processJSONSchema=(i,r,o)=>kI(e,i),e.min=(i,r)=>e.check(ur(i,r)),e.max=(i,r)=>e.check(Br(i,r));const n=e._zod.bag;e.minDate=n.minimum?new Date(n.minimum):null,e.maxDate=n.maximum?new Date(n.maximum):null});function yo(e){return eI(Cu,e)}const Mp=Y("ZodArray",(e,t)=>{KT.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>UI(e,n,i,r),e.element=t.element,e.min=(n,i)=>e.check(Xo(n,i)),e.nonempty=n=>e.check(Xo(1,n)),e.max=(n,i)=>e.check(sc(n,i)),e.length=(n,i)=>e.check(ac(n,i)),e.unwrap=()=>e.element});function yt(e,t){return rI(Mp,e,t)}function Lv(e){const t=e._zod.def.shape;return Eo(Object.keys(t))}const Li=Y("ZodObject",(e,t)=>{QT.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>LI(e,n,i,r),lt(e,"shape",()=>t.shape),e.keyof=()=>Eo(Object.keys(e._zod.def.shape)),e.catchall=n=>e.clone({...e._zod.def,catchall:n}),e.passthrough=()=>e.clone({...e._zod.def,catchall:Nt()}),e.loose=()=>e.clone({...e._zod.def,catchall:Nt()}),e.strict=()=>e.clone({...e._zod.def,catchall:gt()}),e.strip=()=>e.clone({...e._zod.def,catchall:void 0}),e.extend=n=>YE(e,n),e.safeExtend=n=>XE(e,n),e.merge=n=>eA(e,n),e.pick=n=>ZE(e,n),e.omit=n=>QE(e,n),e.partial=(...n)=>tA(Go,e,n[0]),e.required=(...n)=>nA(Ru,e,n[0])});function ce(e,t){const n={type:"object",shape:e??{},...ue(t)};return new Li(n)}function Mv(e,t){return new Li({type:"object",shape:e,catchall:gt(),...ue(t)})}function jp(e,t){return new Li({type:"object",shape:e,catchall:Nt(),...ue(t)})}const pc=Y("ZodUnion",(e,t)=>{mp.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>Ww(e,n,i,r),e.options=t.options});function nn(e,t){return new pc({type:"union",options:e,...ue(t)})}const zp=Y("ZodXor",(e,t)=>{pc.init(e,t),YT.init(e,t),e._zod.processJSONSchema=(n,i,r)=>Ww(e,n,i,r),e.options=t.options});function jv(e,t){return new zp({type:"union",options:e,inclusive:!1,...ue(t)})}const Bp=Y("ZodDiscriminatedUnion",(e,t)=>{pc.init(e,t),XT.init(e,t)});function Fp(e,t,n){return new Bp({type:"union",options:t,discriminator:e,...ue(n)})}const Wp=Y("ZodIntersection",(e,t)=>{e1.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>MI(e,n,i,r)});function Vp(e,t){return new Wp({type:"intersection",left:e,right:t})}const qp=Y("ZodTuple",(e,t)=>{gw.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>jI(e,n,i,r),e.rest=n=>e.clone({...e._zod.def,rest:n})});function Hp(e,t,n){const i=t instanceof Xe,r=i?n:t,o=i?t:null;return new qp({type:"tuple",items:e,rest:o,...ue(r)})}const hc=Y("ZodRecord",(e,t)=>{t1.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>zI(e,n,i,r),e.keyType=t.keyType,e.valueType=t.valueType});function rr(e,t,n){return new hc({type:"record",keyType:e,valueType:t,...ue(n)})}function zv(e,t,n){const i=Hr(e);return i._zod.values=void 0,new hc({type:"record",keyType:i,valueType:t,...ue(n)})}function Bv(e,t,n){return new hc({type:"record",keyType:e,valueType:t,mode:"loose",...ue(n)})}const Kp=Y("ZodMap",(e,t)=>{n1.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>PI(e,n),e.keyType=t.keyType,e.valueType=t.valueType,e.min=(...n)=>e.check(go(...n)),e.nonempty=n=>e.check(go(1,n)),e.max=(...n)=>e.check(Gs(...n)),e.size=(...n)=>e.check(oc(...n))});function Fv(e,t,n){return new Kp({type:"map",keyType:e,valueType:t,...ue(n)})}const Jp=Y("ZodSet",(e,t)=>{r1.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>DI(e,n),e.min=(...n)=>e.check(go(...n)),e.nonempty=n=>e.check(go(1,n)),e.max=(...n)=>e.check(Gs(...n)),e.size=(...n)=>e.check(oc(...n))});function Wv(e,t){return new Jp({type:"set",valueType:e,...ue(t)})}const Ms=Y("ZodEnum",(e,t)=>{i1.init(e,t),it.init(e,t),e._zod.processJSONSchema=(i,r,o)=>EI(e,i,r),e.enum=t.entries,e.options=Object.values(t.entries);const n=new Set(Object.keys(t.entries));e.extract=(i,r)=>{const o={};for(const s of i)if(n.has(s))o[s]=t.entries[s];else throw new Error(`Key ${s} not found in enum`);return new Ms({...t,checks:[],...ue(r),entries:o})},e.exclude=(i,r)=>{const o={...t.entries};for(const s of i)if(n.has(s))delete o[s];else throw new Error(`Key ${s} not found in enum`);return new Ms({...t,checks:[],...ue(r),entries:o})}});function Eo(e,t){const n=Array.isArray(e)?Object.fromEntries(e.map(i=>[i,i])):e;return new Ms({type:"enum",entries:n,...ue(t)})}function Vv(e,t){return new Ms({type:"enum",entries:e,...ue(t)})}const Gp=Y("ZodLiteral",(e,t)=>{o1.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>AI(e,n,i),e.values=new Set(t.values),Object.defineProperty(e,"value",{get(){if(t.values.length>1)throw new Error("This schema contains multiple valid literal values. Use `.values` instead.");return t.values[0]}})});function _e(e,t){return new Gp({type:"literal",values:Array.isArray(e)?e:[e],...ue(t)})}const Zp=Y("ZodFile",(e,t)=>{s1.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>NI(e,n,i),e.min=(n,i)=>e.check(go(n,i)),e.max=(n,i)=>e.check(Gs(n,i)),e.mime=(n,i)=>e.check(iu(Array.isArray(n)?n:[n],i))});function qv(e){return iI(Zp,e)}const Qp=Y("ZodTransform",(e,t)=>{a1.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>RI(e,n),e._zod.parse=(n,i)=>{if(i.direction==="backward")throw new ap(e.constructor.name);n.addIssue=o=>{if(typeof o=="string")n.issues.push(Ma(o,n.value,t));else{const s=o;s.fatal&&(s.continue=!1),s.code??(s.code="custom"),s.input??(s.input=n.value),s.inst??(s.inst=e),n.issues.push(Ma(s))}};const r=t.transform(n.value,n);return r instanceof Promise?r.then(o=>(n.value=o,n)):(n.value=r,n)}});function Ou(e){return new Qp({type:"transform",transform:e})}const Go=Y("ZodOptional",(e,t)=>{yw.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>Vw(e,n,i,r),e.unwrap=()=>e._zod.def.innerType});function wo(e){return new Go({type:"optional",innerType:e})}const Yp=Y("ZodExactOptional",(e,t)=>{c1.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>Vw(e,n,i,r),e.unwrap=()=>e._zod.def.innerType});function Xp(e){return new Yp({type:"optional",innerType:e})}const eh=Y("ZodNullable",(e,t)=>{l1.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>BI(e,n,i,r),e.unwrap=()=>e._zod.def.innerType});function Va(e){return new eh({type:"nullable",innerType:e})}function Hv(e){return wo(Va(e))}const th=Y("ZodDefault",(e,t)=>{u1.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>WI(e,n,i,r),e.unwrap=()=>e._zod.def.innerType,e.removeDefault=e.unwrap});function nh(e,t){return new th({type:"default",innerType:e,get defaultValue(){return typeof t=="function"?t():lp(t)}})}const rh=Y("ZodPrefault",(e,t)=>{d1.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>VI(e,n,i,r),e.unwrap=()=>e._zod.def.innerType});function ih(e,t){return new rh({type:"prefault",innerType:e,get defaultValue(){return typeof t=="function"?t():lp(t)}})}const Ru=Y("ZodNonOptional",(e,t)=>{f1.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>FI(e,n,i,r),e.unwrap=()=>e._zod.def.innerType});function oh(e,t){return new Ru({type:"nonoptional",innerType:e,...ue(t)})}const sh=Y("ZodSuccess",(e,t)=>{p1.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>$I(e,n,i),e.unwrap=()=>e._zod.def.innerType});function Kv(e){return new sh({type:"success",innerType:e})}const ah=Y("ZodCatch",(e,t)=>{h1.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>qI(e,n,i,r),e.unwrap=()=>e._zod.def.innerType,e.removeCatch=e.unwrap});function ch(e,t){return new ah({type:"catch",innerType:e,catchValue:typeof t=="function"?t:()=>t})}const lh=Y("ZodNaN",(e,t)=>{m1.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>TI(e,n)});function Jv(e){return nI(lh,e)}const Pu=Y("ZodPipe",(e,t)=>{g1.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>HI(e,n,i,r),e.in=t.in,e.out=t.out});function qa(e,t){return new Pu({type:"pipe",in:e,out:t})}const Du=Y("ZodCodec",(e,t)=>{Pu.init(e,t),ww.init(e,t)});function Gv(e,t,n){return new Du({type:"pipe",in:e,out:t,transform:n.decode,reverseTransform:n.encode})}const uh=Y("ZodReadonly",(e,t)=>{y1.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>KI(e,n,i,r),e.unwrap=()=>e._zod.def.innerType});function dh(e){return new uh({type:"readonly",innerType:e})}const fh=Y("ZodTemplateLiteral",(e,t)=>{w1.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>II(e,n,i)});function Zv(e,t){return new fh({type:"template_literal",parts:e,...ue(t)})}const ph=Y("ZodLazy",(e,t)=>{_1.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>GI(e,n,i,r),e.unwrap=()=>e._zod.def.getter()});function Uu(e){return new ph({type:"lazy",getter:e})}const hh=Y("ZodPromise",(e,t)=>{b1.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>JI(e,n,i,r),e.unwrap=()=>e._zod.def.innerType});function Qv(e){return new hh({type:"promise",innerType:e})}const mh=Y("ZodFunction",(e,t)=>{v1.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>OI(e,n)});function Ha(e){return new mh({type:"function",input:Array.isArray(e?.input)?Hp(e?.input):e?.input??yt(Nt()),output:e?.output??Nt()})}const mc=Y("ZodCustom",(e,t)=>{S1.init(e,t),it.init(e,t),e._zod.processJSONSchema=(n,i,r)=>CI(e,n)});function Yv(e){const t=new pn({check:"custom"});return t._zod.check=e,t}function Qs(e,t){return oI(mc,e??(()=>!0),t)}function gh(e,t={}){return sI(mc,e,t)}function yh(e){return aI(e)}const Xv=lI,eb=uI;function js(e,t={}){const n=new mc({type:"custom",check:"custom",fn:i=>i instanceof e,abort:!0,...ue(t)});return n._zod.bag.Class=e,n._zod.check=i=>{i.value instanceof e||i.issues.push({code:"invalid_type",expected:e.name,input:i.value,inst:n,path:[...n._zod.def.path??[]]})},n}const tb=(...e)=>dI({Codec:Du,Boolean:dc,String:cc},...e);function kl(e){const t=Uu(()=>nn([W(e),Lt(),nt(),$u(),yt(t),rr(W(),t)]));return t}function nb(e,t){return qa(Ou(e),t)}const r6=Object.freeze(Object.defineProperty({__proto__:null,ZodAny:Pp,ZodArray:Mp,ZodBase64:Eu,ZodBase64URL:Au,ZodBigInt:fc,ZodBigIntFormat:Nu,ZodBoolean:dc,ZodCIDRv4:xu,ZodCIDRv6:ku,ZodCUID:mu,ZodCUID2:gu,ZodCatch:ah,ZodCodec:Du,ZodCustom:mc,ZodCustomStringFormat:Zs,ZodDate:Cu,ZodDefault:th,ZodDiscriminatedUnion:Bp,ZodE164:Tu,ZodEmail:fu,ZodEmoji:pu,ZodEnum:Ms,ZodExactOptional:Yp,ZodFile:Zp,ZodFunction:mh,ZodGUID:Wa,ZodIPv4:bu,ZodIPv6:_u,ZodIntersection:Wp,ZodJWT:Iu,ZodKSUID:vu,ZodLazy:ph,ZodLiteral:Gp,ZodMAC:$p,ZodMap:Kp,ZodNaN:lh,ZodNanoID:hu,ZodNever:Up,ZodNonOptional:Ru,ZodNull:Rp,ZodNullable:eh,ZodNumber:uc,ZodNumberFormat:as,ZodObject:Li,ZodOptional:Go,ZodPipe:Pu,ZodPrefault:rh,ZodPromise:hh,ZodReadonly:uh,ZodRecord:hc,ZodSet:Jp,ZodString:cc,ZodStringFormat:Kt,ZodSuccess:sh,ZodSymbol:Cp,ZodTemplateLiteral:fh,ZodTransform:Qp,ZodTuple:qp,ZodType:it,ZodULID:yu,ZodURL:lc,ZodUUID:vi,ZodUndefined:Op,ZodUnion:pc,ZodUnknown:Dp,ZodVoid:Lp,ZodXID:wu,ZodXor:zp,_ZodString:du,_default:nh,_function:Ha,any:Hn,array:yt,base64:vv,base64url:bv,bigint:Cv,boolean:nt,catch:ch,check:Yv,cidrv4:yv,cidrv6:wv,codec:Gv,cuid:dv,cuid2:fv,custom:Qs,date:yo,describe:Xv,discriminatedUnion:Fp,e164:_v,email:Wi,emoji:lv,enum:Eo,exactOptional:Xp,file:qv,float32:Tv,float64:Iv,function:Ha,guid:rv,hash:Av,hex:Ev,hostname:kv,httpUrl:cv,instanceof:js,int:xl,int32:Nv,int64:Ov,intersection:Vp,ipv4:Ls,ipv6:Su,json:kl,jwt:Sv,keyof:Lv,ksuid:mv,lazy:Uu,literal:_e,looseObject:jp,looseRecord:Bv,mac:gv,map:Fv,meta:eb,nan:Jv,nanoid:uv,nativeEnum:Vv,never:gt,nonoptional:oh,null:$u,nullable:Va,nullish:Hv,number:Lt,object:ce,optional:wo,partialRecord:zv,pipe:qa,prefault:ih,preprocess:nb,promise:Qv,readonly:dh,record:rr,refine:gh,set:Wv,strictObject:Mv,string:W,stringFormat:xv,stringbool:tb,success:Kv,superRefine:yh,symbol:Pv,templateLiteral:Zv,transform:Ou,tuple:Hp,uint32:$v,uint64:Rv,ulid:pv,undefined:Dv,union:nn,unknown:Nt,url:Np,uuid:iv,uuidv4:ov,uuidv6:sv,uuidv7:av,void:Uv,xid:hv,xor:jv},Symbol.toStringTag,{value:"Module"})),rN={invalid_type:"invalid_type",too_big:"too_big",too_small:"too_small",invalid_format:"invalid_format",not_multiple_of:"not_multiple_of",unrecognized_keys:"unrecognized_keys",invalid_union:"invalid_union",invalid_key:"invalid_key",invalid_element:"invalid_element",invalid_value:"invalid_value",custom:"custom"};function iN(e){Gn({customError:e})}function oN(){return Gn().customError}var yf;yf||(yf={});const ve={...r6,...n6,iso:qw},i6=new Set(["$schema","$ref","$defs","definitions","$id","id","$comment","$anchor","$vocabulary","$dynamicRef","$dynamicAnchor","type","enum","const","anyOf","oneOf","allOf","not","properties","required","additionalProperties","patternProperties","propertyNames","minProperties","maxProperties","items","prefixItems","additionalItems","minItems","maxItems","uniqueItems","contains","minContains","maxContains","minLength","maxLength","pattern","format","minimum","maximum","exclusiveMinimum","exclusiveMaximum","multipleOf","description","default","contentEncoding","contentMediaType","contentSchema","unevaluatedItems","unevaluatedProperties","if","then","else","dependentSchemas","dependentRequired","nullable","readOnly"]);function o6(e,t){const n=e.$schema;return n==="https://json-schema.org/draft/2020-12/schema"?"draft-2020-12":n==="http://json-schema.org/draft-07/schema#"?"draft-7":n==="http://json-schema.org/draft-04/schema#"?"draft-4":t??"draft-2020-12"}function s6(e,t){if(!e.startsWith("#"))throw new Error("External $ref is not supported, only local refs (#/...) are allowed");const n=e.slice(1).split("/").filter(Boolean);if(n.length===0)return t.rootSchema;const i=t.version==="draft-2020-12"?"$defs":"definitions";if(n[0]===i){const r=n[1];if(!r||!t.defs[r])throw new Error(`Reference not found: ${e}`);return t.defs[r]}throw new Error(`Reference not found: ${e}`)}function sN(e,t){if(e.not!==void 0){if(typeof e.not=="object"&&Object.keys(e.not).length===0)return ve.never();throw new Error("not is not supported in Zod (except { not: {} } for never)")}if(e.unevaluatedItems!==void 0)throw new Error("unevaluatedItems is not supported");if(e.unevaluatedProperties!==void 0)throw new Error("unevaluatedProperties is not supported");if(e.if!==void 0||e.then!==void 0||e.else!==void 0)throw new Error("Conditional schemas (if/then/else) are not supported");if(e.dependentSchemas!==void 0||e.dependentRequired!==void 0)throw new Error("dependentSchemas and dependentRequired are not supported");if(e.$ref){const r=e.$ref;if(t.refs.has(r))return t.refs.get(r);if(t.processing.has(r))return ve.lazy(()=>{if(!t.refs.has(r))throw new Error(`Circular reference not resolved: ${r}`);return t.refs.get(r)});t.processing.add(r);const o=s6(r,t),s=er(o,t);return t.refs.set(r,s),t.processing.delete(r),s}if(e.enum!==void 0){const r=e.enum;if(t.version==="openapi-3.0"&&e.nullable===!0&&r.length===1&&r[0]===null)return ve.null();if(r.length===0)return ve.never();if(r.length===1)return ve.literal(r[0]);if(r.every(s=>typeof s=="string"))return ve.enum(r);const o=r.map(s=>ve.literal(s));return o.length<2?o[0]:ve.union([o[0],o[1],...o.slice(2)])}if(e.const!==void 0)return ve.literal(e.const);const n=e.type;if(Array.isArray(n)){const r=n.map(o=>{const s={...e,type:o};return sN(s,t)});return r.length===0?ve.never():r.length===1?r[0]:ve.union(r)}if(!n)return ve.any();let i;switch(n){case"string":{let r=ve.string();if(e.format){const o=e.format;o==="email"?r=r.check(ve.email()):o==="uri"||o==="uri-reference"?r=r.check(ve.url()):o==="uuid"||o==="guid"?r=r.check(ve.uuid()):o==="date-time"?r=r.check(ve.iso.datetime()):o==="date"?r=r.check(ve.iso.date()):o==="time"?r=r.check(ve.iso.time()):o==="duration"?r=r.check(ve.iso.duration()):o==="ipv4"?r=r.check(ve.ipv4()):o==="ipv6"?r=r.check(ve.ipv6()):o==="mac"?r=r.check(ve.mac()):o==="cidr"?r=r.check(ve.cidrv4()):o==="cidr-v6"?r=r.check(ve.cidrv6()):o==="base64"?r=r.check(ve.base64()):o==="base64url"?r=r.check(ve.base64url()):o==="e164"?r=r.check(ve.e164()):o==="jwt"?r=r.check(ve.jwt()):o==="emoji"?r=r.check(ve.emoji()):o==="nanoid"?r=r.check(ve.nanoid()):o==="cuid"?r=r.check(ve.cuid()):o==="cuid2"?r=r.check(ve.cuid2()):o==="ulid"?r=r.check(ve.ulid()):o==="xid"?r=r.check(ve.xid()):o==="ksuid"&&(r=r.check(ve.ksuid()))}typeof e.minLength=="number"&&(r=r.min(e.minLength)),typeof e.maxLength=="number"&&(r=r.max(e.maxLength)),e.pattern&&(r=r.regex(new RegExp(e.pattern))),i=r;break}case"number":case"integer":{let r=n==="integer"?ve.number().int():ve.number();typeof e.minimum=="number"&&(r=r.min(e.minimum)),typeof e.maximum=="number"&&(r=r.max(e.maximum)),typeof e.exclusiveMinimum=="number"?r=r.gt(e.exclusiveMinimum):e.exclusiveMinimum===!0&&typeof e.minimum=="number"&&(r=r.gt(e.minimum)),typeof e.exclusiveMaximum=="number"?r=r.lt(e.exclusiveMaximum):e.exclusiveMaximum===!0&&typeof e.maximum=="number"&&(r=r.lt(e.maximum)),typeof e.multipleOf=="number"&&(r=r.multipleOf(e.multipleOf)),i=r;break}case"boolean":{i=ve.boolean();break}case"null":{i=ve.null();break}case"object":{const r={},o=e.properties||{},s=new Set(e.required||[]);for(const[c,l]of Object.entries(o)){const u=er(l,t);r[c]=s.has(c)?u:u.optional()}if(e.propertyNames){const c=er(e.propertyNames,t),l=e.additionalProperties&&typeof e.additionalProperties=="object"?er(e.additionalProperties,t):ve.any();if(Object.keys(r).length===0){i=ve.record(c,l);break}const u=ve.object(r).passthrough(),p=ve.looseRecord(c,l);i=ve.intersection(u,p);break}if(e.patternProperties){const c=e.patternProperties,l=Object.keys(c),u=[];for(const f of l){const g=er(c[f],t),h=ve.string().regex(new RegExp(f));u.push(ve.looseRecord(h,g))}const p=[];if(Object.keys(r).length>0&&p.push(ve.object(r).passthrough()),p.push(...u),p.length===0)i=ve.object({}).passthrough();else if(p.length===1)i=p[0];else{let f=ve.intersection(p[0],p[1]);for(let g=2;g<p.length;g++)f=ve.intersection(f,p[g]);i=f}break}const a=ve.object(r);e.additionalProperties===!1?i=a.strict():typeof e.additionalProperties=="object"?i=a.catchall(er(e.additionalProperties,t)):i=a.passthrough();break}case"array":{const r=e.prefixItems,o=e.items;if(r&&Array.isArray(r)){const s=r.map(c=>er(c,t)),a=o&&typeof o=="object"&&!Array.isArray(o)?er(o,t):void 0;a?i=ve.tuple(s).rest(a):i=ve.tuple(s),typeof e.minItems=="number"&&(i=i.check(ve.minLength(e.minItems))),typeof e.maxItems=="number"&&(i=i.check(ve.maxLength(e.maxItems)))}else if(Array.isArray(o)){const s=o.map(c=>er(c,t)),a=e.additionalItems&&typeof e.additionalItems=="object"?er(e.additionalItems,t):void 0;a?i=ve.tuple(s).rest(a):i=ve.tuple(s),typeof e.minItems=="number"&&(i=i.check(ve.minLength(e.minItems))),typeof e.maxItems=="number"&&(i=i.check(ve.maxLength(e.maxItems)))}else if(o!==void 0){const s=er(o,t);let a=ve.array(s);typeof e.minItems=="number"&&(a=a.min(e.minItems)),typeof e.maxItems=="number"&&(a=a.max(e.maxItems)),i=a}else i=ve.array(ve.any());break}default:throw new Error(`Unsupported type: ${n}`)}return e.description&&(i=i.describe(e.description)),e.default!==void 0&&(i=i.default(e.default)),i}function er(e,t){if(typeof e=="boolean")return e?ve.any():ve.never();let n=sN(e,t);const i=e.type||e.enum!==void 0||e.const!==void 0;if(e.anyOf&&Array.isArray(e.anyOf)){const a=e.anyOf.map(l=>er(l,t)),c=ve.union(a);n=i?ve.intersection(n,c):c}if(e.oneOf&&Array.isArray(e.oneOf)){const a=e.oneOf.map(l=>er(l,t)),c=ve.xor(a);n=i?ve.intersection(n,c):c}if(e.allOf&&Array.isArray(e.allOf))if(e.allOf.length===0)n=i?n:ve.any();else{let a=i?n:er(e.allOf[0],t);const c=i?0:1;for(let l=c;l<e.allOf.length;l++)a=ve.intersection(a,er(e.allOf[l],t));n=a}e.nullable===!0&&t.version==="openapi-3.0"&&(n=ve.nullable(n)),e.readOnly===!0&&(n=ve.readonly(n));const r={},o=["$id","id","$comment","$anchor","$vocabulary","$dynamicRef","$dynamicAnchor"];for(const a of o)a in e&&(r[a]=e[a]);const s=["contentEncoding","contentMediaType","contentSchema"];for(const a of s)a in e&&(r[a]=e[a]);for(const a of Object.keys(e))i6.has(a)||(r[a]=e[a]);return Object.keys(r).length>0&&t.registry.add(n,r),n}function aN(e,t){if(typeof e=="boolean")return e?ve.any():ve.never();const n=o6(e,t?.defaultTarget),i=e.$defs||e.definitions||{},r={version:n,defs:i,refs:new Map,processing:new Set,rootSchema:e,registry:t?.registry??zr};return er(e,r)}function wh(e){return I1(cc,e)}function a6(e){return D1(uc,e)}function Fg(e){return F1(dc,e)}function c6(e){return V1(fc,e)}function l6(e){return tI(Cu,e)}const cN=Object.freeze(Object.defineProperty({__proto__:null,bigint:c6,boolean:Fg,date:l6,number:a6,string:wh},Symbol.toStringTag,{value:"Module"}));Gn(x1());const P_=Object.freeze(Object.defineProperty({__proto__:null,$brand:Ky,$input:_w,$output:bw,NEVER:Hy,TimePrecision:Fw,ZodAny:Pp,ZodArray:Mp,ZodBase64:Eu,ZodBase64URL:Au,ZodBigInt:fc,ZodBigIntFormat:Nu,ZodBoolean:dc,ZodCIDRv4:xu,ZodCIDRv6:ku,ZodCUID:mu,ZodCUID2:gu,ZodCatch:ah,ZodCodec:Du,ZodCustom:mc,ZodCustomStringFormat:Zs,ZodDate:Cu,ZodDefault:th,ZodDiscriminatedUnion:Bp,ZodE164:Tu,ZodEmail:fu,ZodEmoji:pu,ZodEnum:Ms,ZodError:nN,ZodExactOptional:Yp,ZodFile:Zp,get ZodFirstPartyTypeKind(){return yf},ZodFunction:mh,ZodGUID:Wa,ZodIPv4:bu,ZodIPv6:_u,ZodISODate:Ep,ZodISODateTime:kp,ZodISODuration:Tp,ZodISOTime:Ap,ZodIntersection:Wp,ZodIssueCode:rN,ZodJWT:Iu,ZodKSUID:vu,ZodLazy:ph,ZodLiteral:Gp,ZodMAC:$p,ZodMap:Kp,ZodNaN:lh,ZodNanoID:hu,ZodNever:Up,ZodNonOptional:Ru,ZodNull:Rp,ZodNullable:eh,ZodNumber:uc,ZodNumberFormat:as,ZodObject:Li,ZodOptional:Go,ZodPipe:Pu,ZodPrefault:rh,ZodPromise:hh,ZodReadonly:uh,ZodRealError:xr,ZodRecord:hc,ZodSet:Jp,ZodString:cc,ZodStringFormat:Kt,ZodSuccess:sh,ZodSymbol:Cp,ZodTemplateLiteral:fh,ZodTransform:Qp,ZodTuple:qp,ZodType:it,ZodULID:yu,ZodURL:lc,ZodUUID:vi,ZodUndefined:Op,ZodUnion:pc,ZodUnknown:Dp,ZodVoid:Lp,ZodXID:wu,ZodXor:zp,_ZodString:du,_default:nh,_function:Ha,any:Hn,array:yt,base64:vv,base64url:bv,bigint:Cv,boolean:nt,catch:ch,check:Yv,cidrv4:yv,cidrv6:wv,clone:Hr,codec:Gv,coerce:cN,config:Gn,core:ZI,cuid:dv,cuid2:fv,custom:Qs,date:yo,decode:Zw,decodeAsync:Yw,describe:Xv,discriminatedUnion:Fp,e164:_v,email:Wi,emoji:lv,encode:Gw,encodeAsync:Qw,endsWith:ru,enum:Eo,exactOptional:Xp,file:qv,flattenError:fp,float32:Tv,float64:Iv,formatError:pp,fromJSONSchema:aN,function:Ha,getErrorMap:oN,globalRegistry:zr,gt:mo,gte:ur,guid:rv,hash:Av,hex:Ev,hostname:kv,httpUrl:cv,includes:tu,instanceof:js,int:xl,int32:Nv,int64:Ov,intersection:Vp,ipv4:Ls,ipv6:Su,iso:qw,json:kl,jwt:Sv,keyof:Lv,ksuid:mv,lazy:Uu,length:ac,literal:_e,locales:vw,looseObject:jp,looseRecord:Bv,lowercase:Xl,lt:ho,lte:Br,mac:gv,map:Fv,maxLength:sc,maxSize:Gs,meta:eb,mime:iu,minLength:Xo,minSize:go,multipleOf:Us,nan:Jv,nanoid:uv,nativeEnum:Vv,negative:vp,never:gt,nonnegative:_p,nonoptional:oh,nonpositive:bp,normalize:ou,null:$u,nullable:Va,nullish:Hv,number:Lt,object:ce,optional:wo,overwrite:Fi,parse:Hw,parseAsync:Kw,partialRecord:zv,pipe:qa,positive:wp,prefault:ih,preprocess:nb,prettifyError:Xy,promise:Qv,property:Sp,readonly:dh,record:rr,refine:gh,regex:Yl,regexes:hp,registry:gp,safeDecode:ev,safeDecodeAsync:nv,safeEncode:Xw,safeEncodeAsync:tv,safeParse:Jw,safeParseAsync:Ip,set:Wv,setErrorMap:iN,size:oc,slugify:lu,startsWith:nu,strictObject:Mv,string:W,stringFormat:xv,stringbool:tb,success:Kv,superRefine:yh,symbol:Pv,templateLiteral:Zv,toJSONSchema:xp,toLowerCase:au,toUpperCase:cu,transform:Ou,treeifyError:Yy,trim:su,tuple:Hp,uint32:$v,uint64:Rv,ulid:pv,undefined:Dv,union:nn,unknown:Nt,uppercase:eu,url:Np,util:Zy,uuid:iv,uuidv4:ov,uuidv6:sv,uuidv7:av,void:Uv,xid:hv,xor:jv},Symbol.toStringTag,{value:"Module"})),u6=Object.freeze(Object.defineProperty({__proto__:null,$brand:Ky,$input:_w,$output:bw,NEVER:Hy,TimePrecision:Fw,ZodAny:Pp,ZodArray:Mp,ZodBase64:Eu,ZodBase64URL:Au,ZodBigInt:fc,ZodBigIntFormat:Nu,ZodBoolean:dc,ZodCIDRv4:xu,ZodCIDRv6:ku,ZodCUID:mu,ZodCUID2:gu,ZodCatch:ah,ZodCodec:Du,ZodCustom:mc,ZodCustomStringFormat:Zs,ZodDate:Cu,ZodDefault:th,ZodDiscriminatedUnion:Bp,ZodE164:Tu,ZodEmail:fu,ZodEmoji:pu,ZodEnum:Ms,ZodError:nN,ZodExactOptional:Yp,ZodFile:Zp,get ZodFirstPartyTypeKind(){return yf},ZodFunction:mh,ZodGUID:Wa,ZodIPv4:bu,ZodIPv6:_u,ZodISODate:Ep,ZodISODateTime:kp,ZodISODuration:Tp,ZodISOTime:Ap,ZodIntersection:Wp,ZodIssueCode:rN,ZodJWT:Iu,ZodKSUID:vu,ZodLazy:ph,ZodLiteral:Gp,ZodMAC:$p,ZodMap:Kp,ZodNaN:lh,ZodNanoID:hu,ZodNever:Up,ZodNonOptional:Ru,ZodNull:Rp,ZodNullable:eh,ZodNumber:uc,ZodNumberFormat:as,ZodObject:Li,ZodOptional:Go,ZodPipe:Pu,ZodPrefault:rh,ZodPromise:hh,ZodReadonly:uh,ZodRealError:xr,ZodRecord:hc,ZodSet:Jp,ZodString:cc,ZodStringFormat:Kt,ZodSuccess:sh,ZodSymbol:Cp,ZodTemplateLiteral:fh,ZodTransform:Qp,ZodTuple:qp,ZodType:it,ZodULID:yu,ZodURL:lc,ZodUUID:vi,ZodUndefined:Op,ZodUnion:pc,ZodUnknown:Dp,ZodVoid:Lp,ZodXID:wu,ZodXor:zp,_ZodString:du,_default:nh,_function:Ha,any:Hn,array:yt,base64:vv,base64url:bv,bigint:Cv,boolean:nt,catch:ch,check:Yv,cidrv4:yv,cidrv6:wv,clone:Hr,codec:Gv,coerce:cN,config:Gn,core:ZI,cuid:dv,cuid2:fv,custom:Qs,date:yo,decode:Zw,decodeAsync:Yw,default:P_,describe:Xv,discriminatedUnion:Fp,e164:_v,email:Wi,emoji:lv,encode:Gw,encodeAsync:Qw,endsWith:ru,enum:Eo,exactOptional:Xp,file:qv,flattenError:fp,float32:Tv,float64:Iv,formatError:pp,fromJSONSchema:aN,function:Ha,getErrorMap:oN,globalRegistry:zr,gt:mo,gte:ur,guid:rv,hash:Av,hex:Ev,hostname:kv,httpUrl:cv,includes:tu,instanceof:js,int:xl,int32:Nv,int64:Ov,intersection:Vp,ipv4:Ls,ipv6:Su,iso:qw,json:kl,jwt:Sv,keyof:Lv,ksuid:mv,lazy:Uu,length:ac,literal:_e,locales:vw,looseObject:jp,looseRecord:Bv,lowercase:Xl,lt:ho,lte:Br,mac:gv,map:Fv,maxLength:sc,maxSize:Gs,meta:eb,mime:iu,minLength:Xo,minSize:go,multipleOf:Us,nan:Jv,nanoid:uv,nativeEnum:Vv,negative:vp,never:gt,nonnegative:_p,nonoptional:oh,nonpositive:bp,normalize:ou,null:$u,nullable:Va,nullish:Hv,number:Lt,object:ce,optional:wo,overwrite:Fi,parse:Hw,parseAsync:Kw,partialRecord:zv,pipe:qa,positive:wp,prefault:ih,preprocess:nb,prettifyError:Xy,promise:Qv,property:Sp,readonly:dh,record:rr,refine:gh,regex:Yl,regexes:hp,registry:gp,safeDecode:ev,safeDecodeAsync:nv,safeEncode:Xw,safeEncodeAsync:tv,safeParse:Jw,safeParseAsync:Ip,set:Wv,setErrorMap:iN,size:oc,slugify:lu,startsWith:nu,strictObject:Mv,string:W,stringFormat:xv,stringbool:tb,success:Kv,superRefine:yh,symbol:Pv,templateLiteral:Zv,toJSONSchema:xp,toLowerCase:au,toUpperCase:cu,transform:Ou,treeifyError:Yy,trim:su,tuple:Hp,uint32:$v,uint64:Rv,ulid:pv,undefined:Dv,union:nn,unknown:Nt,uppercase:eu,url:Np,util:Zy,uuid:iv,uuidv4:ov,uuidv6:sv,uuidv7:av,void:Uv,xid:hv,xor:jv,z:P_},Symbol.toStringTag,{value:"Module"})),ar=()=>Qs(),d6=()=>Qs(),f6=()=>Qs(),p6=ce({currency:W().optional(),free:ce({name:W(),summary:W()}).optional(),pro:ce({name:W(),monthlyPrice:Lt(),summary:W()}).optional()}),h6=ce({providerOrder:yt(W()).describe("Provider sort order in model selector"),disabledModels:yt(ar()).describe("Models to hide from all users"),curatedDefaults:yt(ar()).describe("Default models enabled for new users"),anonymousModels:yt(ar()).describe("Models available to anonymous users"),defaults:ce({chat:ar(),title:ar(),pdf:ar(),artifact:ar(),artifactSuggestion:ar(),followupSuggestions:ar(),suggestions:ar(),polishText:ar(),formatSheet:ar(),analyzeSheet:ar(),codeEdits:ar(),chatImageCompatible:ar(),image:d6()}).describe("Default model for each task type")}).default({providerOrder:["openai","google","anthropic"],disabledModels:[],curatedDefaults:["openai/gpt-5-nano","openai/gpt-5-mini","openai/gpt-5.2","openai/gpt-5.2-chat-latest","openai/gpt-5.2-chat-latest-reasoning","google/gemini-2.5-flash-lite","google/gemini-3-flash","google/gemini-3-pro-preview","anthropic/claude-sonnet-4.5","anthropic/claude-sonnet-4.5-reasoning","anthropic/claude-opus-4.5","xai/grok-4","xai/grok-4-reasoning"],anonymousModels:["google/gemini-2.5-flash-lite","openai/gpt-5-nano"],defaults:{chat:"openai/gpt-5-nano",title:"google/gemini-2.5-flash-lite",pdf:"openai/gpt-5-mini",artifact:"openai/gpt-5-nano",artifactSuggestion:"openai/gpt-5-mini",followupSuggestions:"google/gemini-2.5-flash-lite",suggestions:"openai/gpt-5-mini",polishText:"openai/gpt-5-mini",formatSheet:"openai/gpt-5-mini",analyzeSheet:"openai/gpt-5-mini",codeEdits:"openai/gpt-5-mini",chatImageCompatible:"openai/gpt-4o-mini",image:"google/gemini-3-pro-image"}}),m6=ce({credits:Lt().describe("Message credits for anonymous users"),availableTools:yt(f6()).describe("Tools available to anonymous users"),rateLimit:ce({requestsPerMinute:Lt(),requestsPerMonth:Lt()}).describe("Rate limits")}).default({credits:10,availableTools:[],rateLimit:{requestsPerMinute:5,requestsPerMonth:10}}),g6=ce({maxBytes:Lt().describe("Max file size in bytes after compression"),maxDimension:Lt().describe("Max image dimension"),acceptedTypes:ce({"image/png":yt(W()),"image/jpeg":yt(W()),"application/pdf":yt(W())}).describe("Accepted MIME types with their file extensions")}).default({maxBytes:1024*1024,maxDimension:2048,acceptedTypes:{"image/png":[".png"],"image/jpeg":[".jpg",".jpeg"],"application/pdf":[".pdf"]}}),y6=ce({sandbox:nt().describe("Code sandbox execution (Vercel-native)"),webSearch:nt().describe("Web search (requires TAVILY_API_KEY)"),urlRetrieval:nt().describe("URL content retrieval (requires FIRECRAWL_API_KEY)"),mcp:nt().describe("MCP tool servers (requires MCP_ENCRYPTION_KEY)"),imageGeneration:nt().describe("AI image generation (requires BLOB_READ_WRITE_TOKEN)"),attachments:nt().describe("File attachments (requires BLOB_READ_WRITE_TOKEN)")}).default({sandbox:!1,webSearch:!1,urlRetrieval:!1,mcp:!1,imageGeneration:!1,attachments:!1}),w6=ce({google:nt().describe("Google OAuth (requires AUTH_GOOGLE_ID + AUTH_GOOGLE_SECRET)"),github:nt().describe("GitHub OAuth (requires AUTH_GITHUB_ID + AUTH_GITHUB_SECRET)"),vercel:nt().describe("Vercel OAuth (requires VERCEL_APP_CLIENT_ID + VERCEL_APP_CLIENT_SECRET)")}).default({google:!1,github:!0,vercel:!1}),v6=ce({githubUrl:Np().default("https://github.com/your-username/your-repo"),appPrefix:W().default("chatjs"),appName:W().default("My AI Chat"),appTitle:W().optional().describe("Browser tab title (defaults to appName)"),appDescription:W().default("AI chat powered by ChatJS"),appUrl:W().url().default("https://your-domain.com"),organization:ce({name:W(),contact:ce({privacyEmail:W().email(),legalEmail:W().email()})}).default({name:"Your Organization",contact:{privacyEmail:"privacy@your-domain.com",legalEmail:"legal@your-domain.com"}}),services:ce({hosting:W(),aiProviders:yt(W()),paymentProcessors:yt(W())}).default({hosting:"Vercel",aiProviders:["OpenAI","Anthropic","Google"],paymentProcessors:[]}),integrations:y6,pricing:p6.optional(),legal:ce({minimumAge:Lt(),governingLaw:W(),refundPolicy:W()}).default({minimumAge:13,governingLaw:"United States",refundPolicy:"no-refunds"}),policies:ce({privacy:ce({title:W(),lastUpdated:W().optional()}),terms:ce({title:W(),lastUpdated:W().optional()})}).default({privacy:{title:"Privacy Policy"},terms:{title:"Terms of Service"}}),authentication:w6,models:h6,anonymous:m6,attachments:g6}),ke=v6.parse(KM);var Ir={exports:{}},bm,D_;function lN(){if(D_)return bm;D_=1;const e=s=>s&&typeof s.message=="string",t=s=>{if(!s)return;const a=s.cause;if(typeof a=="function"){const c=s.cause();return e(c)?c:void 0}else return e(a)?a:void 0},n=(s,a)=>{if(!e(s))return"";const c=s.stack||"";if(a.has(s))return c+`
causes have become circular...`;const l=t(s);return l?(a.add(s),c+`
caused by: `+n(l,a)):c},i=s=>n(s,new Set),r=(s,a,c)=>{if(!e(s))return"";const l=c?"":s.message||"";if(a.has(s))return l+": ...";const u=t(s);if(u){a.add(s);const p=typeof s.cause=="function";return l+(p?"":": ")+r(u,a,p)}else return l};return bm={isErrorLike:e,getErrorCause:t,stackWithCauses:i,messageWithCauses:s=>r(s,new Set)},bm}var _m,U_;function uN(){if(U_)return _m;U_=1;const e=Symbol("circular-ref-tag"),t=Symbol("pino-raw-err-ref"),n=Object.create({},{type:{enumerable:!0,writable:!0,value:void 0},message:{enumerable:!0,writable:!0,value:void 0},stack:{enumerable:!0,writable:!0,value:void 0},aggregateErrors:{enumerable:!0,writable:!0,value:void 0},raw:{enumerable:!1,get:function(){return this[t]},set:function(i){this[t]=i}}});return Object.defineProperty(n,t,{writable:!0,value:{}}),_m={pinoErrProto:n,pinoErrorSymbols:{seen:e,rawSymbol:t}},_m}var Sm,L_;function b6(){if(L_)return Sm;L_=1,Sm=a;const{messageWithCauses:e,stackWithCauses:t,isErrorLike:n}=lN(),{pinoErrProto:i,pinoErrorSymbols:r}=uN(),{seen:o}=r,{toString:s}=Object.prototype;function a(c){if(!n(c))return c;c[o]=void 0;const l=Object.create(i);l.type=s.call(c.constructor)==="[object Function]"?c.constructor.name:c.name,l.message=e(c),l.stack=t(c),Array.isArray(c.errors)&&(l.aggregateErrors=c.errors.map(u=>a(u)));for(const u in c)if(l[u]===void 0){const p=c[u];n(p)?u!=="cause"&&!Object.prototype.hasOwnProperty.call(p,o)&&(l[u]=a(p)):l[u]=p}return delete c[o],l.raw=c,l}return Sm}var xm,M_;function _6(){if(M_)return xm;M_=1,xm=o;const{isErrorLike:e}=lN(),{pinoErrProto:t,pinoErrorSymbols:n}=uN(),{seen:i}=n,{toString:r}=Object.prototype;function o(s){if(!e(s))return s;s[i]=void 0;const a=Object.create(t);a.type=r.call(s.constructor)==="[object Function]"?s.constructor.name:s.name,a.message=s.message,a.stack=s.stack,Array.isArray(s.errors)&&(a.aggregateErrors=s.errors.map(c=>o(c))),e(s.cause)&&!Object.prototype.hasOwnProperty.call(s.cause,i)&&(a.cause=o(s.cause));for(const c in s)if(a[c]===void 0){const l=s[c];e(l)?Object.prototype.hasOwnProperty.call(l,i)||(a[c]=o(l)):a[c]=l}return delete s[i],a.raw=s,a}return xm}var km,j_;function S6(){if(j_)return km;j_=1,km={mapHttpRequest:i,reqSerializer:n};const e=Symbol("pino-raw-req-ref"),t=Object.create({},{id:{enumerable:!0,writable:!0,value:""},method:{enumerable:!0,writable:!0,value:""},url:{enumerable:!0,writable:!0,value:""},query:{enumerable:!0,writable:!0,value:""},params:{enumerable:!0,writable:!0,value:""},headers:{enumerable:!0,writable:!0,value:{}},remoteAddress:{enumerable:!0,writable:!0,value:""},remotePort:{enumerable:!0,writable:!0,value:""},raw:{enumerable:!1,get:function(){return this[e]},set:function(r){this[e]=r}}});Object.defineProperty(t,e,{writable:!0,value:{}});function n(r){const o=r.info||r.socket,s=Object.create(t);if(s.id=typeof r.id=="function"?r.id():r.id||(r.info?r.info.id:void 0),s.method=r.method,r.originalUrl)s.url=r.originalUrl;else{const a=r.path;s.url=typeof a=="string"?a:r.url?r.url.path||r.url:void 0}return r.query&&(s.query=r.query),r.params&&(s.params=r.params),s.headers=r.headers,s.remoteAddress=o&&o.remoteAddress,s.remotePort=o&&o.remotePort,s.raw=r.raw||r,s}function i(r){return{req:n(r)}}return km}var Em,z_;function x6(){if(z_)return Em;z_=1,Em={mapHttpResponse:i,resSerializer:n};const e=Symbol("pino-raw-res-ref"),t=Object.create({},{statusCode:{enumerable:!0,writable:!0,value:0},headers:{enumerable:!0,writable:!0,value:""},raw:{enumerable:!1,get:function(){return this[e]},set:function(r){this[e]=r}}});Object.defineProperty(t,e,{writable:!0,value:{}});function n(r){const o=Object.create(t);return o.statusCode=r.headersSent?r.statusCode:null,o.headers=r.getHeaders?r.getHeaders():r._headers,o.raw=r,o}function i(r){return{res:n(r)}}return Em}var Am,B_;function dN(){if(B_)return Am;B_=1;const e=b6(),t=_6(),n=S6(),i=x6();return Am={err:e,errWithCause:t,mapHttpRequest:n.mapHttpRequest,mapHttpResponse:i.mapHttpResponse,req:n.reqSerializer,res:i.resSerializer,wrapErrorSerializer:function(o){return o===e?o:function(a){return o(e(a))}},wrapRequestSerializer:function(o){return o===n.reqSerializer?o:function(a){return o(n.reqSerializer(a))}},wrapResponseSerializer:function(o){return o===i.resSerializer?o:function(a){return o(i.resSerializer(a))}}},Am}var Tm,F_;function fN(){if(F_)return Tm;F_=1;function e(t,n){return n}return Tm=function(){const n=Error.prepareStackTrace;Error.prepareStackTrace=e;const i=new Error().stack;if(Error.prepareStackTrace=n,!Array.isArray(i))return;const r=i.slice(2),o=[];for(const s of r)s&&o.push(s.getFileName());return o},Tm}var Im,W_;function k6(){if(W_)return Im;W_=1;function e(d){if(d===null||typeof d!="object")return d;if(d instanceof Date)return new Date(d.getTime());if(d instanceof Array){const y=[];for(let v=0;v<d.length;v++)y[v]=e(d[v]);return y}if(typeof d=="object"){const y=Object.create(Object.getPrototypeOf(d));for(const v in d)Object.prototype.hasOwnProperty.call(d,v)&&(y[v]=e(d[v]));return y}return d}function t(d){const y=[];let v="",x=!1,E=!1,N="";for(let C=0;C<d.length;C++){const b=d[C];!x&&b==="."?v&&(y.push(v),v=""):b==="["?(v&&(y.push(v),v=""),x=!0):b==="]"&&x?(y.push(v),v="",x=!1,E=!1):(b==='"'||b==="'")&&x?E?b===N?(E=!1,N=""):v+=b:(E=!0,N=b):v+=b}return v&&y.push(v),y}function n(d,y,v){let x=d;for(let N=0;N<y.length-1;N++){const C=y[N];if(typeof x!="object"||x===null||!(C in x)||typeof x[C]!="object"||x[C]===null)return!1;x=x[C]}const E=y[y.length-1];if(E==="*"){if(Array.isArray(x))for(let N=0;N<x.length;N++)x[N]=v;else if(typeof x=="object"&&x!==null)for(const N in x)Object.prototype.hasOwnProperty.call(x,N)&&(x[N]=v)}else typeof x=="object"&&x!==null&&E in x&&Object.prototype.hasOwnProperty.call(x,E)&&(x[E]=v);return!0}function i(d,y){let v=d;for(let E=0;E<y.length-1;E++){const N=y[E];if(typeof v!="object"||v===null||!(N in v)||typeof v[N]!="object"||v[N]===null)return!1;v=v[N]}const x=y[y.length-1];if(x==="*"){if(Array.isArray(v))for(let E=0;E<v.length;E++)v[E]=void 0;else if(typeof v=="object"&&v!==null)for(const E in v)Object.prototype.hasOwnProperty.call(v,E)&&delete v[E]}else typeof v=="object"&&v!==null&&x in v&&Object.prototype.hasOwnProperty.call(v,x)&&delete v[x];return!0}const r=Symbol("PATH_NOT_FOUND");function o(d,y){let v=d;for(const x of y){if(v==null||typeof v!="object"||v===null||!(x in v))return r;v=v[x]}return v}function s(d,y){let v=d;for(const x of y){if(v==null||typeof v!="object"||v===null)return;v=v[x]}return v}function a(d,y,v,x=!1){for(const E of y){const N=t(E);if(N.includes("*"))c(d,N,v,E,x);else if(x)i(d,N);else{const C=o(d,N);if(C===r)continue;const b=typeof v=="function"?v(C,N):v;n(d,N,b)}}}function c(d,y,v,x,E=!1){const N=y.indexOf("*");if(N===y.length-1){const C=y.slice(0,-1);let b=d;for(const P of C){if(b==null||typeof b!="object"||b===null)return;b=b[P]}if(Array.isArray(b))if(E)for(let P=0;P<b.length;P++)b[P]=void 0;else for(let P=0;P<b.length;P++){const $=[...C,P.toString()],k=typeof v=="function"?v(b[P],$):v;b[P]=k}else if(typeof b=="object"&&b!==null)if(E){const P=[];for(const $ in b)Object.prototype.hasOwnProperty.call(b,$)&&P.push($);for(const $ of P)delete b[$]}else for(const P in b){const $=[...C,P],k=typeof v=="function"?v(b[P],$):v;b[P]=k}}else l(d,y,v,N,x,E)}function l(d,y,v,x,E,N=!1){const C=y.slice(0,x),b=y.slice(x+1),P=[];function $(k,D){if(D===C.length){if(Array.isArray(k))for(let B=0;B<k.length;B++)P[D]=B.toString(),$(k[B],D+1);else if(typeof k=="object"&&k!==null)for(const B in k)P[D]=B,$(k[B],D+1)}else if(D<C.length){const B=C[D];k&&typeof k=="object"&&k!==null&&B in k&&(P[D]=B,$(k[B],D+1))}else if(b.includes("*"))c(k,b,typeof v=="function"?(J,S)=>{const T=[...P.slice(0,D),...S];return v(J,T)}:v,E,N);else if(N)i(k,b);else{const B=typeof v=="function"?v(s(k,b),[...P.slice(0,D),...b]):v;n(k,b,B)}}if(C.length===0)$(d,0);else{let k=d;for(let D=0;D<C.length;D++){const B=C[D];if(k==null||typeof k!="object"||k===null)return;k=k[B],P[D]=B}k!=null&&$(k,C.length)}}function u(d){if(d.length===0)return null;const y=new Map;for(const v of d){const x=t(v);let E=y;for(let N=0;N<x.length;N++){const C=x[N];E.has(C)||E.set(C,new Map),E=E.get(C)}}return y}function p(d,y){if(!y)return d;function v(x,E,N=0){if(!E||E.size===0||x===null||typeof x!="object")return x;if(x instanceof Date)return new Date(x.getTime());if(Array.isArray(x)){const b=[];for(let P=0;P<x.length;P++){const $=P.toString();E.has($)||E.has("*")?b[P]=v(x[P],E.get($)||E.get("*")):b[P]=x[P]}return b}const C=Object.create(Object.getPrototypeOf(x));for(const b in x)Object.prototype.hasOwnProperty.call(x,b)&&(E.has(b)||E.has("*")?C[b]=v(x[b],E.get(b)||E.get("*")):C[b]=x[b]);return C}return v(d,y)}function f(d){if(typeof d!="string")throw new Error("Paths must be (non-empty) strings");if(d==="")throw new Error("Invalid redaction path ()");if(d.includes(".."))throw new Error(`Invalid redaction path (${d})`);if(d.includes(","))throw new Error(`Invalid redaction path (${d})`);let y=0,v=!1,x="";for(let E=0;E<d.length;E++){const N=d[E];if((N==='"'||N==="'")&&y>0)v?N===x&&(v=!1,x=""):(v=!0,x=N);else if(N==="["&&!v)y++;else if(N==="]"&&!v&&(y--,y<0))throw new Error(`Invalid redaction path (${d})`)}if(y!==0)throw new Error(`Invalid redaction path (${d})`)}function g(d){if(!Array.isArray(d))throw new TypeError("paths must be an array");for(const y of d)f(y)}function h(d={}){const{paths:y=[],censor:v="[REDACTED]",serialize:x=JSON.stringify,strict:E=!0,remove:N=!1}=d;g(y);const C=u(y);return function(P){if(E&&(P===null||typeof P!="object")&&(P==null||typeof P!="object"))return x?x(P):P;const $=p(P,C),k=P;let D=v;return typeof v=="function"&&(D=v),a($,y,D,N),x===!1?($.restore=function(){return e(k)},$):typeof x=="function"?x($):JSON.stringify($)}}return Im=h,Im}var Nm,V_;function Lu(){if(V_)return Nm;V_=1;const e=Symbol("pino.setLevel"),t=Symbol("pino.getLevel"),n=Symbol("pino.levelVal"),i=Symbol("pino.levelComp"),r=Symbol("pino.useLevelLabels"),o=Symbol("pino.useOnlyCustomLevels"),s=Symbol("pino.mixin"),a=Symbol("pino.lsCache"),c=Symbol("pino.chindings"),l=Symbol("pino.asJson"),u=Symbol("pino.write"),p=Symbol("pino.redactFmt"),f=Symbol("pino.time"),g=Symbol("pino.timeSliceIndex"),h=Symbol("pino.stream"),d=Symbol("pino.stringify"),y=Symbol("pino.stringifySafe"),v=Symbol("pino.stringifiers"),x=Symbol("pino.end"),E=Symbol("pino.formatOpts"),N=Symbol("pino.messageKey"),C=Symbol("pino.errorKey"),b=Symbol("pino.nestedKey"),P=Symbol("pino.nestedKeyStr"),$=Symbol("pino.mixinMergeStrategy"),k=Symbol("pino.msgPrefix"),D=Symbol("pino.wildcardFirst"),B=Symbol.for("pino.serializers"),J=Symbol.for("pino.formatters"),S=Symbol.for("pino.hooks");return Nm={setLevelSym:e,getLevelSym:t,levelValSym:n,levelCompSym:i,useLevelLabelsSym:r,mixinSym:s,lsCacheSym:a,chindingsSym:c,asJsonSym:l,writeSym:u,serializersSym:B,redactFmtSym:p,timeSym:f,timeSliceIndexSym:g,streamSym:h,stringifySym:d,stringifySafeSym:y,stringifiersSym:v,endSym:x,formatOptsSym:E,messageKeySym:N,errorKeySym:C,nestedKeySym:b,wildcardFirstSym:D,needsMetadataGsym:Symbol.for("pino.metadata"),useOnlyCustomLevelsSym:o,formattersSym:J,hooksSym:S,nestedKeyStrSym:P,mixinMergeStrategySym:$,msgPrefixSym:k},Nm}var $m,q_;function pN(){if(q_)return $m;q_=1;const e=k6(),{redactFmtSym:t,wildcardFirstSym:n}=Lu(),i=/[^.[\]]+|\[([^[\]]*?)\]/g,r="[Redacted]",o=!1;function s(c,l){const{paths:u,censor:p,remove:f}=a(c),g=u.reduce((y,v)=>{i.lastIndex=0;const x=i.exec(v),E=i.exec(v);let N=x[1]!==void 0?x[1].replace(/^(?:"|'|`)(.*)(?:"|'|`)$/,"$1"):x[0];if(N==="*"&&(N=n),E===null)return y[N]=null,y;if(y[N]===null)return y;const{index:C}=E,b=`${v.substr(C,v.length-1)}`;return y[N]=y[N]||[],N!==n&&y[N].length===0&&y[N].push(...y[n]||[]),N===n&&Object.keys(y).forEach(function(P){y[P]&&y[P].push(b)}),y[N].push(b),y},{}),h={[t]:e({paths:u,censor:p,serialize:l,strict:o,remove:f})},d=(...y)=>l(typeof p=="function"?p(...y):p);return[...Object.keys(g),...Object.getOwnPropertySymbols(g)].reduce((y,v)=>{if(g[v]===null)y[v]=x=>d(x,[v]);else{const x=typeof p=="function"?(E,N)=>p(E,[v,...N]):p;y[v]=e({paths:g[v],censor:x,serialize:l,strict:o,remove:f})}return y},h)}function a(c){if(Array.isArray(c))return c={paths:c,censor:r},c;let{paths:l,censor:u=r,remove:p}=c;if(Array.isArray(l)===!1)throw Error("pino  redact must contain an array of strings");return p===!0&&(u=void 0),{paths:l,censor:u,remove:p}}return $m=s,$m}var Cm,H_;function E6(){if(H_)return Cm;H_=1;const e=()=>"",t=()=>`,"time":${Date.now()}`,n=()=>`,"time":${Math.round(Date.now()/1e3)}`,i=()=>`,"time":"${new Date(Date.now()).toISOString()}"`,r=1000000n,o=1000000000n,s=BigInt(Date.now())*r,a=process.hrtime.bigint();return Cm={nullTime:e,epochTime:t,unixTime:n,isoTime:i,isoTimeNano:()=>{const l=process.hrtime.bigint()-a,u=s+l,p=u/o,f=u%o,g=Number(p*1000n+f/1000000n),h=new Date(g),d=h.getUTCFullYear(),y=(h.getUTCMonth()+1).toString().padStart(2,"0"),v=h.getUTCDate().toString().padStart(2,"0"),x=h.getUTCHours().toString().padStart(2,"0"),E=h.getUTCMinutes().toString().padStart(2,"0"),N=h.getUTCSeconds().toString().padStart(2,"0");return`,"time":"${d}-${y}-${v}T${x}:${E}:${N}.${f.toString().padStart(9,"0")}Z"`}},Cm}var Om,K_;function A6(){if(K_)return Om;K_=1;function e(n){try{return JSON.stringify(n)}catch{return'"[Circular]"'}}Om=t;function t(n,i,r){var o=r&&r.stringify||e,s=1;if(typeof n=="object"&&n!==null){var a=i.length+s;if(a===1)return n;var c=new Array(a);c[0]=o(n);for(var l=1;l<a;l++)c[l]=o(i[l]);return c.join(" ")}if(typeof n!="string")return n;var u=i.length;if(u===0)return n;for(var p="",f=1-s,g=-1,h=n&&n.length||0,d=0;d<h;){if(n.charCodeAt(d)===37&&d+1<h){switch(g=g>-1?g:0,n.charCodeAt(d+1)){case 100:case 102:if(f>=u||i[f]==null)break;g<d&&(p+=n.slice(g,d)),p+=Number(i[f]),g=d+2,d++;break;case 105:if(f>=u||i[f]==null)break;g<d&&(p+=n.slice(g,d)),p+=Math.floor(Number(i[f])),g=d+2,d++;break;case 79:case 111:case 106:if(f>=u||i[f]===void 0)break;g<d&&(p+=n.slice(g,d));var y=typeof i[f];if(y==="string"){p+="'"+i[f]+"'",g=d+2,d++;break}if(y==="function"){p+=i[f].name||"<anonymous>",g=d+2,d++;break}p+=o(i[f]),g=d+2,d++;break;case 115:if(f>=u)break;g<d&&(p+=n.slice(g,d)),p+=String(i[f]),g=d+2,d++;break;case 37:g<d&&(p+=n.slice(g,d)),p+="%",g=d+2,d++,f--;break}++f}++d}return g===-1?n:(g<h&&(p+=n.slice(g)),p)}return Om}var bd={exports:{}},J_;function hN(){if(J_)return bd.exports;if(J_=1,typeof SharedArrayBuffer<"u"&&typeof Atomics<"u"){let t=function(n){if((n>0&&n<1/0)===!1)throw typeof n!="number"&&typeof n!="bigint"?TypeError("sleep: ms must be a number"):RangeError("sleep: ms must be a number that is greater than 0 but less than Infinity");Atomics.wait(e,0,0,Number(n))};const e=new Int32Array(new SharedArrayBuffer(4));bd.exports=t}else{let e=function(t){if((t>0&&t<1/0)===!1)throw typeof t!="number"&&typeof t!="bigint"?TypeError("sleep: ms must be a number"):RangeError("sleep: ms must be a number that is greater than 0 but less than Infinity")};bd.exports=e}return bd.exports}var Rm,G_;function T6(){if(G_)return Rm;G_=1;const e=kD,t=bE,n=ED.inherits,i=_E,r=hN(),o=SE,s=100,a=Buffer.allocUnsafe(0),c=16*1024,l="buffer",u="utf8",[p,f]=(process.versions.node||"0.0").split(".").map(Number),g=p>=22&&f>=7;function h(S,T){T._opening=!0,T._writing=!0,T._asyncDrainScheduled=!1;function z(V,K){if(V){T._reopening=!1,T._writing=!1,T._opening=!1,T.sync?process.nextTick(()=>{T.listenerCount("error")>0&&T.emit("error",V)}):T.emit("error",V);return}const oe=T._reopening;T.fd=K,T.file=S,T._reopening=!1,T._opening=!1,T._writing=!1,T.sync?process.nextTick(()=>T.emit("ready")):T.emit("ready"),!T.destroyed&&(!T._writing&&T._len>T.minLength||T._flushPending?T._actualWrite():oe&&process.nextTick(()=>T.emit("drain")))}const L=T.append?"a":"w",q=T.mode;if(T.sync)try{T.mkdir&&e.mkdirSync(i.dirname(S),{recursive:!0});const V=e.openSync(S,L,q);z(null,V)}catch(V){throw z(V),V}else T.mkdir?e.mkdir(i.dirname(S),{recursive:!0},V=>{if(V)return z(V);e.open(S,L,q,z)}):e.open(S,L,q,z)}function d(S){if(!(this instanceof d))return new d(S);let{fd:T,dest:z,minLength:L,maxLength:q,maxWrite:V,periodicFlush:K,sync:oe,append:ne=!0,mkdir:X,retryEAGAIN:ae,fsync:he,contentMode:ge,mode:pe}=S||{};T=T||z,this._len=0,this.fd=-1,this._bufs=[],this._lens=[],this._writing=!1,this._ending=!1,this._reopening=!1,this._asyncDrainScheduled=!1,this._flushPending=!1,this._hwm=Math.max(L||0,16387),this.file=null,this.destroyed=!1,this.minLength=L||0,this.maxLength=q||0,this.maxWrite=V||c,this._periodicFlush=K||0,this._periodicFlushTimer=void 0,this.sync=oe||!1,this.writable=!0,this._fsync=he||!1,this.append=ne||!1,this.mode=pe,this.retryEAGAIN=ae||(()=>!0),this.mkdir=X||!1;let fe,xe;if(ge===l)this._writingBuf=a,this.write=N,this.flush=P,this.flushSync=k,this._actualWrite=B,fe=()=>e.writeSync(this.fd,this._writingBuf),xe=()=>e.write(this.fd,this._writingBuf,this.release);else if(ge===void 0||ge===u)this._writingBuf="",this.write=E,this.flush=b,this.flushSync=$,this._actualWrite=D,fe=()=>e.writeSync(this.fd,this._writingBuf,"utf8"),xe=()=>e.write(this.fd,this._writingBuf,"utf8",this.release);else throw new Error(`SonicBoom supports "${u}" and "${l}", but passed ${ge}`);if(typeof T=="number")this.fd=T,process.nextTick(()=>this.emit("ready"));else if(typeof T=="string")h(T,this);else throw new Error("SonicBoom supports only file descriptors and files");if(this.minLength>=this.maxWrite)throw new Error(`minLength should be smaller than maxWrite (${this.maxWrite})`);this.release=(Ce,Ze)=>{if(Ce){if((Ce.code==="EAGAIN"||Ce.code==="EBUSY")&&this.retryEAGAIN(Ce,this._writingBuf.length,this._len-this._writingBuf.length))if(this.sync)try{r(s),this.release(void 0,0)}catch(we){this.release(we)}else setTimeout(xe,s);else this._writing=!1,this.emit("error",Ce);return}this.emit("write",Ze);const st=y(this._writingBuf,this._len,Ze);if(this._len=st.len,this._writingBuf=st.writingBuf,this._writingBuf.length){if(!this.sync){xe();return}try{do{const we=fe(),Ue=y(this._writingBuf,this._len,we);this._len=Ue.len,this._writingBuf=Ue.writingBuf}while(this._writingBuf.length)}catch(we){this.release(we);return}}this._fsync&&e.fsyncSync(this.fd);const Ke=this._len;this._reopening?(this._writing=!1,this._reopening=!1,this.reopen()):Ke>this.minLength?this._actualWrite():this._ending?Ke>0?this._actualWrite():(this._writing=!1,J(this)):(this._writing=!1,this.sync?this._asyncDrainScheduled||(this._asyncDrainScheduled=!0,process.nextTick(v,this)):this.emit("drain"))},this.on("newListener",function(Ce){Ce==="drain"&&(this._asyncDrainScheduled=!1)}),this._periodicFlush!==0&&(this._periodicFlushTimer=setInterval(()=>this.flush(null),this._periodicFlush),this._periodicFlushTimer.unref())}function y(S,T,z){return typeof S=="string"&&Buffer.byteLength(S)!==z&&(z=Buffer.from(S).subarray(0,z).toString().length),T=Math.max(T-z,0),S=S.slice(z),{writingBuf:S,len:T}}function v(S){S.listenerCount("drain")>0&&(S._asyncDrainScheduled=!1,S.emit("drain"))}n(d,t);function x(S,T){return S.length===0?a:S.length===1?S[0]:Buffer.concat(S,T)}function E(S){if(this.destroyed)throw new Error("SonicBoom destroyed");const T=this._len+S.length,z=this._bufs;return this.maxLength&&T>this.maxLength?(this.emit("drop",S),this._len<this._hwm):(z.length===0||z[z.length-1].length+S.length>this.maxWrite?z.push(""+S):z[z.length-1]+=S,this._len=T,!this._writing&&this._len>=this.minLength&&this._actualWrite(),this._len<this._hwm)}function N(S){if(this.destroyed)throw new Error("SonicBoom destroyed");const T=this._len+S.length,z=this._bufs,L=this._lens;return this.maxLength&&T>this.maxLength?(this.emit("drop",S),this._len<this._hwm):(z.length===0||L[L.length-1]+S.length>this.maxWrite?(z.push([S]),L.push(S.length)):(z[z.length-1].push(S),L[L.length-1]+=S.length),this._len=T,!this._writing&&this._len>=this.minLength&&this._actualWrite(),this._len<this._hwm)}function C(S){this._flushPending=!0;const T=()=>{if(this._fsync)this._flushPending=!1,S();else try{e.fsync(this.fd,L=>{this._flushPending=!1,S(L)})}catch(L){S(L)}this.off("error",z)},z=L=>{this._flushPending=!1,S(L),this.off("drain",T)};this.once("drain",T),this.once("error",z)}function b(S){if(S!=null&&typeof S!="function")throw new Error("flush cb must be a function");if(this.destroyed){const T=new Error("SonicBoom destroyed");if(S){S(T);return}throw T}if(this.minLength<=0){S?.();return}S&&C.call(this,S),!this._writing&&(this._bufs.length===0&&this._bufs.push(""),this._actualWrite())}function P(S){if(S!=null&&typeof S!="function")throw new Error("flush cb must be a function");if(this.destroyed){const T=new Error("SonicBoom destroyed");if(S){S(T);return}throw T}if(this.minLength<=0){S?.();return}S&&C.call(this,S),!this._writing&&(this._bufs.length===0&&(this._bufs.push([]),this._lens.push(0)),this._actualWrite())}d.prototype.reopen=function(S){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this._opening){this.once("ready",()=>{this.reopen(S)});return}if(this._ending)return;if(!this.file)throw new Error("Unable to reopen a file descriptor, you must pass a file to SonicBoom");if(S&&(this.file=S),this._reopening=!0,this._writing)return;const T=this.fd;this.once("ready",()=>{T!==this.fd&&e.close(T,z=>{if(z)return this.emit("error",z)})}),h(this.file,this)},d.prototype.end=function(){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this._opening){this.once("ready",()=>{this.end()});return}this._ending||(this._ending=!0,!this._writing&&(this._len>0&&this.fd>=0?this._actualWrite():J(this)))};function $(){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this.fd<0)throw new Error("sonic boom is not ready yet");!this._writing&&this._writingBuf.length>0&&(this._bufs.unshift(this._writingBuf),this._writingBuf="");let S="";for(;this._bufs.length||S;){S.length<=0&&(S=this._bufs[0]);try{const T=e.writeSync(this.fd,S,"utf8"),z=y(S,this._len,T);S=z.writingBuf,this._len=z.len,S.length<=0&&this._bufs.shift()}catch(T){if((T.code==="EAGAIN"||T.code==="EBUSY")&&!this.retryEAGAIN(T,S.length,this._len-S.length))throw T;r(s)}}try{e.fsyncSync(this.fd)}catch{}}function k(){if(this.destroyed)throw new Error("SonicBoom destroyed");if(this.fd<0)throw new Error("sonic boom is not ready yet");!this._writing&&this._writingBuf.length>0&&(this._bufs.unshift([this._writingBuf]),this._writingBuf=a);let S=a;for(;this._bufs.length||S.length;){S.length<=0&&(S=x(this._bufs[0],this._lens[0]));try{const T=e.writeSync(this.fd,S);S=S.subarray(T),this._len=Math.max(this._len-T,0),S.length<=0&&(this._bufs.shift(),this._lens.shift())}catch(T){if((T.code==="EAGAIN"||T.code==="EBUSY")&&!this.retryEAGAIN(T,S.length,this._len-S.length))throw T;r(s)}}}d.prototype.destroy=function(){this.destroyed||J(this)};function D(){const S=this.release;if(this._writing=!0,this._writingBuf=this._writingBuf||this._bufs.shift()||"",this.sync)try{const T=e.writeSync(this.fd,this._writingBuf,"utf8");S(null,T)}catch(T){S(T)}else e.write(this.fd,this._writingBuf,"utf8",S)}function B(){const S=this.release;if(this._writing=!0,this._writingBuf=this._writingBuf.length?this._writingBuf:x(this._bufs.shift(),this._lens.shift()),this.sync)try{const T=e.writeSync(this.fd,this._writingBuf);S(null,T)}catch(T){S(T)}else g&&(this._writingBuf=Buffer.from(this._writingBuf)),e.write(this.fd,this._writingBuf,S)}function J(S){if(S.fd===-1){S.once("ready",J.bind(null,S));return}S._periodicFlushTimer!==void 0&&clearInterval(S._periodicFlushTimer),S.destroyed=!0,S._bufs=[],S._lens=[],o(typeof S.fd=="number",`sonic.fd must be a number, got ${typeof S.fd}`);try{e.fsync(S.fd,T)}catch{}function T(){S.fd!==1&&S.fd!==2?e.close(S.fd,z):z()}function z(L){if(L){S.emit("error",L);return}S._ending&&!S._writing&&S.emit("finish"),S.emit("close")}}return d.SonicBoom=d,d.default=d,Rm=d,Rm}var Pm,Z_;function mN(){if(Z_)return Pm;Z_=1;const e={exit:[],beforeExit:[]},t={exit:s,beforeExit:a};let n;function i(){n===void 0&&(n=new FinalizationRegistry(l))}function r(h){e[h].length>0||process.on(h,t[h])}function o(h){e[h].length>0||(process.removeListener(h,t[h]),e.exit.length===0&&e.beforeExit.length===0&&(n=void 0))}function s(){c("exit")}function a(){c("beforeExit")}function c(h){for(const d of e[h]){const y=d.deref(),v=d.fn;y!==void 0&&v(y,h)}e[h]=[]}function l(h){for(const d of["exit","beforeExit"]){const y=e[d].indexOf(h);e[d].splice(y,y+1),o(d)}}function u(h,d,y){if(d===void 0)throw new Error("the object can't be undefined");r(h);const v=new WeakRef(d);v.fn=y,i(),n.register(d,v),e[h].push(v)}function p(h,d){u("exit",h,d)}function f(h,d){u("beforeExit",h,d)}function g(h){if(n!==void 0){n.unregister(h);for(const d of["exit","beforeExit"])e[d]=e[d].filter(y=>{const v=y.deref();return v&&v!==h}),o(d)}}return Pm={register:p,registerBeforeExit:f,unregister:g},Pm}class gN{name="";onmessage=t=>{};onmessageerror=t=>{};close(){}postMessage(t){}ref(){return this}unref(){return this}}class El extends lf{close(){}postMessage(t,n){}ref(){}unref(){}start(){}addEventListener(t,n){this.on(t,n)}removeEventListener(t,n){this.off(t,n)}dispatchEvent(t){return this.emit(t.type,t)}}class yN{port1=new El;port2=new El}class wN extends lf{stdin=null;stdout=new fm;stderr=new fm;threadId=0;performance={eventLoopUtilization:()=>({idle:0,active:0,utilization:0})};postMessage(t,n){}postMessageToThread(t,n,i,r){return Promise.resolve()}ref(){}unref(){}terminate(){return Promise.resolve(0)}getHeapSnapshot(){return Promise.resolve(new fm)}}const vN=new Map,bN=function(t){return vN.get(t)},_N=function(t,n){vN.set(t,n)},SN=!0,xN=()=>!1,kN=function(t){},EN=()=>{},AN=()=>new El,TN=null,IN=()=>{},NN=Symbol.for("nodejs.worker_threads.SHARE_ENV"),$N={},CN=0,ON=null,RN=ys("worker_threads.postMessageToThread"),PN=!1,I6={BroadcastChannel:gN,MessageChannel:yN,MessagePort:El,Worker:wN,SHARE_ENV:NN,getEnvironmentData:bN,isMainThread:SN,isMarkedAsUntransferable:xN,markAsUntransferable:kN,markAsUncloneable:EN,moveMessagePortToContext:AN,parentPort:TN,receiveMessageOnPort:IN,resourceLimits:$N,setEnvironmentData:_N,postMessageToThread:RN,threadId:CN,workerData:ON,isInternalThread:PN},N6=Object.freeze(Object.defineProperty({__proto__:null,BroadcastChannel:gN,MessageChannel:yN,MessagePort:El,SHARE_ENV:NN,Worker:wN,default:I6,getEnvironmentData:bN,isInternalThread:PN,isMainThread:SN,isMarkedAsUntransferable:xN,markAsUncloneable:EN,markAsUntransferable:kN,moveMessagePortToContext:AN,parentPort:TN,postMessageToThread:RN,receiveMessageOnPort:IN,resourceLimits:$N,setEnvironmentData:_N,threadId:CN,workerData:ON},Symbol.toStringTag,{value:"Module"})),DN=zL(N6),$6="3.1.0",C6={version:$6};var Dm,Q_;function O6(){if(Q_)return Dm;Q_=1;const e=1e3;function t(i,r,o,s,a){const c=Date.now()+s;let l=Atomics.load(i,r);if(l===o){a(null,"ok");return}let u=l;const p=f=>{Date.now()>c?a(null,"timed-out"):setTimeout(()=>{u=l,l=Atomics.load(i,r),l===u?p(f>=e?e:f*2):l===o?a(null,"ok"):a(null,"not-equal")},f)};p(1)}function n(i,r,o,s,a){const c=Date.now()+s;let l=Atomics.load(i,r);if(l!==o){a(null,"ok");return}const u=p=>{Date.now()>c?a(null,"timed-out"):setTimeout(()=>{l=Atomics.load(i,r),l!==o?a(null,"ok"):u(p>=e?e:p*2)},p)};u(1)}return Dm={wait:t,waitDiff:n},Dm}var Um,Y_;function R6(){return Y_||(Y_=1,Um={WRITE_INDEX:4,READ_INDEX:8}),Um}var Lm,X_;function P6(){if(X_)return Lm;X_=1;const{version:e}=C6,{EventEmitter:t}=bE,{Worker:n}=DN,{join:i}=_E,{pathToFileURL:r}=ID,{wait:o}=O6(),{WRITE_INDEX:s,READ_INDEX:a}=R6(),c=ND,l=SE,u=Symbol("kImpl"),p=c.constants.MAX_STRING_LENGTH;class f{constructor(T){this._value=T}deref(){return this._value}}class g{register(){}unregister(){}}const h=process.env.NODE_V8_COVERAGE?g:i_.FinalizationRegistry||g,d=process.env.NODE_V8_COVERAGE?f:i_.WeakRef||f,y=new h(S=>{S.exited||S.terminate()});function v(S,T){const{filename:z,workerData:L}=T,V=("__bundlerPathsOverrides"in globalThis?globalThis.__bundlerPathsOverrides:{})["thread-stream-worker"]||i(__dirname,"lib","worker.js"),K=new n(V,{...T.workerOpts,trackUnmanagedFds:!1,workerData:{filename:z.indexOf("file://")===0?z:r(z).href,dataBuf:S[u].dataBuf,stateBuf:S[u].stateBuf,workerData:{$context:{threadStreamVersion:e},...L}}});return K.stream=new f(S),K.on("message",N),K.on("exit",C),y.register(S,K),K}function x(S){l(!S[u].sync),S[u].needDrain&&(S[u].needDrain=!1,S.emit("drain"))}function E(S){const T=Atomics.load(S[u].state,s);let z=S[u].data.length-T;if(z>0){if(S[u].buf.length===0){S[u].flushing=!1,S[u].ending?D(S):S[u].needDrain&&process.nextTick(x,S);return}let L=S[u].buf.slice(0,z),q=Buffer.byteLength(L);q<=z?(S[u].buf=S[u].buf.slice(z),k(S,L,E.bind(null,S))):S.flush(()=>{if(!S.destroyed){for(Atomics.store(S[u].state,a,0),Atomics.store(S[u].state,s,0);q>S[u].data.length;)z=z/2,L=S[u].buf.slice(0,z),q=Buffer.byteLength(L);S[u].buf=S[u].buf.slice(z),k(S,L,E.bind(null,S))}})}else if(z===0){if(T===0&&S[u].buf.length===0)return;S.flush(()=>{Atomics.store(S[u].state,a,0),Atomics.store(S[u].state,s,0),E(S)})}else $(S,new Error("overwritten"))}function N(S){const T=this.stream.deref();if(T===void 0){this.exited=!0,this.terminate();return}switch(S.code){case"READY":this.stream=new d(T),T.flush(()=>{T[u].ready=!0,T.emit("ready")});break;case"ERROR":$(T,S.err);break;case"EVENT":Array.isArray(S.args)?T.emit(S.name,...S.args):T.emit(S.name,S.args);break;case"WARNING":process.emitWarning(S.err);break;default:$(T,new Error("this should not happen: "+S.code))}}function C(S){const T=this.stream.deref();T!==void 0&&(y.unregister(T),T.worker.exited=!0,T.worker.off("exit",C),$(T,S!==0?new Error("the worker thread exited"):null))}class b extends t{constructor(T={}){if(super(),T.bufferSize<4)throw new Error("bufferSize must at least fit a 4-byte utf-8 char");this[u]={},this[u].stateBuf=new SharedArrayBuffer(128),this[u].state=new Int32Array(this[u].stateBuf),this[u].dataBuf=new SharedArrayBuffer(T.bufferSize||4*1024*1024),this[u].data=Buffer.from(this[u].dataBuf),this[u].sync=T.sync||!1,this[u].ending=!1,this[u].ended=!1,this[u].needDrain=!1,this[u].destroyed=!1,this[u].flushing=!1,this[u].ready=!1,this[u].finished=!1,this[u].errored=null,this[u].closed=!1,this[u].buf="",this.worker=v(this,T),this.on("message",(z,L)=>{this.worker.postMessage(z,L)})}write(T){if(this[u].destroyed)return P(this,new Error("the worker has exited")),!1;if(this[u].ending)return P(this,new Error("the worker is ending")),!1;if(this[u].flushing&&this[u].buf.length+T.length>=p)try{B(this),this[u].flushing=!0}catch(z){return $(this,z),!1}if(this[u].buf+=T,this[u].sync)try{return B(this),!0}catch(z){return $(this,z),!1}return this[u].flushing||(this[u].flushing=!0,setImmediate(E,this)),this[u].needDrain=this[u].data.length-this[u].buf.length-Atomics.load(this[u].state,s)<=0,!this[u].needDrain}end(){this[u].destroyed||(this[u].ending=!0,D(this))}flush(T){if(this[u].destroyed){typeof T=="function"&&process.nextTick(T,new Error("the worker has exited"));return}const z=Atomics.load(this[u].state,s);o(this[u].state,a,z,1/0,(L,q)=>{if(L){$(this,L),process.nextTick(T,L);return}if(q==="not-equal"){this.flush(T);return}process.nextTick(T)})}flushSync(){this[u].destroyed||(B(this),J(this))}unref(){this.worker.unref()}ref(){this.worker.ref()}get ready(){return this[u].ready}get destroyed(){return this[u].destroyed}get closed(){return this[u].closed}get writable(){return!this[u].destroyed&&!this[u].ending}get writableEnded(){return this[u].ending}get writableFinished(){return this[u].finished}get writableNeedDrain(){return this[u].needDrain}get writableObjectMode(){return!1}get writableErrored(){return this[u].errored}}function P(S,T){setImmediate(()=>{S.emit("error",T)})}function $(S,T){S[u].destroyed||(S[u].destroyed=!0,T&&(S[u].errored=T,P(S,T)),S.worker.exited?setImmediate(()=>{S[u].closed=!0,S.emit("close")}):S.worker.terminate().catch(()=>{}).then(()=>{S[u].closed=!0,S.emit("close")}))}function k(S,T,z){const L=Atomics.load(S[u].state,s),q=Buffer.byteLength(T);return S[u].data.write(T,L),Atomics.store(S[u].state,s,L+q),Atomics.notify(S[u].state,s),z(),!0}function D(S){if(!(S[u].ended||!S[u].ending||S[u].flushing)){S[u].ended=!0;try{S.flushSync();let T=Atomics.load(S[u].state,a);Atomics.store(S[u].state,s,-1),Atomics.notify(S[u].state,s);let z=0;for(;T!==-1;){if(Atomics.wait(S[u].state,a,T,1e3),T=Atomics.load(S[u].state,a),T===-2){$(S,new Error("end() failed"));return}if(++z===10){$(S,new Error("end() took too long (10s)"));return}}process.nextTick(()=>{S[u].finished=!0,S.emit("finish")})}catch(T){$(S,T)}}}function B(S){const T=()=>{S[u].ending?D(S):S[u].needDrain&&process.nextTick(x,S)};for(S[u].flushing=!1;S[u].buf.length!==0;){const z=Atomics.load(S[u].state,s);let L=S[u].data.length-z;if(L===0){J(S),Atomics.store(S[u].state,a,0),Atomics.store(S[u].state,s,0);continue}else if(L<0)throw new Error("overwritten");let q=S[u].buf.slice(0,L),V=Buffer.byteLength(q);if(V<=L)S[u].buf=S[u].buf.slice(L),k(S,q,T);else{for(J(S),Atomics.store(S[u].state,a,0),Atomics.store(S[u].state,s,0);V>S[u].buf.length;)L=L/2,q=S[u].buf.slice(0,L),V=Buffer.byteLength(q);S[u].buf=S[u].buf.slice(L),k(S,q,T)}}}function J(S){if(S[u].flushing)throw new Error("unable to flush while flushing");const T=Atomics.load(S[u].state,s);let z=0;for(;;){const L=Atomics.load(S[u].state,a);if(L===-2)throw Error("_flushSync failed");if(L!==T)Atomics.wait(S[u].state,a,L,1e3);else break;if(++z===10)throw new Error("_flushSync took too long (10s)")}}return Lm=b,Lm}var Mm,eS;function UN(){if(eS)return Mm;eS=1;const{createRequire:e}=AD,t=fN(),{join:n,isAbsolute:i,sep:r}=TD,o=hN(),s=mN(),a=P6();function c(g){s.register(g,u),s.registerBeforeExit(g,p),g.on("close",function(){s.unregister(g)})}function l(g,h,d,y){const v=new a({filename:g,workerData:h,workerOpts:d,sync:y});v.on("ready",x),v.on("close",function(){process.removeListener("exit",E)}),process.on("exit",E);function x(){process.removeListener("exit",E),v.unref(),d.autoEnd!==!1&&c(v)}function E(){v.closed||(v.flushSync(),o(100),v.end())}return v}function u(g){g.ref(),g.flushSync(),g.end(),g.once("close",function(){g.unref()})}function p(g){g.flushSync()}function f(g){const{pipeline:h,targets:d,levels:y,dedupe:v,worker:x={},caller:E=t(),sync:N=!1}=g,C={...g.options},b=typeof E=="string"?[E]:E,P="__bundlerPathsOverrides"in globalThis?globalThis.__bundlerPathsOverrides:{};let $=g.target;if($&&d)throw new Error("only one of target or targets can be specified");return d?($=P["pino-worker"]||n(__dirname,"worker.js"),C.targets=d.filter(D=>D.target).map(D=>({...D,target:k(D.target)})),C.pipelines=d.filter(D=>D.pipeline).map(D=>D.pipeline.map(B=>({...B,level:D.level,target:k(B.target)})))):h&&($=P["pino-worker"]||n(__dirname,"worker.js"),C.pipelines=[h.map(D=>({...D,target:k(D.target)}))]),y&&(C.levels=y),v&&(C.dedupe=v),C.pinoWillSendConfig=!0,l(k($),C,x,N);function k(D){if(D=P[D]||D,i(D)||D.indexOf("file://")===0)return D;if(D==="pino/file")return n(__dirname,"..","file.js");let B;for(const J of b)try{const S=J==="node:repl"?process.cwd()+r:J;B=e(S).resolve(D);break}catch{continue}if(!B)throw new Error(`unable to determine transport target for "${D}"`);return B}}return Mm=f,Mm}var jm,tS;function rb(){if(tS)return jm;tS=1;const e=xD,t=A6(),{mapHttpRequest:n,mapHttpResponse:i}=dN(),r=T6(),o=mN(),{lsCacheSym:s,chindingsSym:a,writeSym:c,serializersSym:l,formatOptsSym:u,endSym:p,stringifiersSym:f,stringifySym:g,stringifySafeSym:h,wildcardFirstSym:d,nestedKeySym:y,formattersSym:v,messageKeySym:x,errorKeySym:E,nestedKeyStrSym:N,msgPrefixSym:C}=Lu(),{isMainThread:b}=DN,P=UN();let $;typeof e.tracingChannel=="function"?$=e.tracingChannel("pino_asJson"):$={hasSubscribers:!1,traceSync(X,ae,he,...ge){return X.call(he,...ge)}};function k(){}function D(X,ae){if(!ae)return he;return function(...pe){ae.call(this,pe,he,X)};function he(ge,...pe){if(typeof ge=="object"){let fe=ge;ge!==null&&(ge.method&&ge.headers&&ge.socket?ge=n(ge):typeof ge.setHeader=="function"&&(ge=i(ge)));let xe;fe===null&&pe.length===0?xe=[null]:(fe=pe.shift(),xe=pe),typeof this[C]=="string"&&fe!==void 0&&fe!==null&&(fe=this[C]+fe),this[c](ge,t(fe,xe,this[u]),X)}else{let fe=ge===void 0?pe.shift():ge;typeof this[C]=="string"&&fe!==void 0&&fe!==null&&(fe=this[C]+fe),this[c](null,t(fe,pe,this[u]),X)}}}function B(X){let ae="",he=0,ge=!1,pe=255;const fe=X.length;if(fe>100)return JSON.stringify(X);for(var xe=0;xe<fe&&pe>=32;xe++)pe=X.charCodeAt(xe),(pe===34||pe===92)&&(ae+=X.slice(he,xe)+"\\",he=xe,ge=!0);return ge?ae+=X.slice(he):ae=X,pe<32?JSON.stringify(X):'"'+ae+'"'}function J(X,ae,he,ge){if($.hasSubscribers===!1)return S.call(this,X,ae,he,ge);const pe={instance:this,arguments};return $.traceSync(S,pe,this,X,ae,he,ge)}function S(X,ae,he,ge){const pe=this[g],fe=this[h],xe=this[f],Ce=this[p],Ze=this[a],st=this[l],Ke=this[v],we=this[x],Ue=this[E];let Ct=this[s][he]+ge;Ct=Ct+Ze;let Ie;Ke.log&&(X=Ke.log(X));const We=xe[d];let Ge="";for(const vt in X)if(Ie=X[vt],Object.prototype.hasOwnProperty.call(X,vt)&&Ie!==void 0){st[vt]?Ie=st[vt](Ie):vt===Ue&&st.err&&(Ie=st.err(Ie));const Le=xe[vt]||We;switch(typeof Ie){case"undefined":case"function":continue;case"number":Number.isFinite(Ie)===!1&&(Ie=null);case"boolean":Le&&(Ie=Le(Ie));break;case"string":Ie=(Le||B)(Ie);break;default:Ie=(Le||pe)(Ie,fe)}if(Ie===void 0)continue;const Be=B(vt);Ge+=","+Be+":"+Ie}let _t="";if(ae!==void 0){Ie=st[we]?st[we](ae):ae;const vt=xe[we]||We;switch(typeof Ie){case"function":break;case"number":Number.isFinite(Ie)===!1&&(Ie=null);case"boolean":vt&&(Ie=vt(Ie)),_t=',"'+we+'":'+Ie;break;case"string":Ie=(vt||B)(Ie),_t=',"'+we+'":'+Ie;break;default:Ie=(vt||pe)(Ie,fe),_t=',"'+we+'":'+Ie}}return this[y]&&Ge?Ct+this[N]+Ge.slice(1)+"}"+_t+Ce:Ct+Ge+_t+Ce}function T(X,ae){let he,ge=X[a];const pe=X[g],fe=X[h],xe=X[f],Ce=xe[d],Ze=X[l],st=X[v].bindings;ae=st(ae);for(const Ke in ae)if(he=ae[Ke],((Ke.length<5||Ke!=="level"&&Ke!=="serializers"&&Ke!=="formatters"&&Ke!=="customLevels")&&ae.hasOwnProperty(Ke)&&he!==void 0)===!0){if(he=Ze[Ke]?Ze[Ke](he):he,he=(xe[Ke]||Ce||pe)(he,fe),he===void 0)continue;ge+=',"'+Ke+'":'+he}return ge}function z(X){return X.write!==X.constructor.prototype.write}function L(X){const ae=new r(X);return ae.on("error",he),!X.sync&&b&&(o.register(ae,q),ae.on("close",function(){o.unregister(ae)})),ae;function he(ge){if(ge.code==="EPIPE"){ae.write=k,ae.end=k,ae.flushSync=k,ae.destroy=k;return}ae.removeListener("error",he),ae.emit("error",ge)}}function q(X,ae){X.destroyed||(ae==="beforeExit"?(X.flush(),X.on("drain",function(){X.end()})):X.flushSync())}function V(X){return function(he,ge,pe={},fe){if(typeof pe=="string")fe=L({dest:pe}),pe={};else if(typeof fe=="string"){if(pe&&pe.transport)throw Error("only one of option.transport or stream can be specified");fe=L({dest:fe})}else if(pe instanceof r||pe.writable||pe._writableState)fe=pe,pe={};else if(pe.transport){if(pe.transport instanceof r||pe.transport.writable||pe.transport._writableState)throw Error("option.transport do not allow stream, please pass to option directly. e.g. pino(transport)");if(pe.transport.targets&&pe.transport.targets.length&&pe.formatters&&typeof pe.formatters.level=="function")throw Error("option.transport.targets do not allow custom level formatters");let Ze;pe.customLevels&&(Ze=pe.useOnlyCustomLevels?pe.customLevels:Object.assign({},pe.levels,pe.customLevels)),fe=P({caller:ge,...pe.transport,levels:Ze})}if(pe=Object.assign({},X,pe),pe.serializers=Object.assign({},X.serializers,pe.serializers),pe.formatters=Object.assign({},X.formatters,pe.formatters),pe.prettyPrint)throw new Error("prettyPrint option is no longer supported, see the pino-pretty package (https://github.com/pinojs/pino-pretty)");const{enabled:xe,onChild:Ce}=pe;return xe===!1&&(pe.level="silent"),Ce||(pe.onChild=k),fe||(z(process.stdout)?fe=process.stdout:fe=L({fd:process.stdout.fd||1})),{opts:pe,stream:fe}}}function K(X,ae){try{return JSON.stringify(X)}catch{try{return(ae||this[h])(X)}catch{return'"[unable to serialize, circular reference is too complex to analyze]"'}}}function oe(X,ae,he){return{level:X,bindings:ae,log:he}}function ne(X){const ae=Number(X);return typeof X=="string"&&Number.isFinite(ae)?ae:X===void 0?1:X}return jm={noop:k,buildSafeSonicBoom:L,asChindings:T,asJson:J,genLog:D,createArgsNormalizer:V,stringify:K,buildFormatters:oe,normalizeDestFileDescriptor:ne},jm}var zm,nS;function ib(){return nS||(nS=1,zm={DEFAULT_LEVELS:{trace:10,debug:20,info:30,warn:40,error:50,fatal:60},SORTING_ORDER:{ASC:"ASC",DESC:"DESC"}}),zm}var Bm,rS;function LN(){if(rS)return Bm;rS=1;const{lsCacheSym:e,levelValSym:t,useOnlyCustomLevelsSym:n,streamSym:i,formattersSym:r,hooksSym:o,levelCompSym:s}=Lu(),{noop:a,genLog:c}=rb(),{DEFAULT_LEVELS:l,SORTING_ORDER:u}=ib(),p={fatal:k=>{const D=c(l.fatal,k);return function(...B){const J=this[i];if(D.call(this,...B),typeof J.flushSync=="function")try{J.flushSync()}catch{}}},error:k=>c(l.error,k),warn:k=>c(l.warn,k),info:k=>c(l.info,k),debug:k=>c(l.debug,k),trace:k=>c(l.trace,k)},f=Object.keys(l).reduce((k,D)=>(k[l[D]]=D,k),{}),g=Object.keys(f).reduce((k,D)=>(k[D]='{"level":'+Number(D),k),{});function h(k){const D=k[r].level,{labels:B}=k.levels,J={};for(const S in B){const T=D(B[S],Number(S));J[S]=JSON.stringify(T).slice(0,-1)}return k[e]=J,k}function d(k,D){if(D)return!1;switch(k){case"fatal":case"error":case"warn":case"info":case"debug":case"trace":return!0;default:return!1}}function y(k){const{labels:D,values:B}=this.levels;if(typeof k=="number"){if(D[k]===void 0)throw Error("unknown level value"+k);k=D[k]}if(B[k]===void 0)throw Error("unknown level "+k);const J=this[t],S=this[t]=B[k],T=this[n],z=this[s],L=this[o].logMethod;for(const q in B){if(z(B[q],S)===!1){this[q]=a;continue}this[q]=d(q,T)?p[q](L):c(B[q],L)}this.emit("level-change",k,S,D[J],J,this)}function v(k){const{levels:D,levelVal:B}=this;return D&&D.labels?D.labels[B]:""}function x(k){const{values:D}=this.levels,B=D[k];return B!==void 0&&this[s](B,this[t])}function E(k,D,B){return k===u.DESC?D<=B:D>=B}function N(k){return typeof k=="string"?E.bind(null,k):k}function C(k=null,D=!1){const B=k?Object.keys(k).reduce((T,z)=>(T[k[z]]=z,T),{}):null,J=Object.assign(Object.create(Object.prototype,{Infinity:{value:"silent"}}),D?null:f,B),S=Object.assign(Object.create(Object.prototype,{silent:{value:1/0}}),D?null:l,k);return{labels:J,values:S}}function b(k,D,B){if(typeof k=="number"){if(![].concat(Object.keys(D||{}).map(T=>D[T]),B?[]:Object.keys(f).map(T=>+T),1/0).includes(k))throw Error(`default level:${k} must be included in custom levels`);return}const J=Object.assign(Object.create(Object.prototype,{silent:{value:1/0}}),B?null:l,D);if(!(k in J))throw Error(`default level:${k} must be included in custom levels`)}function P(k,D){const{labels:B,values:J}=k;for(const S in D){if(S in J)throw Error("levels cannot be overridden");if(D[S]in B)throw Error("pre-existing level values cannot be used for new levels")}}function $(k){if(typeof k!="function"&&!(typeof k=="string"&&Object.values(u).includes(k)))throw new Error('Levels comparison should be one of "ASC", "DESC" or "function" type')}return Bm={initialLsCache:g,genLsCache:h,levelMethods:p,getLevel:v,setLevel:y,isLevelEnabled:x,mappings:C,assertNoLevelCollisions:P,assertDefaultLevelFound:b,genLevelComparison:N,assertLevelComparison:$},Bm}var Fm,iS;function MN(){return iS||(iS=1,Fm={version:"9.14.0"}),Fm}var Wm,oS;function D6(){if(oS)return Wm;oS=1;const{EventEmitter:e}=wD,{lsCacheSym:t,levelValSym:n,setLevelSym:i,getLevelSym:r,chindingsSym:o,parsedChindingsSym:s,mixinSym:a,asJsonSym:c,writeSym:l,mixinMergeStrategySym:u,timeSym:p,timeSliceIndexSym:f,streamSym:g,serializersSym:h,formattersSym:d,errorKeySym:y,messageKeySym:v,useOnlyCustomLevelsSym:x,needsMetadataGsym:E,redactFmtSym:N,stringifySym:C,formatOptsSym:b,stringifiersSym:P,msgPrefixSym:$,hooksSym:k}=Lu(),{getLevel:D,setLevel:B,isLevelEnabled:J,mappings:S,initialLsCache:T,genLsCache:z,assertNoLevelCollisions:L}=LN(),{asChindings:q,asJson:V,buildFormatters:K,stringify:oe,noop:ne}=rb(),{version:X}=MN(),ae=pN(),ge={constructor:class{},child:fe,bindings:xe,setBindings:Ce,flush:Ke,isLevelEnabled:J,version:X,get level(){return this[r]()},set level(we){this[i](we)},get levelVal(){return this[n]},set levelVal(we){throw Error("levelVal is read-only")},get msgPrefix(){return this[$]},get[Symbol.toStringTag](){return"Pino"},[t]:T,[l]:st,[c]:V,[r]:D,[i]:B};Object.setPrototypeOf(ge,e.prototype),Wm=function(){return Object.create(ge)};const pe=we=>we;function fe(we,Ue){if(!we)throw Error("missing bindings for child Pino");const Ct=this[h],Ie=this[d],We=Object.create(this);if(Ue==null)return We[d].bindings!==pe&&(We[d]=K(Ie.level,pe,Ie.log)),We[o]=q(We,we),We[i](this.level),this.onChild!==ne&&this.onChild(We),We;if(Ue.hasOwnProperty("serializers")===!0){We[h]=Object.create(null);for(const Oe in Ct)We[h][Oe]=Ct[Oe];const Le=Object.getOwnPropertySymbols(Ct);for(var Ge=0;Ge<Le.length;Ge++){const Oe=Le[Ge];We[h][Oe]=Ct[Oe]}for(const Oe in Ue.serializers)We[h][Oe]=Ue.serializers[Oe];const Be=Object.getOwnPropertySymbols(Ue.serializers);for(var _t=0;_t<Be.length;_t++){const Oe=Be[_t];We[h][Oe]=Ue.serializers[Oe]}}else We[h]=Ct;if(Ue.hasOwnProperty("formatters")){const{level:Le,bindings:Be,log:Oe}=Ue.formatters;We[d]=K(Le||Ie.level,Be||pe,Oe||Ie.log)}else We[d]=K(Ie.level,pe,Ie.log);if(Ue.hasOwnProperty("customLevels")===!0&&(L(this.levels,Ue.customLevels),We.levels=S(Ue.customLevels,We[x]),z(We)),typeof Ue.redact=="object"&&Ue.redact!==null||Array.isArray(Ue.redact)){We.redact=Ue.redact;const Le=ae(We.redact,oe),Be={stringify:Le[N]};We[C]=oe,We[P]=Le,We[b]=Be}typeof Ue.msgPrefix=="string"&&(We[$]=(this[$]||"")+Ue.msgPrefix),We[o]=q(We,we);const vt=Ue.level||this.level;return We[i](vt),this.onChild(We),We}function xe(){const Ue=`{${this[o].substr(1)}}`,Ct=JSON.parse(Ue);return delete Ct.pid,delete Ct.hostname,Ct}function Ce(we){const Ue=q(this,we);this[o]=Ue,delete this[s]}function Ze(we,Ue){return Object.assign(Ue,we)}function st(we,Ue,Ct){const Ie=this[p](),We=this[a],Ge=this[y],_t=this[v],vt=this[u]||Ze;let Le;const Be=this[k].streamWrite;we==null?Le={}:we instanceof Error?(Le={[Ge]:we},Ue===void 0&&(Ue=we.message)):(Le=we,Ue===void 0&&we[_t]===void 0&&we[Ge]&&(Ue=we[Ge].message)),We&&(Le=vt(Le,We(Le,Ct,this)));const Oe=this[c](Le,Ue,Ct,Ie),kn=this[g];kn[E]===!0&&(kn.lastLevel=Ct,kn.lastObj=Le,kn.lastMsg=Ue,kn.lastTime=Ie.slice(this[f]),kn.lastLogger=this),kn.write(Be?Be(Oe):Oe)}function Ke(we){if(we!=null&&typeof we!="function")throw Error("callback must be a function");const Ue=this[g];typeof Ue.flush=="function"?Ue.flush(we||ne):we&&we()}return Wm}var _d={exports:{}},sS;function U6(){return sS||(sS=1,(function(e,t){const{hasOwnProperty:n}=Object.prototype,i=v();i.configure=v,i.stringify=i,i.default=i,t.stringify=i,t.configure=v,e.exports=i;const r=/[\u0000-\u001f\u0022\u005c\ud800-\udfff]/;function o(x){return x.length<5e3&&!r.test(x)?`"${x}"`:JSON.stringify(x)}function s(x,E){if(x.length>200||E)return x.sort(E);for(let N=1;N<x.length;N++){const C=x[N];let b=N;for(;b!==0&&x[b-1]>C;)x[b]=x[b-1],b--;x[b]=C}return x}const a=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(Object.getPrototypeOf(new Int8Array)),Symbol.toStringTag).get;function c(x){return a.call(x)!==void 0&&x.length!==0}function l(x,E,N){x.length<N&&(N=x.length);const C=E===","?"":" ";let b=`"0":${C}${x[0]}`;for(let P=1;P<N;P++)b+=`${E}"${P}":${C}${x[P]}`;return b}function u(x){if(n.call(x,"circularValue")){const E=x.circularValue;if(typeof E=="string")return`"${E}"`;if(E==null)return E;if(E===Error||E===TypeError)return{toString(){throw new TypeError("Converting circular structure to JSON")}};throw new TypeError('The "circularValue" argument must be of type string or the value null or undefined')}return'"[Circular]"'}function p(x){let E;if(n.call(x,"deterministic")&&(E=x.deterministic,typeof E!="boolean"&&typeof E!="function"))throw new TypeError('The "deterministic" argument must be of type boolean or comparator function');return E===void 0?!0:E}function f(x,E){let N;if(n.call(x,E)&&(N=x[E],typeof N!="boolean"))throw new TypeError(`The "${E}" argument must be of type boolean`);return N===void 0?!0:N}function g(x,E){let N;if(n.call(x,E)){if(N=x[E],typeof N!="number")throw new TypeError(`The "${E}" argument must be of type number`);if(!Number.isInteger(N))throw new TypeError(`The "${E}" argument must be an integer`);if(N<1)throw new RangeError(`The "${E}" argument must be >= 1`)}return N===void 0?1/0:N}function h(x){return x===1?"1 item":`${x} items`}function d(x){const E=new Set;for(const N of x)(typeof N=="string"||typeof N=="number")&&E.add(String(N));return E}function y(x){if(n.call(x,"strict")){const E=x.strict;if(typeof E!="boolean")throw new TypeError('The "strict" argument must be of type boolean');if(E)return N=>{let C=`Object can not safely be stringified. Received type ${typeof N}`;throw typeof N!="function"&&(C+=` (${N.toString()})`),new Error(C)}}}function v(x){x={...x};const E=y(x);E&&(x.bigint===void 0&&(x.bigint=!1),"circularValue"in x||(x.circularValue=Error));const N=u(x),C=f(x,"bigint"),b=p(x),P=typeof b=="function"?b:void 0,$=g(x,"maximumDepth"),k=g(x,"maximumBreadth");function D(z,L,q,V,K,oe){let ne=L[z];switch(typeof ne=="object"&&ne!==null&&typeof ne.toJSON=="function"&&(ne=ne.toJSON(z)),ne=V.call(L,z,ne),typeof ne){case"string":return o(ne);case"object":{if(ne===null)return"null";if(q.indexOf(ne)!==-1)return N;let X="",ae=",";const he=oe;if(Array.isArray(ne)){if(ne.length===0)return"[]";if($<q.length+1)return'"[Array]"';q.push(ne),K!==""&&(oe+=K,X+=`
${oe}`,ae=`,
${oe}`);const Ze=Math.min(ne.length,k);let st=0;for(;st<Ze-1;st++){const we=D(String(st),ne,q,V,K,oe);X+=we!==void 0?we:"null",X+=ae}const Ke=D(String(st),ne,q,V,K,oe);if(X+=Ke!==void 0?Ke:"null",ne.length-1>k){const we=ne.length-k-1;X+=`${ae}"... ${h(we)} not stringified"`}return K!==""&&(X+=`
${he}`),q.pop(),`[${X}]`}let ge=Object.keys(ne);const pe=ge.length;if(pe===0)return"{}";if($<q.length+1)return'"[Object]"';let fe="",xe="";K!==""&&(oe+=K,ae=`,
${oe}`,fe=" ");const Ce=Math.min(pe,k);b&&!c(ne)&&(ge=s(ge,P)),q.push(ne);for(let Ze=0;Ze<Ce;Ze++){const st=ge[Ze],Ke=D(st,ne,q,V,K,oe);Ke!==void 0&&(X+=`${xe}${o(st)}:${fe}${Ke}`,xe=ae)}if(pe>k){const Ze=pe-k;X+=`${xe}"...":${fe}"${h(Ze)} not stringified"`,xe=ae}return K!==""&&xe.length>1&&(X=`
${oe}${X}
${he}`),q.pop(),`{${X}}`}case"number":return isFinite(ne)?String(ne):E?E(ne):"null";case"boolean":return ne===!0?"true":"false";case"undefined":return;case"bigint":if(C)return String(ne);default:return E?E(ne):void 0}}function B(z,L,q,V,K,oe){switch(typeof L=="object"&&L!==null&&typeof L.toJSON=="function"&&(L=L.toJSON(z)),typeof L){case"string":return o(L);case"object":{if(L===null)return"null";if(q.indexOf(L)!==-1)return N;const ne=oe;let X="",ae=",";if(Array.isArray(L)){if(L.length===0)return"[]";if($<q.length+1)return'"[Array]"';q.push(L),K!==""&&(oe+=K,X+=`
${oe}`,ae=`,
${oe}`);const pe=Math.min(L.length,k);let fe=0;for(;fe<pe-1;fe++){const Ce=B(String(fe),L[fe],q,V,K,oe);X+=Ce!==void 0?Ce:"null",X+=ae}const xe=B(String(fe),L[fe],q,V,K,oe);if(X+=xe!==void 0?xe:"null",L.length-1>k){const Ce=L.length-k-1;X+=`${ae}"... ${h(Ce)} not stringified"`}return K!==""&&(X+=`
${ne}`),q.pop(),`[${X}]`}q.push(L);let he="";K!==""&&(oe+=K,ae=`,
${oe}`,he=" ");let ge="";for(const pe of V){const fe=B(pe,L[pe],q,V,K,oe);fe!==void 0&&(X+=`${ge}${o(pe)}:${he}${fe}`,ge=ae)}return K!==""&&ge.length>1&&(X=`
${oe}${X}
${ne}`),q.pop(),`{${X}}`}case"number":return isFinite(L)?String(L):E?E(L):"null";case"boolean":return L===!0?"true":"false";case"undefined":return;case"bigint":if(C)return String(L);default:return E?E(L):void 0}}function J(z,L,q,V,K){switch(typeof L){case"string":return o(L);case"object":{if(L===null)return"null";if(typeof L.toJSON=="function"){if(L=L.toJSON(z),typeof L!="object")return J(z,L,q,V,K);if(L===null)return"null"}if(q.indexOf(L)!==-1)return N;const oe=K;if(Array.isArray(L)){if(L.length===0)return"[]";if($<q.length+1)return'"[Array]"';q.push(L),K+=V;let fe=`
${K}`;const xe=`,
${K}`,Ce=Math.min(L.length,k);let Ze=0;for(;Ze<Ce-1;Ze++){const Ke=J(String(Ze),L[Ze],q,V,K);fe+=Ke!==void 0?Ke:"null",fe+=xe}const st=J(String(Ze),L[Ze],q,V,K);if(fe+=st!==void 0?st:"null",L.length-1>k){const Ke=L.length-k-1;fe+=`${xe}"... ${h(Ke)} not stringified"`}return fe+=`
${oe}`,q.pop(),`[${fe}]`}let ne=Object.keys(L);const X=ne.length;if(X===0)return"{}";if($<q.length+1)return'"[Object]"';K+=V;const ae=`,
${K}`;let he="",ge="",pe=Math.min(X,k);c(L)&&(he+=l(L,ae,k),ne=ne.slice(L.length),pe-=L.length,ge=ae),b&&(ne=s(ne,P)),q.push(L);for(let fe=0;fe<pe;fe++){const xe=ne[fe],Ce=J(xe,L[xe],q,V,K);Ce!==void 0&&(he+=`${ge}${o(xe)}: ${Ce}`,ge=ae)}if(X>k){const fe=X-k;he+=`${ge}"...": "${h(fe)} not stringified"`,ge=ae}return ge!==""&&(he=`
${K}${he}
${oe}`),q.pop(),`{${he}}`}case"number":return isFinite(L)?String(L):E?E(L):"null";case"boolean":return L===!0?"true":"false";case"undefined":return;case"bigint":if(C)return String(L);default:return E?E(L):void 0}}function S(z,L,q){switch(typeof L){case"string":return o(L);case"object":{if(L===null)return"null";if(typeof L.toJSON=="function"){if(L=L.toJSON(z),typeof L!="object")return S(z,L,q);if(L===null)return"null"}if(q.indexOf(L)!==-1)return N;let V="";const K=L.length!==void 0;if(K&&Array.isArray(L)){if(L.length===0)return"[]";if($<q.length+1)return'"[Array]"';q.push(L);const he=Math.min(L.length,k);let ge=0;for(;ge<he-1;ge++){const fe=S(String(ge),L[ge],q);V+=fe!==void 0?fe:"null",V+=","}const pe=S(String(ge),L[ge],q);if(V+=pe!==void 0?pe:"null",L.length-1>k){const fe=L.length-k-1;V+=`,"... ${h(fe)} not stringified"`}return q.pop(),`[${V}]`}let oe=Object.keys(L);const ne=oe.length;if(ne===0)return"{}";if($<q.length+1)return'"[Object]"';let X="",ae=Math.min(ne,k);K&&c(L)&&(V+=l(L,",",k),oe=oe.slice(L.length),ae-=L.length,X=","),b&&(oe=s(oe,P)),q.push(L);for(let he=0;he<ae;he++){const ge=oe[he],pe=S(ge,L[ge],q);pe!==void 0&&(V+=`${X}${o(ge)}:${pe}`,X=",")}if(ne>k){const he=ne-k;V+=`${X}"...":"${h(he)} not stringified"`}return q.pop(),`{${V}}`}case"number":return isFinite(L)?String(L):E?E(L):"null";case"boolean":return L===!0?"true":"false";case"undefined":return;case"bigint":if(C)return String(L);default:return E?E(L):void 0}}function T(z,L,q){if(arguments.length>1){let V="";if(typeof q=="number"?V=" ".repeat(Math.min(q,10)):typeof q=="string"&&(V=q.slice(0,10)),L!=null){if(typeof L=="function")return D("",{"":z},[],L,V,"");if(Array.isArray(L))return B("",z,[],d(L),V,"")}if(V.length!==0)return J("",z,[],V,"")}return S("",z,[])}return T}})(_d,_d.exports)),_d.exports}var Vm,aS;function L6(){if(aS)return Vm;aS=1;const e=Symbol.for("pino.metadata"),{DEFAULT_LEVELS:t}=ib(),n=t.info;function i(c,l){c=c||[],l=l||{dedupe:!1};const u=Object.create(t);u.silent=1/0,l.levels&&typeof l.levels=="object"&&Object.keys(l.levels).forEach(E=>{u[E]=l.levels[E]});const p={write:f,add:d,remove:y,emit:g,flushSync:h,end:v,minLevel:0,lastId:0,streams:[],clone:x,[e]:!0,streamLevels:u};return Array.isArray(c)?c.forEach(d,p):d.call(p,c),c=null,p;function f(E){let N;const C=this.lastLevel,{streams:b}=this;let P=0,$;for(let k=o(b.length,l.dedupe);a(k,b.length,l.dedupe);k=s(k,l.dedupe))if(N=b[k],N.level<=C){if(P!==0&&P!==N.level)break;if($=N.stream,$[e]){const{lastTime:D,lastMsg:B,lastObj:J,lastLogger:S}=this;$.lastLevel=C,$.lastTime=D,$.lastMsg=B,$.lastObj=J,$.lastLogger=S}$.write(E),l.dedupe&&(P=N.level)}else if(!l.dedupe)break}function g(...E){for(const{stream:N}of this.streams)typeof N.emit=="function"&&N.emit(...E)}function h(){for(const{stream:E}of this.streams)typeof E.flushSync=="function"&&E.flushSync()}function d(E){if(!E)return p;const N=typeof E.write=="function"||E.stream,C=E.write?E:E.stream;if(!N)throw Error("stream object needs to implement either StreamEntry or DestinationStream interface");const{streams:b,streamLevels:P}=this;let $;typeof E.levelVal=="number"?$=E.levelVal:typeof E.level=="string"?$=P[E.level]:typeof E.level=="number"?$=E.level:$=n;const k={stream:C,level:$,levelVal:void 0,id:++p.lastId};return b.unshift(k),b.sort(r),this.minLevel=b[0].level,p}function y(E){const{streams:N}=this,C=N.findIndex(b=>b.id===E);return C>=0&&(N.splice(C,1),N.sort(r),this.minLevel=N.length>0?N[0].level:-1),p}function v(){for(const{stream:E}of this.streams)typeof E.flushSync=="function"&&E.flushSync(),E.end()}function x(E){const N=new Array(this.streams.length);for(let C=0;C<N.length;C++)N[C]={level:E,stream:this.streams[C].stream};return{write:f,add:d,remove:y,minLevel:E,streams:N,clone:x,emit:g,flushSync:h,[e]:!0}}}function r(c,l){return c.level-l.level}function o(c,l){return l?c-1:0}function s(c,l){return l?c-1:c+1}function a(c,l,u){return u?c>=0:c<l}return Vm=i,Vm}var cS;function M6(){if(cS)return Ir.exports;cS=1;const e=SD,t=dN(),n=fN(),i=pN(),r=E6(),o=D6(),s=Lu(),{configure:a}=U6(),{assertDefaultLevelFound:c,mappings:l,genLsCache:u,genLevelComparison:p,assertLevelComparison:f}=LN(),{DEFAULT_LEVELS:g,SORTING_ORDER:h}=ib(),{createArgsNormalizer:d,asChindings:y,buildSafeSonicBoom:v,buildFormatters:x,stringify:E,normalizeDestFileDescriptor:N,noop:C}=rb(),{version:b}=MN(),{chindingsSym:P,redactFmtSym:$,serializersSym:k,timeSym:D,timeSliceIndexSym:B,streamSym:J,stringifySym:S,stringifySafeSym:T,stringifiersSym:z,setLevelSym:L,endSym:q,formatOptsSym:V,messageKeySym:K,errorKeySym:oe,nestedKeySym:ne,mixinSym:X,levelCompSym:ae,useOnlyCustomLevelsSym:he,formattersSym:ge,hooksSym:pe,nestedKeyStrSym:fe,mixinMergeStrategySym:xe,msgPrefixSym:Ce}=s,{epochTime:Ze,nullTime:st}=r,{pid:Ke}=process,we=e.hostname(),Ue=t.err,Ct={level:"info",levelComparison:h.ASC,levels:g,messageKey:"msg",errorKey:"err",nestedKey:null,enabled:!0,base:{pid:Ke,hostname:we},serializers:Object.assign(Object.create(null),{err:Ue}),formatters:Object.assign(Object.create(null),{bindings(_t){return _t},level(_t,vt){return{level:vt}}}),hooks:{logMethod:void 0,streamWrite:void 0},timestamp:Ze,name:void 0,redact:null,customLevels:null,useOnlyCustomLevels:!1,depthLimit:5,edgeLimit:100},Ie=d(Ct),We=Object.assign(Object.create(null),t);function Ge(..._t){const vt={},{opts:Le,stream:Be}=Ie(vt,n(),..._t);Le.level&&typeof Le.level=="string"&&g[Le.level.toLowerCase()]!==void 0&&(Le.level=Le.level.toLowerCase());const{redact:Oe,crlf:kn,serializers:En,timestamp:Xt,messageKey:w,errorKey:I,nestedKey:U,base:G,name:Q,level:ee,customLevels:de,levelComparison:wt,mixin:kt,mixinMergeStrategy:Et,useOnlyCustomLevels:dt,formatters:It,hooks:Jr,depthLimit:Hi,edgeLimit:ca,onChild:ui,msgPrefix:vn}=Le,Er=a({maximumDepth:Hi,maximumBreadth:ca}),gr=x(It.level,It.bindings,It.log),Gr=E.bind({[T]:Er}),la=Oe?i(Oe,Gr):{},tm=Oe?{stringify:la[$]}:{stringify:Gr},nm="}"+(kn?`\r
`:`
`),zn=y.bind(null,{[P]:"",[k]:En,[z]:la,[S]:E,[T]:Er,[ge]:gr});let $c="";G!==null&&(Q===void 0?$c=zn(G):$c=zn(Object.assign({},G,{name:Q})));const nd=Xt instanceof Function?Xt:Xt?Ze:st,rd=nd().indexOf(":")+1;if(dt&&!de)throw Error("customLevels is required if useOnlyCustomLevels is set true");if(kt&&typeof kt!="function")throw Error(`Unknown mixin type "${typeof kt}" - expected "function"`);if(vn&&typeof vn!="string")throw Error(`Unknown msgPrefix type "${typeof vn}" - expected "string"`);c(ee,de,dt);const id=l(de,dt);typeof Be.emit=="function"&&Be.emit("message",{code:"PINO_CONFIG",config:{levels:id,messageKey:w,errorKey:I}}),f(wt);const od=p(wt);return Object.assign(vt,{levels:id,[ae]:od,[he]:dt,[J]:Be,[D]:nd,[B]:rd,[S]:E,[T]:Er,[z]:la,[q]:nm,[V]:tm,[K]:w,[oe]:I,[ne]:U,[fe]:U?`,${JSON.stringify(U)}:{`:"",[k]:En,[X]:kt,[xe]:Et,[P]:$c,[ge]:gr,[pe]:Jr,silent:C,onChild:ui,[Ce]:vn}),Object.setPrototypeOf(vt,o()),u(vt),vt[L](ee),vt}return Ir.exports=Ge,Ir.exports.destination=(_t=process.stdout.fd)=>typeof _t=="object"?(_t.dest=N(_t.dest||process.stdout.fd),v(_t)):v({dest:N(_t),minLength:0}),Ir.exports.transport=UN(),Ir.exports.multistream=L6(),Ir.exports.levels=l(),Ir.exports.stdSerializers=We,Ir.exports.stdTimeFunctions=Object.assign({},r),Ir.exports.symbols=s,Ir.exports.version=b,Ir.exports.default=Ge,Ir.exports.pino=Ge,Ir.exports}var jN=M6();const lS=$E(jN),j6="WebSocketPair"in globalThis,z6={write(e){console.log(e.trimEnd())}},uS={base:{app:ke.appPrefix},timestamp:jN.stdTimeFunctions.isoTime,redact:{paths:["password","headers.authorization","headers.cookie","cookies","token"],remove:!1}},dS="info";let Wg;j6?Wg=lS({level:dS,...uS},z6):Wg=lS({level:dS,...uS});function ob(e){return Wg.child({module:e})}const zN="__chatjs_runtime_cache__",BN=globalThis,FN=BN[zN],ri=FN??{entries:new Map,keysByTag:new Map};FN||(BN[zN]=ri);function B6(e,t){try{return JSON.stringify([e,t])}catch{return`${e.join("|")}::${t.map(String).join("|")}`}}function fS(e){return e===!1||e===void 0?Number.POSITIVE_INFINITY:e<=0?Date.now():Date.now()+e*1e3}function Vg(e){const t=ri.entries.get(e);if(t){ri.entries.delete(e);for(const n of t.tags){const i=ri.keysByTag.get(n);i&&(i.delete(e),i.size===0&&ri.keysByTag.delete(n))}}}function F6(e,t){for(const n of t){const i=ri.keysByTag.get(n)??new Set;i.add(e),ri.keysByTag.set(n,i)}}function W6(e,t=[],n={}){return(...i)=>{const r=B6(t,i),o=ri.entries.get(r);if(o&&o.expiresAt>Date.now()&&o.value!==void 0)return Promise.resolve(o.value);if(o?.inflight)return o.inflight;o&&Vg(r);const s={expiresAt:fS(n.revalidate),tags:n.tags?[...n.tags]:[]},a=e(...i).then(c=>(s.value=c,s.inflight=void 0,s.expiresAt=fS(n.revalidate),F6(r,s.tags),ri.entries.set(r,s),c)).catch(c=>{throw Vg(r),c});return s.inflight=a,ri.entries.set(r,s),a}}function V6(e,t){const n=ri.keysByTag.get(e);if(n){for(const i of n)Vg(i);ri.keysByTag.delete(e)}}const wf=ob("kv-cache"),pS=60;let Sd=null;function WN(){return Sd||(Sd=(async()=>{const e=globalThis;if(e.KV_CACHE)return e.KV_CACHE;try{return(await import("cloudflare:workers")).env?.KV_CACHE??null}catch{return null}})(),Sd)}function q6(e,t){let n;try{n=JSON.stringify([e,t])}catch{n=`${e.join("|")}::${t.map(String).join("|")}`}return`${ke.appPrefix}:kv-cache:${n}`}function VN(e){return`${ke.appPrefix}:kv-cache:tag:${e}`}async function H6({kv:e,tag:t,cacheKey:n,ttlSeconds:i}){const r=VN(t),o=await e.get(r),s=o?JSON.parse(o):[];if(!Array.isArray(s)){await e.put(r,JSON.stringify([n]),{expirationTtl:i+pS});return}s.includes(n)||(s.push(n),await e.put(r,JSON.stringify(s),{expirationTtl:i+pS}))}async function K6({kv:e,tag:t}){const n=VN(t),i=await e.get(n);if(!i)return;const r=JSON.parse(i);if(Array.isArray(r))for(const o of r)typeof o=="string"&&await e.delete(o);await e.delete(n)}function sb(e,t=[],n={}){const i=W6(e,t,n),r=typeof n.revalidate=="number"&&n.revalidate>0?n.revalidate:null,o=new Map;return async(...s)=>{const a=await WN();if(!(a&&r))return i(...s);const c=q6(t,s),l=o.get(c);if(l)return l;const u=(async()=>{try{const f=await a.get(c);if(f)return JSON.parse(f).value}catch(f){wf.warn({error:f,cacheKey:c},"KV cache read failed, continuing with callback")}const p=await e(...s);try{await a.put(c,JSON.stringify({value:p}),{expirationTtl:r});const f=n.tags??[];for(const g of f)await H6({kv:a,tag:g,cacheKey:c,ttlSeconds:r})}catch(f){wf.warn({error:f,cacheKey:c},"KV cache write failed")}return p})();o.set(c,u);try{return await u}finally{o.delete(c)}}}function sie(e,t){WN().then(n=>{if(n)return K6({kv:n,tag:e}).catch(i=>{wf.warn({error:i,tag:e},"KV tag invalidation failed")})}).catch(n=>{wf.warn({error:n,tag:e},"KV binding resolution failed")}),V6(e)}const J6=W(),G6=ce({id:W(),object:_e("model"),created:Lt(),owned_by:W(),name:W(),description:W(),context_window:Lt(),max_tokens:Lt(),type:nn([_e("language"),_e("embedding"),_e("image")]),tags:yt(J6).optional(),pricing:ce({input:W().optional(),output:W().optional(),input_cache_read:W().optional(),input_cache_write:W().optional(),web_search:W().optional(),image:W().optional(),input_tiers:yt(ce({cost:W(),min:Lt(),max:Lt().optional()})).optional(),output_tiers:yt(ce({cost:W(),min:Lt(),max:Lt().optional()})).optional(),input_cache_read_tiers:yt(ce({cost:W(),min:Lt(),max:Lt().optional()})).optional()})}),Z6=ce({object:_e("list"),data:yt(G6)}),qg=[{id:"alibaba/qwen-3-14b",object:"model",created:1755815280,owned_by:"alibaba",name:"Qwen3-14B",description:"Qwen3 is the latest generation of large language models in Qwen series, offering a comprehensive suite of dense and mixture-of-experts (MoE) models. Built upon extensive training, Qwen3 delivers groundbreaking advancements in reasoning, instruction-following, agent capabilities, and multilingual support",context_window:40960,max_tokens:16384,type:"language",tags:["reasoning","tool-use"],pricing:{input:"0.00000006",output:"0.00000024"}},{id:"alibaba/qwen-3-235b",object:"model",created:1755815280,owned_by:"alibaba",name:"Qwen3 235B A22b Instruct 2507",description:"Qwen3-235B-A22B-Instruct-2507 is the updated version of the Qwen3-235B-A22B non-thinking mode, featuring Significant improvements in general capabilities, including instruction following, logical reasoning, text comprehension, mathematics, science, coding and tool usage.",context_window:40960,max_tokens:16384,type:"language",tags:["tool-use"],pricing:{input:"0.000000071",output:"0.000000463"}},{id:"alibaba/qwen-3-30b",object:"model",created:1755815280,owned_by:"alibaba",name:"Qwen3-30B-A3B",description:"Qwen3 is the latest generation of large language models in Qwen series, offering a comprehensive suite of dense and mixture-of-experts (MoE) models. Built upon extensive training, Qwen3 delivers groundbreaking advancements in reasoning, instruction-following, agent capabilities, and multilingual support",context_window:40960,max_tokens:16384,type:"language",tags:["reasoning","tool-use"],pricing:{input:"0.00000008",output:"0.00000029"}},{id:"alibaba/qwen-3-32b",object:"model",created:1755815280,owned_by:"alibaba",name:"Qwen 3.32B",description:"Qwen3 is the latest generation of large language models in Qwen series, offering a comprehensive suite of dense and mixture-of-experts (MoE) models. Built upon extensive training, Qwen3 delivers groundbreaking advancements in reasoning, instruction-following, agent capabilities, and multilingual support",context_window:40960,max_tokens:16384,type:"language",tags:["reasoning","tool-use"],pricing:{input:"0.0000001",output:"0.0000003"}},{id:"alibaba/qwen3-235b-a22b-thinking",object:"model",created:1755815280,owned_by:"alibaba",name:"Qwen3 235B A22B Thinking 2507",description:"Qwen3-235B-A22B-Thinking-2507 is the Qwen3's new model with scaling the thinking capability of Qwen3-235B-A22B, improving both the quality and depth of reasoning.",context_window:262114,max_tokens:262114,type:"language",tags:["tool-use","vision","file-input","reasoning"],pricing:{input:"0.0000003",output:"0.0000029"}},{id:"alibaba/qwen3-coder",object:"model",created:1755815280,owned_by:"alibaba",name:"Qwen3 Coder 480B A35B Instruct",description:"Mixture-of-experts LLM with advanced coding and reasoning capabilities",context_window:262144,max_tokens:66536,type:"language",tags:["tool-use"],pricing:{input:"0.00000038",output:"0.00000153"}},{id:"alibaba/qwen3-coder-30b-a3b",object:"model",created:1755815280,owned_by:"alibaba",name:"Qwen 3 Coder 30B A3B Instruct",description:"Efficient coding specialist balancing performance with cost-effectiveness for daily development tasks while maintaining strong tool integration capabilities.",context_window:16e4,max_tokens:32768,type:"language",tags:["reasoning","tool-use"],pricing:{input:"0.00000007",output:"0.00000027"}},{id:"alibaba/qwen3-coder-plus",object:"model",created:1755815280,owned_by:"alibaba",name:"Qwen3 Coder Plus",description:"Powered by Qwen3 this is a powerful Coding Agent that excels in tool calling and environment interaction to achieve autonomous programming. It combines outstanding coding proficiency with versatile general-purpose abilities.",context_window:1e6,max_tokens:65536,type:"language",tags:["tool-use"],pricing:{input:"0.000001",input_tiers:[{cost:"0.000001",min:0,max:32001},{cost:"0.0000018",min:32001,max:128001},{cost:"0.000003",min:128001,max:256001},{cost:"0.000006",min:256001}],output:"0.000005",output_tiers:[{cost:"0.000005",min:0,max:32001},{cost:"0.000009",min:32001,max:128001},{cost:"0.000015",min:128001,max:256001},{cost:"0.00006",min:256001}],input_cache_read:"0.0000002",input_cache_read_tiers:[{cost:"0.0000002",min:0,max:32001},{cost:"0.00000036",min:32001,max:128001},{cost:"0.0000006",min:128001,max:256001},{cost:"0.0000012",min:256001}]}},{id:"alibaba/qwen3-embedding-0.6b",object:"model",created:1755815280,owned_by:"alibaba",name:"Qwen3 Embedding 0.6B",description:"The Qwen3 Embedding model series is the latest proprietary model of the Qwen family, specifically designed for text embedding and ranking tasks. Building upon the dense foundational models of the Qwen3 series, it provides a comprehensive range of text embeddings and reranking models in various sizes (0.6B, 4B, and 8B).",context_window:32768,max_tokens:32768,type:"embedding",tags:[],pricing:{input:"0.00000001"}},{id:"alibaba/qwen3-embedding-4b",object:"model",created:1755815280,owned_by:"alibaba",name:"Qwen3 Embedding 4B",description:"The Qwen3 Embedding model series is the latest proprietary model of the Qwen family, specifically designed for text embedding and ranking tasks. Building upon the dense foundational models of the Qwen3 series, it provides a comprehensive range of text embeddings and reranking models in various sizes (0.6B, 4B, and 8B).",context_window:32768,max_tokens:32768,type:"embedding",tags:[],pricing:{input:"0.00000002"}},{id:"alibaba/qwen3-embedding-8b",object:"model",created:1755815280,owned_by:"alibaba",name:"Qwen3 Embedding 8B",description:"The Qwen3 Embedding model series is the latest proprietary model of the Qwen family, specifically designed for text embedding and ranking tasks. Building upon the dense foundational models of the Qwen3 series, it provides a comprehensive range of text embeddings and reranking models in various sizes (0.6B, 4B, and 8B).",context_window:32768,max_tokens:32768,type:"embedding",tags:[],pricing:{input:"0.00000005"}},{id:"alibaba/qwen3-max",object:"model",created:1755815280,owned_by:"alibaba",name:"Qwen3 Max",description:"The Qwen 3 series Max model has undergone specialized upgrades in agent programming and tool invocation compared to the preview version. The officially released model this time has achieved state-of-the-art (SOTA) performance in its field and is better suited to meet the demands of agents operating in more complex scenarios.",context_window:262144,max_tokens:65536,type:"language",tags:[],pricing:{input:"0.000000845",input_tiers:[{cost:"0.000000845",min:0,max:32769},{cost:"0.0000014",min:32769,max:131073},{cost:"0.00000211",min:131073}],output:"0.00000338",output_tiers:[{cost:"0.00000338",min:0,max:32769},{cost:"0.00000564",min:32769,max:131073},{cost:"0.00000845",min:131073}]}},{id:"alibaba/qwen3-max-preview",object:"model",created:1755815280,owned_by:"alibaba",name:"Qwen3 Max Preview",description:"Qwen3-Max-Preview shows substantial gains over the 2.5 series in overall capability, with significant enhancements in Chinese-English text understanding, complex instruction following, handling of subjective open-ended tasks, multilingual ability, and tool invocation; model knowledge hallucinations are reduced.",context_window:262144,max_tokens:32768,type:"language",tags:["tool-use","implicit-caching"],pricing:{input:"0.0000012",input_tiers:[{cost:"0.0000012",min:0,max:32001},{cost:"0.0000024",min:32001,max:128001},{cost:"0.000003",min:128001}],output:"0.000006",output_tiers:[{cost:"0.000006",min:0,max:32001},{cost:"0.000012",min:32001,max:128001},{cost:"0.000015",min:128001}],input_cache_read:"0.00000024",input_cache_read_tiers:[{cost:"0.00000024",min:0,max:32001},{cost:"0.00000048",min:32001,max:128001},{cost:"0.0000006",min:128001}]}},{id:"alibaba/qwen3-max-thinking",object:"model",created:1755815280,owned_by:"alibaba",name:"Qwen 3 Max Thinking",description:"Compared with the snapshot as of September 23, 2025, the Qwen-3 series Max model in this release achieves an effective integration of thinking and non-thinking modes, resulting in a comprehensive and substantial improvement in the models overall performance. In thinking mode, the model simultaneously supports web search, web information extraction, and a code interpreter tool, enabling it to tackle more complex and challenging problems with greater accuracy by leveraging external tools while engaging in slow, deliberative reasoning. This version is based on a snapshot taken on January 23, 2026.",context_window:256e3,max_tokens:65536,type:"language",tags:["reasoning","tool-use","implicit-caching"],pricing:{input:"0.0000012",input_tiers:[{cost:"0.0000012",min:0,max:32001},{cost:"0.0000024",min:32001,max:128001},{cost:"0.000003",min:128001}],output:"0.000006",output_tiers:[{cost:"0.000006",min:0,max:32001},{cost:"0.000012",min:32001,max:128001},{cost:"0.000015",min:128001}],input_cache_read:"0.00000024",input_cache_read_tiers:[{cost:"0.00000024",min:0,max:32001},{cost:"0.00000048",min:32001,max:128001},{cost:"0.0000006",min:128001}]}},{id:"alibaba/qwen3-next-80b-a3b-instruct",object:"model",created:1755815280,owned_by:"alibaba",name:"Qwen3 Next 80B A3B Instruct",description:"A new generation of open-source, non-thinking mode model powered by Qwen3. This version demonstrates superior Chinese text understanding, augmented logical reasoning, and enhanced capabilities in text generation tasks over the previous iteration (Qwen3-235B-A22B-Instruct-2507).",context_window:262144,max_tokens:32768,type:"language",tags:[],pricing:{input:"0.00000009",output:"0.0000011"}},{id:"alibaba/qwen3-next-80b-a3b-thinking",object:"model",created:1755815280,owned_by:"alibaba",name:"Qwen3 Next 80B A3B Thinking",description:"Qwen3-Next uses a highly sparse MoE design: 80B total parameters, but only ~3B activated per inference step. Experiments show that, with global load balancing, increasing total expert parameters while keeping activated experts fixed steadily reduces training loss.Compared to Qwen3s MoE (128 total experts, 8 routed), Qwen3-Next expands to 512 total experts, combining 10 routed experts + 1 shared expert  maximizing resource usage without hurting performance. The Qwen3-Next-80B-A3B-Thinking excels at complex reasoning tasks  outperforming higher-cost models like Qwen3-30B-A3B-Thinking-2507 and Qwen3-32B-Thinking, outpeforming the closed-source Gemini-2.5-Flash-Thinking on multiple benchmarks, and approaching the performance of our top-tier model Qwen3-235B-A22B-Thinking-2507.",context_window:65536,max_tokens:65536,type:"language",pricing:{input:"0.00000015",output:"0.0000015"}},{id:"alibaba/qwen3-vl-instruct",object:"model",created:1755815280,owned_by:"alibaba",name:"Qwen3 VL 235B A22B Instruct",description:"The Qwen3 series VL models has been comprehensively upgraded in areas such as visual coding and spatial perception. Its visual perception and recognition capabilities have significantly improved, supporting the understanding of ultra-long videos, and its OCR functionality has undergone a major enhancement.",context_window:131072,max_tokens:129024,type:"language",tags:["vision"],pricing:{input:"0.0000004",output:"0.0000016"}},{id:"alibaba/qwen3-vl-thinking",object:"model",created:1755815280,owned_by:"alibaba",name:"Qwen3 VL 235B A22B Thinking",description:"Qwen3 series VL models feature significantly enhanced multimodal reasoning capabilities, with a particular focus on optimizing the model for STEM and mathematical reasoning. Visual perception and recognition abilities have been comprehensively improved, and OCR capabilities have undergone a major upgrade.",context_window:131072,max_tokens:32768,type:"language",tags:["vision"],pricing:{input:"0.0000007",output:"0.0000084"}},{id:"amazon/nova-2-lite",object:"model",created:1755815280,owned_by:"amazon",name:"Nova 2 Lite",description:"Nova 2 Lite is a fast, cost-effective reasoning model for everyday workloads that can process text, images, and videos to generate text.",context_window:1e6,max_tokens:1e6,type:"language",tags:["reasoning","vision"],pricing:{input:"0.0000003",output:"0.0000025"}},{id:"amazon/nova-lite",object:"model",created:1755815280,owned_by:"amazon",name:"Nova Lite",description:"A very low cost multimodal model that is lightning fast for processing image, video, and text inputs.",context_window:3e5,max_tokens:8192,type:"language",pricing:{input:"0.00000006",output:"0.00000024"}},{id:"amazon/nova-micro",object:"model",created:1755815280,owned_by:"amazon",name:"Nova Micro",description:"A text-only model that delivers the lowest latency responses at very low cost.",context_window:128e3,max_tokens:8192,type:"language",pricing:{input:"0.000000035",output:"0.00000014"}},{id:"amazon/nova-pro",object:"model",created:1755815280,owned_by:"amazon",name:"Nova Pro",description:"A highly capable multimodal model with the best combination of accuracy, speed, and cost for a wide range of tasks.",context_window:3e5,max_tokens:8192,type:"language",pricing:{input:"0.0000008",output:"0.0000032"}},{id:"amazon/titan-embed-text-v2",object:"model",created:1755815280,owned_by:"amazon",name:"Titan Text Embeddings V2",description:"Amazon Titan Text Embeddings V2 is a light weight, efficient multilingual embedding model supporting 1024, 512, and 256 dimensions.",context_window:0,max_tokens:0,type:"embedding",pricing:{input:"0.00000002"}},{id:"anthropic/claude-3-haiku",object:"model",created:1755815280,owned_by:"anthropic",name:"Claude 3 Haiku",description:"Claude 3 Haiku is Anthropic's fastest model yet, designed for enterprise workloads which often involve longer prompts. Haiku to quickly analyze large volumes of documents, such as quarterly filings, contracts, or legal cases, for half the cost of other models in its performance tier.",context_window:2e5,max_tokens:4096,type:"language",tags:["tool-use","vision"],pricing:{input:"0.00000025",output:"0.00000125",input_cache_read:"0.00000003",input_cache_write:"0.0000003"}},{id:"anthropic/claude-3-opus",object:"model",created:1755815280,owned_by:"anthropic",name:"Claude 3 Opus",description:"Claude 3 Opus is Anthropic's most powerful AI model, with state-of-the-art performance on highly complex tasks. It can navigate open-ended prompts and sight-unseen scenarios with remarkable fluency and human-like understanding. Claude 3 Opus shows us the frontier of what's possible with generative AI. Claude 3 Opus can process images and return text outputs, and features a 200K context window.",context_window:2e5,max_tokens:8192,type:"language",tags:[],pricing:{input:"0.000015",output:"0.000075"}},{id:"anthropic/claude-3.5-haiku",object:"model",created:1755815280,owned_by:"anthropic",name:"Claude 3.5 Haiku",description:"Claude 3.5 Haiku is the next generation of our fastest model. For a similar speed to Claude 3 Haiku, Claude 3.5 Haiku improves across every skill set and surpasses Claude 3 Opus, the largest model in our previous generation, on many intelligence benchmarks.",context_window:2e5,max_tokens:8192,type:"language",tags:["file-input","tool-use","vision"],pricing:{input:"0.0000008",output:"0.000004",input_cache_read:"0.00000008",input_cache_write:"0.000001"}},{id:"anthropic/claude-3.5-sonnet",object:"model",created:1755815280,owned_by:"anthropic",name:"Claude 3.5 Sonnet",description:"The upgraded Claude 3.5 Sonnet is now state-of-the-art for a variety of tasks including real-world software engineering, agentic capabilities and computer use. The new Claude 3.5 Sonnet delivers these advancements at the same price and speed as its predecessor.",context_window:2e5,max_tokens:8192,type:"language",tags:["file-input","tool-use","vision"],pricing:{input:"0.000003",output:"0.000015",input_cache_read:"0.0000003",input_cache_write:"0.00000375"}},{id:"anthropic/claude-3.5-sonnet-20240620",object:"model",created:1755815280,owned_by:"anthropic",name:"Claude 3.5 Sonnet (2024-06-20)",description:"Claude 3.5 Sonnet raises the industry bar for intelligence, outperforming competitor models and Claude 3 Opus on a wide range of evaluations, with the speed and cost of our mid-tier model, Claude 3 Sonnet.",context_window:2e5,max_tokens:8192,type:"language",tags:["file-input","tool-use","vision"],pricing:{input:"0.000003",output:"0.000015"}},{id:"anthropic/claude-3.7-sonnet",object:"model",created:1755815280,owned_by:"anthropic",name:"Claude 3.7 Sonnet",description:"Claude 3.7 Sonnet is the first hybrid reasoning model and Anthropic's most intelligent model to date. It delivers state-of-the-art performance for coding, content generation, data analysis, and planning tasks, building upon its predecessor Claude 3.5 Sonnet's capabilities in software engineering and computer use.",context_window:2e5,max_tokens:64e3,type:"language",tags:["file-input","reasoning","tool-use","vision"],pricing:{input:"0.000003",output:"0.000015",input_cache_read:"0.0000003",input_cache_write:"0.00000375"}},{id:"anthropic/claude-haiku-4.5",object:"model",created:1755815280,owned_by:"anthropic",name:"Claude Haiku 4.5",description:"Claude Haiku 4.5 matches Sonnet 4's performance on coding, computer use, and agent tasks at substantially lower cost and faster speeds. It delivers near-frontier performance and Claudes unique character at a price point that works for scaled sub-agent deployments, free tier products, and intelligence-sensitive applications with budget constraints.",context_window:2e5,max_tokens:64e3,type:"language",tags:["file-input","reasoning","tool-use","vision"],pricing:{input:"0.000001",output:"0.000005",input_cache_read:"0.0000001",input_cache_write:"0.00000125",web_search:"10"}},{id:"anthropic/claude-opus-4",object:"model",created:1755815280,owned_by:"anthropic",name:"Claude Opus 4",description:"Claude Opus 4 is Anthropic's most powerful model yet and the best coding model in the world, leading on SWE-bench (72.5%) and Terminal-bench (43.2%). It delivers sustained performance on long-running tasks that require focused effort and thousands of steps, with the ability to work continuously for several hoursdramatically outperforming all Sonnet models and significantly expanding what AI agents can accomplish.",context_window:2e5,max_tokens:32e3,type:"language",tags:["file-input","reasoning","tool-use","vision"],pricing:{input:"0.000015",output:"0.000075",input_cache_read:"0.0000015",input_cache_write:"0.00001875",web_search:"10"}},{id:"anthropic/claude-opus-4.1",object:"model",created:1755815280,owned_by:"anthropic",name:"Claude Opus 4.1",description:"Claude Opus 4.1 is a drop-in replacement for Opus 4 that delivers superior performance and precision for real-world coding and agentic tasks. Opus 4.1 advances state-of-the-art coding performance to 74.5% on SWE-bench Verified, and handles complex, multi-step problems with more rigor and attention to detail.",context_window:2e5,max_tokens:32e3,type:"language",tags:["file-input","reasoning","tool-use","vision"],pricing:{input:"0.000015",output:"0.000075",input_cache_read:"0.0000015",input_cache_write:"0.00001875",web_search:"10"}},{id:"anthropic/claude-opus-4.5",object:"model",created:1755815280,owned_by:"anthropic",name:"Claude Opus 4.5",description:"Claude Opus 4.5 is Anthropics latest model in the Opus series, meant for demanding reasoning tasks and complex problem solving. This model has improvements in general intelligence and vision compared to previous iterations. In addition, it is suited for difficult coding tasks and agentic workflows, especially those with computer use and tool use, and can effectively handle context usage and external memory files.",context_window:2e5,max_tokens:64e3,type:"language",tags:["tool-use","reasoning","vision","file-input"],pricing:{input:"0.000005",output:"0.000025",input_cache_read:"0.0000005",input_cache_write:"0.00000625"}},{id:"anthropic/claude-sonnet-4",object:"model",created:1755815280,owned_by:"anthropic",name:"Claude Sonnet 4",description:"Claude Sonnet 4 significantly improves on Sonnet 3.7's industry-leading capabilities, excelling in coding with a state-of-the-art 72.7% on SWE-bench. The model balances performance and efficiency for internal and external use cases, with enhanced steerability for greater control over implementations. While not matching Opus 4 in most domains, it delivers an optimal mix of capability and practicality.",context_window:1e6,max_tokens:64e3,type:"language",tags:["file-input","reasoning","tool-use","vision"],pricing:{input:"0.000003",input_tiers:[{cost:"0.000003",min:0,max:200001},{cost:"0.000006",min:200001}],output:"0.000015",output_tiers:[{cost:"0.000015",min:0,max:200001},{cost:"0.0000225",min:200001}],input_cache_read:"0.0000003",input_cache_write:"0.00000375",web_search:"10"}},{id:"anthropic/claude-sonnet-4.5",object:"model",created:1755815280,owned_by:"anthropic",name:"Claude Sonnet 4.5",description:"Claude Sonnet 4.5 is the newest model in the Sonnet series, offering improvements and updates over Sonnet 4.",context_window:1e6,max_tokens:64e3,type:"language",tags:["file-input","reasoning","tool-use","vision"],pricing:{input:"0.000003",input_tiers:[{cost:"0.000003",min:0,max:200001},{cost:"0.000006",min:200001}],output:"0.000015",output_tiers:[{cost:"0.000015",min:0,max:200001},{cost:"0.0000225",min:200001}],input_cache_read:"0.0000003",input_cache_write:"0.00000375",web_search:"10"}},{id:"arcee-ai/trinity-large-preview",object:"model",created:1755815280,owned_by:"arcee-ai",name:"Trinity Large Preview",description:"Trinity Large (Preview) is a 400B-parameter (13B active) sparse mixture-of-experts language model, engineered to scale model capacity while maintaining inference efficiency over long contexts, with strong performance in reasoning-heavy workloads including math, coding-related tasks, and multi-step agent workflows.",context_window:131e3,max_tokens:131e3,type:"language",tags:["tool-use"],pricing:{input:"0.00000025",output:"0.000001"}},{id:"arcee-ai/trinity-mini",object:"model",created:1755815280,owned_by:"arcee-ai",name:"Trinity Mini",description:"Trinity Mini is a 26B-parameter (3B active) sparse mixture-of-experts language model, engineered for efficient inference over long contexts with robust function calling and multi-step agent workflows.",context_window:131072,max_tokens:131072,type:"language",tags:[],pricing:{input:"0.000000045",output:"0.00000015"}},{id:"bfl/flux-kontext-max",object:"model",created:1755815280,owned_by:"bfl",name:"FLUX.1 Kontext Max",description:`FLUX.1 Kontext creates images from text prompts with unique capabilities for character consistency and advanced editing. It also edits images using simple text prompts. No complex workflows or fine-tuning needed.
This provider gives the option to change the moderation level for inputs and outputs. The control is under safety tolerance and is by default 2 on a range from 0 (more strict) through 6 (more permissive).`,context_window:512,max_tokens:0,type:"image",tags:["image-generation"],pricing:{image:"0.08"}},{id:"bfl/flux-kontext-pro",object:"model",created:1755815280,owned_by:"bfl",name:"FLUX.1 Kontext Pro",description:`FLUX.1 Kontext creates images from text prompts with unique capabilities for character consistency and advanced editing. It also edits images using simple text prompts. No complex workflows or fine-tuning needed.
This provider gives the option to change the moderation level for inputs and outputs. The control is under safety tolerance and is by default 2 on a range from 0 (more strict) through 6 (more permissive).`,context_window:512,max_tokens:0,type:"image",tags:["image-generation"],pricing:{image:"0.04"}},{id:"bfl/flux-pro-1.0-fill",object:"model",created:1755815280,owned_by:"bfl",name:"FLUX.1 Fill [pro]",description:`A state-of-the-art inpainting model, enabling editing and expansion of real and generated images given a text description and a binary mask.
This provider gives the option to change the moderation level for inputs and outputs. The control is under safety tolerance and is by default 2 on a range from 0 (more strict) through 6 (more permissive).`,context_window:0,max_tokens:0,type:"image",tags:["image-generation"],pricing:{image:"0.05"}},{id:"bfl/flux-pro-1.1",object:"model",created:1755815280,owned_by:"bfl",name:"FLUX1.1 [pro]",description:`FLUX1.1 [pro] is the standard for text-to-image generation with fast, reliable and consistently stunning results.
This provider gives the option to change the moderation level for inputs and outputs. The control is under safety tolerance and is by default 2 on a range from 0 (more strict) through 6 (more permissive).`,context_window:0,max_tokens:0,type:"image",tags:["image-generation"],pricing:{image:"0.04"}},{id:"bfl/flux-pro-1.1-ultra",object:"model",created:1755815280,owned_by:"bfl",name:"FLUX1.1 [pro] Ultra",description:`FLUX1.1 [pro] Ultra delivers ultra-fast, ultra high-resolution image creation - with more pixels in every picture. Generate varying aspect ratios from text, at 4MP resolution fast.
This provider gives the option to change the moderation level for inputs and outputs. The control is under safety tolerance and is by default 2 on a range from 0 (more strict) through 6 (more permissive).`,context_window:0,max_tokens:0,type:"image",tags:["image-generation"],pricing:{image:"0.06"}},{id:"bytedance/seed-1.6",object:"model",created:1755815280,owned_by:"bytedance",name:"Seed 1.6",description:"ByteDance's new multimodal deep-thinking model, supporting both text and visual inputs with enhanced reasoning capabilities.",context_window:256e3,max_tokens:32e3,type:"language",tags:["reasoning","tool-use","implicit-caching"],pricing:{input:"0.00000025",input_tiers:[{cost:"0.00000025",min:0,max:128001},{cost:"0.0000005",min:128001}],output:"0.000002",output_tiers:[{cost:"0.000002",min:0,max:128001},{cost:"0.000004",min:128001}],input_cache_read:"0.00000005"}},{id:"bytedance/seed-1.8",object:"model",created:1755815280,owned_by:"bytedance",name:"Bytedance Seed 1.8",description:"Bytedance Seed 1.8 features stronger multimodal understanding and agent capabilities. The model delivers superior performance across a wide range of complex real-world tasks, helping enterprises create greater value.",context_window:256e3,max_tokens:64e3,type:"language",tags:["reasoning","vision","implicit-caching"],pricing:{input:"0.00000025",input_tiers:[{cost:"0.00000025",min:0,max:128001},{cost:"0.0000005",min:128001}],output:"0.000002",output_tiers:[{cost:"0.000002",min:0,max:128001},{cost:"0.000004",min:128001}],input_cache_read:"0.00000005"}},{id:"cohere/command-a",object:"model",created:1755815280,owned_by:"cohere",name:"Command A",description:"Command A is Cohere's most performant model to date, excelling at tool use, agents, retrieval augmented generation (RAG), and multilingual use cases. Command A has a context length of 256K, only requires two GPUs to run, and has 150% higher throughput compared to Command R+ 08-2024.",context_window:256e3,max_tokens:8e3,type:"language",tags:["tool-use"],pricing:{input:"0.0000025",output:"0.00001"}},{id:"cohere/embed-v4.0",object:"model",created:1755815280,owned_by:"cohere",name:"Embed v4.0",description:"A model that allows for text, images, or mixed content to be classified or turned into embeddings.",context_window:0,max_tokens:0,type:"embedding",pricing:{input:"0.00000012"}},{id:"deepseek/deepseek-r1",object:"model",created:1755815280,owned_by:"deepseek",name:"DeepSeek-R1",description:"The DeepSeek R1 model has undergone a minor version upgrade, with the current version being DeepSeek-R1-0528.",context_window:16e4,max_tokens:16384,type:"language",tags:["reasoning","implicit-caching"],pricing:{input:"0.0000005",output:"0.00000215",input_cache_read:"0.0000004"}},{id:"deepseek/deepseek-v3",object:"model",created:1755815280,owned_by:"deepseek",name:"DeepSeek V3 0324",description:"Fast general-purpose LLM with enhanced reasoning capabilities",context_window:163840,max_tokens:16384,type:"language",tags:["tool-use"],pricing:{input:"0.00000077",output:"0.00000077"}},{id:"deepseek/deepseek-v3.1",object:"model",created:1755815280,owned_by:"deepseek",name:"DeepSeek-V3.1",description:"DeepSeek-V3.1 is post-trained on the top of DeepSeek-V3.1-Base, which is built upon the original V3 base checkpoint through a two-phase long context extension approach, following the methodology outlined in the original DeepSeek-V3 report. We have expanded our dataset by collecting additional long documents and substantially extending both training phases. The 32K extension phase has been increased 10-fold to 630B tokens, while the 128K extension phase has been extended by 3.3x to 209B tokens. Additionally, DeepSeek-V3.1 is trained using the UE8M0 FP8 scale data format to ensure compatibility with microscaling data formats.",context_window:163840,max_tokens:128e3,type:"language",tags:["reasoning","tool-use"],pricing:{input:"0.0000003",output:"0.000001"}},{id:"deepseek/deepseek-v3.1-terminus",object:"model",created:1755815280,owned_by:"deepseek",name:"DeepSeek V3.1 Terminus",description:"DeepSeek-V3.1-Terminus delivers more stable & reliable outputs across benchmarks compared to the previous version and addresses user feedback (i.e. language consistency and agent upgrades).",context_window:131072,max_tokens:65536,type:"language",tags:["reasoning","tool-use"],pricing:{input:"0.00000027",output:"0.000001"}},{id:"deepseek/deepseek-v3.2",object:"model",created:1755815280,owned_by:"deepseek",name:"DeepSeek V3.2",description:"DeepSeek-V3.2: Official successor to V3.2-Exp.",context_window:163842,max_tokens:8e3,type:"language",tags:["implicit-caching"],pricing:{input:"0.00000027",output:"0.0000004",input_cache_read:"0.000000216"}},{id:"deepseek/deepseek-v3.2-exp",object:"model",created:1755815280,owned_by:"deepseek",name:"DeepSeek V3.2 Exp",description:"DeepSeek-V3.2-Exp is an experimental model introducing the groundbreaking DeepSeek Sparse Attention (DSA) mechanism for enhanced long-context processing efficiency. Built on V3.1-Terminus, DSA achieves fine-grained sparse attention while maintaining identical output quality.",context_window:163840,max_tokens:163840,type:"language",tags:["implicit-caching","reasoning","tool-use"],pricing:{input:"0.00000027",output:"0.0000004"}},{id:"deepseek/deepseek-v3.2-thinking",object:"model",created:1755815280,owned_by:"deepseek",name:"DeepSeek V3.2 Thinking",description:"Thinking mode of DeepSeek V3.2",context_window:128e3,max_tokens:64e3,type:"language",tags:["reasoning","tool-use","implicit-caching"],pricing:{input:"0.00000028",output:"0.00000042",input_cache_read:"0.000000028"}},{id:"google/gemini-2.0-flash",object:"model",created:1755815280,owned_by:"google",name:"Gemini 2.0 Flash",description:"Gemini 2.0 Flash delivers next-gen features and improved capabilities, including superior speed, native tool use, multimodal generation, and a 1M token context window.",context_window:1e6,max_tokens:8192,type:"language",tags:["implicit-caching"],pricing:{input:"0.0000001",output:"0.0000004",input_cache_read:"0.000000025",web_search:"35"}},{id:"google/gemini-2.0-flash-lite",object:"model",created:1755815280,owned_by:"google",name:"Gemini 2.0 Flash Lite",description:"Gemini 2.0 Flash delivers next-gen features and improved capabilities, including superior speed, built-in tool use, multimodal generation, and a 1M token context window.",context_window:1048576,max_tokens:8192,type:"language",tags:[],pricing:{input:"0.000000075",output:"0.0000003",web_search:"35"}},{id:"google/gemini-2.5-flash",object:"model",created:1755815280,owned_by:"google",name:"Gemini 2.5 Flash",description:"Gemini 2.5 Flash is a thinking model that offers great, well-rounded capabilities. It is designed to offer a balance between price and performance with multimodal support and a 1M token context window.",context_window:1e6,max_tokens:65536,type:"language",tags:["reasoning","tool-use"],pricing:{input:"0.0000003",output:"0.0000025"}},{id:"google/gemini-2.5-flash-image",object:"model",created:1755815280,owned_by:"google",name:"Nano Banana (Gemini 2.5 Flash Image)",description:"Nano Banana (Gemini 2.5 Flash Image) is Google's first fully hybrid reasoning model, letting developers turn thinking on or off and set thinking budgets to balance quality, cost, and latency. Upgraded for rapid creative workflows, it can generate interleaved text and images and supports conversational, multiturn image editing in natural language. Its also localeaware, enabling culturally and linguistically appropriate image generation for audiences worldwide.",context_window:32768,max_tokens:32768,type:"language",tags:["image-generation"],pricing:{input:"0.0000003",output:"0.0000025",image:"0.039"}},{id:"google/gemini-2.5-flash-image-preview",object:"model",created:1755815280,owned_by:"google",name:"Nano Banana Preview (Gemini 2.5 Flash Image Preview)",description:"Nano Banana (Gemini 2.5 Flash Image) is Google's first fully hybrid reasoning model, letting developers turn thinking on or off and set thinking budgets to balance quality, cost, and latency. Upgraded for rapid creative workflows, it can generate interleaved text and images and supports conversational, multiturn image editing in natural language. Its also localeaware, enabling culturally and linguistically appropriate image generation for audiences worldwide.",context_window:32768,max_tokens:32768,type:"language",tags:["image-generation"],pricing:{input:"0.0000003",output:"0.0000025",image:"0.039"}},{id:"google/gemini-2.5-flash-lite",object:"model",created:1755815280,owned_by:"google",name:"Gemini 2.5 Flash Lite",description:"Gemini 2.5 Flash-Lite is a balanced, low-latency model with configurable thinking budgets and tool connectivity (e.g., Google Search grounding and code execution). It supports multimodal input and offers a 1M-token context window.",context_window:1048576,max_tokens:65536,type:"language",tags:["file-input","reasoning","tool-use","vision","implicit-caching"],pricing:{input:"0.0000001",output:"0.0000004",input_cache_read:"0.00000001",web_search:"35"}},{id:"google/gemini-2.5-flash-lite-preview-09-2025",object:"model",created:1755815280,owned_by:"google",name:"Gemini 2.5 Flash Lite Preview 09-2025",description:"Gemini 2.5 Flash-Lite is a balanced, low-latency model with configurable thinking budgets and tool connectivity (e.g., Google Search grounding and code execution). It supports multimodal input and offers a 1M-token context window.",context_window:1048576,max_tokens:65536,type:"language",tags:["file-input","reasoning","tool-use","vision","implicit-caching"],pricing:{input:"0.0000001",output:"0.0000004",input_cache_read:"0.00000001",web_search:"35"}},{id:"google/gemini-2.5-flash-preview-09-2025",object:"model",created:1755815280,owned_by:"google",name:"Gemini 2.5 Flash Preview 09-2025",description:"Gemini 2.5 Flash is a thinking model that offers great, well-rounded capabilities. It is designed to offer a balance between price and performance with multimodal support and a 1M token context window.",context_window:1e6,max_tokens:65536,type:"language",tags:["file-input","implicit-caching","reasoning","tool-use","vision"],pricing:{input:"0.0000003",output:"0.0000025",input_cache_read:"0.00000003",web_search:"35"}},{id:"google/gemini-2.5-pro",object:"model",created:1755815280,owned_by:"google",name:"Gemini 2.5 Pro",description:"Gemini 2.5 Pro is our most advanced reasoning Gemini model, capable of solving complex problems. Gemini 2.5 Pro can comprehend vast datasets and challenging problems from different information sources, including text, audio, images, video, and even entire code repositories.",context_window:1048576,max_tokens:65536,type:"language",tags:["tool-use","reasoning"],pricing:{input:"0.00000125",output:"0.00001"}},{id:"google/gemini-3-flash",object:"model",created:1755815280,owned_by:"google",name:"Gemini 3 Flash",description:"Google's most intelligent model built for speed, combining frontier intelligence with superior search and grounding.",context_window:1e6,max_tokens:64e3,type:"language",tags:["reasoning","file-input","vision","tool-use","implicit-caching"],pricing:{input:"0.0000005",input_tiers:[{cost:"0.0000005",min:0,max:200001},{cost:"0.0000005",min:200001}],output:"0.000003",output_tiers:[{cost:"0.000003",min:0,max:200001},{cost:"0.000003",min:200001}],input_cache_read:"0.00000005",input_cache_read_tiers:[{cost:"0.00000005",min:0,max:200001},{cost:"0.00000005",min:200001}],web_search:"14"}},{id:"google/gemini-3-pro-image",object:"model",created:1755815280,owned_by:"google",name:"Nano Banana Pro (Gemini 3 Pro Image)",description:"Nano Banana Pro (Gemini 3 Pro Image) builds on Nano Banana's generation capabilities into a new era of studio-quality, functional design to help you create and edit high-fidelity, production-ready visuals with unparalleled precision and control. Improvements include enhanced world knowledge and reasoning, dynamic text and translation, and studio level controls.",context_window:65536,max_tokens:32768,type:"language",tags:["image-generation"],pricing:{input:"0.000002",output:"0.00012",web_search:"14"}},{id:"google/gemini-3-pro-preview",object:"model",created:1755815280,owned_by:"google",name:"Gemini 3 Pro Preview",description:"This model improves upon Gemini 2.5 Pro and is catered towards challenging tasks, especially those involving complex reasoning or agentic workflows. Improvements highlighted include use cases for coding, multi-step function calling, planning, reasoning, deep knowledge tasks, and instruction following.",context_window:1e6,max_tokens:64e3,type:"language",tags:["file-input","tool-use","reasoning","vision","implicit-caching"],pricing:{input:"0.000002",input_tiers:[{cost:"0.000002",min:0,max:200001},{cost:"0.000004",min:200001}],output:"0.000012",output_tiers:[{cost:"0.000012",min:0,max:200001},{cost:"0.000018",min:200001}],input_cache_read:"0.0000002",input_cache_read_tiers:[{cost:"0.0000002",min:0,max:200001},{cost:"0.0000004",min:200001}],web_search:"14"}},{id:"google/gemini-embedding-001",object:"model",created:1755815280,owned_by:"google",name:"Gemini Embedding 001",description:"State-of-the-art embedding model with excellent performance across English, multilingual and code tasks.",context_window:0,max_tokens:0,type:"embedding",pricing:{input:"0.00000015"}},{id:"google/imagen-4.0-fast-generate-001",object:"model",created:1755815280,owned_by:"google",name:"Imagen 4 Fast",description:"Imagen 4 Fast is Googles speed-optimized variant of the Imagen 4 text-to-image model, designed for rapid, high-volume image generation. Its ideal for workflows like quick drafts, mockups, and iterative creative exploration. Despite emphasizing speed, it still benefits from the broader Imagen 4 familys improvements in clarity, text rendering, and stylistic flexibility, and supports high-resolution outputs up to 2K.",context_window:480,max_tokens:0,type:"image",tags:["image-generation"],pricing:{image:"0.02"}},{id:"google/imagen-4.0-generate-001",object:"model",created:1755815280,owned_by:"google",name:"Imagen 4",description:"Imagen 4: Google's flagship text-to-image model that serves as the go-to choice for a wide variety of high-quality image generation tasks, featuring significant improvements in text rendering over previous models. It now supports up to 2K resolution generation for creating detailed and crisp visuals, making it suitable for everything from marketing assets to artistic compositions.",context_window:480,max_tokens:0,type:"image",tags:["image-generation"],pricing:{image:"0.04"}},{id:"google/imagen-4.0-ultra-generate-001",object:"model",created:1755815280,owned_by:"google",name:"Imagen 4 Ultra",description:"Imagen 4 Ultra: Highest quality image generation model for detailed and photorealistic outputs.",context_window:480,max_tokens:0,type:"image",tags:["image-generation"],pricing:{image:"0.06"}},{id:"google/text-embedding-005",object:"model",created:1755815280,owned_by:"google",name:"Text Embedding 005",description:"English-focused text embedding model optimized for code and English language tasks.",context_window:0,max_tokens:0,type:"embedding",pricing:{input:"0.000000025"}},{id:"google/text-multilingual-embedding-002",object:"model",created:1755815280,owned_by:"google",name:"Text Multilingual Embedding 002",description:"Multilingual text embedding model optimized for cross-lingual tasks across many languages.",context_window:0,max_tokens:0,type:"embedding",pricing:{input:"0.000000025"}},{id:"inception/mercury-coder-small",object:"model",created:1755815280,owned_by:"inception",name:"Mercury Coder Small Beta",description:"Mercury Coder Small is ideal for code generation, debugging, and refactoring tasks with minimal latency.",context_window:32e3,max_tokens:16384,type:"language",tags:["tool-use"],pricing:{input:"0.00000025",output:"0.000001"}},{id:"kwaipilot/kat-coder-pro-v1",object:"model",created:1755815280,owned_by:"kwaipilot",name:"KAT-Coder-Pro V1",description:"KAT-Coder-Pro V1 is KwaiKAT's most advanced agentic coding model in the KwaiKAT series. Designed specifically for agentic coding tasks, it excels in real-world software engineering scenarios, achieving a remarkable 73.4% solve rate on the SWE-Bench Verified benchmark. KAT-Coder-Pro V1 delivers top-tier coding performance and has been rigorously tested by thousands of in-house engineers. The model has been optimized for tool-use capability, multi-turn interaction, instruction following, generalization and comprehensive capabilities through a multi-stage training process, including mid-training, supervised fine-tuning (SFT), reinforcement fine-tuning (RFT), and scalable agentic RL.",context_window:256e3,max_tokens:32e3,type:"language",tags:["reasoning","implicit-caching"],pricing:{input:"0.000000207",output:"0.000000828",input_cache_read:"0.0000000414"}},{id:"meituan/longcat-flash-chat",object:"model",created:1755815280,owned_by:"meituan",name:"LongCat Flash Chat",description:"LongCat-Flash-Chat is a high-throughput MoE chat model (128k context) designed for agentic tasks.",context_window:128e3,max_tokens:8192,type:"language",tags:["tool-use"],pricing:{}},{id:"meituan/longcat-flash-thinking",object:"model",created:1755815280,owned_by:"meituan",name:"LongCat Flash Thinking",description:"LongCat-Flash-Thinking is a high-throughput MoE reasoning model (128k context) optimized for agentic tasks.",context_window:128e3,max_tokens:8192,type:"language",tags:["reasoning","tool-use"],pricing:{input:"0.00000015",output:"0.0000015"}},{id:"meta/llama-3.1-70b",object:"model",created:1755815280,owned_by:"meta",name:"Llama 3.1 70B Instruct",description:"An update to Meta Llama 3 70B Instruct that includes an expanded 128K context length, multilinguality and improved reasoning capabilities.",context_window:131072,max_tokens:16384,type:"language",tags:["tool-use"],pricing:{input:"0.0000004",output:"0.0000004"}},{id:"meta/llama-3.1-8b",object:"model",created:1755815280,owned_by:"meta",name:"Llama 3.1 8B Instruct",description:"An update to Meta Llama 3 8B Instruct that includes an expanded 128K context length, multilinguality and improved reasoning capabilities.",context_window:131072,max_tokens:16384,type:"language",tags:["tool-use"],pricing:{input:"0.00000003",output:"0.00000005"}},{id:"meta/llama-3.2-11b",object:"model",created:1755815280,owned_by:"meta",name:"Llama 3.2 11B Vision Instruct",description:"Instruction-tuned image reasoning generative model (text + images in / text out) optimized for visual recognition, image reasoning, captioning and answering general questions about the image.",context_window:128e3,max_tokens:8192,type:"language",tags:["tool-use","vision"],pricing:{input:"0.00000016",output:"0.00000016"}},{id:"meta/llama-3.2-1b",object:"model",created:1755815280,owned_by:"meta",name:"Llama 3.2 1B Instruct",description:"Text-only model, supporting on-device use cases such as multilingual local knowledge retrieval, summarization, and rewriting.",context_window:128e3,max_tokens:8192,type:"language",pricing:{input:"0.0000001",output:"0.0000001"}},{id:"meta/llama-3.2-3b",object:"model",created:1755815280,owned_by:"meta",name:"Llama 3.2 3B Instruct",description:"Text-only model, fine-tuned for supporting on-device use cases such as multilingual local knowledge retrieval, summarization, and rewriting.",context_window:128e3,max_tokens:8192,type:"language",pricing:{input:"0.00000015",output:"0.00000015"}},{id:"meta/llama-3.2-90b",object:"model",created:1755815280,owned_by:"meta",name:"Llama 3.2 90B Vision Instruct",description:"Instruction-tuned image reasoning generative model (text + images in / text out) optimized for visual recognition, image reasoning, captioning and answering general questions about the image.",context_window:128e3,max_tokens:8192,type:"language",tags:["tool-use","vision"],pricing:{input:"0.00000072",output:"0.00000072"}},{id:"meta/llama-3.3-70b",object:"model",created:1755815280,owned_by:"meta",name:"Llama 3.3 70B Instruct",description:"Where performance meets efficiency. This model supports high-performance conversational AI designed for content creation, enterprise applications, and research, offering advanced language understanding capabilities, including text summarization, classification, sentiment analysis, and code generation.",context_window:128e3,max_tokens:8192,type:"language",tags:["tool-use"],pricing:{input:"0.00000072",output:"0.00000072"}},{id:"meta/llama-4-maverick",object:"model",created:1755815280,owned_by:"meta",name:"Llama 4 Maverick 17B Instruct",description:"The Llama 4 collection of models are natively multimodal AI models that enable text and multimodal experiences. These models leverage a mixture-of-experts architecture to offer industry-leading performance in text and image understanding. Llama 4 Maverick, a 17 billion parameter model with 128 experts. Served by DeepInfra.",context_window:131072,max_tokens:8192,type:"language",tags:["tool-use","vision"],pricing:{input:"0.00000015",output:"0.0000006"}},{id:"meta/llama-4-scout",object:"model",created:1755815280,owned_by:"meta",name:"Llama 4 Scout 17B Instruct",description:"The Llama 4 collection of models are natively multimodal AI models that enable text and multimodal experiences. These models leverage a mixture-of-experts architecture to offer industry-leading performance in text and image understanding. Llama 4 Scout, a 17 billion parameter model with 16 experts. Served by DeepInfra.",context_window:131072,max_tokens:8192,type:"language",tags:["tool-use","vision"],pricing:{input:"0.00000008",output:"0.0000003"}},{id:"minimax/minimax-m2",object:"model",created:1755815280,owned_by:"minimax",name:"MiniMax M2",description:"MiniMax-M2 redefines efficiency for agents. It is a compact, fast, and cost-effective MoE model (230 billion total parameters with 10 billion active parameters) built for elite performance in coding and agentic tasks, all while maintaining powerful general intelligence.",context_window:262114,max_tokens:262114,type:"language",tags:["reasoning","tool-use"],pricing:{input:"0.00000027",output:"0.00000115"}},{id:"minimax/minimax-m2.1",object:"model",created:1755815280,owned_by:"minimax",name:"MiniMax M2.1",description:"MiniMax 2.1 is MiniMax's latest model, optimized specifically for robustness in coding, tool use, instruction following, and long-horizon planning.",context_window:196608,max_tokens:196608,type:"language",tags:["reasoning","tool-use","implicit-caching"],pricing:{input:"0.00000028",output:"0.0000012",input_cache_read:"0.00000014"}},{id:"minimax/minimax-m2.1-lightning",object:"model",created:1755815280,owned_by:"minimax",name:"MiniMax M2.1 Lightning",description:"MiniMax-M2.1-lightning is a faster version of MiniMax-M2.1, offering the same performance but with significantly higher throughput (output speed ~100 TPS, MiniMax-M2 output speed ~60 TPS).",context_window:204800,max_tokens:131072,type:"language",tags:["reasoning","tool-use","implicit-caching"],pricing:{input:"0.0000003",output:"0.0000024",input_cache_read:"0.00000003",input_cache_write:"0.000000375"}},{id:"mistral/codestral",object:"model",created:1755815280,owned_by:"mistral",name:"Mistral Codestral",description:"Mistral's cutting-edge language model for coding released end of July 2025, Codestral specializes in low-latency, high-frequency tasks such as fill-in-the-middle (FIM), code correction and test generation.",context_window:128e3,max_tokens:4e3,type:"language",tags:["tool-use"],pricing:{input:"0.0000003",output:"0.0000009"}},{id:"mistral/codestral-embed",object:"model",created:1755815280,owned_by:"mistral",name:"Codestral Embed",description:"Code embedding model that can embed code databases and repositories to power coding assistants.",context_window:0,max_tokens:0,type:"embedding",pricing:{input:"0.00000015"}},{id:"mistral/devstral-2",object:"model",created:1755815280,owned_by:"mistral",name:"Devstral 2",description:"An enterprise-grade text model that excels at using tools to explore codebases, editing multiple files, and powering software engineering agents.",context_window:256e3,max_tokens:256e3,type:"language",tags:["tool-use"],pricing:{}},{id:"mistral/devstral-small",object:"model",created:1755815280,owned_by:"mistral",name:"Devstral Small 1.1",description:"Devstral is an agentic LLM for software engineering tasks built under a collaboration between Mistral AI and All Hands AI . Devstral excels at using tools to explore codebases, editing multiple files and power software engineering agents.",context_window:128e3,max_tokens:64e3,type:"language",tags:["tool-use"],pricing:{input:"0.0000001",output:"0.0000003"}},{id:"mistral/devstral-small-2",object:"model",created:1755815280,owned_by:"mistral",name:"Devstral Small 2",description:"Our open source model that excels at using tools to explore codebases, editing multiple files, and powering software engineering agents.",context_window:256e3,max_tokens:256e3,type:"language",tags:["tool-use"],pricing:{}},{id:"mistral/magistral-medium",object:"model",created:1755815280,owned_by:"mistral",name:"Magistral Medium 2509",description:"Complex thinking, backed by deep understanding, with transparent reasoning you can follow and verify. The model excels in maintaining high-fidelity reasoning across numerous languages, even when switching between languages mid-task.",context_window:128e3,max_tokens:64e3,type:"language",tags:["reasoning","vision"],pricing:{input:"0.000002",output:"0.000005"}},{id:"mistral/magistral-small",object:"model",created:1755815280,owned_by:"mistral",name:"Magistral Small 2509",description:"Complex thinking, backed by deep understanding, with transparent reasoning you can follow and verify. The model excels in maintaining high-fidelity reasoning across numerous languages, even when switching between languages mid-task.",context_window:128e3,max_tokens:64e3,type:"language",tags:["reasoning","vision"],pricing:{input:"0.0000005",output:"0.0000015"}},{id:"mistral/ministral-14b",object:"model",created:1755815280,owned_by:"mistral",name:"Ministral 14B",description:"Ministral 3 14B is the largest model in the Ministral 3 family, offering state-of-the-art capabilities and performance comparable to its larger Mistral Small 3.2 24B counterpart. Optimized for local deployment, it delivers high performance across diverse hardware, including local setups.",context_window:256e3,max_tokens:256e3,type:"language",tags:["vision","file-input"],pricing:{input:"0.0000002",output:"0.0000002"}},{id:"mistral/ministral-3b",object:"model",created:1755815280,owned_by:"mistral",name:"Ministral 3B",description:"A compact, efficient model for on-device tasks like smart assistants and local analytics, offering low-latency performance.",context_window:128e3,max_tokens:4e3,type:"language",tags:["tool-use"],pricing:{input:"0.00000004",output:"0.00000004"}},{id:"mistral/ministral-8b",object:"model",created:1755815280,owned_by:"mistral",name:"Ministral 8B",description:"A more powerful model with faster, memory-efficient inference, ideal for complex workflows and demanding edge applications.",context_window:128e3,max_tokens:4e3,type:"language",tags:["tool-use"],pricing:{input:"0.0000001",output:"0.0000001"}},{id:"mistral/mistral-embed",object:"model",created:1755815280,owned_by:"mistral",name:"Mistral Embed",description:"General-purpose text embedding model for semantic search, similarity, clustering, and RAG workflows.",context_window:0,max_tokens:0,type:"embedding",pricing:{input:"0.0000001"}},{id:"mistral/mistral-large-3",object:"model",created:1755815280,owned_by:"mistral",name:"Mistral Large 3",description:"Mistral Large 3 2512 is Mistrals most capable model to date. It has a sparse mixture-of-experts architecture with 41B active parameters (675B total).",context_window:256e3,max_tokens:256e3,type:"language",tags:["vision"],pricing:{input:"0.0000005",output:"0.0000015"}},{id:"mistral/mistral-medium",object:"model",created:1755815280,owned_by:"mistral",name:"Mistral Medium 3.1",description:"Mistral Medium 3 delivers frontier performance while being an order of magnitude less expensive. For instance, the model performs at or above 90% of Claude Sonnet 3.7 on benchmarks across the board at a significantly lower cost.",context_window:128e3,max_tokens:64e3,type:"language",tags:["tool-use","vision"],pricing:{input:"0.0000004",output:"0.000002"}},{id:"mistral/mistral-nemo",object:"model",created:1755815280,owned_by:"mistral",name:"Mistral Nemo 12B",description:"12B model trained jointly by Mistral AI and NVIDIA, it significantly outperforms existing models smaller or similar in size.",context_window:131072,max_tokens:131072,type:"language",tags:[],pricing:{input:"0.00000002",output:"0.00000004"}},{id:"mistral/mistral-small",object:"model",created:1755815280,owned_by:"mistral",name:"Mistral Small",description:"Mistral Small is the ideal choice for simple tasks that one can do in bulk - like Classification, Customer Support, or Text Generation. It offers excellent performance at an affordable price point.",context_window:32e3,max_tokens:4e3,type:"language",tags:["tool-use","vision"],pricing:{input:"0.0000001",output:"0.0000003"}},{id:"mistral/mixtral-8x22b-instruct",object:"model",created:1755815280,owned_by:"mistral",name:"Mixtral MoE 8x22B Instruct",description:"8x22b Instruct model. 8x22b is mixture-of-experts open source model by Mistral served by Fireworks.",context_window:65536,max_tokens:2048,type:"language",pricing:{input:"0.0000012",output:"0.0000012"}},{id:"mistral/pixtral-12b",object:"model",created:1755815280,owned_by:"mistral",name:"Pixtral 12B 2409",description:"A 12B model with image understanding capabilities in addition to text.",context_window:128e3,max_tokens:4e3,type:"language",tags:["tool-use","vision"],pricing:{input:"0.00000015",output:"0.00000015"}},{id:"mistral/pixtral-large",object:"model",created:1755815280,owned_by:"mistral",name:"Pixtral Large",description:"Pixtral Large is the second model in our multimodal family and demonstrates frontier-level image understanding. Particularly, the model is able to understand documents, charts and natural images, while maintaining the leading text-only understanding of Mistral Large 2.",context_window:128e3,max_tokens:4e3,type:"language",tags:["tool-use","vision"],pricing:{input:"0.000002",output:"0.000006"}},{id:"moonshotai/kimi-k2",object:"model",created:1755815280,owned_by:"moonshotai",name:"Kimi K2",description:"Kimi K2 is a large-scale Mixture-of-Experts (MoE) language model developed by Moonshot AI, featuring 1 trillion total parameters with 32 billion active per forward pass. It is optimized for agentic capabilities, including advanced tool use, reasoning, and code synthesis. Kimi K2 excels across a broad range of benchmarks, particularly in coding (LiveCodeBench, SWE-bench), reasoning (ZebraLogic, GPQA), and tool-use (Tau2, AceBench) tasks.",context_window:131072,max_tokens:16384,type:"language",tags:["tool-use"],pricing:{input:"0.0000005",output:"0.000002"}},{id:"moonshotai/kimi-k2-0905",object:"model",created:1755815280,owned_by:"moonshotai",name:"Kimi K2 0905",description:"Kimi K2 0905 has shown strong performance on agentic tasks thanks to its tool calling, reasoning abilities, and long context handling. But as a large parameter model (1T parameters), its also resource-intensive. Running it in production requires a highly optimized inference stack to avoid excessive latency.",context_window:131072,max_tokens:16384,type:"language",pricing:{input:"0.0000006",output:"0.0000025"}},{id:"moonshotai/kimi-k2-thinking",object:"model",created:1755815280,owned_by:"moonshotai",name:"Kimi K2 Thinking",description:"Kimi K2 Thinking is an advanced open-source thinking model by Moonshot AI. It can execute up to 200  300 sequential tool calls without human interference, reasoning coherently across hundreds of steps to solve complex problems. Built as a thinking agent, it reasons step by step while using tools, achieving state-of-the-art performance on Humanity's Last Exam (HLE), BrowseComp, and other benchmarks, with major gains in reasoning, agentic search, coding, writing, and general capabilities.",context_window:216144,max_tokens:216144,type:"language",tags:["reasoning","tool-use","implicit-caching"],pricing:{input:"0.00000047",output:"0.000002",input_cache_read:"0.000000141"}},{id:"moonshotai/kimi-k2-thinking-turbo",object:"model",created:1755815280,owned_by:"moonshotai",name:"Kimi K2 Thinking Turbo",description:"High-speed version of kimi-k2-thinking, suitable for scenarios requiring both deep reasoning and extremely fast responses",context_window:262114,max_tokens:262114,type:"language",tags:["reasoning","tool-use","implicit-caching"],pricing:{input:"0.00000115",output:"0.000008",input_cache_read:"0.00000015"}},{id:"moonshotai/kimi-k2-turbo",object:"model",created:1755815280,owned_by:"moonshotai",name:"Kimi K2 Turbo",description:"Kimi K2 Turbo is the high-speed version of kimi-k2, with the same model parameters as kimi-k2, but the output speed is increased to 60 tokens per second, with a maximum of 100 tokens per second, the context length is 256k",context_window:256e3,max_tokens:16384,type:"language",tags:["tool-use"],pricing:{input:"0.0000024",output:"0.00001"}},{id:"moonshotai/kimi-k2.5",object:"model",created:1755815280,owned_by:"moonshotai",name:"Kimi K2.5",description:"kimi-k2.5 is Kimi's most versatile model to date, featuring a native multimodal architecture that supports both visual and text input, thinking and non-thinking modes, and dialogue and agent tasks.",context_window:256e3,max_tokens:256e3,type:"language",tags:["reasoning","tool-use","vision","implicit-caching"],pricing:{input:"0.0000006",output:"0.000003",input_cache_read:"0.0000001"}},{id:"morph/morph-v3-fast",object:"model",created:1755815280,owned_by:"morph",name:"Morph V3 Fast",description:"Morph offers a specialized AI model that applies code changes suggested by frontier models (like Claude or GPT-4o) to your existing code files FAST - 4500+ tokens/second. It acts as the final step in the AI coding workflow. Supports 16k input tokens and 16k output tokens.",context_window:81920,max_tokens:16384,type:"language",pricing:{input:"0.0000008",output:"0.0000012"}},{id:"morph/morph-v3-large",object:"model",created:1755815280,owned_by:"morph",name:"Morph V3 Large",description:"Morph offers a specialized AI model that applies code changes suggested by frontier models (like Claude or GPT-4o) to your existing code files FAST - 2500+ tokens/second. It acts as the final step in the AI coding workflow. Supports 16k input tokens and 16k output tokens.",context_window:81920,max_tokens:16384,type:"language",pricing:{input:"0.0000009",output:"0.0000019"}},{id:"nvidia/nemotron-3-nano-30b-a3b",object:"model",created:1755815280,owned_by:"nvidia",name:"Nemotron 3 Nano 30B A3B",description:"NVIDIA Nemotron 3 Nano is an open reasoning model optimized for fast, cost-efficient inference. Built with a hybrid MoE and Mamba architecture and trained on NVIDIA-curated synthetic reasoning data, it delivers strong multi-step reasoning with stable latency and predictable performance for agentic and production workloads.",context_window:262144,max_tokens:262144,type:"language",tags:["reasoning"],pricing:{input:"0.00000006",output:"0.00000024"}},{id:"nvidia/nemotron-nano-12b-v2-vl",object:"model",created:1755815280,owned_by:"nvidia",name:"Nvidia Nemotron Nano 12B V2 VL",description:"The model is an auto-regressive vision language model that uses an optimized transformer architecture. The model enables multi-image reasoning and video understanding, along with strong document intelligence, visual Q&A and summarization capabilities.",context_window:131072,max_tokens:131072,type:"language",tags:["vision","reasoning","tool-use"],pricing:{input:"0.0000002",output:"0.0000006"}},{id:"nvidia/nemotron-nano-9b-v2",object:"model",created:1755815280,owned_by:"nvidia",name:"Nvidia Nemotron Nano 9B V2",description:"NVIDIA-Nemotron-Nano-9B-v2 is a large language model (LLM) trained from scratch by NVIDIA, and designed as a unified model for both reasoning and non-reasoning tasks. It responds to user queries and tasks by first generating a reasoning trace and then concluding with a final response. The model's reasoning capabilities can be controlled via a system prompt. If the user prefers the model to provide its final answer without intermediate reasoning traces, it can be configured to do so.",context_window:131072,max_tokens:131072,type:"language",tags:["reasoning","tool-use"],pricing:{input:"0.00000004",output:"0.00000016"}},{id:"openai/codex-mini",object:"model",created:1755815280,owned_by:"openai",name:"Codex Mini",description:"Codex Mini is a fine-tuned version of o4-mini specifically for use in Codex CLI.",context_window:2e5,max_tokens:1e5,type:"language",tags:["reasoning","vision","file-input","tool-use","implicit-caching"],pricing:{input:"0.0000015",output:"0.000006",input_cache_read:"0.000000375"}},{id:"openai/gpt-3.5-turbo",object:"model",created:1755815280,owned_by:"openai",name:"GPT-3.5 Turbo",description:"OpenAI's most capable and cost effective model in the GPT-3.5 family optimized for chat purposes, but also works well for traditional completions tasks.",context_window:16385,max_tokens:4096,type:"language",pricing:{input:"0.0000005",output:"0.0000015"}},{id:"openai/gpt-3.5-turbo-instruct",object:"model",created:1755815280,owned_by:"openai",name:"GPT-3.5 Turbo Instruct",description:"Similar capabilities as GPT-3 era models. Compatible with legacy Completions endpoint and not Chat Completions.",context_window:8192,max_tokens:4096,type:"language",pricing:{input:"0.0000015",output:"0.000002"}},{id:"openai/gpt-4-turbo",object:"model",created:1755815280,owned_by:"openai",name:"GPT-4 Turbo",description:"gpt-4-turbo from OpenAI has broad general knowledge and domain expertise allowing it to follow complex instructions in natural language and solve difficult problems accurately. It has a knowledge cutoff of April 2023 and a 128,000 token context window.",context_window:128e3,max_tokens:4096,type:"language",tags:["tool-use","vision"],pricing:{input:"0.00001",output:"0.00003"}},{id:"openai/gpt-4.1",object:"model",created:1755815280,owned_by:"openai",name:"GPT-4.1",description:"GPT 4.1 is OpenAI's flagship model for complex tasks. It is well suited for problem solving across domains.",context_window:1047576,max_tokens:32768,type:"language",tags:["file-input","tool-use","vision"],pricing:{input:"0.000002",output:"0.000008",input_cache_read:"0.0000005"}},{id:"openai/gpt-4.1-mini",object:"model",created:1755815280,owned_by:"openai",name:"GPT-4.1 mini",description:"GPT 4.1 mini provides a balance between intelligence, speed, and cost that makes it an attractive model for many use cases.",context_window:1047576,max_tokens:32768,type:"language",tags:["file-input","tool-use","vision","implicit-caching"],pricing:{input:"0.0000004",output:"0.0000016",input_cache_read:"0.0000001"}},{id:"openai/gpt-4.1-nano",object:"model",created:1755815280,owned_by:"openai",name:"GPT-4.1 nano",description:"GPT-4.1 nano is the fastest, most cost-effective GPT 4.1 model.",context_window:1047576,max_tokens:32768,type:"language",tags:["file-input","tool-use","vision","implicit-caching"],pricing:{input:"0.0000001",output:"0.0000004",input_cache_read:"0.00000003"}},{id:"openai/gpt-4o",object:"model",created:1755815280,owned_by:"openai",name:"GPT-4o",description:"GPT-4o from OpenAI has broad general knowledge and domain expertise allowing it to follow complex instructions in natural language and solve difficult problems accurately. It matches GPT-4 Turbo performance with a faster and cheaper API.",context_window:128e3,max_tokens:16384,type:"language",tags:["file-input","tool-use","vision","implicit-caching"],pricing:{input:"0.0000025",output:"0.00001",input_cache_read:"0.00000125"}},{id:"openai/gpt-4o-mini",object:"model",created:1755815280,owned_by:"openai",name:"GPT-4o mini",description:"GPT-4o mini from OpenAI is their most advanced and cost-efficient small model. It is multi-modal (accepting text or image inputs and outputting text) and has higher intelligence than gpt-3.5-turbo but is just as fast.",context_window:128e3,max_tokens:16384,type:"language",tags:["file-input","tool-use","vision","implicit-caching"],pricing:{input:"0.00000015",output:"0.0000006",input_cache_read:"0.000000075"}},{id:"openai/gpt-4o-mini-search-preview",object:"model",created:1755815280,owned_by:"openai",name:"GPT 4o Mini Search Preview",description:"GPT-4o mini Search Preview is a specialized model trained to understand and execute web search queries with the Chat Completions API. In addition to token fees, web search queries have a fee per tool call.",context_window:128e3,max_tokens:16384,type:"language",tags:[],pricing:{input:"0.00000015",output:"0.0000006",web_search:"10"}},{id:"openai/gpt-5",object:"model",created:1755815280,owned_by:"openai",name:"GPT-5",description:"GPT-5 is OpenAI's flagship language model that excels at complex reasoning, broad real-world knowledge, code-intensive, and multi-step agentic tasks.",context_window:4e5,max_tokens:128e3,type:"language",tags:["file-input","reasoning","tool-use","vision","image-generation","implicit-caching"],pricing:{input:"0.00000125",output:"0.00001",input_cache_read:"0.00000013"}},{id:"openai/gpt-5-chat",object:"model",created:1755815280,owned_by:"openai",name:"GPT-5 Chat",description:"GPT-5 Chat points to the GPT-5 snapshot currently used in ChatGPT.",context_window:128e3,max_tokens:16384,type:"language",tags:["tool-use","implicit-caching","file-input","image-generation","vision","reasoning"],pricing:{input:"0.00000125",output:"0.00001",input_cache_read:"0.000000125",web_search:"10"}},{id:"openai/gpt-5-codex",object:"model",created:1755815280,owned_by:"openai",name:"GPT-5-Codex",description:"GPT-5-Codex is a version of GPT-5 optimized for agentic coding tasks in Codex or similar environments.",context_window:4e5,max_tokens:128e3,type:"language",tags:["file-input","reasoning","tool-use","vision","implicit-caching"],pricing:{input:"0.00000125",output:"0.00001",input_cache_read:"0.00000013"}},{id:"openai/gpt-5-mini",object:"model",created:1755815280,owned_by:"openai",name:"GPT-5 mini",description:"GPT-5 mini is a cost optimized model that excels at reasoning/chat tasks. It offers an optimal balance between speed, cost, and capability.",context_window:4e5,max_tokens:128e3,type:"language",tags:["file-input","reasoning","tool-use","vision","implicit-caching"],pricing:{input:"0.00000025",output:"0.000002",input_cache_read:"0.00000003"}},{id:"openai/gpt-5-nano",object:"model",created:1755815280,owned_by:"openai",name:"GPT-5 nano",description:"GPT-5 nano is a high throughput model that excels at simple instruction or classification tasks.",context_window:4e5,max_tokens:128e3,type:"language",tags:["file-input","reasoning","tool-use","vision","image-generation","implicit-caching"],pricing:{input:"0.00000005",output:"0.0000004",input_cache_read:"0.00000001"}},{id:"openai/gpt-5-pro",object:"model",created:1755815280,owned_by:"openai",name:"GPT-5 pro",description:"GPT-5 pro uses more compute to think harder and provide consistently better answers. Since GPT-5 pro is designed to tackle tough problems, some requests may take several minutes to finish.",context_window:4e5,max_tokens:272e3,type:"language",tags:["file-input","implicit-caching","reasoning","tool-use","vision","image-generation"],pricing:{input:"0.000015",output:"0.00012",web_search:"10"}},{id:"openai/gpt-5.1-codex",object:"model",created:1755815280,owned_by:"openai",name:"GPT-5.1-Codex",description:"GPT-5.1-Codex is a version of GPT-5.1 optimized for agentic coding tasks in Codex or similar environments.",context_window:4e5,max_tokens:128e3,type:"language",tags:["file-input","tool-use","reasoning","vision"],pricing:{input:"0.00000125",output:"0.00001",input_cache_read:"0.000000125"}},{id:"openai/gpt-5.1-codex-max",object:"model",created:1755815280,owned_by:"openai",name:"GPT 5.1 Codex Max",description:"GPT5.1-Codex-Max is purpose-built for agentic coding.",context_window:4e5,max_tokens:128e3,type:"language",tags:["reasoning","file-input","tool-use","vision","implicit-caching"],pricing:{input:"0.00000125",output:"0.00001",input_cache_read:"0.000000125",web_search:"10"}},{id:"openai/gpt-5.1-codex-mini",object:"model",created:1755815280,owned_by:"openai",name:"GPT-5.1 Codex mini",description:"GPT-5.1 Codex mini is a smaller, faster, and cheaper version of GPT-5.1 Codex.",context_window:4e5,max_tokens:128e3,type:"language",tags:["reasoning","file-input","vision","tool-use","implicit-caching"],pricing:{input:"0.00000025",output:"0.000002",input_cache_read:"0.000000025",web_search:"10"}},{id:"openai/gpt-5.1-instant",object:"model",created:1755815280,owned_by:"openai",name:"GPT-5.1 Instant",description:"GPT-5.1 Instant (or GPT-5.1 chat) is a warmer and more conversational version of GPT-5-chat, with improved instruction following and adaptive reasoning for deciding when to think before responding.",context_window:128e3,max_tokens:16384,type:"language",tags:["tool-use","vision","file-input","reasoning","implicit-caching"],pricing:{input:"0.00000125",output:"0.00001",input_cache_read:"0.00000013"}},{id:"openai/gpt-5.1-thinking",object:"model",created:1755815280,owned_by:"openai",name:"GPT 5.1 Thinking",description:"An upgraded version of GPT-5 that adapts thinking time more precisely to the question to spend more time on complex questions and respond more quickly to simpler tasks.",context_window:4e5,max_tokens:128e3,type:"language",tags:["tool-use","implicit-caching","reasoning","vision","file-input"],pricing:{input:"0.00000125",output:"0.00001",input_cache_read:"0.00000013"}},{id:"openai/gpt-5.2",object:"model",created:1755815280,owned_by:"openai",name:"GPT 5.2",description:"GPT-5.2 is OpenAI's best general-purpose model, part of the GPT-5 flagship model family. It's their most intelligent model yet for both general and agentic tasks.",context_window:4e5,max_tokens:128e3,type:"language",tags:["tool-use","vision","file-input","reasoning","implicit-caching"],pricing:{input:"0.00000175",output:"0.000014",input_cache_read:"0.00000018"}},{id:"openai/gpt-5.2-chat",object:"model",created:1755815280,owned_by:"openai",name:"GPT-5.2 Chat",description:"The model powering ChatGPT is gpt-5.2-chat-latest: this is OpenAI's best general-purpose model, part of the GPT-5 flagship model family.",context_window:128e3,max_tokens:16384,type:"language",tags:["vision","file-input","tool-use","reasoning","implicit-caching"],pricing:{input:"0.00000175",output:"0.000014",input_cache_read:"0.000000175",web_search:"10"}},{id:"openai/gpt-5.2-codex",object:"model",created:1755815280,owned_by:"openai",name:"GPT-5.2-Codex",description:"GPT5.2-Codex is a version of GPT5.2 further optimized for agentic coding in Codex, including improvements on long-horizon work through context compaction, stronger performance on large code changes like refactors and migrations, improved performance in Windows environments, and significantly stronger cybersecurity capabilities.",context_window:4e5,max_tokens:128e3,type:"language",tags:["file-input","tool-use","reasoning","vision","implicit-caching"],pricing:{input:"0.00000175",output:"0.000014",input_cache_read:"0.000000175",web_search:"10"}},{id:"openai/gpt-5.2-pro",object:"model",created:1755815280,owned_by:"openai",name:"GPT 5.2 ",description:"Version of GPT-5.2 that produces smarter and more precise responses.",context_window:4e5,max_tokens:128e3,type:"language",tags:["tool-use","vision","implicit-caching","reasoning","file-input"],pricing:{input:"0.000021",output:"0.000168",web_search:"10"}},{id:"openai/gpt-oss-120b",object:"model",created:1755815280,owned_by:"openai",name:"gpt-oss-120b",description:"Extremely capable general-purpose LLM with strong, controllable reasoning capabilities",context_window:131072,max_tokens:131072,type:"language",tags:["reasoning","tool-use"],pricing:{input:"0.0000001",output:"0.0000005"}},{id:"openai/gpt-oss-20b",object:"model",created:1755815280,owned_by:"openai",name:"gpt-oss-20b",description:"A compact, open-weight language model optimized for low-latency and resource-constrained environments, including local and edge deployments",context_window:128e3,max_tokens:8192,type:"language",tags:["reasoning","tool-use"],pricing:{input:"0.00000007",output:"0.0000003"}},{id:"openai/gpt-oss-safeguard-20b",object:"model",created:1755815280,owned_by:"openai",name:"gpt-oss-safeguard-20b",description:"OpenAI's first open weight reasoning model specifically trained for safety classification tasks. Fine-tuned from GPT-OSS, this model helps classify text content based on customizable policies, enabling bring-your-own-policy Trust & Safety AI where your own taxonomy, definitions, and thresholds guide classification decisions.",context_window:131072,max_tokens:65536,type:"language",tags:["reasoning","tool-use"],pricing:{input:"0.000000075",output:"0.0000003",input_cache_read:"0.000000037"}},{id:"openai/o1",object:"model",created:1755815280,owned_by:"openai",name:"o1",description:"o1 is OpenAI's flagship reasoning model, designed for complex problems that require deep thinking. It provides strong reasoning capabilities with improved accuracy for complex multi-step tasks.",context_window:2e5,max_tokens:1e5,type:"language",tags:["file-input","reasoning","tool-use","vision","implicit-caching"],pricing:{input:"0.000015",output:"0.00006",input_cache_read:"0.0000075"}},{id:"openai/o3",object:"model",created:1755815280,owned_by:"openai",name:"o3",description:"OpenAI's o3 is their most powerful reasoning model, setting new state-of-the-art benchmarks in coding, math, science, and visual perception. It excels at complex queries requiring multi-faceted analysis, with particular strength in analyzing images, charts, and graphics.",context_window:2e5,max_tokens:1e5,type:"language",tags:["file-input","reasoning","tool-use","vision","implicit-caching"],pricing:{input:"0.000002",output:"0.000008",input_cache_read:"0.0000005"}},{id:"openai/o3-deep-research",object:"model",created:1755815280,owned_by:"openai",name:"o3-deep-research",description:"o3-deep-research is OpenAI's most advanced model for deep research, designed to tackle complex, multi-step research tasks. It can search and synthesize information from across the internet as well as from your own databrought in through MCP connectors.",context_window:2e5,max_tokens:1e5,type:"language",tags:["reasoning","file-input","tool-use","vision","implicit-caching"],pricing:{input:"0.00001",output:"0.00004",input_cache_read:"0.0000025",web_search:"10"}},{id:"openai/o3-mini",object:"model",created:1755815280,owned_by:"openai",name:"o3-mini",description:"o3-mini is OpenAI's most recent small reasoning model, providing high intelligence at the same cost and latency targets of o1-mini.",context_window:2e5,max_tokens:1e5,type:"language",tags:["file-input","reasoning","tool-use","implicit-caching"],pricing:{input:"0.0000011",output:"0.0000044",input_cache_read:"0.00000055"}},{id:"openai/o3-pro",object:"model",created:1755815280,owned_by:"openai",name:"o3 Pro",description:"The o-series of models are trained with reinforcement learning to think before they answer and perform complex reasoning. The o3-pro model uses more compute to think harder and provide consistently better answers.",context_window:2e5,max_tokens:1e5,type:"language",tags:["reasoning","vision","file-input","tool-use"],pricing:{input:"0.00002",output:"0.00008"}},{id:"openai/o4-mini",object:"model",created:1755815280,owned_by:"openai",name:"o4-mini",description:"OpenAI's o4-mini delivers fast, cost-efficient reasoning with exceptional performance for its size, particularly excelling in math (best-performing on AIME benchmarks), coding, and visual tasks.",context_window:2e5,max_tokens:1e5,type:"language",tags:["file-input","reasoning","tool-use","vision","implicit-caching"],pricing:{input:"0.0000011",output:"0.0000044",input_cache_read:"0.000000275"}},{id:"openai/text-embedding-3-large",object:"model",created:1755815280,owned_by:"openai",name:"text-embedding-3-large",description:"OpenAI's most capable embedding model for both english and non-english tasks.",context_window:0,max_tokens:0,type:"embedding",pricing:{input:"0.00000013"}},{id:"openai/text-embedding-3-small",object:"model",created:1755815280,owned_by:"openai",name:"text-embedding-3-small",description:"OpenAI's improved, more performant version of their ada embedding model.",context_window:0,max_tokens:0,type:"embedding",pricing:{input:"0.00000002"}},{id:"openai/text-embedding-ada-002",object:"model",created:1755815280,owned_by:"openai",name:"text-embedding-ada-002",description:"OpenAI's legacy text embedding model.",context_window:0,max_tokens:0,type:"embedding",pricing:{input:"0.0000001"}},{id:"perplexity/sonar",object:"model",created:1755815280,owned_by:"perplexity",name:"Sonar",description:"Perplexity's lightweight offering with search grounding, quicker and cheaper than Sonar Pro.",context_window:127e3,max_tokens:8e3,type:"language",tags:["tool-use","vision"],pricing:{input:"0.000001",output:"0.000001"}},{id:"perplexity/sonar-pro",object:"model",created:1755815280,owned_by:"perplexity",name:"Sonar Pro",description:"Perplexity's premier offering with search grounding, supporting advanced queries and follow-ups.",context_window:2e5,max_tokens:8e3,type:"language",tags:["tool-use","vision"],pricing:{input:"0.000003",output:"0.000015"}},{id:"perplexity/sonar-reasoning",object:"model",created:1755815280,owned_by:"perplexity",name:"Sonar Reasoning",description:"A reasoning-focused model that outputs Chain of Thought (CoT) in responses, providing detailed explanations with search grounding.",context_window:127e3,max_tokens:8e3,type:"language",tags:["reasoning"],pricing:{input:"0.000001",output:"0.000005"}},{id:"perplexity/sonar-reasoning-pro",object:"model",created:1755815280,owned_by:"perplexity",name:"Sonar Reasoning Pro",description:"A premium reasoning-focused model that outputs Chain of Thought (CoT) in responses, providing comprehensive explanations with enhanced search capabilities and multiple search queries per request.",context_window:127e3,max_tokens:8e3,type:"language",tags:["reasoning"],pricing:{input:"0.000002",output:"0.000008"}},{id:"prime-intellect/intellect-3",object:"model",created:1755815280,owned_by:"prime-intellect",name:"INTELLECT 3",description:`Introducing INTELLECT-3: Scaling RL to a 100B+ MoE model on our end-to-end stack.

Achieving state-of-the-art performance for its size across math, code and reasoning.`,context_window:131072,max_tokens:131072,type:"language",tags:["reasoning","tool-use"],pricing:{input:"0.0000002",output:"0.0000011"}},{id:"recraft/recraft-v2",object:"model",created:1755815280,owned_by:"recraft",name:"Recraft V2",description:"Recraft V2 is an image generation model released in March 2024 and the first model trained from scratch by Recraft. With 20 billion parameters, it was a breakthrough in human anatomical accuracy and the first to support brand consistency and brand color inputs. It also introduced vector image generation (SVG output), as well as minimalistic icon and illustration styles.",context_window:0,max_tokens:0,type:"image",tags:["image-generation"],pricing:{image:"0.022"}},{id:"recraft/recraft-v3",object:"model",created:1755815280,owned_by:"recraft",name:"Recraft V3",description:"V3 introduced major advances in photorealism and text rendering. It was the first Recraft model to generate mid-size text accurately and, as of 2025, is the only model capable of placing text at specific positions in an image.",context_window:0,max_tokens:0,type:"image",tags:["image-generation"],pricing:{image:"0.04"}},{id:"vercel/v0-1.0-md",object:"model",created:1755815280,owned_by:"vercel",name:"v0-1.0-md",description:"Access the model behind v0 to generate, fix, and optimize modern web apps with framework-specific reasoning and up-to-date knowledge.",context_window:128e3,max_tokens:32e3,type:"language",tags:["tool-use","vision"],pricing:{input:"0.000003",output:"0.000015"}},{id:"vercel/v0-1.5-md",object:"model",created:1755815280,owned_by:"vercel",name:"v0-1.5-md",description:"Access the model behind v0 to generate, fix, and optimize modern web apps with framework-specific reasoning and up-to-date knowledge.",context_window:128e3,max_tokens:32768,type:"language",tags:["tool-use","vision"],pricing:{input:"0.000003",output:"0.000015"}},{id:"voyage/voyage-3-large",object:"model",created:1755815280,owned_by:"voyage",name:"voyage-3-large",description:"Voyage AI's embedding model with the best general-purpose and multilingual retrieval quality.",context_window:0,max_tokens:0,type:"embedding",pricing:{input:"0.00000018"}},{id:"voyage/voyage-3.5",object:"model",created:1755815280,owned_by:"voyage",name:"voyage-3.5",description:"Voyage AI's embedding model optimized for general-purpose and multilingual retrieval quality.",context_window:0,max_tokens:0,type:"embedding",pricing:{input:"0.00000006"}},{id:"voyage/voyage-3.5-lite",object:"model",created:1755815280,owned_by:"voyage",name:"voyage-3.5-lite",description:"Voyage AI's embedding model optimized for latency and cost.",context_window:0,max_tokens:0,type:"embedding",pricing:{input:"0.00000002"}},{id:"voyage/voyage-code-2",object:"model",created:1755815280,owned_by:"voyage",name:"voyage-code-2",description:"Voyage AI's embedding model optimized for code retrieval (17% better than alternatives). This is the previous generation of code embeddings models.",context_window:0,max_tokens:0,type:"embedding",pricing:{input:"0.00000012"}},{id:"voyage/voyage-code-3",object:"model",created:1755815280,owned_by:"voyage",name:"voyage-code-3",description:"Voyage AI's embedding model optimized for code retrieval.",context_window:0,max_tokens:0,type:"embedding",pricing:{input:"0.00000018"}},{id:"voyage/voyage-finance-2",object:"model",created:1755815280,owned_by:"voyage",name:"voyage-finance-2",description:"Voyage AI's embedding model optimized for finance retrieval and RAG.",context_window:0,max_tokens:0,type:"embedding",pricing:{input:"0.00000012"}},{id:"voyage/voyage-law-2",object:"model",created:1755815280,owned_by:"voyage",name:"voyage-law-2",description:"Voyage AI's embedding model optimized for legal retrieval and RAG.",context_window:0,max_tokens:0,type:"embedding",pricing:{input:"0.00000012"}},{id:"xai/grok-2-vision",object:"model",created:1755815280,owned_by:"xai",name:"Grok 2 Vision",description:"Grok 2 vision model excels in vision-based tasks, delivering state-of-the-art performance in visual math reasoning (MathVista) and document-based question answering (DocVQA). It can process a wide variety of visual information including documents, diagrams, charts, screenshots, and photographs.",context_window:32768,max_tokens:32768,type:"language",tags:["tool-use","vision"],pricing:{input:"0.000002",output:"0.00001"}},{id:"xai/grok-3",object:"model",created:1755815280,owned_by:"xai",name:"Grok 3 Beta",description:"xAI's flagship model that excels at enterprise use cases like data extraction, coding, and text summarization. Possesses deep domain knowledge in finance, healthcare, law, and science.",context_window:131072,max_tokens:131072,type:"language",tags:["tool-use"],pricing:{input:"0.000003",output:"0.000015"}},{id:"xai/grok-3-fast",object:"model",created:1755815280,owned_by:"xai",name:"Grok 3 Fast Beta",description:"xAI's flagship model that excels at enterprise use cases like data extraction, coding, and text summarization. Possesses deep domain knowledge in finance, healthcare, law, and science. The fast model variant is served on faster infrastructure, offering response times that are significantly faster than the standard. The increased speed comes at a higher cost per output token.",context_window:131072,max_tokens:131072,type:"language",tags:["tool-use"],pricing:{input:"0.000005",output:"0.000025"}},{id:"xai/grok-3-mini",object:"model",created:1755815280,owned_by:"xai",name:"Grok 3 Mini Beta",description:"xAI's lightweight model that thinks before responding. Great for simple or logic-based tasks that do not require deep domain knowledge. The raw thinking traces are accessible.",context_window:131072,max_tokens:131072,type:"language",tags:["tool-use"],pricing:{input:"0.0000003",output:"0.0000005"}},{id:"xai/grok-3-mini-fast",object:"model",created:1755815280,owned_by:"xai",name:"Grok 3 Mini Fast Beta",description:"xAI's lightweight model that thinks before responding. Great for simple or logic-based tasks that do not require deep domain knowledge. The raw thinking traces are accessible. The fast model variant is served on faster infrastructure, offering response times that are significantly faster than the standard. The increased speed comes at a higher cost per output token.",context_window:131072,max_tokens:131072,type:"language",tags:["tool-use"],pricing:{input:"0.0000006",output:"0.000004"}},{id:"xai/grok-4",object:"model",created:1755815280,owned_by:"xai",name:"Grok 4",description:"xAI's latest and greatest flagship model, offering unparalleled performance in natural language, math and reasoning - the perfect jack of all trades.",context_window:256e3,max_tokens:256e3,type:"language",tags:["reasoning","tool-use","vision"],pricing:{input:"0.000003",output:"0.000015"}},{id:"xai/grok-4-fast-non-reasoning",object:"model",created:1755815280,owned_by:"xai",name:"Grok 4 Fast Non-Reasoning",description:"Grok 4 Fast is xAI's latest multimodal model with SOTA cost-efficiency and a 2M token context window. It comes in two flavors: non-reasoning and reasoning.",context_window:2e6,max_tokens:256e3,type:"language",tags:["tool-use","implicit-caching"],pricing:{input:"0.0000002",input_tiers:[{cost:"0.0000002",min:0,max:128001},{cost:"0.0000004",min:128001}],output:"0.0000005",output_tiers:[{cost:"0.0000005",min:0,max:128001},{cost:"0.000001",min:128001}],input_cache_read:"0.00000005"}},{id:"xai/grok-4-fast-reasoning",object:"model",created:1755815280,owned_by:"xai",name:"Grok 4 Fast Reasoning",description:"Grok 4 Fast is xAI's latest multimodal model with SOTA cost-efficiency and a 2M token context window. It comes in two flavors: non-reasoning and reasoning.",context_window:2e6,max_tokens:256e3,type:"language",tags:["reasoning","tool-use","implicit-caching"],pricing:{input:"0.0000002",input_tiers:[{cost:"0.0000002",min:0,max:128001},{cost:"0.0000004",min:128001}],output:"0.0000005",output_tiers:[{cost:"0.0000005",min:0,max:128001},{cost:"0.000001",min:128001}],input_cache_read:"0.00000005"}},{id:"xai/grok-4.1-fast-non-reasoning",object:"model",created:1755815280,owned_by:"xai",name:"Grok 4.1 Fast Non-Reasoning",description:"Grok 4.1 Fast is xAI's best tool-calling model with a 2M context window. It reasons and completes agentic tasks accurately and rapidly, excelling at complex real-world use cases such as customer support and finance. To optimize for speed use this variant. Otherwise, use the reasoning version.",context_window:2e6,max_tokens:3e4,type:"language",tags:["tool-use","implicit-caching"],pricing:{input:"0.0000002",input_tiers:[{cost:"0.0000002",min:0,max:128001},{cost:"0.0000004",min:128001}],output:"0.0000005",output_tiers:[{cost:"0.0000005",min:0,max:128001},{cost:"0.000001",min:128001}],input_cache_read:"0.00000005"}},{id:"xai/grok-4.1-fast-reasoning",object:"model",created:1755815280,owned_by:"xai",name:"Grok 4.1 Fast Reasoning",description:"Grok 4.1 Fast is xAI's best tool-calling model with a 2M context window. It reasons and completes agentic tasks accurately and rapidly, excelling at complex real-world use cases such as customer support and finance. To optimize for maximal intelligence use this variant. Otherwise, use the non-reasoning version.",context_window:2e6,max_tokens:3e4,type:"language",tags:["reasoning","tool-use","implicit-caching"],pricing:{input:"0.0000002",input_tiers:[{cost:"0.0000002",min:0,max:128001},{cost:"0.0000004",min:128001}],output:"0.0000005",output_tiers:[{cost:"0.0000005",min:0,max:128001},{cost:"0.000001",min:128001}],input_cache_read:"0.00000005"}},{id:"xai/grok-code-fast-1",object:"model",created:1755815280,owned_by:"xai",name:"Grok Code Fast 1",description:"xAI's latest coding model that offers fast agentic coding with a 256K context window.",context_window:256e3,max_tokens:256e3,type:"language",tags:["reasoning","tool-use","implicit-caching"],pricing:{input:"0.0000002",output:"0.0000015",input_cache_read:"0.00000002"}},{id:"xiaomi/mimo-v2-flash",object:"model",created:1755815280,owned_by:"xiaomi",name:"MiMo V2 Flash",description:"Xiaomi MiMo-V2-Flash is a proprietary MoE model developed by Xiaomi, designed for extreme inference efficiency with 309B total parameters (15B active). By incorporating an innovative Hybrid attention architecture and multi-layer MTP inference acceleration, it ranks among the top 2 global open-source models across multiple Agent benchmarks.",context_window:262144,max_tokens:32e3,type:"language",tags:["reasoning","tool-use"],pricing:{input:"0.00000009",output:"0.00000029"}},{id:"zai/glm-4.5",object:"model",created:1755815280,owned_by:"zai",name:"GLM-4.5",description:"GLM-4.5 Series Models are foundation models specifically engineered for intelligent agents. The flagship GLM-4.5 integrates 355 billion total parameters (32 billion active), unifying reasoning, coding, and agent capabilities to address complex application demands. As a hybrid reasoning system, it offers dual operational modes.",context_window:131072,max_tokens:131072,type:"language",tags:["reasoning","tool-use"],pricing:{input:"0.0000006",output:"0.0000022"}},{id:"zai/glm-4.5-air",object:"model",created:1755815280,owned_by:"zai",name:"GLM 4.5 Air",description:"GLM-4.5 and GLM-4.5-Air are our latest flagship models, purpose-built as foundational models for agent-oriented applications. Both leverage a Mixture-of-Experts (MoE) architecture. GLM-4.5 has a total parameter count of 355B with 32B active parameters per forward pass, while GLM-4.5-Air adopts a more streamlined design with 106B total parameters and 12B active parameters.",context_window:128e3,max_tokens:96e3,type:"language",tags:["reasoning","tool-use","implicit-caching"],pricing:{input:"0.0000002",output:"0.0000011",input_cache_read:"0.00000003"}},{id:"zai/glm-4.5v",object:"model",created:1755815280,owned_by:"zai",name:"GLM 4.5V",description:"Built on the GLM-4.5-Air base model, GLM-4.5V inherits proven techniques from GLM-4.1V-Thinking while achieving effective scaling through a powerful 106B-parameter MoE architecture.",context_window:65536,max_tokens:16384,type:"language",tags:["reasoning","tool-use","vision"],pricing:{input:"0.0000006",output:"0.0000018"}},{id:"zai/glm-4.6",object:"model",created:1755815280,owned_by:"zai",name:"GLM 4.6",description:"As the latest iteration in the GLM series, GLM-4.6 achieves comprehensive enhancements across multiple domains, including real-world coding, long-context processing, reasoning, searching, writing, and agentic applications.",context_window:2e5,max_tokens:96e3,type:"language",tags:["reasoning","tool-use","implicit-caching"],pricing:{input:"0.00000045",output:"0.0000018",input_cache_read:"0.00000011"}},{id:"zai/glm-4.6v",object:"model",created:1755815280,owned_by:"zai",name:"GLM-4.6V",description:"GLM-4.6V series are Z.ais iterations in a multimodal large language model. GLM-4.6V scales its context window to 128k tokens in training, and achieves SoTA performance in visual understanding among models of similar parameter scales.",context_window:128e3,max_tokens:24e3,type:"language",tags:["vision","file-input","reasoning","tool-use","implicit-caching"],pricing:{input:"0.0000003",output:"0.0000009",input_cache_read:"0.00000005"}},{id:"zai/glm-4.6v-flash",object:"model",created:1755815280,owned_by:"zai",name:"GLM-4.6V-Flash",description:"For local deployment and low-latency applications. GLM-4.6V series are Z.ais iterations in a multimodal large language model. GLM-4.6V scales its context window to 128k tokens in training, and achieves SoTA performance in visual understanding among models of similar parameter scales.",context_window:128e3,max_tokens:24e3,type:"language",tags:["vision","reasoning","file-input","tool-use","implicit-caching"],pricing:{}},{id:"zai/glm-4.7",object:"model",created:1755815280,owned_by:"zai",name:"GLM 4.7",description:"GLM-4.7 is Z.ais latest flagship model, with major upgrades focused on two key areas: stronger coding capabilities and more stable multi-step reasoning and execution.",context_window:202752,max_tokens:12e4,type:"language",tags:["reasoning","implicit-caching","tool-use"],pricing:{input:"0.00000043",output:"0.00000175",input_cache_read:"0.00000008"}},{id:"zai/glm-4.7-flashx",object:"model",created:1755815280,owned_by:"zai",name:"GLM 4.7 FlashX",description:" GLM-4.7-Flash balances high performance with efficiency, making it the perfect lightweight deployment option. ",context_window:2e5,max_tokens:128e3,type:"language",tags:["reasoning","tool-use","implicit-caching"],pricing:{input:"0.00000006",output:"0.0000004",input_cache_read:"0.00000001"}}];function Q6(e){const t=e.tags??[];return{id:e.id,object:e.object,owned_by:e.owned_by,name:e.name,description:e.description,type:e.type,tags:e.tags,context_window:e.context_window,max_tokens:e.max_tokens,pricing:e.pricing,reasoning:t.includes("reasoning"),toolCall:t.includes("tool-use"),input:{image:t.includes("vision")||e.type==="image",text:e.type==="language",pdf:t.includes("file-input"),video:!1,audio:!1},output:{image:t.includes("image-generation")||e.type==="image",text:e.type==="language",audio:!1}}}const zc=ob("ai/models");async function Y6(){const e=process.env.AI_GATEWAY_API_KEY||process.env.VERCEL_OIDC_TOKEN;if(!e)return zc.warn("No AI gateway API key found, using fallback models"),qg;const t="https://ai-gateway.vercel.sh/v1/models";zc.debug({url:t},"Fetching models from AI gateway");try{const n=await fetch(t,{headers:{Authorization:`Bearer ${e}`,"Content-Type":"application/json"},next:{revalidate:3600}});if(!n.ok)throw zc.error({status:n.status,statusText:n.statusText,url:t},"AI gateway returned non-OK response"),new Error(`Failed to fetch models: ${n.statusText}`);const i=await n.json(),r=Z6.parse(i),o=r.data?.length??0;return zc.info({modelCount:o},"Successfully fetched models from AI gateway"),r.data||[]}catch(n){return zc.error({err:n,url:t},"Error fetching models from gateway, falling back to generated models"),qg}}const X6=sb(async()=>(await Y6()).map(Q6),["ai-gateway-models"],{revalidate:3600,tags:["ai-gateway-models"]}),qm=new Set(ke.models.disabledModels),xd=ke.models.providerOrder;function ez(e){return e.flatMap(t=>{const n=t.id;if(t.reasoning===!0){const i=`${n}-reasoning`;return[{...t,id:i,apiModelId:n,disabled:qm.has(n)},{...t,reasoning:!1,apiModelId:n,disabled:qm.has(n)}]}return[{...t,apiModelId:n,disabled:qm.has(n)}]}).filter(t=>t.type==="language"&&!t.disabled)}function tz(e){return e.filter(t=>t.output.text===!0).sort((t,n)=>{const i=xd.indexOf(t.owned_by),r=xd.indexOf(n.owned_by),o=i===-1?xd.length:i,s=r===-1?xd.length:r;return o!==s?o-s:0})}const qN=sb(async()=>{const e=await X6();return ez(e)},["all-app-models"],{revalidate:3600,tags:["ai-gateway-models"]}),nz=sb(async()=>{const e=await qN();return tz(e)},["chat-models"],{revalidate:3600,tags:["ai-gateway-models"]});async function aie(e){const n=(await qN()).find(i=>i.id===e);if(!n)throw new Error(`Model ${e} not found`);return n}const Hm="openai/gpt-5-nano";new Set(qg.map(e=>e.id));async function ab(){return await nz()}mM(ab,"/app/actions/get-chat-models.ts","getChatModels");const rz=Object.freeze(Object.defineProperty({__proto__:null,getChatModels:ab},Symbol.toStringTag,{value:"Module"}));const iz=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),oz=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,i)=>i?i.toUpperCase():n.toLowerCase()),hS=e=>{const t=oz(e);return t.charAt(0).toUpperCase()+t.slice(1)},HN=(...e)=>e.filter((t,n,i)=>!!t&&t.trim()!==""&&i.indexOf(t)===n).join(" ").trim(),sz=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0};var az={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const cz=fn.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:r="",children:o,iconNode:s,...a},c)=>fn.createElement("svg",{ref:c,...az,width:t,height:t,stroke:e,strokeWidth:i?Number(n)*24/Number(t):n,className:HN("lucide",r),...!o&&!sz(a)&&{"aria-hidden":"true"},...a},[...s.map(([l,u])=>fn.createElement(l,u)),...Array.isArray(o)?o:[o]]));const cb=(e,t)=>{const n=fn.forwardRef(({className:i,...r},o)=>fn.createElement(cz,{ref:o,iconNode:t,className:HN(`lucide-${iz(hS(e))}`,`lucide-${e}`,i),...r}));return n.displayName=hS(e),n};const lz=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],uz=cb("chevron-left",lz);const dz=[["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M17 20v2",key:"1rnc9c"}],["path",{d:"M17 2v2",key:"11trls"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M2 17h2",key:"7oei6x"}],["path",{d:"M2 7h2",key:"asdhe0"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"M20 17h2",key:"1fpfkl"}],["path",{d:"M20 7h2",key:"1o8tra"}],["path",{d:"M7 20v2",key:"4gnj0m"}],["path",{d:"M7 2v2",key:"1i4yhu"}],["rect",{x:"4",y:"4",width:"16",height:"16",rx:"2",key:"1vbyd7"}],["rect",{x:"8",y:"8",width:"8",height:"8",rx:"1",key:"z9xiuo"}]],fz=cb("cpu",dz);const pz=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],hz=cb("external-link",pz),mz=await Qt("/components/link.tsx"),lb=Ne(mz,"/components/link.tsx","default"),gz=await Qt("/components/new-chat-button.tsx"),yz=Ne(gz,"/components/new-chat-button.tsx","NewChatButton"),wz=await Qt("/components/search-chats.tsx"),vz=Ne(wz,"/components/search-chats.tsx","SearchChatsButton"),bz=await Qt("/components/sidebar-top-row.tsx"),_z=Ne(bz,"/components/sidebar-top-row.tsx","SidebarTopRow"),KN=await Qt("/components/ui/scroll-area.tsx"),Sz=Ne(KN,"/components/ui/scroll-area.tsx","ScrollArea");Ne(KN,"/components/ui/scroll-area.tsx","ScrollBar");const hn=await Qt("/components/ui/sidebar.tsx"),xz=Ne(hn,"/components/ui/sidebar.tsx","Sidebar"),kz=Ne(hn,"/components/ui/sidebar.tsx","SidebarContent"),Ez=Ne(hn,"/components/ui/sidebar.tsx","SidebarFooter");Ne(hn,"/components/ui/sidebar.tsx","SidebarGroup");Ne(hn,"/components/ui/sidebar.tsx","SidebarGroupAction");Ne(hn,"/components/ui/sidebar.tsx","SidebarGroupContent");Ne(hn,"/components/ui/sidebar.tsx","SidebarGroupLabel");const Az=Ne(hn,"/components/ui/sidebar.tsx","SidebarHeader");Ne(hn,"/components/ui/sidebar.tsx","SidebarInput");const Tz=Ne(hn,"/components/ui/sidebar.tsx","SidebarInset"),Iz=Ne(hn,"/components/ui/sidebar.tsx","SidebarMenu");Ne(hn,"/components/ui/sidebar.tsx","SidebarMenuAction");Ne(hn,"/components/ui/sidebar.tsx","SidebarMenuBadge");const Nz=Ne(hn,"/components/ui/sidebar.tsx","SidebarMenuButton"),mS=Ne(hn,"/components/ui/sidebar.tsx","SidebarMenuItem");Ne(hn,"/components/ui/sidebar.tsx","SidebarMenuSkeleton");Ne(hn,"/components/ui/sidebar.tsx","SidebarMenuSub");Ne(hn,"/components/ui/sidebar.tsx","SidebarMenuSubButton");Ne(hn,"/components/ui/sidebar.tsx","SidebarMenuSubItem");const $z=Ne(hn,"/components/ui/sidebar.tsx","SidebarProvider");Ne(hn,"/components/ui/sidebar.tsx","SidebarRail");const gS=Ne(hn,"/components/ui/sidebar.tsx","SidebarSeparator");Ne(hn,"/components/ui/sidebar.tsx","SidebarTrigger");Ne(hn,"/components/ui/sidebar.tsx","useSidebar");const Cz=await Qt("/components/app-sidebar-history-conditional.tsx"),Oz=Ne(Cz,"/components/app-sidebar-history-conditional.tsx","AppSidebarHistoryConditional"),Rz=await Qt("/components/sidebar-user-nav.tsx"),Pz=Ne(Rz,"/components/sidebar-user-nav.tsx","SidebarUserNav");function Dz(){return F.jsxs(xz,{className:"grid max-h-dvh grid-rows-[auto_1fr_auto] group-data-[side=left]:border-r-0",collapsible:"icon",children:[F.jsx(Az,{className:"shrink-0",children:F.jsxs(Iz,{children:[F.jsx("div",{className:"flex flex-row items-center justify-between",children:F.jsx(_z,{})}),F.jsx(yz,{}),F.jsx(mS,{children:F.jsx(vz,{})}),F.jsx(mS,{children:F.jsx(Nz,{asChild:!0,tooltip:"Models",children:F.jsxs(lb,{href:"/settings/models",children:[F.jsx(fz,{className:"size-4"}),F.jsx("span",{className:"group-data-[collapsible=icon]:hidden",children:"Models"})]})})})]})}),F.jsx(gS,{}),F.jsx(Sz,{className:"relative flex-1 overflow-y-auto",children:F.jsx(kz,{className:"max-w-(--sidebar-width) pr-2",children:F.jsx(Oz,{})})}),F.jsx(gS,{}),F.jsx(Ez,{children:F.jsx(Pz,{})})]})}const JN=await Qt("/components/keyboard-shortcuts.tsx"),Uz=Ne(JN,"/components/keyboard-shortcuts.tsx","KeyboardShortcuts");Ne(JN,"/components/keyboard-shortcuts.tsx","getNewChatShortcutText");const kd=ke.anonymous,Lz={CREDITS:kd.credits,AVAILABLE_MODELS:ke.models.anonymousModels,AVAILABLE_TOOLS:kd.availableTools,RATE_LIMIT:{REQUESTS_PER_MINUTE:kd.rateLimit.requestsPerMinute,REQUESTS_PER_MONTH:kd.rateLimit.requestsPerMonth}},GN=await Qt("/providers/chat-models-provider.tsx"),Mz=Ne(GN,"/providers/chat-models-provider.tsx","ChatModelsProvider");Ne(GN,"/providers/chat-models-provider.tsx","useChatModels");const ub=await Qt("/providers/default-model-provider.tsx"),jz=Ne(ub,"/providers/default-model-provider.tsx","DefaultModelProvider");Ne(ub,"/providers/default-model-provider.tsx","useDefaultModel");Ne(ub,"/providers/default-model-provider.tsx","useModelChange");const zz=await Qt("/providers/react-query-provider.tsx"),Bz=Ne(zz,"/providers/react-query-provider.tsx","ReactQueryProvider"),ZN=await Qt("/providers/session-provider.tsx"),Fz=Ne(ZN,"/providers/session-provider.tsx","SessionProvider");Ne(ZN,"/providers/session-provider.tsx","useSession");function yS(e,t){if(!e)return;const n=e.split(";").map(r=>r.trim()).find(r=>r.startsWith(`${t}=`));if(!n)return;const i=n.slice(t.length+1);try{return decodeURIComponent(i)}catch{return i}}async function Wz({children:e,requestInfo:t}){const n=t?.ctx?.session??null,i=t?.request?.headers.get("cookie")??null,r=yS(i,"sidebar:state")!=="true",o=yS(i,"chat-model"),s=!n?.user,a=await ab();let c=o??Hm;return o&&(a.some(u=>u.id===o)?s&&(Lz.AVAILABLE_MODELS.includes(o)||(c=Hm)):c=Hm),F.jsx(Bz,{children:F.jsx(Fz,{initialSession:n,children:F.jsx(HM,{children:F.jsxs($z,{defaultOpen:!r,children:[F.jsx(Dz,{}),F.jsx(Tz,{style:{"--header-height":"calc(var(--spacing) * 13)"},children:F.jsx(Mz,{models:a,children:F.jsxs(jz,{defaultModel:c,children:[F.jsx(Uz,{}),e]})})})]})})})})}const Vz=await Qt("/components/settings/settings-header.tsx"),qz=Ne(Vz,"/components/settings/settings-header.tsx","SettingsHeader"),Hz=await Qt("/components/settings/settings-nav.tsx"),wS=Ne(Hz,"/components/settings/settings-nav.tsx","SettingsNav");function Kz({children:e}){return F.jsxs("div",{className:"mx-auto flex h-dvh max-h-dvh w-full max-w-4xl flex-1 flex-col px-2 py-2 md:px-4",children:[F.jsx(qz,{}),F.jsx("div",{className:"mb-4 md:hidden",children:F.jsx(wS,{orientation:"horizontal"})}),F.jsxs("div",{className:"flex min-h-0 flex-1 gap-4",children:[F.jsx("div",{className:"hidden md:block",children:F.jsx(wS,{orientation:"vertical"})}),F.jsx("div",{className:"flex min-h-0 w-full flex-1 flex-col px-4",children:e})]})]})}const Jz=await Qt("/components/login-form.tsx"),Gz=Ne(Jz,"/components/login-form.tsx","LoginForm");function vS(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function Zz(...e){return t=>{let n=!1;const i=e.map(r=>{const o=vS(r,t);return!n&&typeof o=="function"&&(n=!0),o});if(n)return()=>{for(let r=0;r<i.length;r++){const o=i[r];typeof o=="function"?o():vS(e[r],null)}}}}var Qz=Symbol.for("react.lazy"),vf=VL[" use ".trim().toString()];function Yz(e){return typeof e=="object"&&e!==null&&"then"in e}function QN(e){return e!=null&&typeof e=="object"&&"$$typeof"in e&&e.$$typeof===Qz&&"_payload"in e&&Yz(e._payload)}function Xz(e){const t=t3(e),n=fn.forwardRef((i,r)=>{let{children:o,...s}=i;QN(o)&&typeof vf=="function"&&(o=vf(o._payload));const a=fn.Children.toArray(o),c=a.find(r3);if(c){const l=c.props.children,u=a.map(p=>p===c?fn.Children.count(l)>1?fn.Children.only(null):fn.isValidElement(l)?l.props.children:null:p);return F.jsx(t,{...s,ref:r,children:fn.isValidElement(l)?fn.cloneElement(l,void 0,u):null})}return F.jsx(t,{...s,ref:r,children:o})});return n.displayName=`${e}.Slot`,n}var e3=Xz("Slot");function t3(e){const t=fn.forwardRef((n,i)=>{let{children:r,...o}=n;if(QN(r)&&typeof vf=="function"&&(r=vf(r._payload)),fn.isValidElement(r)){const s=o3(r),a=i3(o,r.props);return r.type!==fn.Fragment&&(a.ref=i?Zz(i,s):s),fn.cloneElement(r,a)}return fn.Children.count(r)>1?fn.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var n3=Symbol("radix.slottable");function r3(e){return fn.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===n3}function i3(e,t){const n={...t};for(const i in t){const r=e[i],o=t[i];/^on[A-Z]/.test(i)?r&&o?n[i]=(...a)=>{const c=o(...a);return r(...a),c}:r&&(n[i]=r):i==="style"?n[i]={...r,...o}:i==="className"&&(n[i]=[r,o].filter(Boolean).join(" "))}return{...e,...n}}function o3(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function YN(e){var t,n,i="";if(typeof e=="string"||typeof e=="number")i+=e;else if(typeof e=="object")if(Array.isArray(e)){var r=e.length;for(t=0;t<r;t++)e[t]&&(n=YN(e[t]))&&(i&&(i+=" "),i+=n)}else for(n in e)e[n]&&(i&&(i+=" "),i+=n);return i}function XN(){for(var e,t,n=0,i="",r=arguments.length;n<r;n++)(e=arguments[n])&&(t=YN(e))&&(i&&(i+=" "),i+=t);return i}const bS=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,_S=XN,s3=(e,t)=>n=>{var i;if(t?.variants==null)return _S(e,n?.class,n?.className);const{variants:r,defaultVariants:o}=t,s=Object.keys(r).map(l=>{const u=n?.[l],p=o?.[l];if(u===null)return null;const f=bS(u)||bS(p);return r[l][f]}),a=n&&Object.entries(n).reduce((l,u)=>{let[p,f]=u;return f===void 0||(l[p]=f),l},{}),c=t==null||(i=t.compoundVariants)===null||i===void 0?void 0:i.reduce((l,u)=>{let{class:p,className:f,...g}=u;return Object.entries(g).every(h=>{let[d,y]=h;return Array.isArray(y)?y.includes({...o,...a}[d]):{...o,...a}[d]===y})?[...l,p,f]:l},[]);return _S(e,s,c,n?.class,n?.className)},a3=(e,t)=>{const n=new Array(e.length+t.length);for(let i=0;i<e.length;i++)n[i]=e[i];for(let i=0;i<t.length;i++)n[e.length+i]=t[i];return n},c3=(e,t)=>({classGroupId:e,validator:t}),e$=(e=new Map,t=null,n)=>({nextPart:e,validators:t,classGroupId:n}),bf="-",SS=[],l3="arbitrary..",u3=e=>{const t=f3(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:i}=e;return{getClassGroupId:s=>{if(s.startsWith("[")&&s.endsWith("]"))return d3(s);const a=s.split(bf),c=a[0]===""&&a.length>1?1:0;return t$(a,c,t)},getConflictingClassGroupIds:(s,a)=>{if(a){const c=i[s],l=n[s];return c?l?a3(l,c):c:l||SS}return n[s]||SS}}},t$=(e,t,n)=>{if(e.length-t===0)return n.classGroupId;const r=e[t],o=n.nextPart.get(r);if(o){const l=t$(e,t+1,o);if(l)return l}const s=n.validators;if(s===null)return;const a=t===0?e.join(bf):e.slice(t).join(bf),c=s.length;for(let l=0;l<c;l++){const u=s[l];if(u.validator(a))return u.classGroupId}},d3=e=>e.slice(1,-1).indexOf(":")===-1?void 0:(()=>{const t=e.slice(1,-1),n=t.indexOf(":"),i=t.slice(0,n);return i?l3+i:void 0})(),f3=e=>{const{theme:t,classGroups:n}=e;return p3(n,t)},p3=(e,t)=>{const n=e$();for(const i in e){const r=e[i];db(r,n,i,t)}return n},db=(e,t,n,i)=>{const r=e.length;for(let o=0;o<r;o++){const s=e[o];h3(s,t,n,i)}},h3=(e,t,n,i)=>{if(typeof e=="string"){m3(e,t,n);return}if(typeof e=="function"){g3(e,t,n,i);return}y3(e,t,n,i)},m3=(e,t,n)=>{const i=e===""?t:n$(t,e);i.classGroupId=n},g3=(e,t,n,i)=>{if(w3(e)){db(e(i),t,n,i);return}t.validators===null&&(t.validators=[]),t.validators.push(c3(n,e))},y3=(e,t,n,i)=>{const r=Object.entries(e),o=r.length;for(let s=0;s<o;s++){const[a,c]=r[s];db(c,n$(t,a),n,i)}},n$=(e,t)=>{let n=e;const i=t.split(bf),r=i.length;for(let o=0;o<r;o++){const s=i[o];let a=n.nextPart.get(s);a||(a=e$(),n.nextPart.set(s,a)),n=a}return n},w3=e=>"isThemeGetter"in e&&e.isThemeGetter===!0,v3=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=Object.create(null),i=Object.create(null);const r=(o,s)=>{n[o]=s,t++,t>e&&(t=0,i=n,n=Object.create(null))};return{get(o){let s=n[o];if(s!==void 0)return s;if((s=i[o])!==void 0)return r(o,s),s},set(o,s){o in n?n[o]=s:r(o,s)}}},Hg="!",xS=":",b3=[],kS=(e,t,n,i,r)=>({modifiers:e,hasImportantModifier:t,baseClassName:n,maybePostfixModifierPosition:i,isExternal:r}),_3=e=>{const{prefix:t,experimentalParseClassName:n}=e;let i=r=>{const o=[];let s=0,a=0,c=0,l;const u=r.length;for(let d=0;d<u;d++){const y=r[d];if(s===0&&a===0){if(y===xS){o.push(r.slice(c,d)),c=d+1;continue}if(y==="/"){l=d;continue}}y==="["?s++:y==="]"?s--:y==="("?a++:y===")"&&a--}const p=o.length===0?r:r.slice(c);let f=p,g=!1;p.endsWith(Hg)?(f=p.slice(0,-1),g=!0):p.startsWith(Hg)&&(f=p.slice(1),g=!0);const h=l&&l>c?l-c:void 0;return kS(o,g,f,h)};if(t){const r=t+xS,o=i;i=s=>s.startsWith(r)?o(s.slice(r.length)):kS(b3,!1,s,void 0,!0)}if(n){const r=i;i=o=>n({className:o,parseClassName:r})}return i},S3=e=>{const t=new Map;return e.orderSensitiveModifiers.forEach((n,i)=>{t.set(n,1e6+i)}),n=>{const i=[];let r=[];for(let o=0;o<n.length;o++){const s=n[o],a=s[0]==="[",c=t.has(s);a||c?(r.length>0&&(r.sort(),i.push(...r),r=[]),i.push(s)):r.push(s)}return r.length>0&&(r.sort(),i.push(...r)),i}},x3=e=>({cache:v3(e.cacheSize),parseClassName:_3(e),sortModifiers:S3(e),...u3(e)}),k3=/\s+/,E3=(e,t)=>{const{parseClassName:n,getClassGroupId:i,getConflictingClassGroupIds:r,sortModifiers:o}=t,s=[],a=e.trim().split(k3);let c="";for(let l=a.length-1;l>=0;l-=1){const u=a[l],{isExternal:p,modifiers:f,hasImportantModifier:g,baseClassName:h,maybePostfixModifierPosition:d}=n(u);if(p){c=u+(c.length>0?" "+c:c);continue}let y=!!d,v=i(y?h.substring(0,d):h);if(!v){if(!y){c=u+(c.length>0?" "+c:c);continue}if(v=i(h),!v){c=u+(c.length>0?" "+c:c);continue}y=!1}const x=f.length===0?"":f.length===1?f[0]:o(f).join(":"),E=g?x+Hg:x,N=E+v;if(s.indexOf(N)>-1)continue;s.push(N);const C=r(v,y);for(let b=0;b<C.length;++b){const P=C[b];s.push(E+P)}c=u+(c.length>0?" "+c:c)}return c},A3=(...e)=>{let t=0,n,i,r="";for(;t<e.length;)(n=e[t++])&&(i=r$(n))&&(r&&(r+=" "),r+=i);return r},r$=e=>{if(typeof e=="string")return e;let t,n="";for(let i=0;i<e.length;i++)e[i]&&(t=r$(e[i]))&&(n&&(n+=" "),n+=t);return n},T3=(e,...t)=>{let n,i,r,o;const s=c=>{const l=t.reduce((u,p)=>p(u),e());return n=x3(l),i=n.cache.get,r=n.cache.set,o=a,a(c)},a=c=>{const l=i(c);if(l)return l;const u=E3(c,n);return r(c,u),u};return o=s,(...c)=>o(A3(...c))},I3=[],An=e=>{const t=n=>n[e]||I3;return t.isThemeGetter=!0,t},i$=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,o$=/^\((?:(\w[\w-]*):)?(.+)\)$/i,N3=/^\d+\/\d+$/,$3=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,C3=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,O3=/^(rgba?|hsla?|hwb|(ok)?(lab|lch)|color-mix)\(.+\)$/,R3=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,P3=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,ya=e=>N3.test(e),ft=e=>!!e&&!Number.isNaN(Number(e)),Co=e=>!!e&&Number.isInteger(Number(e)),Km=e=>e.endsWith("%")&&ft(e.slice(0,-1)),Gi=e=>$3.test(e),D3=()=>!0,U3=e=>C3.test(e)&&!O3.test(e),s$=()=>!1,L3=e=>R3.test(e),M3=e=>P3.test(e),j3=e=>!Ee(e)&&!Ae(e),z3=e=>gc(e,l$,s$),Ee=e=>i$.test(e),ds=e=>gc(e,u$,U3),Jm=e=>gc(e,q3,ft),ES=e=>gc(e,a$,s$),B3=e=>gc(e,c$,M3),Ed=e=>gc(e,d$,L3),Ae=e=>o$.test(e),Bc=e=>yc(e,u$),F3=e=>yc(e,H3),AS=e=>yc(e,a$),W3=e=>yc(e,l$),V3=e=>yc(e,c$),Ad=e=>yc(e,d$,!0),gc=(e,t,n)=>{const i=i$.exec(e);return i?i[1]?t(i[1]):n(i[2]):!1},yc=(e,t,n=!1)=>{const i=o$.exec(e);return i?i[1]?t(i[1]):n:!1},a$=e=>e==="position"||e==="percentage",c$=e=>e==="image"||e==="url",l$=e=>e==="length"||e==="size"||e==="bg-size",u$=e=>e==="length",q3=e=>e==="number",H3=e=>e==="family-name",d$=e=>e==="shadow",K3=()=>{const e=An("color"),t=An("font"),n=An("text"),i=An("font-weight"),r=An("tracking"),o=An("leading"),s=An("breakpoint"),a=An("container"),c=An("spacing"),l=An("radius"),u=An("shadow"),p=An("inset-shadow"),f=An("text-shadow"),g=An("drop-shadow"),h=An("blur"),d=An("perspective"),y=An("aspect"),v=An("ease"),x=An("animate"),E=()=>["auto","avoid","all","avoid-page","page","left","right","column"],N=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],C=()=>[...N(),Ae,Ee],b=()=>["auto","hidden","clip","visible","scroll"],P=()=>["auto","contain","none"],$=()=>[Ae,Ee,c],k=()=>[ya,"full","auto",...$()],D=()=>[Co,"none","subgrid",Ae,Ee],B=()=>["auto",{span:["full",Co,Ae,Ee]},Co,Ae,Ee],J=()=>[Co,"auto",Ae,Ee],S=()=>["auto","min","max","fr",Ae,Ee],T=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],z=()=>["start","end","center","stretch","center-safe","end-safe"],L=()=>["auto",...$()],q=()=>[ya,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...$()],V=()=>[e,Ae,Ee],K=()=>[...N(),AS,ES,{position:[Ae,Ee]}],oe=()=>["no-repeat",{repeat:["","x","y","space","round"]}],ne=()=>["auto","cover","contain",W3,z3,{size:[Ae,Ee]}],X=()=>[Km,Bc,ds],ae=()=>["","none","full",l,Ae,Ee],he=()=>["",ft,Bc,ds],ge=()=>["solid","dashed","dotted","double"],pe=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],fe=()=>[ft,Km,AS,ES],xe=()=>["","none",h,Ae,Ee],Ce=()=>["none",ft,Ae,Ee],Ze=()=>["none",ft,Ae,Ee],st=()=>[ft,Ae,Ee],Ke=()=>[ya,"full",...$()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[Gi],breakpoint:[Gi],color:[D3],container:[Gi],"drop-shadow":[Gi],ease:["in","out","in-out"],font:[j3],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[Gi],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[Gi],shadow:[Gi],spacing:["px",ft],text:[Gi],"text-shadow":[Gi],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",ya,Ee,Ae,y]}],container:["container"],columns:[{columns:[ft,Ee,Ae,a]}],"break-after":[{"break-after":E()}],"break-before":[{"break-before":E()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:C()}],overflow:[{overflow:b()}],"overflow-x":[{"overflow-x":b()}],"overflow-y":[{"overflow-y":b()}],overscroll:[{overscroll:P()}],"overscroll-x":[{"overscroll-x":P()}],"overscroll-y":[{"overscroll-y":P()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:k()}],"inset-x":[{"inset-x":k()}],"inset-y":[{"inset-y":k()}],start:[{start:k()}],end:[{end:k()}],top:[{top:k()}],right:[{right:k()}],bottom:[{bottom:k()}],left:[{left:k()}],visibility:["visible","invisible","collapse"],z:[{z:[Co,"auto",Ae,Ee]}],basis:[{basis:[ya,"full","auto",a,...$()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[ft,ya,"auto","initial","none",Ee]}],grow:[{grow:["",ft,Ae,Ee]}],shrink:[{shrink:["",ft,Ae,Ee]}],order:[{order:[Co,"first","last","none",Ae,Ee]}],"grid-cols":[{"grid-cols":D()}],"col-start-end":[{col:B()}],"col-start":[{"col-start":J()}],"col-end":[{"col-end":J()}],"grid-rows":[{"grid-rows":D()}],"row-start-end":[{row:B()}],"row-start":[{"row-start":J()}],"row-end":[{"row-end":J()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":S()}],"auto-rows":[{"auto-rows":S()}],gap:[{gap:$()}],"gap-x":[{"gap-x":$()}],"gap-y":[{"gap-y":$()}],"justify-content":[{justify:[...T(),"normal"]}],"justify-items":[{"justify-items":[...z(),"normal"]}],"justify-self":[{"justify-self":["auto",...z()]}],"align-content":[{content:["normal",...T()]}],"align-items":[{items:[...z(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...z(),{baseline:["","last"]}]}],"place-content":[{"place-content":T()}],"place-items":[{"place-items":[...z(),"baseline"]}],"place-self":[{"place-self":["auto",...z()]}],p:[{p:$()}],px:[{px:$()}],py:[{py:$()}],ps:[{ps:$()}],pe:[{pe:$()}],pt:[{pt:$()}],pr:[{pr:$()}],pb:[{pb:$()}],pl:[{pl:$()}],m:[{m:L()}],mx:[{mx:L()}],my:[{my:L()}],ms:[{ms:L()}],me:[{me:L()}],mt:[{mt:L()}],mr:[{mr:L()}],mb:[{mb:L()}],ml:[{ml:L()}],"space-x":[{"space-x":$()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":$()}],"space-y-reverse":["space-y-reverse"],size:[{size:q()}],w:[{w:[a,"screen",...q()]}],"min-w":[{"min-w":[a,"screen","none",...q()]}],"max-w":[{"max-w":[a,"screen","none","prose",{screen:[s]},...q()]}],h:[{h:["screen","lh",...q()]}],"min-h":[{"min-h":["screen","lh","none",...q()]}],"max-h":[{"max-h":["screen","lh",...q()]}],"font-size":[{text:["base",n,Bc,ds]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[i,Ae,Jm]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",Km,Ee]}],"font-family":[{font:[F3,Ee,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[r,Ae,Ee]}],"line-clamp":[{"line-clamp":[ft,"none",Ae,Jm]}],leading:[{leading:[o,...$()]}],"list-image":[{"list-image":["none",Ae,Ee]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Ae,Ee]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:V()}],"text-color":[{text:V()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ge(),"wavy"]}],"text-decoration-thickness":[{decoration:[ft,"from-font","auto",Ae,ds]}],"text-decoration-color":[{decoration:V()}],"underline-offset":[{"underline-offset":[ft,"auto",Ae,Ee]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:$()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Ae,Ee]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Ae,Ee]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:K()}],"bg-repeat":[{bg:oe()}],"bg-size":[{bg:ne()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},Co,Ae,Ee],radial:["",Ae,Ee],conic:[Co,Ae,Ee]},V3,B3]}],"bg-color":[{bg:V()}],"gradient-from-pos":[{from:X()}],"gradient-via-pos":[{via:X()}],"gradient-to-pos":[{to:X()}],"gradient-from":[{from:V()}],"gradient-via":[{via:V()}],"gradient-to":[{to:V()}],rounded:[{rounded:ae()}],"rounded-s":[{"rounded-s":ae()}],"rounded-e":[{"rounded-e":ae()}],"rounded-t":[{"rounded-t":ae()}],"rounded-r":[{"rounded-r":ae()}],"rounded-b":[{"rounded-b":ae()}],"rounded-l":[{"rounded-l":ae()}],"rounded-ss":[{"rounded-ss":ae()}],"rounded-se":[{"rounded-se":ae()}],"rounded-ee":[{"rounded-ee":ae()}],"rounded-es":[{"rounded-es":ae()}],"rounded-tl":[{"rounded-tl":ae()}],"rounded-tr":[{"rounded-tr":ae()}],"rounded-br":[{"rounded-br":ae()}],"rounded-bl":[{"rounded-bl":ae()}],"border-w":[{border:he()}],"border-w-x":[{"border-x":he()}],"border-w-y":[{"border-y":he()}],"border-w-s":[{"border-s":he()}],"border-w-e":[{"border-e":he()}],"border-w-t":[{"border-t":he()}],"border-w-r":[{"border-r":he()}],"border-w-b":[{"border-b":he()}],"border-w-l":[{"border-l":he()}],"divide-x":[{"divide-x":he()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":he()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...ge(),"hidden","none"]}],"divide-style":[{divide:[...ge(),"hidden","none"]}],"border-color":[{border:V()}],"border-color-x":[{"border-x":V()}],"border-color-y":[{"border-y":V()}],"border-color-s":[{"border-s":V()}],"border-color-e":[{"border-e":V()}],"border-color-t":[{"border-t":V()}],"border-color-r":[{"border-r":V()}],"border-color-b":[{"border-b":V()}],"border-color-l":[{"border-l":V()}],"divide-color":[{divide:V()}],"outline-style":[{outline:[...ge(),"none","hidden"]}],"outline-offset":[{"outline-offset":[ft,Ae,Ee]}],"outline-w":[{outline:["",ft,Bc,ds]}],"outline-color":[{outline:V()}],shadow:[{shadow:["","none",u,Ad,Ed]}],"shadow-color":[{shadow:V()}],"inset-shadow":[{"inset-shadow":["none",p,Ad,Ed]}],"inset-shadow-color":[{"inset-shadow":V()}],"ring-w":[{ring:he()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:V()}],"ring-offset-w":[{"ring-offset":[ft,ds]}],"ring-offset-color":[{"ring-offset":V()}],"inset-ring-w":[{"inset-ring":he()}],"inset-ring-color":[{"inset-ring":V()}],"text-shadow":[{"text-shadow":["none",f,Ad,Ed]}],"text-shadow-color":[{"text-shadow":V()}],opacity:[{opacity:[ft,Ae,Ee]}],"mix-blend":[{"mix-blend":[...pe(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":pe()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[ft]}],"mask-image-linear-from-pos":[{"mask-linear-from":fe()}],"mask-image-linear-to-pos":[{"mask-linear-to":fe()}],"mask-image-linear-from-color":[{"mask-linear-from":V()}],"mask-image-linear-to-color":[{"mask-linear-to":V()}],"mask-image-t-from-pos":[{"mask-t-from":fe()}],"mask-image-t-to-pos":[{"mask-t-to":fe()}],"mask-image-t-from-color":[{"mask-t-from":V()}],"mask-image-t-to-color":[{"mask-t-to":V()}],"mask-image-r-from-pos":[{"mask-r-from":fe()}],"mask-image-r-to-pos":[{"mask-r-to":fe()}],"mask-image-r-from-color":[{"mask-r-from":V()}],"mask-image-r-to-color":[{"mask-r-to":V()}],"mask-image-b-from-pos":[{"mask-b-from":fe()}],"mask-image-b-to-pos":[{"mask-b-to":fe()}],"mask-image-b-from-color":[{"mask-b-from":V()}],"mask-image-b-to-color":[{"mask-b-to":V()}],"mask-image-l-from-pos":[{"mask-l-from":fe()}],"mask-image-l-to-pos":[{"mask-l-to":fe()}],"mask-image-l-from-color":[{"mask-l-from":V()}],"mask-image-l-to-color":[{"mask-l-to":V()}],"mask-image-x-from-pos":[{"mask-x-from":fe()}],"mask-image-x-to-pos":[{"mask-x-to":fe()}],"mask-image-x-from-color":[{"mask-x-from":V()}],"mask-image-x-to-color":[{"mask-x-to":V()}],"mask-image-y-from-pos":[{"mask-y-from":fe()}],"mask-image-y-to-pos":[{"mask-y-to":fe()}],"mask-image-y-from-color":[{"mask-y-from":V()}],"mask-image-y-to-color":[{"mask-y-to":V()}],"mask-image-radial":[{"mask-radial":[Ae,Ee]}],"mask-image-radial-from-pos":[{"mask-radial-from":fe()}],"mask-image-radial-to-pos":[{"mask-radial-to":fe()}],"mask-image-radial-from-color":[{"mask-radial-from":V()}],"mask-image-radial-to-color":[{"mask-radial-to":V()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":N()}],"mask-image-conic-pos":[{"mask-conic":[ft]}],"mask-image-conic-from-pos":[{"mask-conic-from":fe()}],"mask-image-conic-to-pos":[{"mask-conic-to":fe()}],"mask-image-conic-from-color":[{"mask-conic-from":V()}],"mask-image-conic-to-color":[{"mask-conic-to":V()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:K()}],"mask-repeat":[{mask:oe()}],"mask-size":[{mask:ne()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",Ae,Ee]}],filter:[{filter:["","none",Ae,Ee]}],blur:[{blur:xe()}],brightness:[{brightness:[ft,Ae,Ee]}],contrast:[{contrast:[ft,Ae,Ee]}],"drop-shadow":[{"drop-shadow":["","none",g,Ad,Ed]}],"drop-shadow-color":[{"drop-shadow":V()}],grayscale:[{grayscale:["",ft,Ae,Ee]}],"hue-rotate":[{"hue-rotate":[ft,Ae,Ee]}],invert:[{invert:["",ft,Ae,Ee]}],saturate:[{saturate:[ft,Ae,Ee]}],sepia:[{sepia:["",ft,Ae,Ee]}],"backdrop-filter":[{"backdrop-filter":["","none",Ae,Ee]}],"backdrop-blur":[{"backdrop-blur":xe()}],"backdrop-brightness":[{"backdrop-brightness":[ft,Ae,Ee]}],"backdrop-contrast":[{"backdrop-contrast":[ft,Ae,Ee]}],"backdrop-grayscale":[{"backdrop-grayscale":["",ft,Ae,Ee]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[ft,Ae,Ee]}],"backdrop-invert":[{"backdrop-invert":["",ft,Ae,Ee]}],"backdrop-opacity":[{"backdrop-opacity":[ft,Ae,Ee]}],"backdrop-saturate":[{"backdrop-saturate":[ft,Ae,Ee]}],"backdrop-sepia":[{"backdrop-sepia":["",ft,Ae,Ee]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":$()}],"border-spacing-x":[{"border-spacing-x":$()}],"border-spacing-y":[{"border-spacing-y":$()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Ae,Ee]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[ft,"initial",Ae,Ee]}],ease:[{ease:["linear","initial",v,Ae,Ee]}],delay:[{delay:[ft,Ae,Ee]}],animate:[{animate:["none",x,Ae,Ee]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[d,Ae,Ee]}],"perspective-origin":[{"perspective-origin":C()}],rotate:[{rotate:Ce()}],"rotate-x":[{"rotate-x":Ce()}],"rotate-y":[{"rotate-y":Ce()}],"rotate-z":[{"rotate-z":Ce()}],scale:[{scale:Ze()}],"scale-x":[{"scale-x":Ze()}],"scale-y":[{"scale-y":Ze()}],"scale-z":[{"scale-z":Ze()}],"scale-3d":["scale-3d"],skew:[{skew:st()}],"skew-x":[{"skew-x":st()}],"skew-y":[{"skew-y":st()}],transform:[{transform:[Ae,Ee,"","none","gpu","cpu"]}],"transform-origin":[{origin:C()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:Ke()}],"translate-x":[{"translate-x":Ke()}],"translate-y":[{"translate-y":Ke()}],"translate-z":[{"translate-z":Ke()}],"translate-none":["translate-none"],accent:[{accent:V()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:V()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Ae,Ee]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":$()}],"scroll-mx":[{"scroll-mx":$()}],"scroll-my":[{"scroll-my":$()}],"scroll-ms":[{"scroll-ms":$()}],"scroll-me":[{"scroll-me":$()}],"scroll-mt":[{"scroll-mt":$()}],"scroll-mr":[{"scroll-mr":$()}],"scroll-mb":[{"scroll-mb":$()}],"scroll-ml":[{"scroll-ml":$()}],"scroll-p":[{"scroll-p":$()}],"scroll-px":[{"scroll-px":$()}],"scroll-py":[{"scroll-py":$()}],"scroll-ps":[{"scroll-ps":$()}],"scroll-pe":[{"scroll-pe":$()}],"scroll-pt":[{"scroll-pt":$()}],"scroll-pr":[{"scroll-pr":$()}],"scroll-pb":[{"scroll-pb":$()}],"scroll-pl":[{"scroll-pl":$()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Ae,Ee]}],fill:[{fill:["none",...V()]}],"stroke-w":[{stroke:[ft,Bc,ds,Jm]}],stroke:[{stroke:["none",...V()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},J3=T3(K3),Fn=[];for(let e=0;e<256;++e)Fn.push((e+256).toString(16).slice(1));function G3(e,t=0){return(Fn[e[t+0]]+Fn[e[t+1]]+Fn[e[t+2]]+Fn[e[t+3]]+"-"+Fn[e[t+4]]+Fn[e[t+5]]+"-"+Fn[e[t+6]]+Fn[e[t+7]]+"-"+Fn[e[t+8]]+Fn[e[t+9]]+"-"+Fn[e[t+10]]+Fn[e[t+11]]+Fn[e[t+12]]+Fn[e[t+13]]+Fn[e[t+14]]+Fn[e[t+15]]).toLowerCase()}const jd=new Uint8Array(256);let Td=jd.length;function Z3(){return Td>jd.length-16&&($D(jd),Td=0),jd.slice(Td,Td+=16)}const Gm={};function Q3(e,t,n){let i;{const r=Date.now(),o=Z3();Y3(Gm,r,o),i=X3(o,Gm.msecs,Gm.seq,t,n)}return t??G3(i)}function Y3(e,t,n){return e.msecs??=-1/0,e.seq??=0,t>e.msecs?(e.seq=n[6]<<23|n[7]<<16|n[8]<<8|n[9],e.msecs=t):(e.seq=e.seq+1|0,e.seq===0&&e.msecs++),e}function X3(e,t,n,i,r=0){if(e.length<16)throw new Error("Random bytes length must be >= 16");if(!i)i=new Uint8Array(16),r=0;else if(r<0||r+16>i.length)throw new RangeError(`UUID byte range ${r}:${r+15} is out of buffer bounds`);return t??=Date.now(),n??=e[6]*127<<24|e[7]<<16|e[8]<<8|e[9],i[r++]=t/1099511627776&255,i[r++]=t/4294967296&255,i[r++]=t/16777216&255,i[r++]=t/65536&255,i[r++]=t/256&255,i[r++]=t&255,i[r++]=112|n>>>28&15,i[r++]=n>>>20&255,i[r++]=128|n>>>14&63,i[r++]=n>>>6&255,i[r++]=n<<2&255|e[10]&3,i[r++]=e[11],i[r++]=e[12],i[r++]=e[13],i[r++]=e[14],i[r++]=e[15],i}function fb(...e){return J3(XN(e))}function cie(){return Q3()}const pb=s3("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9","icon-sm":"size-8","icon-lg":"size-10"}},defaultVariants:{variant:"default",size:"default"}});function eB({className:e,variant:t,size:n,asChild:i=!1,...r}){const o=i?e3:"button";return F.jsx(o,{"data-slot":"button",className:fb(pb({variant:t,size:n,className:e})),...r})}function tB(){return F.jsxs(F.Fragment,{children:[F.jsx("title",{children:"Login"}),F.jsx("meta",{content:"Login to your account",name:"description"}),F.jsxs("div",{className:"container mx-auto flex h-dvh w-screen flex-col items-center justify-center",children:[F.jsxs(lb,{className:fb(pb({variant:"ghost"}),"absolute top-4 left-4 md:top-8 md:left-8"),href:"/",children:[F.jsx(uz,{className:"mr-2 h-4 w-4"}),"Back"]}),F.jsx("div",{className:"mx-auto flex w-full flex-col items-center justify-center sm:w-[420px]",children:F.jsx(Gz,{className:"w-full"})})]})]})}function nB(){return F.jsxs("main",{className:"prose dark:prose-invert container mx-auto max-w-3xl py-10",children:[F.jsx("h1",{children:ke.policies.privacy.title}),ke.policies.privacy.lastUpdated?F.jsxs("p",{children:[F.jsx("strong",{children:"Last updated:"})," ",ke.policies.privacy.lastUpdated]}):null,F.jsxs("p",{children:["At ",ke.organization.name,", we respect your privacy and are committed to protecting your personal data. This Privacy Policy explains how we collect, use, and safeguard your information when you use our service."]}),F.jsx("h2",{children:"Information We Collect"}),F.jsx("p",{children:"We may collect the following types of information:"}),F.jsxs("ul",{children:[F.jsxs("li",{children:[F.jsx("strong",{children:"Search Queries"}),": The questions and searches you submit to our service."]}),F.jsxs("li",{children:[F.jsx("strong",{children:"Usage Data"}),": Information about how you interact with our service, including features used and time spent on the platform."]}),F.jsxs("li",{children:[F.jsx("strong",{children:"Device Information"}),": Information about your device, browser type, IP address, and operating system."]}),F.jsxs("li",{children:[F.jsx("strong",{children:"Account Information"}),": Email address and profile information when you create an account."]}),F.jsxs("li",{children:[F.jsx("strong",{children:"Subscription Data"}),": Information about your subscription status and billing history (but not payment details)."]}),F.jsxs("li",{children:[F.jsx("strong",{children:"Cookies and Similar Technologies"}),": We use cookies and similar tracking technologies to enhance your experience and collect usage information."]})]}),F.jsxs("p",{children:[F.jsx("strong",{children:"Important Note on Payment Data"}),":"," ",ke.organization.name," does not collect, store, or process any payment card details, bank information, or other sensitive payment data. All payment information is handled directly by our payment processors (",ke.services.paymentProcessors.join(", "),") and is subject to their respective privacy policies and security standards."]}),F.jsx("h2",{children:"How We Use Your Information"}),F.jsxs("ul",{children:[F.jsx("li",{children:"To provide and improve our service"}),F.jsx("li",{children:"To understand how users interact with our platform"}),F.jsx("li",{children:"To personalize and enhance your experience"}),F.jsx("li",{children:"To monitor and analyze usage patterns and trends"}),F.jsx("li",{children:"To detect, prevent, and address technical issues"})]}),F.jsx("h2",{children:"Data Sharing and Disclosure"}),F.jsx("p",{children:"We may share your information in the following circumstances:"}),F.jsxs("ul",{children:[F.jsxs("li",{children:[F.jsx("strong",{children:"Service Providers"}),": With third-party service providers who help us operate, improve, and analyze our service."]}),F.jsxs("li",{children:[F.jsx("strong",{children:"Hosting"}),": ",ke.services.hosting," hosts our infrastructure."]}),F.jsxs("li",{children:[F.jsx("strong",{children:"AI Processing Partners"}),": We utilize services from companies including ",ke.services.aiProviders.join(", ")," to process queries and provide results."]}),F.jsxs("li",{children:[F.jsx("strong",{children:"Payment Processors"}),": We use"," ",ke.services.paymentProcessors.join(", ")," to process payments and manage subscriptions. These providers handle all payment data directly and have their own privacy policies governing payment information."]}),F.jsxs("li",{children:[F.jsx("strong",{children:"Compliance with Laws"}),": When required by applicable law, regulation, legal process, or governmental request."]}),F.jsxs("li",{children:[F.jsx("strong",{children:"Business Transfers"}),": In connection with a merger, acquisition, or sale of assets."]})]}),F.jsxs("p",{children:[F.jsx("strong",{children:"Payment Data"}),": When you make a payment, your payment information is transmitted directly to our payment processors and is not stored on our servers. We only receive confirmation of successful payments and subscription status updates."]}),F.jsx("h2",{children:"Data Security"}),F.jsx("p",{children:"We implement appropriate technical and organizational measures to protect your personal information. However, no method of transmission over the Internet or electronic storage is 100% secure, and we cannot guarantee absolute security."}),F.jsx("h2",{children:"Your Rights"}),F.jsx("p",{children:"Depending on your location, you may have the right to:"}),F.jsxs("ul",{children:[F.jsx("li",{children:"Access the personal information we hold about you"}),F.jsx("li",{children:"Request correction or deletion of your personal information"}),F.jsx("li",{children:"Object to or restrict certain processing activities"}),F.jsx("li",{children:"Data portability"}),F.jsx("li",{children:"Withdraw consent where applicable"})]}),F.jsx("h2",{children:"Children's Privacy"}),F.jsxs("p",{children:["Our service is not directed to children under the age of",` ${ke.legal.minimumAge}`,". We do not knowingly collect personal information from children under",` ${ke.legal.minimumAge}`,". If you are a parent or guardian and believe your child has provided us with personal information, please contact us."]}),F.jsx("h2",{children:"Changes to This Privacy Policy"}),F.jsx("p",{children:'We may update our Privacy Policy from time to time. We will notify you of any changes by posting the new Privacy Policy on this page and updating the "Last updated" date.'}),F.jsx("h2",{children:"Contact Us"}),F.jsxs("p",{children:["If you have any questions about this Privacy Policy, please contact us at: ",ke.organization.contact.privacyEmail]}),F.jsxs("p",{children:["By using ",ke.appName,", you agree to our Privacy Policy and our Terms of Service."]})]})}function rB(){return F.jsxs(F.Fragment,{children:[F.jsx("title",{children:"Privacy Policy"}),F.jsx(nB,{})]})}const iB=await Qt("/app/(chat)/project/[projectId]/project-page.tsx"),oB=Ne(iB,"/app/(chat)/project/[projectId]/project-page.tsx","ProjectPage");function sB({projectId:e}){return F.jsxs(F.Fragment,{children:[F.jsx("title",{children:"Project"}),F.jsx(fn.Suspense,{children:F.jsx(oB,{projectId:e})})]})}const aB=await Qt("/app/(chat)/project/[projectId]/chat/[chatId]/project-chat-page.tsx"),cB=Ne(aB,"/app/(chat)/project/[projectId]/chat/[chatId]/project-chat-page.tsx","ProjectChatPage");function lB({projectId:e}){return F.jsxs(F.Fragment,{children:[F.jsx("title",{children:"Project Chat"}),F.jsx(fn.Suspense,{children:F.jsx(cB,{projectId:e})})]})}const uB=await Qt("/components/signup-form.tsx"),dB=Ne(uB,"/components/signup-form.tsx","SignupForm");function fB(){return F.jsxs(F.Fragment,{children:[F.jsx("title",{children:"Create an account"}),F.jsx("meta",{content:"Create an account to get started.",name:"description"}),F.jsxs("div",{className:"container m-auto flex h-dvh w-screen flex-col items-center justify-center px-4",children:[F.jsx(lb,{className:fb(pb({variant:"ghost"}),"absolute top-4 right-4 md:top-8 md:right-8"),href:"/login",children:"Login"}),F.jsx("div",{className:"mx-auto w-full sm:w-[480px]",children:F.jsx(dB,{})})]})]})}function pB(){return F.jsx("div",{className:"space-y-6",children:F.jsxs("div",{children:[F.jsx("h2",{className:"font-semibold text-lg",children:"General"}),F.jsx("p",{className:"text-muted-foreground text-sm",children:"General settings will be available here soon."})]})})}function hB(){return F.jsxs(F.Fragment,{children:[F.jsx("title",{children:"Settings"}),F.jsx(pB,{})]})}const mB=await Qt("/components/settings/mcp-details-page.tsx"),gB=Ne(mB,"/components/settings/mcp-details-page.tsx","McpDetailsPage"),vh=await Qt("/components/settings/settings-page.tsx"),hb=Ne(vh,"/components/settings/settings-page.tsx","SettingsPage"),mb=Ne(vh,"/components/settings/settings-page.tsx","SettingsPageHeader");Ne(vh,"/components/settings/settings-page.tsx","SettingsPageContent");Ne(vh,"/components/settings/settings-page.tsx","SettingsPageScrollArea");function yB({connectorId:e}){return F.jsxs(F.Fragment,{children:[F.jsx("title",{children:"Settings  Connector"}),F.jsxs(hb,{children:[F.jsxs(mb,{children:[F.jsx("h2",{className:"font-semibold text-lg",children:"Connector details"}),F.jsx("p",{className:"text-muted-foreground text-sm",children:"Tools, resources, and authorization status."})]}),F.jsx(gB,{connectorId:e})]})]})}const wB=await Qt("/components/settings/connectors-settings.tsx"),vB=Ne(wB,"/components/settings/connectors-settings.tsx","ConnectorsSettings");function bB(){return F.jsxs(hb,{children:[F.jsxs(mb,{children:[F.jsx("h2",{className:"font-semibold text-lg",children:"Connectors & MCP"}),F.jsx("p",{className:"text-muted-foreground text-sm",children:"Connect to Model Context Protocol servers to extend AI capabilities with external tools."})]}),F.jsx(vB,{})]})}function _B(){return F.jsxs(F.Fragment,{children:[F.jsx("title",{children:"Settings  Connectors"}),F.jsx(bB,{})]})}const SB=await Qt("/components/settings/models-settings.tsx"),xB=Ne(SB,"/components/settings/models-settings.tsx","ModelsSettings");function kB(){return F.jsxs(hb,{children:[F.jsxs(mb,{className:"flex flex-col gap-3 sm:flex-row sm:items-start sm:justify-between",children:[F.jsxs("div",{children:[F.jsx("h2",{className:"font-semibold text-lg",children:"Models"}),F.jsx("p",{className:"text-muted-foreground text-sm",children:"Configure your AI model preferences."})]}),F.jsx(eB,{asChild:!0,className:"w-full max-w-[300px] sm:w-auto",size:"sm",variant:"outline",children:F.jsxs("a",{href:"https://airegistry.app",rel:"noopener noreferrer",target:"_blank",children:[F.jsx(hz,{className:"size-4"}),F.jsx("span",{children:"Models Registry"})]})})]}),F.jsx(xB,{})]})}function EB(){return F.jsxs(F.Fragment,{children:[F.jsx("title",{children:"Settings  Models"}),F.jsx(kB,{})]})}const AB=await Qt("/app/(chat)/share/[id]/shared-chat-page.tsx"),TB=Ne(AB,"/app/(chat)/share/[id]/shared-chat-page.tsx","SharedChatPage");function IB({id:e}){return F.jsxs(F.Fragment,{children:[F.jsx("title",{children:"Shared Chat"}),F.jsx(TB,{id:e})]})}function NB({hasFree:e,hasPro:t}){return e&&t?"free and paid":t?"paid":"free"}function $B({hasAnyPlan:e,planTypesLabel:t,hasFree:n,hasPro:i,currencySymbol:r,paymentProcessors:o}){return e?F.jsxs(F.Fragment,{children:[F.jsxs("p",{children:[ke.appName," offers ",t," subscription plans."]}),F.jsxs("ul",{children:[n&&F.jsxs("li",{children:[F.jsxs("strong",{children:[ke.pricing?.free?.name,":"]})," ",ke.pricing?.free?.summary]}),i&&F.jsxs("li",{children:[F.jsxs("strong",{children:[ke.pricing?.pro?.name,":"]})," ",r,ke.pricing?.pro?.monthlyPrice,"/month "," ",ke.pricing?.pro?.summary]})]}),o.length>0&&F.jsxs("p",{children:["We use third-party payment processors to handle billing and payments:"," ",o.join(", "),". ",ke.appName," does not store any payment card details, bank information, or other sensitive payment data. All payment information is processed directly by our providers."]}),i&&F.jsxs("ul",{children:[F.jsx("li",{children:"Billing is monthly and charged automatically"}),F.jsx("li",{children:"All fees are non-refundable except as expressly stated"}),F.jsx("li",{children:"We may change prices with 30 days notice"}),F.jsx("li",{children:"You are responsible for applicable taxes"}),F.jsx("li",{children:"Failed payments may result in suspension or termination"})]})]}):F.jsxs(F.Fragment,{children:[F.jsxs("p",{children:[ke.appName," currently does not offer paid plans. If we introduce paid features in the future, this section will be updated and you will be notified in advance."]}),o.length>0&&F.jsxs("p",{children:["When payments are enabled, billing will be processed by"," ",o.join(", "),". We will not store payment card details; payment data will be handled directly by our providers according to their policies and security standards."]})]})}function CB(){const e={USD:"$",EUR:"",GBP:""},t=ke.pricing?.currency,n=t?e[t]??t:"",i=!!ke.pricing?.free,r=!!ke.pricing?.pro,o=i||r,s=Array.isArray(ke.services?.paymentProcessors)?ke.services.paymentProcessors:[],a=NB({hasFree:i,hasPro:r});return F.jsxs("main",{className:"prose dark:prose-invert container mx-auto max-w-3xl py-10",children:[F.jsx("h1",{children:ke.policies.terms.title}),ke.policies.terms.lastUpdated?F.jsxs("p",{children:[F.jsx("strong",{children:"Last updated:"})," ",ke.policies.terms.lastUpdated]}):null,F.jsxs("p",{children:["Welcome to ",ke.appName,". These Terms of Service govern your use of our website and services. By using ",ke.appName,", you agree to these terms in full. If you disagree with any part of these terms, please do not use our service."]}),F.jsx("h2",{children:"1. Acceptance of Terms"}),F.jsxs("p",{children:["By accessing or using ",ke.appName,", you acknowledge that you have read, understood, and agree to be bound by these Terms of Service. We reserve the right to modify these terms at any time, and such modifications shall be effective immediately upon posting. Your continued use of ",ke.appName," after any modifications indicates your acceptance of the modified terms."]}),F.jsx("h2",{children:"2. Description of Service"}),F.jsxs("p",{children:[ke.appName," helps users find information using AI. Our service is hosted on ",ke.services.hosting," and integrates with AI technology providers including ",ke.services.aiProviders.join(", ")," to deliver results and content generation capabilities."]}),F.jsx("h2",{children:"3. User Conduct"}),F.jsxs("ul",{children:[F.jsx("li",{children:"Comply with applicable laws and regulations"}),F.jsx("li",{children:"Respect intellectual property rights"}),F.jsx("li",{children:"Do not distribute malware or harmful code"}),F.jsx("li",{children:"Do not attempt unauthorized access to our systems"}),F.jsx("li",{children:"Do not scrape or conduct automated queries"}),F.jsx("li",{children:"Do not generate or distribute illegal or harmful content"}),F.jsx("li",{children:"Do not interfere with the proper functioning of the service"})]}),F.jsx("h2",{children:"4. Content and Results"}),F.jsxs("ul",{children:[F.jsx("li",{children:"No guarantees on accuracy, completeness, or reliability of results"}),F.jsx("li",{children:"Generated content is based on your queries"}),F.jsx("li",{children:"We may link to third-party websites that we do not control; use your own judgment"})]}),F.jsx("h2",{children:"5. Intellectual Property"}),F.jsxs("p",{children:["All content, features, and functionality of ",ke.appName," are the property of ",ke.organization.name," or its licensors and are protected by intellectual property laws."]}),F.jsx("h2",{children:"6. Third-Party Services"}),F.jsxs("p",{children:[ke.appName," relies on third-party services to provide functionality:"]}),F.jsxs("ul",{children:[F.jsxs("li",{children:["Hosting: ",ke.services.hosting]}),F.jsxs("li",{children:["AI providers: ",ke.services.aiProviders.join(", ")]}),ke.services.paymentProcessors.length>0?F.jsxs("li",{children:["Payments: ",ke.services.paymentProcessors.join(", ")," for billing and subscription management"]}):null]}),F.jsx("p",{children:"These third-party services have their own terms and privacy policies and may process your data as described in our Privacy Policy. Payment data is processed directly by our payment providers according to their respective privacy policies and security standards."}),F.jsx("h2",{children:"7. Pricing and Billing"}),F.jsx($B,{currencySymbol:n,hasAnyPlan:o,hasFree:i,hasPro:r,paymentProcessors:s,planTypesLabel:a}),F.jsx("h2",{children:"8. Cancellation and Refunds"}),F.jsx("p",{children:"You may cancel your subscription at any time through your account settings or by contacting us. Upon cancellation, your subscription remains active until the end of the billing period, after which your account reverts to the free plan."}),F.jsxs("p",{children:[F.jsx("strong",{children:"No Refund Policy"}),": All subscription fees are final and non-refundable."]}),F.jsx("h2",{children:"9. Privacy"}),F.jsxs("p",{children:["Your use of ",ke.appName," is also governed by our Privacy Policy, which is incorporated by reference."]}),F.jsx("h2",{children:"10. Limitation of Liability"}),F.jsxs("p",{children:["To the maximum extent permitted by law, ",ke.organization.name," shall not be liable for indirect, incidental, special, consequential, or punitive damages."]}),F.jsx("h2",{children:"11. Disclaimers"}),F.jsxs("p",{children:[ke.appName,' is provided "as is" and "as available" without any warranties of any kind, either express or implied.']}),F.jsx("h2",{children:"12. Termination"}),F.jsx("p",{children:"We may suspend or terminate your access for conduct that violates these Terms or is harmful to others, us, or third parties."}),F.jsx("h2",{children:"13. Governing Law"}),F.jsxs("p",{children:["These Terms are governed by the laws of ",ke.legal.governingLaw,"."]}),F.jsx("h2",{children:"14. Contact Us"}),F.jsxs("p",{children:["If you have any questions about these Terms of Service, contact us at"," ",ke.organization.contact.legalEmail]}),F.jsxs("p",{children:["By using ",ke.appName,", you agree to these Terms of Service and our Privacy Policy."]})]})}function OB(){return F.jsxs(F.Fragment,{children:[F.jsx("title",{children:"Terms of Service"}),F.jsx(CB,{})]})}const TS="events",IS="meta",Zm=600*1e3,NS={"Content-Type":"text/event-stream","Cache-Control":"no-cache",Connection:"keep-alive"};function RB(e){return typeof e=="object"&&e!==null&&"id"in e&&"block"in e&&typeof e.id=="string"&&e.id.length>0&&typeof e.block=="string"&&e.block.length>0}let PB=class{state;listeners=new Set;constructor(t){this.state=t}async fetch(t){const{pathname:n}=new URL(t.url);try{return t.method==="POST"&&n==="/append"?await this.handleAppend(t):t.method==="POST"&&n==="/finalize"?await this.handleFinalize():t.method==="GET"&&n==="/resume"?await this.handleResume(t):new Response("Not Found",{status:404})}catch(i){return console.error("[TRACE] StreamBufferDO request failed",{pathname:n,error:i}),new Response("Internal Server Error",{status:500})}}async alarm(){const t=await this.getMeta();if(t){if(t.expiresAt>Date.now()){await this.state.storage.setAlarm(t.expiresAt);return}await this.state.storage.deleteAll(),await this.closeAllListeners()}}async handleAppend(t){const n=await this.parseAppendPayload(t);if(!n)return new Response("Invalid append payload",{status:400});const i=Date.now(),r=await this.state.blockConcurrencyWhile(async()=>{const[s,a]=await this.readState();if(a.finalized)return{status:409,message:"Stream already finalized",events:s,meta:a};const c=new Set(s.map(f=>f.id)),l=Date.now(),u=[...s];for(const f of n.events)c.has(f.id)||(c.add(f.id),u.push({id:f.id,block:f.block,createdAt:l}));const p={finalized:!1,expiresAt:l+Zm,updatedAt:l};return await this.writeState(u,p),{status:200,message:"ok",events:u,meta:p}});await this.flushListeners(r.events,r.meta.finalized);const o=Date.now()-i;return o>80&&console.warn("[TRACE] StreamBufferDO append slow",{elapsed:o,eventCount:r.events.length}),Response.json({ok:r.status===200,message:r.message},{status:r.status})}async handleFinalize(){const t=Date.now(),n=await this.state.blockConcurrencyWhile(async()=>{const[r,o]=await this.readState();if(o.finalized)return{events:r,meta:o};const s=Date.now(),a={finalized:!0,expiresAt:s+Zm,updatedAt:s};return await this.writeState(r,a),{events:r,meta:a}});await this.flushListeners(n.events,n.meta.finalized);const i=Date.now()-t;return i>80&&console.warn("[TRACE] StreamBufferDO finalize slow",{elapsed:i}),Response.json({ok:!0})}async handleResume(t){const n=t.headers.get("Last-Event-ID"),[i,r]=await this.readState(),o=this.resolveResumeCursor(i,n),s=new TransformStream,c={writer:s.writable.getWriter(),cursor:o};for(let l=c.cursor;l<i.length;l++)await c.writer.write(i[l].block),c.cursor=l+1;return r.finalized?(await c.writer.close(),new Response(s.readable.pipeThrough(new TextEncoderStream),{headers:NS})):(this.listeners.add(c),t.signal.addEventListener("abort",()=>{this.removeListener(c,!0).catch(()=>{})},{once:!0}),new Response(s.readable.pipeThrough(new TextEncoderStream),{headers:NS}))}async readState(){const t=await this.state.storage.get(TS),n=await this.getMeta(),i=Date.now(),r=t??[],o=n??{finalized:!1,expiresAt:i+Zm,updatedAt:i};return[r,o]}async writeState(t,n){await this.state.storage.put(TS,t),await this.state.storage.put(IS,n),await this.state.storage.setAlarm(n.expiresAt)}async getMeta(){return await this.state.storage.get(IS)??null}resolveResumeCursor(t,n){if(!n)return 0;const i=t.findIndex(r=>r.id===n);return i<0?0:i+1}async parseAppendPayload(t){const n=await t.json().catch(()=>null);if(!n||typeof n!="object"||!("events"in n))return null;const i=n.events;if(!Array.isArray(i))return null;const r=i.filter(RB);return r.length===0?null:{events:r}}async flushListeners(t,n){for(const i of[...this.listeners])try{for(let r=i.cursor;r<t.length;r++)await i.writer.write(t[r].block),i.cursor=r+1;n&&await this.removeListener(i,!0)}catch(r){console.error("[TRACE] StreamBufferDO listener write failed",{error:r}),await this.removeListener(i,!1)}}async removeListener(t,n){this.listeners.has(t)&&(this.listeners.delete(t),n&&await t.writer.close().catch(()=>{}))}async closeAllListeners(){for(const t of[...this.listeners])await this.removeListener(t,!0)}};function $S(e){switch(e){case"a-z":return"abcdefghijklmnopqrstuvwxyz";case"A-Z":return"ABCDEFGHIJKLMNOPQRSTUVWXYZ";case"0-9":return"0123456789";case"-_":return"-_";default:throw new Error(`Unsupported alphabet: ${e}`)}}function gb(...e){const t=e.map($S).join("");if(t.length===0)throw new Error("No valid characters provided for random string generation.");const n=t.length;return(i,...r)=>{if(i<=0)throw new Error("Length must be a positive integer.");let o=t,s=n;r.length>0&&(o=r.map($S).join(""),s=o.length);const a=Math.floor(256/s)*s,c=new Uint8Array(i*2),l=c.length;let u="",p=l,f;for(;u.length<i;)p>=l&&(crypto.getRandomValues(c),p=0),f=c[p++],f<a&&(u+=o[f%s]);return u}}const yb=gb("a-z","0-9","A-Z","-_");function DB(e,t){typeof e=="string"&&(e=new TextEncoder().encode(e)),typeof t=="string"&&(t=new TextEncoder().encode(t));const n=new Uint8Array(e),i=new Uint8Array(t);let r=n.length^i.length;const o=Math.max(n.length,i.length);for(let s=0;s<o;s++)r|=(s<n.length?n[s]:0)^(s<i.length?i[s]:0);return r===0}function UB(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function Xr(e,t=""){if(!Number.isSafeInteger(e)||e<0){const n=t&&`"${t}" `;throw new Error(`${n}expected integer >= 0, got ${e}`)}}function Ka(e,t,n=""){const i=UB(e),r=e?.length,o=t!==void 0;if(!i||o&&r!==t){const s=n&&`"${n}" `,a=o?` of length ${t}`:"",c=i?`length=${r}`:`type=${typeof e}`;throw new Error(s+"expected Uint8Array"+a+", got "+c)}return e}function bh(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash must wrapped by utils.createHasher");Xr(e.outputLen),Xr(e.blockLen)}function _f(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function LB(e,t){Ka(e,void 0,"digestInto() output");const n=t.outputLen;if(e.length<n)throw new Error('"digestInto() output" expected to be of length >='+n)}function Qm(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function zs(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function zd(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Ei(e,t){return e<<32-t|e>>>t}function Tt(e,t){return e<<t|e>>>32-t>>>0}const MB=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function jB(e){return e<<24&4278190080|e<<8&16711680|e>>>8&65280|e>>>24&255}function zB(e){for(let t=0;t<e.length;t++)e[t]=jB(e[t]);return e}const CS=MB?e=>e:zB,BB=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",Zi={_0:48,_9:57,A:65,F:70,a:97,f:102};function OS(e){if(e>=Zi._0&&e<=Zi._9)return e-Zi._0;if(e>=Zi.A&&e<=Zi.F)return e-(Zi.A-10);if(e>=Zi.a&&e<=Zi.f)return e-(Zi.a-10)}function FB(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(BB)return Uint8Array.fromHex(e);const t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const i=new Uint8Array(n);for(let r=0,o=0;r<n;r++,o+=2){const s=OS(e.charCodeAt(o)),a=OS(e.charCodeAt(o+1));if(s===void 0||a===void 0){const c=e[o]+e[o+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+o)}i[r]=s*16+a}return i}const WB=async()=>{};async function RS(e,t,n){let i=Date.now();for(let r=0;r<e;r++){n(r);const o=Date.now()-i;o>=0&&o<t||(await WB(),i+=o)}}function VB(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function PS(e,t=""){return typeof e=="string"?VB(e):Ka(e,void 0,t)}function f$(e,t){if(t!==void 0&&{}.toString.call(t)!=="[object Object]")throw new Error("options must be object or undefined");return Object.assign(e,t)}function qB(e,t={}){const n=(r,o)=>e(o).update(r).digest(),i=e(void 0);return n.outputLen=i.outputLen,n.blockLen=i.blockLen,n.create=r=>e(r),Object.assign(n,t),Object.freeze(n)}const HB=e=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,e])});class p${oHash;iHash;blockLen;outputLen;finished=!1;destroyed=!1;constructor(t,n){if(bh(t),Ka(n,void 0,"key"),this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;const i=this.blockLen,r=new Uint8Array(i);r.set(n.length>i?t.create().update(n).digest():n);for(let o=0;o<r.length;o++)r[o]^=54;this.iHash.update(r),this.oHash=t.create();for(let o=0;o<r.length;o++)r[o]^=106;this.oHash.update(r),zs(r)}update(t){return _f(this),this.iHash.update(t),this}digestInto(t){_f(this),Ka(t,this.outputLen,"output"),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){const t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||=Object.create(Object.getPrototypeOf(this),{});const{oHash:n,iHash:i,finished:r,destroyed:o,blockLen:s,outputLen:a}=this;return t=t,t.finished=r,t.destroyed=o,t.blockLen=s,t.outputLen=a,t.oHash=n._cloneInto(t.oHash),t.iHash=i._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}}const _h=(e,t,n)=>new p$(e,t).update(n).digest();_h.create=(e,t)=>new p$(e,t);function KB(e,t,n){return bh(e),n===void 0&&(n=new Uint8Array(e.outputLen)),_h(e,n,t)}const Ym=Uint8Array.of(0),DS=Uint8Array.of();function JB(e,t,n,i=32){bh(e),Xr(i,"length");const r=e.outputLen;if(i>255*r)throw new Error("Length must be <= 255*HashLen");const o=Math.ceil(i/r);n===void 0?n=DS:Ka(n,void 0,"info");const s=new Uint8Array(o*r),a=_h.create(e,t),c=a._cloneInto(),l=new Uint8Array(a.outputLen);for(let u=0;u<o;u++)Ym[0]=u+1,c.update(u===0?DS:l).update(n).update(Ym).digestInto(l),s.set(l,r*u),a._cloneInto(c);return a.destroy(),c.destroy(),zs(l,Ym),s.slice(0,i)}const h$=(e,t,n,i,r)=>JB(e,KB(e,t,n),i,r);function GB(e,t,n){return e&t^~e&n}function ZB(e,t,n){return e&t^e&n^t&n}class QB{blockLen;outputLen;padOffset;isLE;buffer;view;finished=!1;length=0;pos=0;destroyed=!1;constructor(t,n,i,r){this.blockLen=t,this.outputLen=n,this.padOffset=i,this.isLE=r,this.buffer=new Uint8Array(t),this.view=zd(this.buffer)}update(t){_f(this),Ka(t);const{view:n,buffer:i,blockLen:r}=this,o=t.length;for(let s=0;s<o;){const a=Math.min(r-this.pos,o-s);if(a===r){const c=zd(t);for(;r<=o-s;s+=r)this.process(c,s);continue}i.set(t.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===r&&(this.process(n,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){_f(this),LB(t,this),this.finished=!0;const{buffer:n,view:i,blockLen:r,isLE:o}=this;let{pos:s}=this;n[s++]=128,zs(this.buffer.subarray(s)),this.padOffset>r-s&&(this.process(i,0),s=0);for(let p=s;p<r;p++)n[p]=0;i.setBigUint64(r-8,BigInt(this.length*8),o),this.process(i,0);const a=zd(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen must be aligned to 32bit");const l=c/4,u=this.get();if(l>u.length)throw new Error("_sha2: outputLen bigger than state");for(let p=0;p<l;p++)a.setUint32(4*p,u[p],o)}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const i=t.slice(0,n);return this.destroy(),i}_cloneInto(t){t||=new this.constructor,t.set(...this.get());const{blockLen:n,buffer:i,length:r,finished:o,destroyed:s,pos:a}=this;return t.destroyed=s,t.finished=o,t.length=r,t.pos=a,r%n&&t.buffer.set(i),t}clone(){return this._cloneInto()}}const Oo=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),YB=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ro=new Uint32Array(64);class XB extends QB{constructor(t){super(64,t,8,!1)}get(){const{A:t,B:n,C:i,D:r,E:o,F:s,G:a,H:c}=this;return[t,n,i,r,o,s,a,c]}set(t,n,i,r,o,s,a,c){this.A=t|0,this.B=n|0,this.C=i|0,this.D=r|0,this.E=o|0,this.F=s|0,this.G=a|0,this.H=c|0}process(t,n){for(let p=0;p<16;p++,n+=4)Ro[p]=t.getUint32(n,!1);for(let p=16;p<64;p++){const f=Ro[p-15],g=Ro[p-2],h=Ei(f,7)^Ei(f,18)^f>>>3,d=Ei(g,17)^Ei(g,19)^g>>>10;Ro[p]=d+Ro[p-7]+h+Ro[p-16]|0}let{A:i,B:r,C:o,D:s,E:a,F:c,G:l,H:u}=this;for(let p=0;p<64;p++){const f=Ei(a,6)^Ei(a,11)^Ei(a,25),g=u+f+GB(a,c,l)+YB[p]+Ro[p]|0,d=(Ei(i,2)^Ei(i,13)^Ei(i,22))+ZB(i,r,o)|0;u=l,l=c,c=a,a=s+g|0,s=o,o=r,r=i,i=g+d|0}i=i+this.A|0,r=r+this.B|0,o=o+this.C|0,s=s+this.D|0,a=a+this.E|0,c=c+this.F|0,l=l+this.G|0,u=u+this.H|0,this.set(i,r,o,s,a,c,l,u)}roundClean(){zs(Ro)}destroy(){this.set(0,0,0,0,0,0,0,0),zs(this.buffer)}}class e8 extends XB{A=Oo[0]|0;B=Oo[1]|0;C=Oo[2]|0;D=Oo[3]|0;E=Oo[4]|0;F=Oo[5]|0;G=Oo[6]|0;H=Oo[7]|0;constructor(){super(32)}}const Sh=qB(()=>new e8,HB(1)),Sf=new TextEncoder,vo=new TextDecoder,xf=2**32;function Vi(...e){const t=e.reduce((r,{length:o})=>r+o,0),n=new Uint8Array(t);let i=0;for(const r of e)n.set(r,i),i+=r.length;return n}function Kg(e,t,n){if(t<0||t>=xf)throw new RangeError(`value must be >= 0 and <= ${xf-1}. Received ${t}`);e.set([t>>>24,t>>>16,t>>>8,t&255],n)}function m$(e){const t=Math.floor(e/xf),n=e%xf,i=new Uint8Array(8);return Kg(i,t,0),Kg(i,n,4),i}function wb(e){const t=new Uint8Array(4);return Kg(t,e),t}function fr(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++){const i=e.charCodeAt(n);if(i>127)throw new TypeError("non-ASCII string encountered in encode()");t[n]=i}return t}function t8(e){if(Uint8Array.prototype.toBase64)return e.toBase64();const t=32768,n=[];for(let i=0;i<e.length;i+=t)n.push(String.fromCharCode.apply(null,e.subarray(i,i+t)));return btoa(n.join(""))}function n8(e){if(Uint8Array.fromBase64)return Uint8Array.fromBase64(e);const t=atob(e),n=new Uint8Array(t.length);for(let i=0;i<t.length;i++)n[i]=t.charCodeAt(i);return n}function Pn(e){if(Uint8Array.fromBase64)return Uint8Array.fromBase64(typeof e=="string"?e:vo.decode(e),{alphabet:"base64url"});let t=e;t instanceof Uint8Array&&(t=vo.decode(t)),t=t.replace(/-/g,"+").replace(/_/g,"/");try{return n8(t)}catch{throw new TypeError("The input to be decoded is not correctly encoded.")}}function Dn(e){let t=e;return typeof t=="string"&&(t=Sf.encode(t)),Uint8Array.prototype.toBase64?t.toBase64({alphabet:"base64url",omitPadding:!0}):t8(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}class ir extends Error{static code="ERR_JOSE_GENERIC";code="ERR_JOSE_GENERIC";constructor(t,n){super(t,n),this.name=this.constructor.name,Error.captureStackTrace?.(this,this.constructor)}}class Cr extends ir{static code="ERR_JWT_CLAIM_VALIDATION_FAILED";code="ERR_JWT_CLAIM_VALIDATION_FAILED";claim;reason;payload;constructor(t,n,i="unspecified",r="unspecified"){super(t,{cause:{claim:i,reason:r,payload:n}}),this.claim=i,this.reason=r,this.payload=n}}class Jg extends ir{static code="ERR_JWT_EXPIRED";code="ERR_JWT_EXPIRED";claim;reason;payload;constructor(t,n,i="unspecified",r="unspecified"){super(t,{cause:{claim:i,reason:r,payload:n}}),this.claim=i,this.reason=r,this.payload=n}}class Gg extends ir{static code="ERR_JOSE_ALG_NOT_ALLOWED";code="ERR_JOSE_ALG_NOT_ALLOWED"}class wn extends ir{static code="ERR_JOSE_NOT_SUPPORTED";code="ERR_JOSE_NOT_SUPPORTED"}class Zg extends ir{static code="ERR_JWE_DECRYPTION_FAILED";code="ERR_JWE_DECRYPTION_FAILED";constructor(t="decryption operation failed",n){super(t,n)}}class ze extends ir{static code="ERR_JWE_INVALID";code="ERR_JWE_INVALID"}class bn extends ir{static code="ERR_JWS_INVALID";code="ERR_JWS_INVALID"}class Ni extends ir{static code="ERR_JWT_INVALID";code="ERR_JWT_INVALID"}class r8 extends ir{static code="ERR_JWK_INVALID";code="ERR_JWK_INVALID"}class g$ extends ir{static code="ERR_JWKS_INVALID";code="ERR_JWKS_INVALID"}class y$ extends ir{static code="ERR_JWKS_NO_MATCHING_KEY";code="ERR_JWKS_NO_MATCHING_KEY";constructor(t="no applicable key found in the JSON Web Key Set",n){super(t,n)}}class i8 extends ir{[Symbol.asyncIterator];static code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";code="ERR_JWKS_MULTIPLE_MATCHING_KEYS";constructor(t="multiple matching keys found in the JSON Web Key Set",n){super(t,n)}}class o8 extends ir{static code="ERR_JWKS_TIMEOUT";code="ERR_JWKS_TIMEOUT";constructor(t="request timed out",n){super(t,n)}}class s8 extends ir{static code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED";code="ERR_JWS_SIGNATURE_VERIFICATION_FAILED";constructor(t="signature verification failed",n){super(t,n)}}function w$(e){switch(e){case"A128GCM":case"A128GCMKW":case"A192GCM":case"A192GCMKW":case"A256GCM":case"A256GCMKW":return 96;case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return 128;default:throw new wn(`Unsupported JWE Algorithm: ${e}`)}}const a8=e=>crypto.getRandomValues(new Uint8Array(w$(e)>>3));function v$(e,t){if(t.length<<3!==w$(e))throw new ze("Invalid Initialization Vector length")}function kf(e,t){const n=e.byteLength<<3;if(n!==t)throw new ze(`Invalid Content Encryption Key length. Expected ${t} bits, got ${n} bits`)}const Rn=(e,t="algorithm.name")=>new TypeError(`CryptoKey does not support this operation, its ${t} must be ${e}`),$i=(e,t)=>e.name===t;function Bd(e){return parseInt(e.name.slice(4),10)}function c8(e){switch(e){case"ES256":return"P-256";case"ES384":return"P-384";case"ES512":return"P-521";default:throw new Error("unreachable")}}function b$(e,t){if(t&&!e.usages.includes(t))throw new TypeError(`CryptoKey does not support this operation, its usages must include ${t}.`)}function l8(e,t,n){switch(t){case"HS256":case"HS384":case"HS512":{if(!$i(e.algorithm,"HMAC"))throw Rn("HMAC");const i=parseInt(t.slice(2),10);if(Bd(e.algorithm.hash)!==i)throw Rn(`SHA-${i}`,"algorithm.hash");break}case"RS256":case"RS384":case"RS512":{if(!$i(e.algorithm,"RSASSA-PKCS1-v1_5"))throw Rn("RSASSA-PKCS1-v1_5");const i=parseInt(t.slice(2),10);if(Bd(e.algorithm.hash)!==i)throw Rn(`SHA-${i}`,"algorithm.hash");break}case"PS256":case"PS384":case"PS512":{if(!$i(e.algorithm,"RSA-PSS"))throw Rn("RSA-PSS");const i=parseInt(t.slice(2),10);if(Bd(e.algorithm.hash)!==i)throw Rn(`SHA-${i}`,"algorithm.hash");break}case"Ed25519":case"EdDSA":{if(!$i(e.algorithm,"Ed25519"))throw Rn("Ed25519");break}case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":{if(!$i(e.algorithm,t))throw Rn(t);break}case"ES256":case"ES384":case"ES512":{if(!$i(e.algorithm,"ECDSA"))throw Rn("ECDSA");const i=c8(t);if(e.algorithm.namedCurve!==i)throw Rn(i,"algorithm.namedCurve");break}default:throw new TypeError("CryptoKey does not support this operation")}b$(e,n)}function es(e,t,n){switch(t){case"A128GCM":case"A192GCM":case"A256GCM":{if(!$i(e.algorithm,"AES-GCM"))throw Rn("AES-GCM");const i=parseInt(t.slice(1,4),10);if(e.algorithm.length!==i)throw Rn(i,"algorithm.length");break}case"A128KW":case"A192KW":case"A256KW":{if(!$i(e.algorithm,"AES-KW"))throw Rn("AES-KW");const i=parseInt(t.slice(1,4),10);if(e.algorithm.length!==i)throw Rn(i,"algorithm.length");break}case"ECDH":{switch(e.algorithm.name){case"ECDH":case"X25519":break;default:throw Rn("ECDH or X25519")}break}case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":if(!$i(e.algorithm,"PBKDF2"))throw Rn("PBKDF2");break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(!$i(e.algorithm,"RSA-OAEP"))throw Rn("RSA-OAEP");const i=parseInt(t.slice(9),10)||1;if(Bd(e.algorithm.hash)!==i)throw Rn(`SHA-${i}`,"algorithm.hash");break}default:throw new TypeError("CryptoKey does not support this operation")}b$(e,n)}function _$(e,t,...n){if(n=n.filter(Boolean),n.length>2){const i=n.pop();e+=`one of type ${n.join(", ")}, or ${i}.`}else n.length===2?e+=`one of type ${n[0]} or ${n[1]}.`:e+=`of type ${n[0]}.`;return t==null?e+=` Received ${t}`:typeof t=="function"&&t.name?e+=` Received function ${t.name}`:typeof t=="object"&&t!=null&&t.constructor?.name&&(e+=` Received an instance of ${t.constructor.name}`),e}const Ys=(e,...t)=>_$("Key must be ",e,...t),S$=(e,t,...n)=>_$(`Key for the ${e} algorithm must be `,t,...n);function rl(e){if(!wc(e))throw new Error("CryptoKey instance expected")}const wc=e=>{if(e?.[Symbol.toStringTag]==="CryptoKey")return!0;try{return e instanceof CryptoKey}catch{return!1}},vb=e=>e?.[Symbol.toStringTag]==="KeyObject",bb=e=>wc(e)||vb(e);async function u8(e,t){if(!(e instanceof Uint8Array))throw new TypeError("First argument must be a buffer");if(!(t instanceof Uint8Array))throw new TypeError("Second argument must be a buffer");const n={name:"HMAC",hash:"SHA-256"},i=await crypto.subtle.generateKey(n,!1,["sign"]),r=new Uint8Array(await crypto.subtle.sign(n,i,e)),o=new Uint8Array(await crypto.subtle.sign(n,i,t));let s=0,a=-1;for(;++a<32;)s|=r[a]^o[a];return s===0}async function d8(e,t,n,i,r,o){if(!(t instanceof Uint8Array))throw new TypeError(Ys(t,"Uint8Array"));const s=parseInt(e.slice(1,4),10),a=await crypto.subtle.importKey("raw",t.subarray(s>>3),"AES-CBC",!1,["decrypt"]),c=await crypto.subtle.importKey("raw",t.subarray(0,s>>3),{hash:`SHA-${s<<1}`,name:"HMAC"},!1,["sign"]),l=Vi(o,i,n,m$(o.length<<3)),u=new Uint8Array((await crypto.subtle.sign("HMAC",c,l)).slice(0,s>>3));let p;try{p=await u8(r,u)}catch{}if(!p)throw new Zg;let f;try{f=new Uint8Array(await crypto.subtle.decrypt({iv:i,name:"AES-CBC"},a,n))}catch{}if(!f)throw new Zg;return f}async function f8(e,t,n,i,r,o){let s;t instanceof Uint8Array?s=await crypto.subtle.importKey("raw",t,"AES-GCM",!1,["decrypt"]):(es(t,e,"decrypt"),s=t);try{return new Uint8Array(await crypto.subtle.decrypt({additionalData:o,iv:i,name:"AES-GCM",tagLength:128},s,Vi(n,r)))}catch{throw new Zg}}async function x$(e,t,n,i,r,o){if(!wc(t)&&!(t instanceof Uint8Array))throw new TypeError(Ys(t,"CryptoKey","KeyObject","Uint8Array","JSON Web Key"));if(!i)throw new ze("JWE Initialization Vector missing");if(!r)throw new ze("JWE Authentication Tag missing");switch(v$(e,i),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return t instanceof Uint8Array&&kf(t,parseInt(e.slice(-3),10)),d8(e,t,n,i,r,o);case"A128GCM":case"A192GCM":case"A256GCM":return t instanceof Uint8Array&&kf(t,parseInt(e.slice(1,4),10)),f8(e,t,n,i,r,o);default:throw new wn("Unsupported JWE Content Encryption Algorithm")}}function xh(...e){const t=e.filter(Boolean);if(t.length===0||t.length===1)return!0;let n;for(const i of t){const r=Object.keys(i);if(!n||n.size===0){n=new Set(r);continue}for(const o of r){if(n.has(o))return!1;n.add(o)}}return!0}const p8=e=>typeof e=="object"&&e!==null;function pr(e){if(!p8(e)||Object.prototype.toString.call(e)!=="[object Object]")return!1;if(Object.getPrototypeOf(e)===null)return!0;let t=e;for(;Object.getPrototypeOf(t)!==null;)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function k$(e,t){if(e.algorithm.length!==parseInt(t.slice(1,4),10))throw new TypeError(`Invalid key size for alg: ${t}`)}function E$(e,t,n){return e instanceof Uint8Array?crypto.subtle.importKey("raw",e,"AES-KW",!0,[n]):(es(e,t,n),e)}async function Qg(e,t,n){const i=await E$(t,e,"wrapKey");k$(i,e);const r=await crypto.subtle.importKey("raw",n,{hash:"SHA-256",name:"HMAC"},!0,["sign"]);return new Uint8Array(await crypto.subtle.wrapKey("raw",r,i,"AES-KW"))}async function Yg(e,t,n){const i=await E$(t,e,"unwrapKey");k$(i,e);const r=await crypto.subtle.unwrapKey("raw",n,i,"AES-KW",{hash:"SHA-256",name:"HMAC"},!0,["sign"]);return new Uint8Array(await crypto.subtle.exportKey("raw",r))}async function A$(e,t){const n=`SHA-${e.slice(-3)}`;return new Uint8Array(await crypto.subtle.digest(n,t))}function Xm(e){return Vi(wb(e.length),e)}async function h8(e,t,n){const i=t>>3,r=32,o=Math.ceil(i/r),s=new Uint8Array(o*r);for(let a=1;a<=o;a++){const c=new Uint8Array(4+e.length+n.length);c.set(wb(a),0),c.set(e,4),c.set(n,4+e.length);const l=await A$("sha256",c);s.set(l,(a-1)*r)}return s.slice(0,i)}async function T$(e,t,n,i,r=new Uint8Array,o=new Uint8Array){es(e,"ECDH"),es(t,"ECDH","deriveBits");const s=Xm(fr(n)),a=Xm(r),c=Xm(o),l=wb(i),u=new Uint8Array,p=Vi(s,a,c,l,u),f=new Uint8Array(await crypto.subtle.deriveBits({name:e.algorithm.name,public:e},t,m8(e)));return h8(f,i,p)}function m8(e){return e.algorithm.name==="X25519"?256:Math.ceil(parseInt(e.algorithm.namedCurve.slice(-3),10)/8)<<3}function I$(e){switch(e.algorithm.namedCurve){case"P-256":case"P-384":case"P-521":return!0;default:return e.algorithm.name==="X25519"}}function g8(e,t){return e instanceof Uint8Array?crypto.subtle.importKey("raw",e,"PBKDF2",!1,["deriveBits"]):(es(e,t,"deriveBits"),e)}const y8=(e,t)=>Vi(fr(e),Uint8Array.of(0),t);async function N$(e,t,n,i){if(!(e instanceof Uint8Array)||e.length<8)throw new ze("PBES2 Salt Input must be 8 or more octets");const r=y8(t,e),o=parseInt(t.slice(13,16),10),s={hash:`SHA-${t.slice(8,11)}`,iterations:n,name:"PBKDF2",salt:r},a=await g8(i,t);return new Uint8Array(await crypto.subtle.deriveBits(s,a,o))}async function w8(e,t,n,i=2048,r=crypto.getRandomValues(new Uint8Array(16))){const o=await N$(r,e,i,t);return{encryptedKey:await Qg(e.slice(-6),o,n),p2c:i,p2s:Dn(r)}}async function v8(e,t,n,i,r){const o=await N$(r,e,i,t);return Yg(e.slice(-6),o,n)}function kh(e,t){if(e.startsWith("RS")||e.startsWith("PS")){const{modulusLength:n}=t.algorithm;if(typeof n!="number"||n<2048)throw new TypeError(`${e} requires key modulusLength to be 2048 bits or larger`)}}const $$=e=>{switch(e){case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":return"RSA-OAEP";default:throw new wn(`alg ${e} is not supported either by JOSE or your javascript runtime`)}};async function b8(e,t,n){return es(t,e,"encrypt"),kh(e,t),new Uint8Array(await crypto.subtle.encrypt($$(e),t,n))}async function _8(e,t,n){return es(t,e,"decrypt"),kh(e,t),new Uint8Array(await crypto.subtle.decrypt($$(e),t,n))}function _b(e){switch(e){case"A128GCM":return 128;case"A192GCM":return 192;case"A256GCM":case"A128CBC-HS256":return 256;case"A192CBC-HS384":return 384;case"A256CBC-HS512":return 512;default:throw new wn(`Unsupported JWE Algorithm: ${e}`)}}const xa=e=>crypto.getRandomValues(new Uint8Array(_b(e)>>3));function S8(e){let t,n;switch(e.kty){case"AKP":{switch(e.alg){case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":t={name:e.alg},n=e.priv?["sign"]:["verify"];break;default:throw new wn('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case"RSA":{switch(e.alg){case"PS256":case"PS384":case"PS512":t={name:"RSA-PSS",hash:`SHA-${e.alg.slice(-3)}`},n=e.d?["sign"]:["verify"];break;case"RS256":case"RS384":case"RS512":t={name:"RSASSA-PKCS1-v1_5",hash:`SHA-${e.alg.slice(-3)}`},n=e.d?["sign"]:["verify"];break;case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":t={name:"RSA-OAEP",hash:`SHA-${parseInt(e.alg.slice(-3),10)||1}`},n=e.d?["decrypt","unwrapKey"]:["encrypt","wrapKey"];break;default:throw new wn('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case"EC":{switch(e.alg){case"ES256":t={name:"ECDSA",namedCurve:"P-256"},n=e.d?["sign"]:["verify"];break;case"ES384":t={name:"ECDSA",namedCurve:"P-384"},n=e.d?["sign"]:["verify"];break;case"ES512":t={name:"ECDSA",namedCurve:"P-521"},n=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:"ECDH",namedCurve:e.crv},n=e.d?["deriveBits"]:[];break;default:throw new wn('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}case"OKP":{switch(e.alg){case"Ed25519":case"EdDSA":t={name:"Ed25519"},n=e.d?["sign"]:["verify"];break;case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":t={name:e.crv},n=e.d?["deriveBits"]:[];break;default:throw new wn('Invalid or unsupported JWK "alg" (Algorithm) Parameter value')}break}default:throw new wn('Invalid or unsupported JWK "kty" (Key Type) Parameter value')}return{algorithm:t,keyUsages:n}}async function Fd(e){if(!e.alg)throw new TypeError('"alg" argument is required when "jwk.alg" is not present');const{algorithm:t,keyUsages:n}=S8(e),i={...e};return i.kty!=="AKP"&&delete i.alg,delete i.use,crypto.subtle.importKey("jwk",i,t,e.ext??!(e.d||e.priv),e.key_ops??n)}async function Mu(e,t,n){if(!pr(e))throw new TypeError("JWK must be an object");let i;switch(t??=e.alg,i??=e.ext,e.kty){case"oct":if(typeof e.k!="string"||!e.k)throw new TypeError('missing "k" (Key Value) Parameter value');return Pn(e.k);case"RSA":if("oth"in e&&e.oth!==void 0)throw new wn('RSA JWK "oth" (Other Primes Info) Parameter value is not supported');return Fd({...e,alg:t,ext:i});case"AKP":{if(typeof e.alg!="string"||!e.alg)throw new TypeError('missing "alg" (Algorithm) Parameter value');if(t!==void 0&&t!==e.alg)throw new TypeError("JWK alg and alg option value mismatch");return Fd({...e,ext:i})}case"EC":case"OKP":return Fd({...e,alg:t,ext:i});default:throw new wn('Unsupported "kty" (Key Type) Parameter value')}}async function x8(e,t,n,i,r){if(!(n instanceof Uint8Array))throw new TypeError(Ys(n,"Uint8Array"));const o=parseInt(e.slice(1,4),10),s=await crypto.subtle.importKey("raw",n.subarray(o>>3),"AES-CBC",!1,["encrypt"]),a=await crypto.subtle.importKey("raw",n.subarray(0,o>>3),{hash:`SHA-${o<<1}`,name:"HMAC"},!1,["sign"]),c=new Uint8Array(await crypto.subtle.encrypt({iv:i,name:"AES-CBC"},s,t)),l=Vi(r,i,c,m$(r.length<<3)),u=new Uint8Array((await crypto.subtle.sign("HMAC",a,l)).slice(0,o>>3));return{ciphertext:c,tag:u,iv:i}}async function k8(e,t,n,i,r){let o;n instanceof Uint8Array?o=await crypto.subtle.importKey("raw",n,"AES-GCM",!1,["encrypt"]):(es(n,e,"encrypt"),o=n);const s=new Uint8Array(await crypto.subtle.encrypt({additionalData:r,iv:i,name:"AES-GCM",tagLength:128},o,t)),a=s.slice(-16);return{ciphertext:s.slice(0,-16),tag:a,iv:i}}async function C$(e,t,n,i,r){if(!wc(n)&&!(n instanceof Uint8Array))throw new TypeError(Ys(n,"CryptoKey","KeyObject","Uint8Array","JSON Web Key"));switch(i?v$(e,i):i=a8(e),e){case"A128CBC-HS256":case"A192CBC-HS384":case"A256CBC-HS512":return n instanceof Uint8Array&&kf(n,parseInt(e.slice(-3),10)),x8(e,t,n,i,r);case"A128GCM":case"A192GCM":case"A256GCM":return n instanceof Uint8Array&&kf(n,parseInt(e.slice(1,4),10)),k8(e,t,n,i,r);default:throw new wn("Unsupported JWE Content Encryption Algorithm")}}async function E8(e,t,n,i){const r=e.slice(0,7),o=await C$(r,n,t,i,new Uint8Array);return{encryptedKey:o.ciphertext,iv:Dn(o.iv),tag:Dn(o.tag)}}async function A8(e,t,n,i,r){const o=e.slice(0,7);return x$(o,t,n,i,r,new Uint8Array)}async function T8(e,t,n,i,r){switch(e){case"dir":{if(n!==void 0)throw new ze("Encountered unexpected JWE Encrypted Key");return t}case"ECDH-ES":if(n!==void 0)throw new ze("Encountered unexpected JWE Encrypted Key");case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{if(!pr(i.epk))throw new ze('JOSE Header "epk" (Ephemeral Public Key) missing or invalid');if(rl(t),!I$(t))throw new wn("ECDH with the provided key is not allowed or not supported by your javascript runtime");const o=await Mu(i.epk,e);rl(o);let s,a;if(i.apu!==void 0){if(typeof i.apu!="string")throw new ze('JOSE Header "apu" (Agreement PartyUInfo) invalid');try{s=Pn(i.apu)}catch{throw new ze("Failed to base64url decode the apu")}}if(i.apv!==void 0){if(typeof i.apv!="string")throw new ze('JOSE Header "apv" (Agreement PartyVInfo) invalid');try{a=Pn(i.apv)}catch{throw new ze("Failed to base64url decode the apv")}}const c=await T$(o,t,e==="ECDH-ES"?i.enc:e,e==="ECDH-ES"?_b(i.enc):parseInt(e.slice(-5,-2),10),s,a);if(e==="ECDH-ES")return c;if(n===void 0)throw new ze("JWE Encrypted Key missing");return Yg(e.slice(-6),c,n)}case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{if(n===void 0)throw new ze("JWE Encrypted Key missing");return rl(t),_8(e,t,n)}case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{if(n===void 0)throw new ze("JWE Encrypted Key missing");if(typeof i.p2c!="number")throw new ze('JOSE Header "p2c" (PBES2 Count) missing or invalid');const o=r?.maxPBES2Count||1e4;if(i.p2c>o)throw new ze('JOSE Header "p2c" (PBES2 Count) out is of acceptable bounds');if(typeof i.p2s!="string")throw new ze('JOSE Header "p2s" (PBES2 Salt) missing or invalid');let s;try{s=Pn(i.p2s)}catch{throw new ze("Failed to base64url decode the p2s")}return v8(e,t,n,i.p2c,s)}case"A128KW":case"A192KW":case"A256KW":{if(n===void 0)throw new ze("JWE Encrypted Key missing");return Yg(e,t,n)}case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{if(n===void 0)throw new ze("JWE Encrypted Key missing");if(typeof i.iv!="string")throw new ze('JOSE Header "iv" (Initialization Vector) missing or invalid');if(typeof i.tag!="string")throw new ze('JOSE Header "tag" (Authentication Tag) missing or invalid');let o;try{o=Pn(i.iv)}catch{throw new ze("Failed to base64url decode the iv")}let s;try{s=Pn(i.tag)}catch{throw new ze("Failed to base64url decode the tag")}return A8(e,t,n,o,s)}default:throw new wn('Invalid or unsupported "alg" (JWE Algorithm) header value')}}function Eh(e,t,n,i,r){if(r.crit!==void 0&&i?.crit===void 0)throw new e('"crit" (Critical) Header Parameter MUST be integrity protected');if(!i||i.crit===void 0)return new Set;if(!Array.isArray(i.crit)||i.crit.length===0||i.crit.some(s=>typeof s!="string"||s.length===0))throw new e('"crit" (Critical) Header Parameter MUST be an array of non-empty strings when present');let o;n!==void 0?o=new Map([...Object.entries(n),...t.entries()]):o=t;for(const s of i.crit){if(!o.has(s))throw new wn(`Extension Header Parameter "${s}" is not recognized`);if(r[s]===void 0)throw new e(`Extension Header Parameter "${s}" is missing`);if(o.get(s)&&i[s]===void 0)throw new e(`Extension Header Parameter "${s}" MUST be integrity protected`)}return new Set(i.crit)}function Xg(e,t){if(t!==void 0&&(!Array.isArray(t)||t.some(n=>typeof n!="string")))throw new TypeError(`"${e}" option must be an array of strings`);if(t)return new Set(t)}const Ah=e=>pr(e)&&typeof e.kty=="string",I8=e=>e.kty!=="oct"&&(e.kty==="AKP"&&typeof e.priv=="string"||typeof e.d=="string"),N8=e=>e.kty!=="oct"&&e.d===void 0&&e.priv===void 0,$8=e=>e.kty==="oct"&&typeof e.k=="string";let Oa;const US=async(e,t,n,i=!1)=>{Oa||=new WeakMap;let r=Oa.get(e);if(r?.[n])return r[n];const o=await Fd({...t,alg:n});return i&&Object.freeze(e),r?r[n]=o:Oa.set(e,{[n]:o}),o},C8=(e,t)=>{Oa||=new WeakMap;let n=Oa.get(e);if(n?.[t])return n[t];const i=e.type==="public",r=!!i;let o;if(e.asymmetricKeyType==="x25519"){switch(t){case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":break;default:throw new TypeError("given KeyObject instance cannot be used for this algorithm")}o=e.toCryptoKey(e.asymmetricKeyType,r,i?[]:["deriveBits"])}if(e.asymmetricKeyType==="ed25519"){if(t!=="EdDSA"&&t!=="Ed25519")throw new TypeError("given KeyObject instance cannot be used for this algorithm");o=e.toCryptoKey(e.asymmetricKeyType,r,[i?"verify":"sign"])}switch(e.asymmetricKeyType){case"ml-dsa-44":case"ml-dsa-65":case"ml-dsa-87":{if(t!==e.asymmetricKeyType.toUpperCase())throw new TypeError("given KeyObject instance cannot be used for this algorithm");o=e.toCryptoKey(e.asymmetricKeyType,r,[i?"verify":"sign"])}}if(e.asymmetricKeyType==="rsa"){let s;switch(t){case"RSA-OAEP":s="SHA-1";break;case"RS256":case"PS256":case"RSA-OAEP-256":s="SHA-256";break;case"RS384":case"PS384":case"RSA-OAEP-384":s="SHA-384";break;case"RS512":case"PS512":case"RSA-OAEP-512":s="SHA-512";break;default:throw new TypeError("given KeyObject instance cannot be used for this algorithm")}if(t.startsWith("RSA-OAEP"))return e.toCryptoKey({name:"RSA-OAEP",hash:s},r,i?["encrypt"]:["decrypt"]);o=e.toCryptoKey({name:t.startsWith("PS")?"RSA-PSS":"RSASSA-PKCS1-v1_5",hash:s},r,[i?"verify":"sign"])}if(e.asymmetricKeyType==="ec"){const a=new Map([["prime256v1","P-256"],["secp384r1","P-384"],["secp521r1","P-521"]]).get(e.asymmetricKeyDetails?.namedCurve);if(!a)throw new TypeError("given KeyObject instance cannot be used for this algorithm");t==="ES256"&&a==="P-256"&&(o=e.toCryptoKey({name:"ECDSA",namedCurve:a},r,[i?"verify":"sign"])),t==="ES384"&&a==="P-384"&&(o=e.toCryptoKey({name:"ECDSA",namedCurve:a},r,[i?"verify":"sign"])),t==="ES512"&&a==="P-521"&&(o=e.toCryptoKey({name:"ECDSA",namedCurve:a},r,[i?"verify":"sign"])),t.startsWith("ECDH-ES")&&(o=e.toCryptoKey({name:"ECDH",namedCurve:a},r,i?[]:["deriveBits"]))}if(!o)throw new TypeError("given KeyObject instance cannot be used for this algorithm");return n?n[t]=o:Oa.set(e,{[t]:o}),o};async function ju(e,t){if(e instanceof Uint8Array||wc(e))return e;if(vb(e)){if(e.type==="secret")return e.export();if("toCryptoKey"in e&&typeof e.toCryptoKey=="function")try{return C8(e,t)}catch(i){if(i instanceof TypeError)throw i}let n=e.export({format:"jwk"});return US(e,n,t)}if(Ah(e))return e.k?Pn(e.k):US(e,e,t,!0);throw new Error("unreachable")}const ka=e=>e?.[Symbol.toStringTag],ey=(e,t,n)=>{if(t.use!==void 0){let i;switch(n){case"sign":case"verify":i="sig";break;case"encrypt":case"decrypt":i="enc";break}if(t.use!==i)throw new TypeError(`Invalid key for this operation, its "use" must be "${i}" when present`)}if(t.alg!==void 0&&t.alg!==e)throw new TypeError(`Invalid key for this operation, its "alg" must be "${e}" when present`);if(Array.isArray(t.key_ops)){let i;switch(!0){case(n==="sign"||n==="verify"):case e==="dir":case e.includes("CBC-HS"):i=n;break;case e.startsWith("PBES2"):i="deriveBits";break;case/^A\d{3}(?:GCM)?(?:KW)?$/.test(e):!e.includes("GCM")&&e.endsWith("KW")?i=n==="encrypt"?"wrapKey":"unwrapKey":i=n;break;case(n==="encrypt"&&e.startsWith("RSA")):i="wrapKey";break;case n==="decrypt":i=e.startsWith("RSA")?"unwrapKey":"deriveBits";break}if(i&&t.key_ops?.includes?.(i)===!1)throw new TypeError(`Invalid key for this operation, its "key_ops" must include "${i}" when present`)}return!0},O8=(e,t,n)=>{if(!(t instanceof Uint8Array)){if(Ah(t)){if($8(t)&&ey(e,t,n))return;throw new TypeError('JSON Web Key for symmetric algorithms must have JWK "kty" (Key Type) equal to "oct" and the JWK "k" (Key Value) present')}if(!bb(t))throw new TypeError(S$(e,t,"CryptoKey","KeyObject","JSON Web Key","Uint8Array"));if(t.type!=="secret")throw new TypeError(`${ka(t)} instances for symmetric algorithms must be of type "secret"`)}},R8=(e,t,n)=>{if(Ah(t))switch(n){case"decrypt":case"sign":if(I8(t)&&ey(e,t,n))return;throw new TypeError("JSON Web Key for this operation must be a private JWK");case"encrypt":case"verify":if(N8(t)&&ey(e,t,n))return;throw new TypeError("JSON Web Key for this operation must be a public JWK")}if(!bb(t))throw new TypeError(S$(e,t,"CryptoKey","KeyObject","JSON Web Key"));if(t.type==="secret")throw new TypeError(`${ka(t)} instances for asymmetric algorithms must not be of type "secret"`);if(t.type==="public")switch(n){case"sign":throw new TypeError(`${ka(t)} instances for asymmetric algorithm signing must be of type "private"`);case"decrypt":throw new TypeError(`${ka(t)} instances for asymmetric algorithm decryption must be of type "private"`)}if(t.type==="private")switch(n){case"verify":throw new TypeError(`${ka(t)} instances for asymmetric algorithm verifying must be of type "public"`);case"encrypt":throw new TypeError(`${ka(t)} instances for asymmetric algorithm encryption must be of type "public"`)}};function Th(e,t,n){switch(e.substring(0,2)){case"A1":case"A2":case"di":case"HS":case"PB":O8(e,t,n);break;default:R8(e,t,n)}}async function P8(e,t,n){if(!pr(e))throw new ze("Flattened JWE must be an object");if(e.protected===void 0&&e.header===void 0&&e.unprotected===void 0)throw new ze("JOSE Header missing");if(e.iv!==void 0&&typeof e.iv!="string")throw new ze("JWE Initialization Vector incorrect type");if(typeof e.ciphertext!="string")throw new ze("JWE Ciphertext missing or incorrect type");if(e.tag!==void 0&&typeof e.tag!="string")throw new ze("JWE Authentication Tag incorrect type");if(e.protected!==void 0&&typeof e.protected!="string")throw new ze("JWE Protected Header incorrect type");if(e.encrypted_key!==void 0&&typeof e.encrypted_key!="string")throw new ze("JWE Encrypted Key incorrect type");if(e.aad!==void 0&&typeof e.aad!="string")throw new ze("JWE AAD incorrect type");if(e.header!==void 0&&!pr(e.header))throw new ze("JWE Shared Unprotected Header incorrect type");if(e.unprotected!==void 0&&!pr(e.unprotected))throw new ze("JWE Per-Recipient Unprotected Header incorrect type");let i;if(e.protected)try{const N=Pn(e.protected);i=JSON.parse(vo.decode(N))}catch{throw new ze("JWE Protected Header is invalid")}if(!xh(i,e.header,e.unprotected))throw new ze("JWE Protected, JWE Unprotected Header, and JWE Per-Recipient Unprotected Header Parameter names must be disjoint");const r={...i,...e.header,...e.unprotected};if(Eh(ze,new Map,n?.crit,i,r),r.zip!==void 0)throw new wn('JWE "zip" (Compression Algorithm) Header Parameter is not supported.');const{alg:o,enc:s}=r;if(typeof o!="string"||!o)throw new ze("missing JWE Algorithm (alg) in JWE Header");if(typeof s!="string"||!s)throw new ze("missing JWE Encryption Algorithm (enc) in JWE Header");const a=n&&Xg("keyManagementAlgorithms",n.keyManagementAlgorithms),c=n&&Xg("contentEncryptionAlgorithms",n.contentEncryptionAlgorithms);if(a&&!a.has(o)||!a&&o.startsWith("PBES2"))throw new Gg('"alg" (Algorithm) Header Parameter value not allowed');if(c&&!c.has(s))throw new Gg('"enc" (Encryption Algorithm) Header Parameter value not allowed');let l;if(e.encrypted_key!==void 0)try{l=Pn(e.encrypted_key)}catch{throw new ze("Failed to base64url decode the encrypted_key")}let u=!1;typeof t=="function"&&(t=await t(i,e),u=!0),Th(o==="dir"?s:o,t,"decrypt");const p=await ju(t,o);let f;try{f=await T8(o,p,l,r,n)}catch(N){if(N instanceof TypeError||N instanceof ze||N instanceof wn)throw N;f=xa(s)}let g,h;if(e.iv!==void 0)try{g=Pn(e.iv)}catch{throw new ze("Failed to base64url decode the iv")}if(e.tag!==void 0)try{h=Pn(e.tag)}catch{throw new ze("Failed to base64url decode the tag")}const d=e.protected!==void 0?fr(e.protected):new Uint8Array;let y;e.aad!==void 0?y=Vi(d,fr("."),fr(e.aad)):y=d;let v;try{v=Pn(e.ciphertext)}catch{throw new ze("Failed to base64url decode the ciphertext")}const E={plaintext:await x$(s,f,v,g,h,y)};if(e.protected!==void 0&&(E.protectedHeader=i),e.aad!==void 0)try{E.additionalAuthenticatedData=Pn(e.aad)}catch{throw new ze("Failed to base64url decode the aad")}return e.unprotected!==void 0&&(E.sharedUnprotectedHeader=e.unprotected),e.header!==void 0&&(E.unprotectedHeader=e.header),u?{...E,key:p}:E}async function D8(e,t,n){if(e instanceof Uint8Array&&(e=vo.decode(e)),typeof e!="string")throw new ze("Compact JWE must be a string or Uint8Array");const{0:i,1:r,2:o,3:s,4:a,length:c}=e.split(".");if(c!==5)throw new ze("Invalid Compact JWE");const l=await P8({ciphertext:s,iv:o||void 0,protected:i,tag:a||void 0,encrypted_key:r||void 0},t,n),u={plaintext:l.plaintext,protectedHeader:l.protectedHeader};return typeof t=="function"?{...u,key:l.key}:u}const U8=Symbol();async function L8(e){if(vb(e))if(e.type==="secret")e=e.export();else return e.export({format:"jwk"});if(e instanceof Uint8Array)return{kty:"oct",k:Dn(e)};if(!wc(e))throw new TypeError(Ys(e,"CryptoKey","KeyObject","Uint8Array"));if(!e.extractable)throw new TypeError("non-extractable CryptoKey cannot be exported as a JWK");const{ext:t,key_ops:n,alg:i,use:r,...o}=await crypto.subtle.exportKey("jwk",e);return o.kty==="AKP"&&(o.alg=i),o}async function O$(e){return L8(e)}async function M8(e,t,n,i,r={}){let o,s,a;switch(e){case"dir":{a=n;break}case"ECDH-ES":case"ECDH-ES+A128KW":case"ECDH-ES+A192KW":case"ECDH-ES+A256KW":{if(rl(n),!I$(n))throw new wn("ECDH with the provided key is not allowed or not supported by your javascript runtime");const{apu:c,apv:l}=r;let u;r.epk?u=await ju(r.epk,e):u=(await crypto.subtle.generateKey(n.algorithm,!0,["deriveBits"])).privateKey;const{x:p,y:f,crv:g,kty:h}=await O$(u),d=await T$(n,u,e==="ECDH-ES"?t:e,e==="ECDH-ES"?_b(t):parseInt(e.slice(-5,-2),10),c,l);if(s={epk:{x:p,crv:g,kty:h}},h==="EC"&&(s.epk.y=f),c&&(s.apu=Dn(c)),l&&(s.apv=Dn(l)),e==="ECDH-ES"){a=d;break}a=i||xa(t);const y=e.slice(-6);o=await Qg(y,d,a);break}case"RSA-OAEP":case"RSA-OAEP-256":case"RSA-OAEP-384":case"RSA-OAEP-512":{a=i||xa(t),rl(n),o=await b8(e,n,a);break}case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{a=i||xa(t);const{p2c:c,p2s:l}=r;({encryptedKey:o,...s}=await w8(e,n,a,c,l));break}case"A128KW":case"A192KW":case"A256KW":{a=i||xa(t),o=await Qg(e,n,a);break}case"A128GCMKW":case"A192GCMKW":case"A256GCMKW":{a=i||xa(t);const{iv:c}=r;({encryptedKey:o,...s}=await E8(e,n,a,c));break}default:throw new wn('Invalid or unsupported "alg" (JWE Algorithm) header value')}return{cek:a,encryptedKey:o,parameters:s}}class j8{#e;#t;#n;#r;#i;#s;#a;#o;constructor(t){if(!(t instanceof Uint8Array))throw new TypeError("plaintext must be an instance of Uint8Array");this.#e=t}setKeyManagementParameters(t){if(this.#o)throw new TypeError("setKeyManagementParameters can only be called once");return this.#o=t,this}setProtectedHeader(t){if(this.#t)throw new TypeError("setProtectedHeader can only be called once");return this.#t=t,this}setSharedUnprotectedHeader(t){if(this.#n)throw new TypeError("setSharedUnprotectedHeader can only be called once");return this.#n=t,this}setUnprotectedHeader(t){if(this.#r)throw new TypeError("setUnprotectedHeader can only be called once");return this.#r=t,this}setAdditionalAuthenticatedData(t){return this.#i=t,this}setContentEncryptionKey(t){if(this.#s)throw new TypeError("setContentEncryptionKey can only be called once");return this.#s=t,this}setInitializationVector(t){if(this.#a)throw new TypeError("setInitializationVector can only be called once");return this.#a=t,this}async encrypt(t,n){if(!this.#t&&!this.#r&&!this.#n)throw new ze("either setProtectedHeader, setUnprotectedHeader, or sharedUnprotectedHeader must be called before #encrypt()");if(!xh(this.#t,this.#r,this.#n))throw new ze("JWE Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint");const i={...this.#t,...this.#r,...this.#n};if(Eh(ze,new Map,n?.crit,this.#t,i),i.zip!==void 0)throw new wn('JWE "zip" (Compression Algorithm) Header Parameter is not supported.');const{alg:r,enc:o}=i;if(typeof r!="string"||!r)throw new ze('JWE "alg" (Algorithm) Header Parameter missing or invalid');if(typeof o!="string"||!o)throw new ze('JWE "enc" (Encryption Algorithm) Header Parameter missing or invalid');let s;if(this.#s&&(r==="dir"||r==="ECDH-ES"))throw new TypeError(`setContentEncryptionKey cannot be called with JWE "alg" (Algorithm) Header ${r}`);Th(r==="dir"?o:r,t,"encrypt");let a;{let y;const v=await ju(t,r);({cek:a,encryptedKey:s,parameters:y}=await M8(r,o,v,this.#s,this.#o)),y&&(n&&U8 in n?this.#r?this.#r={...this.#r,...y}:this.setUnprotectedHeader(y):this.#t?this.#t={...this.#t,...y}:this.setProtectedHeader(y))}let c,l,u,p;if(this.#t?(l=Dn(JSON.stringify(this.#t)),u=fr(l)):(l="",u=new Uint8Array),this.#i){p=Dn(this.#i);const y=fr(p);c=Vi(u,fr("."),y)}else c=u;const{ciphertext:f,tag:g,iv:h}=await C$(o,this.#e,a,this.#a,c),d={ciphertext:Dn(f)};return h&&(d.iv=Dn(h)),g&&(d.tag=Dn(g)),s&&(d.encrypted_key=Dn(s)),p&&(d.aad=p),this.#t&&(d.protected=l),this.#n&&(d.unprotected=this.#n),this.#r&&(d.header=this.#r),d}}function R$(e,t){const n=`SHA-${e.slice(-3)}`;switch(e){case"HS256":case"HS384":case"HS512":return{hash:n,name:"HMAC"};case"PS256":case"PS384":case"PS512":return{hash:n,name:"RSA-PSS",saltLength:parseInt(e.slice(-3),10)>>3};case"RS256":case"RS384":case"RS512":return{hash:n,name:"RSASSA-PKCS1-v1_5"};case"ES256":case"ES384":case"ES512":return{hash:n,name:"ECDSA",namedCurve:t.namedCurve};case"Ed25519":case"EdDSA":return{name:"Ed25519"};case"ML-DSA-44":case"ML-DSA-65":case"ML-DSA-87":return{name:e};default:throw new wn(`alg ${e} is not supported either by JOSE or your javascript runtime`)}}async function P$(e,t,n){if(t instanceof Uint8Array){if(!e.startsWith("HS"))throw new TypeError(Ys(t,"CryptoKey","KeyObject","JSON Web Key"));return crypto.subtle.importKey("raw",t,{hash:`SHA-${e.slice(-3)}`,name:"HMAC"},!1,[n])}return l8(t,e,n),t}async function z8(e,t,n,i){const r=await P$(e,t,"verify");kh(e,r);const o=R$(e,r.algorithm);try{return await crypto.subtle.verify(o,r,n,i)}catch{return!1}}async function B8(e,t,n){if(!pr(e))throw new bn("Flattened JWS must be an object");if(e.protected===void 0&&e.header===void 0)throw new bn('Flattened JWS must have either of the "protected" or "header" members');if(e.protected!==void 0&&typeof e.protected!="string")throw new bn("JWS Protected Header incorrect type");if(e.payload===void 0)throw new bn("JWS Payload missing");if(typeof e.signature!="string")throw new bn("JWS Signature missing or incorrect type");if(e.header!==void 0&&!pr(e.header))throw new bn("JWS Unprotected Header incorrect type");let i={};if(e.protected)try{const y=Pn(e.protected);i=JSON.parse(vo.decode(y))}catch{throw new bn("JWS Protected Header is invalid")}if(!xh(i,e.header))throw new bn("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");const r={...i,...e.header},o=Eh(bn,new Map([["b64",!0]]),n?.crit,i,r);let s=!0;if(o.has("b64")&&(s=i.b64,typeof s!="boolean"))throw new bn('The "b64" (base64url-encode payload) Header Parameter must be a boolean');const{alg:a}=r;if(typeof a!="string"||!a)throw new bn('JWS "alg" (Algorithm) Header Parameter missing or invalid');const c=n&&Xg("algorithms",n.algorithms);if(c&&!c.has(a))throw new Gg('"alg" (Algorithm) Header Parameter value not allowed');if(s){if(typeof e.payload!="string")throw new bn("JWS Payload must be a string")}else if(typeof e.payload!="string"&&!(e.payload instanceof Uint8Array))throw new bn("JWS Payload must be a string or an Uint8Array instance");let l=!1;typeof t=="function"&&(t=await t(i,e),l=!0),Th(a,t,"verify");const u=Vi(e.protected!==void 0?fr(e.protected):new Uint8Array,fr("."),typeof e.payload=="string"?s?fr(e.payload):Sf.encode(e.payload):e.payload);let p;try{p=Pn(e.signature)}catch{throw new bn("Failed to base64url decode the signature")}const f=await ju(t,a);if(!await z8(a,f,p,u))throw new s8;let h;if(s)try{h=Pn(e.payload)}catch{throw new bn("Failed to base64url decode the payload")}else typeof e.payload=="string"?h=Sf.encode(e.payload):h=e.payload;const d={payload:h};return e.protected!==void 0&&(d.protectedHeader=i),e.header!==void 0&&(d.unprotectedHeader=e.header),l?{...d,key:f}:d}async function F8(e,t,n){if(e instanceof Uint8Array&&(e=vo.decode(e)),typeof e!="string")throw new bn("Compact JWS must be a string or Uint8Array");const{0:i,1:r,2:o,length:s}=e.split(".");if(s!==3)throw new bn("Invalid Compact JWS");const a=await B8({payload:r,protected:i,signature:o},t,n),c={payload:a.payload,protectedHeader:a.protectedHeader};return typeof t=="function"?{...c,key:a.key}:c}const Lo=e=>Math.floor(e.getTime()/1e3),D$=60,U$=D$*60,Sb=U$*24,W8=Sb*7,V8=Sb*365.25,q8=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i;function il(e){const t=q8.exec(e);if(!t||t[4]&&t[1])throw new TypeError("Invalid time period format");const n=parseFloat(t[2]),i=t[3].toLowerCase();let r;switch(i){case"sec":case"secs":case"second":case"seconds":case"s":r=Math.round(n);break;case"minute":case"minutes":case"min":case"mins":case"m":r=Math.round(n*D$);break;case"hour":case"hours":case"hr":case"hrs":case"h":r=Math.round(n*U$);break;case"day":case"days":case"d":r=Math.round(n*Sb);break;case"week":case"weeks":case"w":r=Math.round(n*W8);break;default:r=Math.round(n*V8);break}return t[1]==="-"||t[4]==="ago"?-r:r}function fs(e,t){if(!Number.isFinite(t))throw new TypeError(`Invalid ${e} input`);return t}const LS=e=>e.includes("/")?e.toLowerCase():`application/${e.toLowerCase()}`,H8=(e,t)=>typeof e=="string"?t.includes(e):Array.isArray(e)?t.some(Set.prototype.has.bind(new Set(e))):!1;function L$(e,t,n={}){let i;try{i=JSON.parse(vo.decode(t))}catch{}if(!pr(i))throw new Ni("JWT Claims Set must be a top-level JSON object");const{typ:r}=n;if(r&&(typeof e.typ!="string"||LS(e.typ)!==LS(r)))throw new Cr('unexpected "typ" JWT header value',i,"typ","check_failed");const{requiredClaims:o=[],issuer:s,subject:a,audience:c,maxTokenAge:l}=n,u=[...o];l!==void 0&&u.push("iat"),c!==void 0&&u.push("aud"),a!==void 0&&u.push("sub"),s!==void 0&&u.push("iss");for(const h of new Set(u.reverse()))if(!(h in i))throw new Cr(`missing required "${h}" claim`,i,h,"missing");if(s&&!(Array.isArray(s)?s:[s]).includes(i.iss))throw new Cr('unexpected "iss" claim value',i,"iss","check_failed");if(a&&i.sub!==a)throw new Cr('unexpected "sub" claim value',i,"sub","check_failed");if(c&&!H8(i.aud,typeof c=="string"?[c]:c))throw new Cr('unexpected "aud" claim value',i,"aud","check_failed");let p;switch(typeof n.clockTolerance){case"string":p=il(n.clockTolerance);break;case"number":p=n.clockTolerance;break;case"undefined":p=0;break;default:throw new TypeError("Invalid clockTolerance option type")}const{currentDate:f}=n,g=Lo(f||new Date);if((i.iat!==void 0||l)&&typeof i.iat!="number")throw new Cr('"iat" claim must be a number',i,"iat","invalid");if(i.nbf!==void 0){if(typeof i.nbf!="number")throw new Cr('"nbf" claim must be a number',i,"nbf","invalid");if(i.nbf>g+p)throw new Cr('"nbf" claim timestamp check failed',i,"nbf","check_failed")}if(i.exp!==void 0){if(typeof i.exp!="number")throw new Cr('"exp" claim must be a number',i,"exp","invalid");if(i.exp<=g-p)throw new Jg('"exp" claim timestamp check failed',i,"exp","check_failed")}if(l){const h=g-i.iat,d=typeof l=="number"?l:il(l);if(h-p>d)throw new Jg('"iat" claim timestamp check failed (too far in the past)',i,"iat","check_failed");if(h<0-p)throw new Cr('"iat" claim timestamp check failed (it should be in the past)',i,"iat","check_failed")}return i}class M${#e;constructor(t){if(!pr(t))throw new TypeError("JWT Claims Set MUST be an object");this.#e=structuredClone(t)}data(){return Sf.encode(JSON.stringify(this.#e))}get iss(){return this.#e.iss}set iss(t){this.#e.iss=t}get sub(){return this.#e.sub}set sub(t){this.#e.sub=t}get aud(){return this.#e.aud}set aud(t){this.#e.aud=t}set jti(t){this.#e.jti=t}set nbf(t){typeof t=="number"?this.#e.nbf=fs("setNotBefore",t):t instanceof Date?this.#e.nbf=fs("setNotBefore",Lo(t)):this.#e.nbf=Lo(new Date)+il(t)}set exp(t){typeof t=="number"?this.#e.exp=fs("setExpirationTime",t):t instanceof Date?this.#e.exp=fs("setExpirationTime",Lo(t)):this.#e.exp=Lo(new Date)+il(t)}set iat(t){t===void 0?this.#e.iat=Lo(new Date):t instanceof Date?this.#e.iat=fs("setIssuedAt",Lo(t)):typeof t=="string"?this.#e.iat=fs("setIssuedAt",Lo(new Date)+il(t)):this.#e.iat=fs("setIssuedAt",t)}}async function vc(e,t,n){const i=await F8(e,t,n);if(i.protectedHeader.crit?.includes("b64")&&i.protectedHeader.b64===!1)throw new Ni("JWTs MUST NOT use unencoded payload");const o={payload:L$(i.protectedHeader,i.payload,n),protectedHeader:i.protectedHeader};return typeof t=="function"?{...o,key:i.key}:o}async function K8(e,t,n){const i=await D8(e,t,n),r=L$(i.protectedHeader,i.plaintext,n),{protectedHeader:o}=i;if(o.iss!==void 0&&o.iss!==r.iss)throw new Cr('replicated "iss" claim header parameter mismatch',r,"iss","mismatch");if(o.sub!==void 0&&o.sub!==r.sub)throw new Cr('replicated "sub" claim header parameter mismatch',r,"sub","mismatch");if(o.aud!==void 0&&JSON.stringify(o.aud)!==JSON.stringify(r.aud))throw new Cr('replicated "aud" claim header parameter mismatch',r,"aud","mismatch");const s={payload:r,protectedHeader:o};return typeof t=="function"?{...s,key:i.key}:s}class J8{#e;constructor(t){this.#e=new j8(t)}setContentEncryptionKey(t){return this.#e.setContentEncryptionKey(t),this}setInitializationVector(t){return this.#e.setInitializationVector(t),this}setProtectedHeader(t){return this.#e.setProtectedHeader(t),this}setKeyManagementParameters(t){return this.#e.setKeyManagementParameters(t),this}async encrypt(t,n){const i=await this.#e.encrypt(t,n);return[i.protected,i.encrypted_key,i.iv,i.ciphertext,i.tag].join(".")}}async function G8(e,t,n){const i=await P$(e,t,"sign");kh(e,i);const r=await crypto.subtle.sign(R$(e,i.algorithm),i,n);return new Uint8Array(r)}class Z8{#e;#t;#n;constructor(t){if(!(t instanceof Uint8Array))throw new TypeError("payload must be an instance of Uint8Array");this.#e=t}setProtectedHeader(t){if(this.#t)throw new TypeError("setProtectedHeader can only be called once");return this.#t=t,this}setUnprotectedHeader(t){if(this.#n)throw new TypeError("setUnprotectedHeader can only be called once");return this.#n=t,this}async sign(t,n){if(!this.#t&&!this.#n)throw new bn("either setProtectedHeader or setUnprotectedHeader must be called before #sign()");if(!xh(this.#t,this.#n))throw new bn("JWS Protected and JWS Unprotected Header Parameter names must be disjoint");const i={...this.#t,...this.#n},r=Eh(bn,new Map([["b64",!0]]),n?.crit,this.#t,i);let o=!0;if(r.has("b64")&&(o=this.#t.b64,typeof o!="boolean"))throw new bn('The "b64" (base64url-encode payload) Header Parameter must be a boolean');const{alg:s}=i;if(typeof s!="string"||!s)throw new bn('JWS "alg" (Algorithm) Header Parameter missing or invalid');Th(s,t,"sign");let a,c;o?(a=Dn(this.#e),c=fr(a)):(c=this.#e,a="");let l,u;this.#t?(l=Dn(JSON.stringify(this.#t)),u=fr(l)):(l="",u=new Uint8Array);const p=Vi(u,fr("."),c),f=await ju(t,s),g=await G8(s,f,p),h={signature:Dn(g),payload:a};return this.#n&&(h.header=this.#n),this.#t&&(h.protected=l),h}}class Q8{#e;constructor(t){this.#e=new Z8(t)}setProtectedHeader(t){return this.#e.setProtectedHeader(t),this}async sign(t,n){const i=await this.#e.sign(t,n);if(i.payload===void 0)throw new TypeError("use the flattened module for creating JWS with b64: false");return`${i.protected}.${i.payload}.${i.signature}`}}class Y8{#e;#t;constructor(t={}){this.#t=new M$(t)}setIssuer(t){return this.#t.iss=t,this}setSubject(t){return this.#t.sub=t,this}setAudience(t){return this.#t.aud=t,this}setJti(t){return this.#t.jti=t,this}setNotBefore(t){return this.#t.nbf=t,this}setExpirationTime(t){return this.#t.exp=t,this}setIssuedAt(t){return this.#t.iat=t,this}setProtectedHeader(t){return this.#e=t,this}async sign(t,n){const i=new Q8(this.#t.data());if(i.setProtectedHeader(this.#e),Array.isArray(this.#e?.crit)&&this.#e.crit.includes("b64")&&this.#e.b64===!1)throw new Ni("JWTs MUST NOT use unencoded payload");return i.sign(t,n)}}class X8{#e;#t;#n;#r;#i;#s;#a;#o;constructor(t={}){this.#o=new M$(t)}setIssuer(t){return this.#o.iss=t,this}setSubject(t){return this.#o.sub=t,this}setAudience(t){return this.#o.aud=t,this}setJti(t){return this.#o.jti=t,this}setNotBefore(t){return this.#o.nbf=t,this}setExpirationTime(t){return this.#o.exp=t,this}setIssuedAt(t){return this.#o.iat=t,this}setProtectedHeader(t){if(this.#r)throw new TypeError("setProtectedHeader can only be called once");return this.#r=t,this}setKeyManagementParameters(t){if(this.#n)throw new TypeError("setKeyManagementParameters can only be called once");return this.#n=t,this}setContentEncryptionKey(t){if(this.#e)throw new TypeError("setContentEncryptionKey can only be called once");return this.#e=t,this}setInitializationVector(t){if(this.#t)throw new TypeError("setInitializationVector can only be called once");return this.#t=t,this}replicateIssuerAsHeader(){return this.#i=!0,this}replicateSubjectAsHeader(){return this.#s=!0,this}replicateAudienceAsHeader(){return this.#a=!0,this}async encrypt(t,n){const i=new J8(this.#o.data());return this.#r&&(this.#i||this.#s||this.#a)&&(this.#r={...this.#r,iss:this.#i?this.#o.iss:void 0,sub:this.#s?this.#o.sub:void 0,aud:this.#a?this.#o.aud:void 0}),i.setProtectedHeader(this.#r),this.#t&&i.setInitializationVector(this.#t),this.#e&&i.setContentEncryptionKey(this.#e),this.#n&&i.setKeyManagementParameters(this.#n),i.encrypt(t,n)}}const Ai=(e,t)=>{if(typeof e!="string"||!e)throw new r8(`${t} missing or invalid`)};async function j$(e,t){let n;if(Ah(e))n=e;else if(bb(e))n=await O$(e);else throw new TypeError(Ys(e,"CryptoKey","KeyObject","JSON Web Key"));if(t??="sha256",t!=="sha256"&&t!=="sha384"&&t!=="sha512")throw new TypeError('digestAlgorithm must one of "sha256", "sha384", or "sha512"');let i;switch(n.kty){case"AKP":Ai(n.alg,'"alg" (Algorithm) Parameter'),Ai(n.pub,'"pub" (Public key) Parameter'),i={alg:n.alg,kty:n.kty,pub:n.pub};break;case"EC":Ai(n.crv,'"crv" (Curve) Parameter'),Ai(n.x,'"x" (X Coordinate) Parameter'),Ai(n.y,'"y" (Y Coordinate) Parameter'),i={crv:n.crv,kty:n.kty,x:n.x,y:n.y};break;case"OKP":Ai(n.crv,'"crv" (Subtype of Key Pair) Parameter'),Ai(n.x,'"x" (Public Key) Parameter'),i={crv:n.crv,kty:n.kty,x:n.x};break;case"RSA":Ai(n.e,'"e" (Exponent) Parameter'),Ai(n.n,'"n" (Modulus) Parameter'),i={e:n.e,kty:n.kty,n:n.n};break;case"oct":Ai(n.k,'"k" (Key Value) Parameter'),i={k:n.k,kty:n.kty};break;default:throw new wn('"kty" (Key Type) Parameter missing or unsupported')}const r=fr(JSON.stringify(i));return Dn(await A$(t,r))}function eF(e){switch(typeof e=="string"&&e.slice(0,2)){case"RS":case"PS":return"RSA";case"ES":return"EC";case"Ed":return"OKP";case"ML":return"AKP";default:throw new wn('Unsupported "alg" value for a JSON Web Key Set')}}function tF(e){return e&&typeof e=="object"&&Array.isArray(e.keys)&&e.keys.every(nF)}function nF(e){return pr(e)}class rF{#e;#t=new WeakMap;constructor(t){if(!tF(t))throw new g$("JSON Web Key Set malformed");this.#e=structuredClone(t)}jwks(){return this.#e}async getKey(t,n){const{alg:i,kid:r}={...t,...n?.header},o=eF(i),s=this.#e.keys.filter(l=>{let u=o===l.kty;if(u&&typeof r=="string"&&(u=r===l.kid),u&&(typeof l.alg=="string"||o==="AKP")&&(u=i===l.alg),u&&typeof l.use=="string"&&(u=l.use==="sig"),u&&Array.isArray(l.key_ops)&&(u=l.key_ops.includes("verify")),u)switch(i){case"ES256":u=l.crv==="P-256";break;case"ES384":u=l.crv==="P-384";break;case"ES512":u=l.crv==="P-521";break;case"Ed25519":case"EdDSA":u=l.crv==="Ed25519";break}return u}),{0:a,length:c}=s;if(c===0)throw new y$;if(c!==1){const l=new i8,u=this.#t;throw l[Symbol.asyncIterator]=async function*(){for(const p of s)try{yield await MS(u,p,i)}catch{}},l}return MS(this.#t,a,i)}}async function MS(e,t,n){const i=e.get(t)||e.set(t,{}).get(t);if(i[n]===void 0){const r=await Mu({...t,ext:!0},n);if(r instanceof Uint8Array||r.type!=="public")throw new g$("JSON Web Key Set members must be public keys");i[n]=r}return i[n]}function jS(e){const t=new rF(e),n=async(i,r)=>t.getKey(i,r);return Object.defineProperties(n,{jwks:{value:()=>structuredClone(t.jwks()),enumerable:!1,configurable:!1,writable:!1}}),n}function iF(){return typeof WebSocketPair<"u"||typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"||typeof EdgeRuntime<"u"&&EdgeRuntime==="vercel"}let ty;(typeof navigator>"u"||!navigator.userAgent?.startsWith?.("Mozilla/5.0 "))&&(ty="jose/v6.1.3");const oF=Symbol();async function sF(e,t,n,i=fetch){const r=await i(e,{method:"GET",signal:n,redirect:"manual",headers:t}).catch(o=>{throw o.name==="TimeoutError"?new o8:o});if(r.status!==200)throw new ir("Expected 200 OK from the JSON Web Key Set HTTP response");try{return await r.json()}catch{throw new ir("Failed to parse the JSON Web Key Set HTTP response as JSON")}}const eg=Symbol();function aF(e,t){return!(typeof e!="object"||e===null||!("uat"in e)||typeof e.uat!="number"||Date.now()-e.uat>=t||!("jwks"in e)||!pr(e.jwks)||!Array.isArray(e.jwks.keys)||!Array.prototype.every.call(e.jwks.keys,pr))}class cF{#e;#t;#n;#r;#i;#s;#a;#o;#c;#l;constructor(t,n){if(!(t instanceof URL))throw new TypeError("url must be an instance of URL");this.#e=new URL(t.href),this.#t=typeof n?.timeoutDuration=="number"?n?.timeoutDuration:5e3,this.#n=typeof n?.cooldownDuration=="number"?n?.cooldownDuration:3e4,this.#r=typeof n?.cacheMaxAge=="number"?n?.cacheMaxAge:6e5,this.#a=new Headers(n?.headers),ty&&!this.#a.has("User-Agent")&&this.#a.set("User-Agent",ty),this.#a.has("accept")||(this.#a.set("accept","application/json"),this.#a.append("accept","application/jwk-set+json")),this.#o=n?.[oF],n?.[eg]!==void 0&&(this.#l=n?.[eg],aF(n?.[eg],this.#r)&&(this.#i=this.#l.uat,this.#c=jS(this.#l.jwks)))}pendingFetch(){return!!this.#s}coolingDown(){return typeof this.#i=="number"?Date.now()<this.#i+this.#n:!1}fresh(){return typeof this.#i=="number"?Date.now()<this.#i+this.#r:!1}jwks(){return this.#c?.jwks()}async getKey(t,n){(!this.#c||!this.fresh())&&await this.reload();try{return await this.#c(t,n)}catch(i){if(i instanceof y$&&this.coolingDown()===!1)return await this.reload(),this.#c(t,n);throw i}}async reload(){this.#s&&iF()&&(this.#s=void 0),this.#s||=sF(this.#e.href,this.#a,AbortSignal.timeout(this.#t),this.#o).then(t=>{this.#c=jS(t),this.#l&&(this.#l.uat=Date.now(),this.#l.jwks=t),this.#i=Date.now(),this.#s=void 0}).catch(t=>{throw this.#s=void 0,t}),await this.#s}}function lF(e,t){const n=new cF(e,t),i=async(r,o)=>n.getKey(r,o);return Object.defineProperties(i,{coolingDown:{get:()=>n.coolingDown(),enumerable:!0,configurable:!1},fresh:{get:()=>n.fresh(),enumerable:!0,configurable:!1},reload:{value:()=>n.reload(),enumerable:!0,configurable:!1,writable:!1},reloading:{get:()=>n.pendingFetch(),enumerable:!0,configurable:!1},jwks:{value:()=>n.jwks(),enumerable:!0,configurable:!1,writable:!1}}),i}function xb(e){let t;if(typeof e=="string"){const n=e.split(".");(n.length===3||n.length===5)&&([t]=n)}else if(typeof e=="object"&&e)if("protected"in e)t=e.protected;else throw new TypeError("Token does not contain a Protected Header");try{if(typeof t!="string"||!t)throw new Error;const n=JSON.parse(vo.decode(Pn(t)));if(!pr(n))throw new Error;return n}catch{throw new TypeError("Invalid Token or Protected Header formatting")}}function Ao(e){if(typeof e!="string")throw new Ni("JWTs must use Compact JWS serialization, JWT must be a string");const{1:t,length:n}=e.split(".");if(n===5)throw new Ni("Only JWTs using Compact JWS serialization can be decoded");if(n!==3)throw new Ni("Invalid JWT");if(!t)throw new Ni("JWTs must contain a payload");let i;try{i=Pn(t)}catch{throw new Ni("Failed to base64url decode the payload")}let r;try{r=JSON.parse(vo.decode(i))}catch{throw new Ni("Failed to parse the decoded payload as JSON")}if(!pr(r))throw new Ni("Invalid JWT Claims Set");return r}async function z$(e,t,n=3600){return await new Y8(e).setProtectedHeader({alg:"HS256"}).setIssuedAt().setExpirationTime(Math.floor(Date.now()/1e3)+n).sign(new TextEncoder().encode(t))}async function uF(e,t){try{return(await vc(e,new TextEncoder().encode(t))).payload}catch{return null}}const B$=new Uint8Array([66,101,116,116,101,114,65,117,116,104,46,106,115,32,71,101,110,101,114,97,116,101,100,32,69,110,99,114,121,112,116,105,111,110,32,75,101,121]),dF=()=>Date.now()/1e3|0,F$="dir",W$="A256CBC-HS512";async function V$(e,t,n,i=3600){const r=h$(Sh,new TextEncoder().encode(t),new TextEncoder().encode(n),B$,64),o=await j$({kty:"oct",k:Dn(r)},"sha256");return await new X8(e).setProtectedHeader({alg:F$,enc:W$,kid:o}).setIssuedAt().setExpirationTime(dF()+i).setJti(crypto.randomUUID()).encrypt(r)}async function q$(e,t,n){if(!e)return null;try{const{payload:i}=await K8(e,async({kid:r})=>{const o=h$(Sh,new TextEncoder().encode(t),new TextEncoder().encode(n),B$,64);if(r===void 0||r===await j$({kty:"oct",k:Dn(o)},"sha256"))return o;throw new Error("no matching decryption secret")},{clockTolerance:15,keyManagementAlgorithms:[F$],contentEncryptionAlgorithms:[W$,"A256GCM"]});return i}catch{return null}}function fF(e,t){if(!e||!t)return e;const n=Object.entries(t).filter(([,{returned:i}])=>i===!1).map(([i])=>i);return Object.entries(structuredClone(e)).filter(([i])=>!n.includes(i)).reduce((i,[r,o])=>({...i,[r]:o}),{})}function H$(e,t,n){let i=!1;return function(...r){return i||((n?.warn??console.warn)(`[Deprecation] ${t}`),i=!0),e.apply(this,r)}}const Al=e=>gb("a-z","A-Z","0-9")(e||32);function pF(e){return Ls().safeParse(e).success||Su().safeParse(e).success}function hF(e){return Su().safeParse(e).success}function mF(e){const t=e.toLowerCase();if(t.startsWith("::ffff:")){const i=t.substring(7);if(Ls().safeParse(i).success)return i}const n=e.split(":");if(n.length===7&&n[5]?.toLowerCase()==="ffff"){const i=n[6];if(i&&Ls().safeParse(i).success)return i}if(t.includes("::ffff:")||t.includes(":ffff:")){const i=K$(e);if(i.length===8&&i[0]==="0000"&&i[1]==="0000"&&i[2]==="0000"&&i[3]==="0000"&&i[4]==="0000"&&i[5]==="ffff"&&i[6]&&i[7])return`${Number.parseInt(i[6].substring(0,2),16)}.${Number.parseInt(i[6].substring(2,4),16)}.${Number.parseInt(i[7].substring(0,2),16)}.${Number.parseInt(i[7].substring(2,4),16)}`}return null}function K$(e){if(e.includes("::")){const t=e.split("::"),n=t[0]?t[0].split(":"):[],i=t[1]?t[1].split(":"):[],r=8-n.length-i.length,o=Array(r).fill("0000"),s=n.map(c=>c.padStart(4,"0")),a=i.map(c=>c.padStart(4,"0"));return[...s,...o,...a]}return e.split(":").map(t=>t.padStart(4,"0"))}function gF(e,t){const n=K$(e);if(t<128){let i=t;return n.map(r=>{if(i<=0)return"0000";if(i>=16)return i-=16,r;const o=Number.parseInt(r,16)&(65535<<16-i&65535);return i=0,o.toString(16).padStart(4,"0")}).join(":").toLowerCase()}return n.join(":").toLowerCase()}function yF(e,t={}){if(Ls().safeParse(e).success||!hF(e))return e.toLowerCase();const n=mF(e);return n?n.toLowerCase():gF(e,t.ipv6Subnet||64)}function wF(e,t){return`${e}|${t}`}const Wd=Object.create(null),Fc=e=>globalThis.process?.env||globalThis.Deno?.env.toObject()||globalThis.__env__||(e?Wd:globalThis),qt=new Proxy(Wd,{get(e,t){return Fc()[t]??Wd[t]},has(e,t){return t in Fc()||t in Wd},set(e,t,n){const i=Fc(!0);return i[t]=n,!0},deleteProperty(e,t){if(!t)return!1;const n=Fc(!0);return delete n[t],!0},ownKeys(){const e=Fc(!0);return Object.keys(e)}});function vF(e){return e?e!=="false":!1}const Ef=typeof process<"u"&&process.env&&"production"||"",Ih=Ef==="production",kb=()=>Ef==="dev"||Ef==="development",zu=()=>Ef==="test"||vF(qt.TEST);function Pt(e,t){return typeof process<"u"&&process.env?process.env[e]??t:typeof Deno<"u"?Deno.env.get(e)??t:typeof Bun<"u"?Bun.env[e]??t:t}function zS(e,t=!0){const n=Pt(e);return n?n!=="0"&&n.toLowerCase()!=="false"&&n!=="":t}const bF=Object.freeze({get BETTER_AUTH_SECRET(){return Pt("BETTER_AUTH_SECRET")},get AUTH_SECRET(){return Pt("AUTH_SECRET")},get BETTER_AUTH_TELEMETRY(){return Pt("BETTER_AUTH_TELEMETRY")},get BETTER_AUTH_TELEMETRY_ID(){return Pt("BETTER_AUTH_TELEMETRY_ID")},get NODE_ENV(){return Pt("NODE_ENV","development")},get PACKAGE_VERSION(){return Pt("PACKAGE_VERSION","0.0.0")},get BETTER_AUTH_TELEMETRY_ENDPOINT(){return Pt("BETTER_AUTH_TELEMETRY_ENDPOINT","")}}),Wc=1,Cn=4,Ci=8,Ur=24,BS={eterm:Cn,cons25:Cn,console:Cn,cygwin:Cn,dtterm:Cn,gnome:Cn,hurd:Cn,jfbterm:Cn,konsole:Cn,kterm:Cn,mlterm:Cn,mosh:Ur,putty:Cn,st:Cn,"rxvt-unicode-24bit":Ur,terminator:Ur,"xterm-kitty":Ur},_F=new Map(Object.entries({APPVEYOR:Ci,BUILDKITE:Ci,CIRCLECI:Ur,DRONE:Ci,GITEA_ACTIONS:Ur,GITHUB_ACTIONS:Ur,GITLAB_CI:Ci,TRAVIS:Ci})),SF=[/ansi/,/color/,/linux/,/direct/,/^con[0-9]*x[0-9]/,/^rxvt/,/^screen/,/^xterm/,/^vt100/,/^vt220/];function J$(){if(Pt("FORCE_COLOR")!==void 0)switch(Pt("FORCE_COLOR")){case"":case"1":case"true":return Cn;case"2":return Ci;case"3":return Ur;default:return Wc}if(Pt("NODE_DISABLE_COLORS")!==void 0&&Pt("NODE_DISABLE_COLORS")!==""||Pt("NO_COLOR")!==void 0&&Pt("NO_COLOR")!==""||Pt("TERM")==="dumb")return Wc;if(Pt("TMUX"))return Ur;if("TF_BUILD"in qt&&"AGENT_NAME"in qt)return Cn;if("CI"in qt){for(const{0:e,1:t}of _F)if(e in qt)return t;return Pt("CI_NAME")==="codeship"?Ci:Wc}if("TEAMCITY_VERSION"in qt)return/^(9\.(0*[1-9]\d*)\.|\d{2,}\.)/.exec(Pt("TEAMCITY_VERSION"))!==null?Cn:Wc;switch(Pt("TERM_PROGRAM")){case"iTerm.app":return!Pt("TERM_PROGRAM_VERSION")||/^[0-2]\./.exec(Pt("TERM_PROGRAM_VERSION"))!==null?Ci:Ur;case"HyperTerm":case"MacTerm":return Ur;case"Apple_Terminal":return Ci}if(Pt("COLORTERM")==="truecolor"||Pt("COLORTERM")==="24bit")return Ur;if(Pt("TERM")){if(/truecolor/.exec(Pt("TERM"))!==null)return Ur;if(/^xterm-256/.exec(Pt("TERM"))!==null)return Ci;const e=Pt("TERM").toLowerCase();if(BS[e])return BS[e];if(SF.some(t=>t.exec(e)!==null))return Cn}return Pt("COLORTERM")?Cn:Wc}const Nn={reset:"\x1B[0m",bright:"\x1B[1m",dim:"\x1B[2m",fg:{red:"\x1B[31m",green:"\x1B[32m",yellow:"\x1B[33m",blue:"\x1B[34m",magenta:"\x1B[35m"},bg:{black:"\x1B[40m"}},ny=["debug","info","success","warn","error"];function Nh(e,t){return ny.indexOf(t)>=ny.indexOf(e)}const xF={info:Nn.fg.blue,success:Nn.fg.green,warn:Nn.fg.yellow,error:Nn.fg.red,debug:Nn.fg.magenta},kF=(e,t,n)=>{const i=new Date().toISOString();return n?`${Nn.dim}${i}${Nn.reset} ${xF[e]}${e.toUpperCase()}${Nn.reset} ${Nn.bright}[Better Auth]:${Nn.reset} ${t}`:`${i} ${e.toUpperCase()} [Better Auth]: ${t}`},Tl=e=>{const t=e?.disabled!==!0,n=e?.level??"warn",i=e?.disableColors!==void 0?!e.disableColors:J$()!==1,r=(o,s,a=[])=>{if(!t||!Nh(n,o))return;const c=kF(o,s,i);if(!e||typeof e.log!="function"){o==="error"?console.error(c,...a):o==="warn"?console.warn(c,...a):console.log(c,...a);return}e.log(o==="success"?"info":o,s,...a)};return{...Object.fromEntries(ny.map(o=>[o,(...[s,...a])=>r(o,s,a)])),get level(){return n}}},Qe=Tl();function tr(e){function t(n,i){if(typeof i=="string"&&/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:\.\d+)?Z$/.test(i)){const r=new Date(i);if(!isNaN(r.getTime()))return r}return i}try{return typeof e!="string"?e:JSON.parse(e,t)}catch(n){return Qe.error("Error parsing JSON",{error:n}),null}}function Eb(e,t){let n;try{n=new URL(e).pathname.replace(/\/+$/,"")||"/"}catch{return"/"}return t==="/"||t===""?n:n===t?"/":n.startsWith(t+"/")?n.slice(t.length).replace(/\/+$/,"")||"/":n}const Re={USER_NOT_FOUND:"User not found",FAILED_TO_CREATE_USER:"Failed to create user",FAILED_TO_CREATE_SESSION:"Failed to create session",FAILED_TO_UPDATE_USER:"Failed to update user",FAILED_TO_GET_SESSION:"Failed to get session",INVALID_PASSWORD:"Invalid password",INVALID_EMAIL:"Invalid email",INVALID_EMAIL_OR_PASSWORD:"Invalid email or password",SOCIAL_ACCOUNT_ALREADY_LINKED:"Social account already linked",PROVIDER_NOT_FOUND:"Provider not found",INVALID_TOKEN:"Invalid token",ID_TOKEN_NOT_SUPPORTED:"id_token not supported",FAILED_TO_GET_USER_INFO:"Failed to get user info",USER_EMAIL_NOT_FOUND:"User email not found",EMAIL_NOT_VERIFIED:"Email not verified",PASSWORD_TOO_SHORT:"Password too short",PASSWORD_TOO_LONG:"Password too long",USER_ALREADY_EXISTS:"User already exists.",USER_ALREADY_EXISTS_USE_ANOTHER_EMAIL:"User already exists. Use another email.",EMAIL_CAN_NOT_BE_UPDATED:"Email can not be updated",CREDENTIAL_ACCOUNT_NOT_FOUND:"Credential account not found",SESSION_EXPIRED:"Session expired. Re-authenticate to perform this action.",FAILED_TO_UNLINK_LAST_ACCOUNT:"You can't unlink your last account",ACCOUNT_NOT_FOUND:"Account not found",USER_ALREADY_HAS_PASSWORD:"User already has a password. Provide that to delete the account.",CROSS_SITE_NAVIGATION_LOGIN_BLOCKED:"Cross-site navigation login blocked. This request appears to be a CSRF attack.",VERIFICATION_EMAIL_NOT_ENABLED:"Verification email isn't enabled",EMAIL_ALREADY_VERIFIED:"Email is already verified",EMAIL_MISMATCH:"Email mismatch",SESSION_NOT_FRESH:"Session is not fresh",LINKED_ACCOUNT_ALREADY_EXISTS:"Linked account already exists",INVALID_ORIGIN:"Invalid origin",INVALID_CALLBACK_URL:"Invalid callbackURL",INVALID_REDIRECT_URL:"Invalid redirectURL",INVALID_ERROR_CALLBACK_URL:"Invalid errorCallbackURL",INVALID_NEW_USER_CALLBACK_URL:"Invalid newUserCallbackURL",MISSING_OR_NULL_ORIGIN:"Missing or null Origin",CALLBACK_URL_REQUIRED:"callbackURL is required",FAILED_TO_CREATE_VERIFICATION:"Unable to create verification",FIELD_NOT_ALLOWED:"Field not allowed to be set",ASYNC_VALIDATION_NOT_SUPPORTED:"Async validation is not supported",VALIDATION_ERROR:"Validation Error",MISSING_FIELD:"Field is required"};var Fe=class extends Error{constructor(e,t){super(e,t),this.name="BetterAuthError",this.message=e,this.stack=""}};const EF="0123456789abcdef",Af={encode:e=>{if(typeof e=="string"&&(e=new TextEncoder().encode(e)),e.byteLength===0)return"";const t=new Uint8Array(e);let n="";for(const i of t)n+=i.toString(16).padStart(2,"0");return n},decode:e=>{if(!e)return"";if(typeof e=="string"){if(e.length%2!==0)throw new Error("Invalid hexadecimal string");if(!new RegExp(`^[${EF}]+$`).test(e))throw new Error("Invalid hexadecimal string");const t=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2)t[n/2]=parseInt(e.slice(n,n+2),16);return new TextDecoder().decode(t)}return new TextDecoder().decode(e)}};function AF(e,t,n,i){bh(e);const r=f$({dkLen:32,asyncTick:10},i),{c:o,dkLen:s,asyncTick:a}=r;if(Xr(o,"c"),Xr(s,"dkLen"),Xr(a,"asyncTick"),o<1)throw new Error("iterations (c) must be >= 1");const c=PS(t,"password"),l=PS(n,"salt"),u=new Uint8Array(s),p=_h.create(e,c),f=p._cloneInto().update(l);return{c:o,dkLen:s,asyncTick:a,DK:u,PRF:p,PRFSalt:f}}function TF(e,t,n,i,r){return e.destroy(),t.destroy(),i&&i.destroy(),zs(r),n}function G$(e,t,n,i){const{c:r,dkLen:o,DK:s,PRF:a,PRFSalt:c}=AF(e,t,n,i);let l;const u=new Uint8Array(4),p=zd(u),f=new Uint8Array(a.outputLen);for(let g=1,h=0;h<o;g++,h+=a.outputLen){const d=s.subarray(h,h+a.outputLen);p.setInt32(0,g,!1),(l=c._cloneInto(l)).update(u).digestInto(f),d.set(f.subarray(0,d.length));for(let y=1;y<r;y++){a._cloneInto(l).update(f).digestInto(f);for(let v=0;v<d.length;v++)d[v]^=f[v]}}return TF(a,c,s,l,f)}function FS(e,t,n,i,r,o){let s=e[t++]^n[i++],a=e[t++]^n[i++],c=e[t++]^n[i++],l=e[t++]^n[i++],u=e[t++]^n[i++],p=e[t++]^n[i++],f=e[t++]^n[i++],g=e[t++]^n[i++],h=e[t++]^n[i++],d=e[t++]^n[i++],y=e[t++]^n[i++],v=e[t++]^n[i++],x=e[t++]^n[i++],E=e[t++]^n[i++],N=e[t++]^n[i++],C=e[t++]^n[i++],b=s,P=a,$=c,k=l,D=u,B=p,J=f,S=g,T=h,z=d,L=y,q=v,V=x,K=E,oe=N,ne=C;for(let X=0;X<8;X+=2)D^=Tt(b+V|0,7),T^=Tt(D+b|0,9),V^=Tt(T+D|0,13),b^=Tt(V+T|0,18),z^=Tt(B+P|0,7),K^=Tt(z+B|0,9),P^=Tt(K+z|0,13),B^=Tt(P+K|0,18),oe^=Tt(L+J|0,7),$^=Tt(oe+L|0,9),J^=Tt($+oe|0,13),L^=Tt(J+$|0,18),k^=Tt(ne+q|0,7),S^=Tt(k+ne|0,9),q^=Tt(S+k|0,13),ne^=Tt(q+S|0,18),P^=Tt(b+k|0,7),$^=Tt(P+b|0,9),k^=Tt($+P|0,13),b^=Tt(k+$|0,18),J^=Tt(B+D|0,7),S^=Tt(J+B|0,9),D^=Tt(S+J|0,13),B^=Tt(D+S|0,18),q^=Tt(L+z|0,7),T^=Tt(q+L|0,9),z^=Tt(T+q|0,13),L^=Tt(z+T|0,18),V^=Tt(ne+oe|0,7),K^=Tt(V+ne|0,9),oe^=Tt(K+V|0,13),ne^=Tt(oe+K|0,18);r[o++]=s+b|0,r[o++]=a+P|0,r[o++]=c+$|0,r[o++]=l+k|0,r[o++]=u+D|0,r[o++]=p+B|0,r[o++]=f+J|0,r[o++]=g+S|0,r[o++]=h+T|0,r[o++]=d+z|0,r[o++]=y+L|0,r[o++]=v+q|0,r[o++]=x+V|0,r[o++]=E+K|0,r[o++]=N+oe|0,r[o++]=C+ne|0}function tg(e,t,n,i,r){let o=i+0,s=i+16*r;for(let a=0;a<16;a++)n[s+a]=e[t+(2*r-1)*16+a];for(let a=0;a<r;a++,o+=16,t+=16)FS(n,s,e,t,n,o),a>0&&(s+=16),FS(n,o,e,t+=16,n,s)}function IF(e,t,n){const i=f$({dkLen:32,asyncTick:10,maxmem:1073742848},n),{N:r,r:o,p:s,dkLen:a,asyncTick:c,maxmem:l,onProgress:u}=i;if(Xr(r,"N"),Xr(o,"r"),Xr(s,"p"),Xr(a,"dkLen"),Xr(c,"asyncTick"),Xr(l,"maxmem"),u!==void 0&&typeof u!="function")throw new Error("progressCb must be a function");const p=128*o,f=p/4,g=Math.pow(2,32);if(r<=1||(r&r-1)!==0||r>g)throw new Error('"N" expected a power of 2, and 2^1 <= N <= 2^32');if(s<1||s>(g-1)*32/p)throw new Error('"p" expected integer 1..((2^32 - 1) * 32) / (128 * r)');if(a<1||a>(g-1)*32)throw new Error('"dkLen" expected integer 1..(2^32 - 1) * 32');if(p*(r+s)>l)throw new Error('"maxmem" limit was hit, expected 128*r*(N+p) <= "maxmem"='+l);const d=G$(Sh,e,t,{c:1,dkLen:p*s}),y=Qm(d),v=Qm(new Uint8Array(p*r)),x=Qm(new Uint8Array(p));let E=()=>{};if(u){const N=2*r*s,C=Math.max(Math.floor(N/1e4),1);let b=0;E=()=>{b++,u&&(!(b%C)||b===N)&&u(b/N)}}return{N:r,r:o,p:s,dkLen:a,blockSize32:f,V:v,B32:y,B:d,tmp:x,blockMixCb:E,asyncTick:c}}function NF(e,t,n,i,r){const o=G$(Sh,e,n,{c:1,dkLen:t});return zs(n,i,r),o}async function $F(e,t,n){const{N:i,r,p:o,dkLen:s,blockSize32:a,V:c,B32:l,B:u,tmp:p,blockMixCb:f,asyncTick:g}=IF(e,t,n);CS(l);for(let h=0;h<o;h++){const d=a*h;for(let v=0;v<a;v++)c[v]=l[d+v];let y=0;await RS(i-1,g,()=>{tg(c,y,c,y+=a,r),f()}),tg(c,(i-1)*a,l,d,r),f(),await RS(i,g,()=>{const v=(l[d+a-16]&i-1)>>>0;for(let x=0;x<a;x++)p[x]=l[d+x]^c[v*a+x];tg(p,0,l,d,r),f()})}return CS(l),NF(e,s,u,c,p)}const wa={N:16384,r:16,p:1,dkLen:64};async function Z$(e,t){return await $F(e.normalize("NFKC"),t,{N:wa.N,p:wa.p,r:wa.r,dkLen:wa.dkLen,maxmem:128*wa.N*wa.r*2})}const CF=async e=>{const t=Af.encode(crypto.getRandomValues(new Uint8Array(16))),n=await Z$(e,t);return`${t}:${Af.encode(n)}`},OF=async({hash:e,password:t})=>{const[n,i]=e.split(":");if(!n||!i)throw new Fe("Invalid password hash");return DB(await Z$(t,n),FB(i))};function $s(){const e=typeof globalThis<"u"&&globalThis.crypto;if(e&&typeof e.subtle=="object"&&e.subtle!=null)return e.subtle;throw new Error("crypto.subtle must be defined")}function Tf(e){return e?"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_":"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"}function Q$(e,t,n){let i="",r=0,o=0;for(const s of e)for(r=r<<8|s,o+=8;o>=6;)o-=6,i+=t[r>>o&63];if(o>0&&(i+=t[r<<6-o&63]),n){const s=(4-i.length%4)%4;i+="=".repeat(s)}return i}function Y$(e,t){const n=new Map;for(let s=0;s<t.length;s++)n.set(t[s],s);const i=[];let r=0,o=0;for(const s of e){if(s==="=")break;const a=n.get(s);if(a===void 0)throw new Error(`Invalid Base64 character: ${s}`);r=r<<6|a,o+=6,o>=8&&(o-=8,i.push(r>>o&255))}return Uint8Array.from(i)}const bo={encode(e,t={}){const n=Tf(!1),i=typeof e=="string"?new TextEncoder().encode(e):new Uint8Array(e);return Q$(i,n,t.padding??!0)},decode(e){typeof e!="string"&&(e=new TextDecoder().decode(e));const t=e.includes("-")||e.includes("_"),n=Tf(t);return Y$(e,n)}},$h={encode(e,t={}){const n=Tf(!0),i=typeof e=="string"?new TextEncoder().encode(e):new Uint8Array(e);return Q$(i,n,t.padding??!0)},decode(e){const t=e.includes("-")||e.includes("_"),n=Tf(t);return Y$(e,n)}};function Ab(e,t){return{digest:async n=>{const i=new TextEncoder,r=typeof n=="string"?i.encode(n):n;return await $s().digest(e,r)}}}function RF(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function ry(e){if(typeof e!="boolean")throw new Error(`boolean expected, not ${e}`)}function Vd(e){if(!Number.isSafeInteger(e)||e<0)throw new Error("positive integer expected, got "+e)}function In(e,t,n=""){const i=RF(e),r=e?.length,o=t!==void 0;if(!i||o&&r!==t){const s=n&&`"${n}" `,a=o?` of length ${t}`:"",c=i?`length=${r}`:`type=${typeof e}`;throw new Error(s+"expected Uint8Array"+a+", got "+c)}return e}function WS(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function PF(e,t){In(e,void 0,"output");const n=t.outputLen;if(e.length<n)throw new Error("digestInto() expects output buffer of length at least "+n)}function Zo(e){return new Uint32Array(e.buffer,e.byteOffset,Math.floor(e.byteLength/4))}function Ja(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function DF(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}const UF=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68,X$=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",LF=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function MF(e){if(In(e),X$)return e.toHex();let t="";for(let n=0;n<e.length;n++)t+=LF[e[n]];return t}const Qi={_0:48,_9:57,A:65,F:70,a:97,f:102};function VS(e){if(e>=Qi._0&&e<=Qi._9)return e-Qi._0;if(e>=Qi.A&&e<=Qi.F)return e-(Qi.A-10);if(e>=Qi.a&&e<=Qi.f)return e-(Qi.a-10)}function jF(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(X$)return Uint8Array.fromHex(e);const t=e.length,n=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);const i=new Uint8Array(n);for(let r=0,o=0;r<n;r++,o+=2){const s=VS(e.charCodeAt(o)),a=VS(e.charCodeAt(o+1));if(s===void 0||a===void 0){const c=e[o]+e[o+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+o)}i[r]=s*16+a}return i}function zF(e){if(typeof e!="string")throw new Error("string expected");return new Uint8Array(new TextEncoder().encode(e))}function BF(...e){let t=0;for(let i=0;i<e.length;i++){const r=e[i];In(r),t+=r.length}const n=new Uint8Array(t);for(let i=0,r=0;i<e.length;i++){const o=e[i];n.set(o,r),r+=o.length}return n}function FF(e,t){if(t==null||typeof t!="object")throw new Error("options must be defined");return Object.assign(e,t)}function WF(e,t){if(e.length!==t.length)return!1;let n=0;for(let i=0;i<e.length;i++)n|=e[i]^t[i];return n===0}const VF=(e,t)=>{function n(i,...r){if(In(i,void 0,"key"),!UF)throw new Error("Non little-endian hardware is not yet supported");if(e.nonceLength!==void 0){const u=r[0];In(u,e.varSizeNonce?void 0:e.nonceLength,"nonce")}const o=e.tagLength;o&&r[1]!==void 0&&In(r[1],void 0,"AAD");const s=t(i,...r),a=(u,p)=>{if(p!==void 0){if(u!==2)throw new Error("cipher output not supported");In(p,void 0,"output")}};let c=!1;return{encrypt(u,p){if(c)throw new Error("cannot encrypt() twice with same key + nonce");return c=!0,In(u),a(s.encrypt.length,p),s.encrypt(u,p)},decrypt(u,p){if(In(u),o&&u.length<o)throw new Error('"ciphertext" expected length bigger than tagLength='+o);return a(s.decrypt.length,p),s.decrypt(u,p)}}}return Object.assign(n,e),n};function qS(e,t,n=!0){if(t===void 0)return new Uint8Array(e);if(t.length!==e)throw new Error('"output" expected Uint8Array of length '+e+", got: "+t.length);if(n&&!HF(t))throw new Error("invalid output, must be aligned");return t}function qF(e,t,n){ry(n);const i=new Uint8Array(16),r=DF(i);return r.setBigUint64(0,BigInt(t),n),r.setBigUint64(8,BigInt(e),n),i}function HF(e){return e.byteOffset%4===0}function If(e){return Uint8Array.from(e)}function KF(e=32){const t=typeof globalThis=="object"?globalThis.crypto:null;if(typeof t?.getRandomValues!="function")throw new Error("crypto.getRandomValues must be defined");return t.getRandomValues(new Uint8Array(e))}function eC(e,t=KF){const{nonceLength:n}=e;Vd(n);const i=(r,o)=>{const s=BF(r,o);return o.fill(0),s};return((r,...o)=>({encrypt(s){In(s);const a=t(n),c=e(r,a,...o).encrypt(s);return c instanceof Promise?c.then(l=>i(a,l)):i(a,c)},decrypt(s){In(s);const a=s.subarray(0,n),c=s.subarray(n);return e(r,a,...o).decrypt(c)}}))}const tC=e=>Uint8Array.from(e.split(""),t=>t.charCodeAt(0)),JF=tC("expand 16-byte k"),GF=tC("expand 32-byte k"),ZF=Zo(JF),QF=Zo(GF);function Te(e,t){return e<<t|e>>>32-t}function iy(e){return e.byteOffset%4===0}const Id=64,YF=16,nC=2**32-1,HS=Uint32Array.of();function XF(e,t,n,i,r,o,s,a){const c=r.length,l=new Uint8Array(Id),u=Zo(l),p=iy(r)&&iy(o),f=p?Zo(r):HS,g=p?Zo(o):HS;for(let h=0;h<c;s++){if(e(t,n,i,u,s,a),s>=nC)throw new Error("arx: counter overflow");const d=Math.min(Id,c-h);if(p&&d===Id){const y=h/4;if(h%4!==0)throw new Error("arx: invalid block position");for(let v=0,x;v<YF;v++)x=y+v,g[x]=f[x]^u[v];h+=Id;continue}for(let y=0,v;y<d;y++)v=h+y,o[v]=r[v]^l[y];h+=d}}function eW(e,t){const{allowShortKeys:n,extendNonceFn:i,counterLength:r,counterRight:o,rounds:s}=FF({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},t);if(typeof e!="function")throw new Error("core must be a function");return Vd(r),Vd(s),ry(o),ry(n),(a,c,l,u,p=0)=>{In(a,void 0,"key"),In(c,void 0,"nonce"),In(l,void 0,"data");const f=l.length;if(u===void 0&&(u=new Uint8Array(f)),In(u,void 0,"output"),Vd(p),p<0||p>=nC)throw new Error("arx: counter overflow");if(u.length<f)throw new Error(`arx: output (${u.length}) is shorter than data (${f})`);const g=[];let h=a.length,d,y;if(h===32)g.push(d=If(a)),y=QF;else if(h===16&&n)d=new Uint8Array(32),d.set(a),d.set(a,16),y=ZF,g.push(d);else throw In(a,32,"arx key"),new Error("invalid key size");iy(c)||g.push(c=If(c));const v=Zo(d);if(i){if(c.length!==24)throw new Error("arx: extended nonce must be 24 bytes");i(y,v,Zo(c.subarray(0,16)),v),c=c.subarray(16)}const x=16-r;if(x!==c.length)throw new Error(`arx: nonce must be ${x} or 16 bytes`);if(x!==12){const N=new Uint8Array(12);N.set(c,o?0:12-c.length),c=N,g.push(c)}const E=Zo(c);return XF(e,y,v,E,l,u,p,s),Ja(...g),u}}function Bn(e,t){return e[t++]&255|(e[t++]&255)<<8}class tW{blockLen=16;outputLen=16;buffer=new Uint8Array(16);r=new Uint16Array(10);h=new Uint16Array(10);pad=new Uint16Array(8);pos=0;finished=!1;constructor(t){t=If(In(t,32,"key"));const n=Bn(t,0),i=Bn(t,2),r=Bn(t,4),o=Bn(t,6),s=Bn(t,8),a=Bn(t,10),c=Bn(t,12),l=Bn(t,14);this.r[0]=n&8191,this.r[1]=(n>>>13|i<<3)&8191,this.r[2]=(i>>>10|r<<6)&7939,this.r[3]=(r>>>7|o<<9)&8191,this.r[4]=(o>>>4|s<<12)&255,this.r[5]=s>>>1&8190,this.r[6]=(s>>>14|a<<2)&8191,this.r[7]=(a>>>11|c<<5)&8065,this.r[8]=(c>>>8|l<<8)&8191,this.r[9]=l>>>5&127;for(let u=0;u<8;u++)this.pad[u]=Bn(t,16+2*u)}process(t,n,i=!1){const r=i?0:2048,{h:o,r:s}=this,a=s[0],c=s[1],l=s[2],u=s[3],p=s[4],f=s[5],g=s[6],h=s[7],d=s[8],y=s[9],v=Bn(t,n+0),x=Bn(t,n+2),E=Bn(t,n+4),N=Bn(t,n+6),C=Bn(t,n+8),b=Bn(t,n+10),P=Bn(t,n+12),$=Bn(t,n+14);let k=o[0]+(v&8191),D=o[1]+((v>>>13|x<<3)&8191),B=o[2]+((x>>>10|E<<6)&8191),J=o[3]+((E>>>7|N<<9)&8191),S=o[4]+((N>>>4|C<<12)&8191),T=o[5]+(C>>>1&8191),z=o[6]+((C>>>14|b<<2)&8191),L=o[7]+((b>>>11|P<<5)&8191),q=o[8]+((P>>>8|$<<8)&8191),V=o[9]+($>>>5|r),K=0,oe=K+k*a+D*(5*y)+B*(5*d)+J*(5*h)+S*(5*g);K=oe>>>13,oe&=8191,oe+=T*(5*f)+z*(5*p)+L*(5*u)+q*(5*l)+V*(5*c),K+=oe>>>13,oe&=8191;let ne=K+k*c+D*a+B*(5*y)+J*(5*d)+S*(5*h);K=ne>>>13,ne&=8191,ne+=T*(5*g)+z*(5*f)+L*(5*p)+q*(5*u)+V*(5*l),K+=ne>>>13,ne&=8191;let X=K+k*l+D*c+B*a+J*(5*y)+S*(5*d);K=X>>>13,X&=8191,X+=T*(5*h)+z*(5*g)+L*(5*f)+q*(5*p)+V*(5*u),K+=X>>>13,X&=8191;let ae=K+k*u+D*l+B*c+J*a+S*(5*y);K=ae>>>13,ae&=8191,ae+=T*(5*d)+z*(5*h)+L*(5*g)+q*(5*f)+V*(5*p),K+=ae>>>13,ae&=8191;let he=K+k*p+D*u+B*l+J*c+S*a;K=he>>>13,he&=8191,he+=T*(5*y)+z*(5*d)+L*(5*h)+q*(5*g)+V*(5*f),K+=he>>>13,he&=8191;let ge=K+k*f+D*p+B*u+J*l+S*c;K=ge>>>13,ge&=8191,ge+=T*a+z*(5*y)+L*(5*d)+q*(5*h)+V*(5*g),K+=ge>>>13,ge&=8191;let pe=K+k*g+D*f+B*p+J*u+S*l;K=pe>>>13,pe&=8191,pe+=T*c+z*a+L*(5*y)+q*(5*d)+V*(5*h),K+=pe>>>13,pe&=8191;let fe=K+k*h+D*g+B*f+J*p+S*u;K=fe>>>13,fe&=8191,fe+=T*l+z*c+L*a+q*(5*y)+V*(5*d),K+=fe>>>13,fe&=8191;let xe=K+k*d+D*h+B*g+J*f+S*p;K=xe>>>13,xe&=8191,xe+=T*u+z*l+L*c+q*a+V*(5*y),K+=xe>>>13,xe&=8191;let Ce=K+k*y+D*d+B*h+J*g+S*f;K=Ce>>>13,Ce&=8191,Ce+=T*p+z*u+L*l+q*c+V*a,K+=Ce>>>13,Ce&=8191,K=(K<<2)+K|0,K=K+oe|0,oe=K&8191,K=K>>>13,ne+=K,o[0]=oe,o[1]=ne,o[2]=X,o[3]=ae,o[4]=he,o[5]=ge,o[6]=pe,o[7]=fe,o[8]=xe,o[9]=Ce}finalize(){const{h:t,pad:n}=this,i=new Uint16Array(10);let r=t[1]>>>13;t[1]&=8191;for(let a=2;a<10;a++)t[a]+=r,r=t[a]>>>13,t[a]&=8191;t[0]+=r*5,r=t[0]>>>13,t[0]&=8191,t[1]+=r,r=t[1]>>>13,t[1]&=8191,t[2]+=r,i[0]=t[0]+5,r=i[0]>>>13,i[0]&=8191;for(let a=1;a<10;a++)i[a]=t[a]+r,r=i[a]>>>13,i[a]&=8191;i[9]-=8192;let o=(r^1)-1;for(let a=0;a<10;a++)i[a]&=o;o=~o;for(let a=0;a<10;a++)t[a]=t[a]&o|i[a];t[0]=(t[0]|t[1]<<13)&65535,t[1]=(t[1]>>>3|t[2]<<10)&65535,t[2]=(t[2]>>>6|t[3]<<7)&65535,t[3]=(t[3]>>>9|t[4]<<4)&65535,t[4]=(t[4]>>>12|t[5]<<1|t[6]<<14)&65535,t[5]=(t[6]>>>2|t[7]<<11)&65535,t[6]=(t[7]>>>5|t[8]<<8)&65535,t[7]=(t[8]>>>8|t[9]<<5)&65535;let s=t[0]+n[0];t[0]=s&65535;for(let a=1;a<8;a++)s=(t[a]+n[a]|0)+(s>>>16)|0,t[a]=s&65535;Ja(i)}update(t){WS(this),In(t),t=If(t);const{buffer:n,blockLen:i}=this,r=t.length;for(let o=0;o<r;){const s=Math.min(i-this.pos,r-o);if(s===i){for(;i<=r-o;o+=i)this.process(t,o);continue}n.set(t.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===i&&(this.process(n,0,!1),this.pos=0)}return this}destroy(){Ja(this.h,this.r,this.buffer,this.pad)}digestInto(t){WS(this),PF(t,this),this.finished=!0;const{buffer:n,h:i}=this;let{pos:r}=this;if(r){for(n[r++]=1;r<16;r++)n[r]=0;this.process(n,0,!0)}this.finalize();let o=0;for(let s=0;s<8;s++)t[o++]=i[s]>>>0,t[o++]=i[s]>>>8;return t}digest(){const{buffer:t,outputLen:n}=this;this.digestInto(t);const i=t.slice(0,n);return this.destroy(),i}}function nW(e){const t=(i,r)=>e(r).update(i).digest(),n=e(new Uint8Array(32));return t.outputLen=n.outputLen,t.blockLen=n.blockLen,t.create=i=>e(i),t}const rW=nW(e=>new tW(e));function iW(e,t,n,i,r,o=20){let s=e[0],a=e[1],c=e[2],l=e[3],u=t[0],p=t[1],f=t[2],g=t[3],h=t[4],d=t[5],y=t[6],v=t[7],x=r,E=n[0],N=n[1],C=n[2],b=s,P=a,$=c,k=l,D=u,B=p,J=f,S=g,T=h,z=d,L=y,q=v,V=x,K=E,oe=N,ne=C;for(let ae=0;ae<o;ae+=2)b=b+D|0,V=Te(V^b,16),T=T+V|0,D=Te(D^T,12),b=b+D|0,V=Te(V^b,8),T=T+V|0,D=Te(D^T,7),P=P+B|0,K=Te(K^P,16),z=z+K|0,B=Te(B^z,12),P=P+B|0,K=Te(K^P,8),z=z+K|0,B=Te(B^z,7),$=$+J|0,oe=Te(oe^$,16),L=L+oe|0,J=Te(J^L,12),$=$+J|0,oe=Te(oe^$,8),L=L+oe|0,J=Te(J^L,7),k=k+S|0,ne=Te(ne^k,16),q=q+ne|0,S=Te(S^q,12),k=k+S|0,ne=Te(ne^k,8),q=q+ne|0,S=Te(S^q,7),b=b+B|0,ne=Te(ne^b,16),L=L+ne|0,B=Te(B^L,12),b=b+B|0,ne=Te(ne^b,8),L=L+ne|0,B=Te(B^L,7),P=P+J|0,V=Te(V^P,16),q=q+V|0,J=Te(J^q,12),P=P+J|0,V=Te(V^P,8),q=q+V|0,J=Te(J^q,7),$=$+S|0,K=Te(K^$,16),T=T+K|0,S=Te(S^T,12),$=$+S|0,K=Te(K^$,8),T=T+K|0,S=Te(S^T,7),k=k+D|0,oe=Te(oe^k,16),z=z+oe|0,D=Te(D^z,12),k=k+D|0,oe=Te(oe^k,8),z=z+oe|0,D=Te(D^z,7);let X=0;i[X++]=s+b|0,i[X++]=a+P|0,i[X++]=c+$|0,i[X++]=l+k|0,i[X++]=u+D|0,i[X++]=p+B|0,i[X++]=f+J|0,i[X++]=g+S|0,i[X++]=h+T|0,i[X++]=d+z|0,i[X++]=y+L|0,i[X++]=v+q|0,i[X++]=x+V|0,i[X++]=E+K|0,i[X++]=N+oe|0,i[X++]=C+ne|0}function oW(e,t,n,i){let r=e[0],o=e[1],s=e[2],a=e[3],c=t[0],l=t[1],u=t[2],p=t[3],f=t[4],g=t[5],h=t[6],d=t[7],y=n[0],v=n[1],x=n[2],E=n[3];for(let C=0;C<20;C+=2)r=r+c|0,y=Te(y^r,16),f=f+y|0,c=Te(c^f,12),r=r+c|0,y=Te(y^r,8),f=f+y|0,c=Te(c^f,7),o=o+l|0,v=Te(v^o,16),g=g+v|0,l=Te(l^g,12),o=o+l|0,v=Te(v^o,8),g=g+v|0,l=Te(l^g,7),s=s+u|0,x=Te(x^s,16),h=h+x|0,u=Te(u^h,12),s=s+u|0,x=Te(x^s,8),h=h+x|0,u=Te(u^h,7),a=a+p|0,E=Te(E^a,16),d=d+E|0,p=Te(p^d,12),a=a+p|0,E=Te(E^a,8),d=d+E|0,p=Te(p^d,7),r=r+l|0,E=Te(E^r,16),h=h+E|0,l=Te(l^h,12),r=r+l|0,E=Te(E^r,8),h=h+E|0,l=Te(l^h,7),o=o+u|0,y=Te(y^o,16),d=d+y|0,u=Te(u^d,12),o=o+u|0,y=Te(y^o,8),d=d+y|0,u=Te(u^d,7),s=s+p|0,v=Te(v^s,16),f=f+v|0,p=Te(p^f,12),s=s+p|0,v=Te(v^s,8),f=f+v|0,p=Te(p^f,7),a=a+c|0,x=Te(x^a,16),g=g+x|0,c=Te(c^g,12),a=a+c|0,x=Te(x^a,8),g=g+x|0,c=Te(c^g,7);let N=0;i[N++]=r,i[N++]=o,i[N++]=s,i[N++]=a,i[N++]=y,i[N++]=v,i[N++]=x,i[N++]=E}const sW=eW(iW,{counterRight:!1,counterLength:8,extendNonceFn:oW,allowShortKeys:!1}),aW=new Uint8Array(16),KS=(e,t)=>{e.update(t);const n=t.length%16;n&&e.update(aW.subarray(n))},cW=new Uint8Array(32);function JS(e,t,n,i,r){r!==void 0&&In(r,void 0,"AAD");const o=e(t,n,cW),s=qF(i.length,r?r.length:0,!0),a=rW.create(o);r&&KS(a,r),KS(a,i),a.update(s);const c=a.digest();return Ja(o,s),c}const lW=e=>(t,n,i)=>({encrypt(o,s){const a=o.length;s=qS(a+16,s,!1),s.set(o);const c=s.subarray(0,-16);e(t,n,c,c,1);const l=JS(e,t,n,c,i);return s.set(l,a),Ja(l),s},decrypt(o,s){s=qS(o.length-16,s,!1);const a=o.subarray(0,-16),c=o.subarray(-16),l=JS(e,t,n,a,i);if(!WF(c,l))throw new Error("invalid tag");return s.set(o.subarray(0,-16)),e(t,n,s,s,1),Ja(l),s}}),rC=VF({blockSize:64,nonceLength:24,tagLength:16},lW(sW)),iC=async({key:e,data:t})=>{const n=await Ab("SHA-256").digest(e),i=zF(t);return MF(eC(rC)(new Uint8Array(n)).encrypt(i))},oC=async({key:e,data:t})=>{const n=await Ab("SHA-256").digest(e),i=jF(t),r=eC(rC)(new Uint8Array(n));return new TextDecoder().decode(r.decrypt(i))},Ga=(e,t="ms")=>new Date(Date.now()+(t==="sec"?e*1e3:e)),ts=e=>{const t=(e.plugins??[]).reduce((u,p)=>{const f=p.schema;if(!f)return u;for(const[g,h]of Object.entries(f))u[g]={fields:{...u[g]?.fields,...h.fields},modelName:h.modelName||g};return u},{}),n=e.rateLimit?.storage==="database",i={rateLimit:{modelName:e.rateLimit?.modelName||"rateLimit",fields:{key:{type:"string",unique:!0,required:!0,fieldName:e.rateLimit?.fields?.key||"key"},count:{type:"number",required:!0,fieldName:e.rateLimit?.fields?.count||"count"},lastRequest:{type:"number",bigint:!0,required:!0,fieldName:e.rateLimit?.fields?.lastRequest||"lastRequest",defaultValue:()=>Date.now()}}}},{user:r,session:o,account:s,verification:a,...c}=t,l={session:{modelName:e.session?.modelName||"session",fields:{expiresAt:{type:"date",required:!0,fieldName:e.session?.fields?.expiresAt||"expiresAt"},token:{type:"string",required:!0,fieldName:e.session?.fields?.token||"token",unique:!0},createdAt:{type:"date",required:!0,fieldName:e.session?.fields?.createdAt||"createdAt",defaultValue:()=>new Date},updatedAt:{type:"date",required:!0,fieldName:e.session?.fields?.updatedAt||"updatedAt",onUpdate:()=>new Date},ipAddress:{type:"string",required:!1,fieldName:e.session?.fields?.ipAddress||"ipAddress"},userAgent:{type:"string",required:!1,fieldName:e.session?.fields?.userAgent||"userAgent"},userId:{type:"string",fieldName:e.session?.fields?.userId||"userId",references:{model:e.user?.modelName||"user",field:"id",onDelete:"cascade"},required:!0,index:!0},...o?.fields,...e.session?.additionalFields},order:2}};return{user:{modelName:e.user?.modelName||"user",fields:{name:{type:"string",required:!0,fieldName:e.user?.fields?.name||"name",sortable:!0},email:{type:"string",unique:!0,required:!0,fieldName:e.user?.fields?.email||"email",sortable:!0},emailVerified:{type:"boolean",defaultValue:!1,required:!0,fieldName:e.user?.fields?.emailVerified||"emailVerified",input:!1},image:{type:"string",required:!1,fieldName:e.user?.fields?.image||"image"},createdAt:{type:"date",defaultValue:()=>new Date,required:!0,fieldName:e.user?.fields?.createdAt||"createdAt"},updatedAt:{type:"date",defaultValue:()=>new Date,onUpdate:()=>new Date,required:!0,fieldName:e.user?.fields?.updatedAt||"updatedAt"},...r?.fields,...e.user?.additionalFields},order:1},...!e.secondaryStorage||e.session?.storeSessionInDatabase?l:{},account:{modelName:e.account?.modelName||"account",fields:{accountId:{type:"string",required:!0,fieldName:e.account?.fields?.accountId||"accountId"},providerId:{type:"string",required:!0,fieldName:e.account?.fields?.providerId||"providerId"},userId:{type:"string",references:{model:e.user?.modelName||"user",field:"id",onDelete:"cascade"},required:!0,fieldName:e.account?.fields?.userId||"userId",index:!0},accessToken:{type:"string",required:!1,returned:!1,fieldName:e.account?.fields?.accessToken||"accessToken"},refreshToken:{type:"string",required:!1,returned:!1,fieldName:e.account?.fields?.refreshToken||"refreshToken"},idToken:{type:"string",required:!1,returned:!1,fieldName:e.account?.fields?.idToken||"idToken"},accessTokenExpiresAt:{type:"date",required:!1,returned:!1,fieldName:e.account?.fields?.accessTokenExpiresAt||"accessTokenExpiresAt"},refreshTokenExpiresAt:{type:"date",required:!1,returned:!1,fieldName:e.account?.fields?.refreshTokenExpiresAt||"refreshTokenExpiresAt"},scope:{type:"string",required:!1,fieldName:e.account?.fields?.scope||"scope"},password:{type:"string",required:!1,returned:!1,fieldName:e.account?.fields?.password||"password"},createdAt:{type:"date",required:!0,fieldName:e.account?.fields?.createdAt||"createdAt",defaultValue:()=>new Date},updatedAt:{type:"date",required:!0,fieldName:e.account?.fields?.updatedAt||"updatedAt",onUpdate:()=>new Date},...s?.fields,...e.account?.additionalFields},order:3},verification:{modelName:e.verification?.modelName||"verification",fields:{identifier:{type:"string",required:!0,fieldName:e.verification?.fields?.identifier||"identifier",index:!0},value:{type:"string",required:!0,fieldName:e.verification?.fields?.value||"value"},expiresAt:{type:"date",required:!0,fieldName:e.verification?.fields?.expiresAt||"expiresAt"},createdAt:{type:"date",required:!0,defaultValue:()=>new Date,fieldName:e.verification?.fields?.createdAt||"createdAt"},updatedAt:{type:"date",required:!0,defaultValue:()=>new Date,onUpdate:()=>new Date,fieldName:e.verification?.fields?.updatedAt||"updatedAt"},...a?.fields,...e.verification?.additionalFields},order:4},...c,...n?i:{}}},Bu=ce({id:W(),createdAt:yo().default(()=>new Date),updatedAt:yo().default(()=>new Date)}),uW=Bu.extend({providerId:W(),accountId:W(),userId:wh(),accessToken:W().nullish(),refreshToken:W().nullish(),idToken:W().nullish(),accessTokenExpiresAt:yo().nullish(),refreshTokenExpiresAt:yo().nullish(),scope:W().nullish(),password:W().nullish()}),dW=ce({key:W(),count:Lt(),lastRequest:Lt()}),fW=Bu.extend({userId:wh(),expiresAt:yo(),token:W(),ipAddress:W().nullish(),userAgent:W().nullish()}),pW=Bu.extend({email:W().transform(e=>e.toLowerCase()),emailVerified:nt().default(!1),name:W(),image:W().nullish()}),hW=Bu.extend({value:W(),expiresAt:yo(),identifier:W()}),mW=Object.freeze(Object.defineProperty({__proto__:null,accountSchema:uW,coreSchema:Bu,getAuthTables:ts,rateLimitSchema:dW,sessionSchema:fW,userSchema:pW,verificationSchema:hW},Symbol.toStringTag,{value:"Module"}));function gW(){const e=Object.getOwnPropertyDescriptor(Error,"stackTraceLimit");return e===void 0?Object.isExtensible(Error):Object.prototype.hasOwnProperty.call(e,"writable")?e.writable:e.set!==void 0}function yW(e){const t=e.split(`
    at `);return t.length<=1?e:(t.splice(1,1),t.join(`
    at `))}function wW(e,t){class n extends e{#e;constructor(...r){if(gW()){const s=Error.stackTraceLimit;Error.stackTraceLimit=0,super(...r),Error.stackTraceLimit=s}else super(...r);const o=new Error().stack;o&&(this.#e=yW(o.replace(/^Error/,this.name)))}get errorStack(){return this.#e}}return Object.defineProperty(n.prototype,"constructor",{get(){return t},enumerable:!1,configurable:!0}),n}const vW={OK:200,CREATED:201,ACCEPTED:202,NO_CONTENT:204,MULTIPLE_CHOICES:300,MOVED_PERMANENTLY:301,FOUND:302,SEE_OTHER:303,NOT_MODIFIED:304,TEMPORARY_REDIRECT:307,BAD_REQUEST:400,UNAUTHORIZED:401,PAYMENT_REQUIRED:402,FORBIDDEN:403,NOT_FOUND:404,METHOD_NOT_ALLOWED:405,NOT_ACCEPTABLE:406,PROXY_AUTHENTICATION_REQUIRED:407,REQUEST_TIMEOUT:408,CONFLICT:409,GONE:410,LENGTH_REQUIRED:411,PRECONDITION_FAILED:412,PAYLOAD_TOO_LARGE:413,URI_TOO_LONG:414,UNSUPPORTED_MEDIA_TYPE:415,RANGE_NOT_SATISFIABLE:416,EXPECTATION_FAILED:417,"I'M_A_TEAPOT":418,MISDIRECTED_REQUEST:421,UNPROCESSABLE_ENTITY:422,LOCKED:423,FAILED_DEPENDENCY:424,TOO_EARLY:425,UPGRADE_REQUIRED:426,PRECONDITION_REQUIRED:428,TOO_MANY_REQUESTS:429,REQUEST_HEADER_FIELDS_TOO_LARGE:431,UNAVAILABLE_FOR_LEGAL_REASONS:451,INTERNAL_SERVER_ERROR:500,NOT_IMPLEMENTED:501,BAD_GATEWAY:502,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,HTTP_VERSION_NOT_SUPPORTED:505,VARIANT_ALSO_NEGOTIATES:506,INSUFFICIENT_STORAGE:507,LOOP_DETECTED:508,NOT_EXTENDED:510,NETWORK_AUTHENTICATION_REQUIRED:511};var sC=class extends Error{constructor(e="INTERNAL_SERVER_ERROR",t=void 0,n={},i=typeof e=="number"?e:vW[e]){super(t?.message,t?.cause?{cause:t.cause}:void 0),this.status=e,this.body=t,this.headers=n,this.statusCode=i,this.name="APIError",this.status=e,this.headers=n,this.statusCode=i,this.body=t?{code:t?.message?.toUpperCase().replace(/ /g,"_").replace(/[^A-Z0-9_]/g,""),...t}:void 0}},aC=class extends sC{constructor(t,n){super(400,{message:t,code:"VALIDATION_ERROR"}),this.message=t,this.issues=n,this.issues=n}},GS=class extends Error{constructor(e){super(e),this.name="BetterCallError"}};const le=wW(sC,Error),bW=/^application\/([a-z0-9.+-]*\+)?json/i;async function _W(e,t){const n=e.headers.get("content-type")||"",i=n.toLowerCase();if(e.body){if(t&&t.length>0&&!t.some(r=>{const o=i.split(";")[0].trim(),s=r.toLowerCase().trim();return o===s||o.includes(s)}))throw i?new le(415,{message:`Content-Type "${n}" is not allowed. Allowed types: ${t.join(", ")}`,code:"UNSUPPORTED_MEDIA_TYPE"}):new le(415,{message:`Content-Type is required. Allowed types: ${t.join(", ")}`,code:"UNSUPPORTED_MEDIA_TYPE"});if(bW.test(i))return await e.json();if(i.includes("application/x-www-form-urlencoded")){const r=await e.formData(),o={};return r.forEach((s,a)=>{o[a]=s.toString()}),o}if(i.includes("multipart/form-data")){const r=await e.formData(),o={};return r.forEach((s,a)=>{o[a]=s}),o}return i.includes("text/plain")?await e.text():i.includes("application/octet-stream")?await e.arrayBuffer():i.includes("application/pdf")||i.includes("image/")||i.includes("video/")?await e.blob():i.includes("application/stream")||e.body instanceof ReadableStream?e.body:await e.text()}}function Nf(e){return e instanceof le||e?.name==="APIError"}function SW(e){try{return e.includes("%")?decodeURIComponent(e):e}catch{return e}}async function xW(e){try{return{data:await e,error:null}}catch(t){return{data:null,error:t}}}function cC(e){return e instanceof Request||Object.prototype.toString.call(e)==="[object Request]"}function kW(e){if(e===void 0)return!1;const t=typeof e;return t==="string"||t==="number"||t==="boolean"||t===null?!0:t!=="object"?!1:Array.isArray(e)?!0:e.buffer?!1:e.constructor&&e.constructor.name==="Object"||typeof e.toJSON=="function"}function EW(e,t,n){let i=0;const r=new WeakMap;return JSON.stringify(e,(s,a)=>{if(typeof a=="bigint")return a.toString();if(typeof a=="object"&&a!==null){if(r.has(a))return`[Circular ref-${r.get(a)}]`;r.set(a,i++)}return a},n)}function AW(e){return!e||typeof e!="object"?!1:"_flag"in e&&e._flag==="json"}function Cs(e,t){if(e instanceof Response)return t?.headers instanceof Headers&&t.headers.forEach((r,o)=>{e.headers.set(o,r)}),e;if(AW(e)){const r=e.body,o=e.routerResponse;if(o instanceof Response)return o;const s=new Headers;if(o?.headers){const a=new Headers(o.headers);for(const[c,l]of a.entries())a.set(c,l)}if(e.headers)for(const[a,c]of new Headers(e.headers).entries())s.set(a,c);if(t?.headers)for(const[a,c]of new Headers(t.headers).entries())s.set(a,c);return s.set("Content-Type","application/json"),new Response(JSON.stringify(r),{...o,headers:s,status:e.status??t?.status??o?.status,statusText:t?.statusText??o?.statusText})}if(Nf(e))return Cs(e.body,{status:t?.status??e.statusCode,statusText:e.status.toString(),headers:t?.headers||e.headers});let n=e,i=new Headers(t?.headers);return e?typeof e=="string"?(n=e,i.set("Content-Type","text/plain")):e instanceof ArrayBuffer||ArrayBuffer.isView(e)?(n=e,i.set("Content-Type","application/octet-stream")):e instanceof Blob?(n=e,i.set("Content-Type",e.type||"application/octet-stream")):e instanceof FormData?n=e:e instanceof URLSearchParams?(n=e,i.set("Content-Type","application/x-www-form-urlencoded")):e instanceof ReadableStream?(n=e,i.set("Content-Type","application/octet-stream")):kW(e)&&(n=EW(e),i.set("Content-Type","application/json")):(e===null&&(n=JSON.stringify(null)),i.set("content-type","application/json")),new Response(n,{...t,headers:i})}const Tb={name:"HMAC",hash:"SHA-256"},lC=async e=>{const t=typeof e=="string"?new TextEncoder().encode(e):e;return await $s().importKey("raw",t,Tb,!1,["sign","verify"])},TW=async(e,t,n)=>{try{const i=atob(e),r=new Uint8Array(i.length);for(let o=0,s=i.length;o<s;o++)r[o]=i.charCodeAt(o);return await $s().verify(Tb,n,r,new TextEncoder().encode(t))}catch{return!1}},IW=async(e,t)=>{const n=await lC(t),i=await $s().sign(Tb.name,n,new TextEncoder().encode(e));return btoa(String.fromCharCode(...new Uint8Array(i)))},NW=async(e,t)=>{const n=await IW(e,t);return e=`${e}.${n}`,e=encodeURIComponent(e),e},ZS=(e,t)=>{let n=e;if(t)if(t==="secure")n="__Secure-"+e;else if(t==="host")n="__Host-"+e;else return;return n};function $W(e){if(typeof e!="string")throw new TypeError("argument str must be a string");const t=new Map;let n=0;for(;n<e.length;){const i=e.indexOf("=",n);if(i===-1)break;let r=e.indexOf(";",n);if(r===-1)r=e.length;else if(r<i){n=e.lastIndexOf(";",i-1)+1;continue}const o=e.slice(n,i).trim();if(!t.has(o)){let s=e.slice(i+1,r).trim();s.codePointAt(0)===34&&(s=s.slice(1,-1)),t.set(o,SW(s))}n=r+1}return t}const uC=(e,t,n={})=>{let i;if(n?.prefix==="secure"?i=`${`__Secure-${e}`}=${t}`:n?.prefix==="host"?i=`${`__Host-${e}`}=${t}`:i=`${e}=${t}`,e.startsWith("__Secure-")&&!n.secure&&(n.secure=!0),e.startsWith("__Host-")&&(n.secure||(n.secure=!0),n.path!=="/"&&(n.path="/"),n.domain&&(n.domain=void 0)),n&&typeof n.maxAge=="number"&&n.maxAge>=0){if(n.maxAge>3456e4)throw new Error("Cookies Max-Age SHOULD NOT be greater than 400 days (34560000 seconds) in duration.");i+=`; Max-Age=${Math.floor(n.maxAge)}`}if(n.domain&&n.prefix!=="host"&&(i+=`; Domain=${n.domain}`),n.path&&(i+=`; Path=${n.path}`),n.expires){if(n.expires.getTime()-Date.now()>3456e7)throw new Error("Cookies Expires SHOULD NOT be greater than 400 days (34560000 seconds) in the future.");i+=`; Expires=${n.expires.toUTCString()}`}return n.httpOnly&&(i+="; HttpOnly"),n.secure&&(i+="; Secure"),n.sameSite&&(i+=`; SameSite=${n.sameSite.charAt(0).toUpperCase()+n.sameSite.slice(1)}`),n.partitioned&&(n.secure||(n.secure=!0),i+="; Partitioned"),i},CW=(e,t,n)=>(t=encodeURIComponent(t),uC(e,t,n)),OW=async(e,t,n,i)=>(t=await NW(t,n),uC(e,t,i));async function RW(e,t={}){let n={body:t.body,query:t.query};if(e.body){const i=await e.body["~standard"].validate(t.body);if(i.issues)return{data:null,error:QS(i.issues,"body")};n.body=i.value}if(e.query){const i=await e.query["~standard"].validate(t.query);if(i.issues)return{data:null,error:QS(i.issues,"query")};n.query=i.value}return e.requireHeaders&&!t.headers?{data:null,error:{message:"Headers is required",issues:[]}}:e.requireRequest&&!t.request?{data:null,error:{message:"Request is required",issues:[]}}:{data:n,error:null}}function QS(e,t){return{message:e.map(n=>`[${n.path?.length?`${t}.`+n.path.map(i=>typeof i=="object"?i.key:i).join("."):t}] ${n.message}`).join("; "),issues:e}}const dC=async(e,{options:t,path:n})=>{const i=new Headers;let r;const{data:o,error:s}=await RW(t,e);if(s)throw new aC(s.message,s.issues);const a="headers"in e?e.headers instanceof Headers?e.headers:new Headers(e.headers):"request"in e&&cC(e.request)?e.request.headers:null,c=a?.get("cookie"),l=c?$W(c):void 0,u={...e,body:o.body,query:o.query,path:e.path||n||"virtual:",context:"context"in e&&e.context?e.context:{},returned:void 0,headers:e?.headers,request:e?.request,params:"params"in e?e.params:void 0,method:e.method??(Array.isArray(t.method)?t.method[0]:t.method==="*"?"GET":t.method),setHeader:(p,f)=>{i.set(p,f)},getHeader:p=>a?a.get(p):null,getCookie:(p,f)=>{const g=ZS(p,f);return g&&l?.get(g)||null},getSignedCookie:async(p,f,g)=>{const h=ZS(p,g);if(!h)return null;const d=l?.get(h);if(!d)return null;const y=d.lastIndexOf(".");if(y<1)return null;const v=d.substring(0,y),x=d.substring(y+1);return x.length!==44||!x.endsWith("=")?null:await TW(x,v,await lC(f))?v:!1},setCookie:(p,f,g)=>{const h=CW(p,f,g);return i.append("set-cookie",h),h},setSignedCookie:async(p,f,g,h)=>{const d=await OW(p,f,g,h);return i.append("set-cookie",d),d},redirect:p=>(i.set("location",p),new le("FOUND",void 0,i)),error:(p,f,g)=>new le(p,f,g),setStatus:p=>{r=p},json:(p,f)=>e.asResponse?{body:f?.body||p,routerResponse:f,_flag:"json"}:p,responseHeaders:i,get responseStatus(){return r}};for(const p of t.use||[]){const f=await p({...u,returnHeaders:!0,asResponse:!1});f.response&&Object.assign(u.context,f.response),f.headers&&f.headers.forEach((g,h)=>{u.responseHeaders.set(h,g)})}return u};function Il(e,t,n){const i=typeof e=="string"?e:void 0,r=typeof t=="object"?t:e,o=typeof t=="function"?t:n;if((r.method==="GET"||r.method==="HEAD")&&r.body)throw new GS("Body is not allowed with GET or HEAD methods");if(i&&/\/{2,}/.test(i))throw new GS("Path cannot contain consecutive slashes");const s=async(...a)=>{const c=a[0]||{},{data:l,error:u}=await xW(dC(c,{options:r,path:i}));if(u)throw u instanceof aC?(r.onValidationError&&await r.onValidationError({message:u.message,issues:u.issues}),new le(400,{message:u.message,code:"VALIDATION_ERROR"})):u;const p=await o(l).catch(async h=>{if(Nf(h)){const d=r.onAPIError;if(d&&await d(h),c.asResponse)return h}throw h}),f=l.responseHeaders,g=l.responseStatus;return c.asResponse?Cs(p,{headers:f,status:g}):c.returnHeaders?c.returnStatus?{headers:f,response:p,status:g}:{headers:f,response:p}:c.returnStatus?{response:p,status:g}:p};return s.options=r,s.path=i,s}Il.create=e=>(t,n,i)=>Il(t,{...n,use:[...n?.use||[],...e?.use||[]]},i);function Ra(e,t){const n=async i=>{const r=i,o=typeof e=="function"?e:t,s=await dC(r,{options:typeof e=="function"?{}:e,path:"/"});if(!o)throw new Error("handler must be defined");const a=await o(s),c=s.responseHeaders;return r.returnHeaders?{headers:c,response:a}:a};return n.options=typeof e=="function"?{}:e,n}Ra.create=e=>{function t(n,i){if(typeof n=="function")return Ra({use:e?.use},n);if(!i)throw new Error("Middleware handler is required");return Ra({...n,method:"*",use:[...e?.use||[],...n.use||[]]},i)}return t};const ng={};function fC(e){switch(e.constructor.name){case"ZodString":return"string";case"ZodNumber":return"number";case"ZodBoolean":return"boolean";case"ZodObject":return"object";case"ZodArray":return"array";default:return"string"}}function YS(e){const t=[];return e.metadata?.openapi?.parameters?(t.push(...e.metadata.openapi.parameters),t):(e.query instanceof Li&&Object.entries(e.query.shape).forEach(([n,i])=>{i instanceof Li&&t.push({name:n,in:"query",schema:{type:fC(i),..."minLength"in i&&i.minLength?{minLength:i.minLength}:{},description:i.description}})}),t)}function PW(e){if(e.metadata?.openapi?.requestBody)return e.metadata.openapi.requestBody;if(e.body&&(e.body instanceof Li||e.body instanceof Go)){const t=e.body.shape;if(!t)return;const n={},i=[];return Object.entries(t).forEach(([r,o])=>{o instanceof Li&&(n[r]={type:fC(o),description:o.description},o instanceof Go||i.push(r))}),{required:e.body instanceof Go?!1:!!e.body,content:{"application/json":{schema:{type:"object",properties:n,required:i}}}}}}function XS(e){return{400:{content:{"application/json":{schema:{type:"object",properties:{message:{type:"string"}},required:["message"]}}},description:"Bad Request. Usually due to missing parameters, or invalid parameters."},401:{content:{"application/json":{schema:{type:"object",properties:{message:{type:"string"}},required:["message"]}}},description:"Unauthorized. Due to missing or invalid authentication."},403:{content:{"application/json":{schema:{type:"object",properties:{message:{type:"string"}}}}},description:"Forbidden. You do not have permission to access this resource or to perform this action."},404:{content:{"application/json":{schema:{type:"object",properties:{message:{type:"string"}}}}},description:"Not Found. The requested resource was not found."},429:{content:{"application/json":{schema:{type:"object",properties:{message:{type:"string"}}}}},description:"Too Many Requests. You have exceeded the rate limit. Try again later."},500:{content:{"application/json":{schema:{type:"object",properties:{message:{type:"string"}}}}},description:"Internal Server Error. This is a problem with the server that you cannot fix."},...e}}async function DW(e,t){const n={schemas:{}};return Object.entries(e).forEach(([i,r])=>{const o=r.options;if(!(!r.path||o.metadata?.SERVER_ONLY)&&(o.method==="GET"&&(ng[r.path]={get:{tags:["Default",...o.metadata?.openapi?.tags||[]],description:o.metadata?.openapi?.description,operationId:o.metadata?.openapi?.operationId,security:[{bearerAuth:[]}],parameters:YS(o),responses:XS(o.metadata?.openapi?.responses)}}),o.method==="POST")){const s=PW(o);ng[r.path]={post:{tags:["Default",...o.metadata?.openapi?.tags||[]],description:o.metadata?.openapi?.description,operationId:o.metadata?.openapi?.operationId,security:[{bearerAuth:[]}],parameters:YS(o),...s?{requestBody:s}:{requestBody:{content:{"application/json":{schema:{type:"object",properties:{}}}}}},responses:XS(o.metadata?.openapi?.responses)}}}}),{openapi:"3.1.1",info:{title:"Better Auth",description:"API Reference for your Better Auth Instance",version:"1.1.0"},components:n,security:[{apiKeyCookie:[]}],servers:[{url:t?.url}],tags:[{name:"Default",description:"Default endpoints that are included with Better Auth by default. These endpoints are not part of any plugin."}],paths:ng}}const UW=(e,t)=>`<!doctype html>
<html>
  <head>
    <title>Scalar API Reference</title>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1" />
  </head>
  <body>
    <script
      id="api-reference"
      type="application/json">
    ${JSON.stringify(e)}
    <\/script>
	 <script>
      var configuration = {
	  	favicon: ${t?.logo?`data:image/svg+xml;utf8,${encodeURIComponent(t.logo)}`:void 0} ,
	   	theme: ${t?.theme||"saturn"},
        metaData: {
			title: ${t?.title||"Open API Reference"},
			description: ${t?.description||"Better Call Open API"},
		}
      }
      document.getElementById('api-reference').dataset.configuration =
        JSON.stringify(configuration)
    <\/script>
	  <script src="https://cdn.jsdelivr.net/npm/@scalar/api-reference"><\/script>
  </body>
</html>`,$f=(()=>{const e=function(){};return e.prototype=Object.create(null),Object.freeze(e.prototype),e})();function ex(){return{root:{key:""},static:new $f}}function Ib(e){const[t,...n]=e.split("/");return n[n.length-1]===""?n.slice(0,-1):n}function pC(e,t){const n=new $f;for(const[i,r]of t){const o=i<0?e.slice(-(i+1)).join("/"):e[i];if(typeof r=="string")n[r]=o;else{const s=o.match(r);if(s)for(const a in s.groups)n[a]=s.groups[a]}}return n}function tx(e,t="",n,i){t=t.toUpperCase(),n.charCodeAt(0)!==47&&(n=`/${n}`),n=n.replace(/\\:/g,"%3A");const r=Ib(n);let o=e.root,s=0;const a=[],c=[];for(let u=0;u<r.length;u++){let p=r[u];if(p.startsWith("**")){o.wildcard||(o.wildcard={key:"**"}),o=o.wildcard,a.push([-(u+1),p.split(":")[1]||"_",p.length===2]);break}if(p==="*"||p.includes(":")){if(o.param||(o.param={key:"*"}),o=o.param,p==="*")a.push([u,`_${s++}`,!0]);else if(p.includes(":",1)){const g=LW(p);c[u]=g,o.hasRegexParam=!0,a.push([u,g,!1])}else a.push([u,p.slice(1),!1]);continue}p==="\\*"?p=r[u]="*":p==="\\*\\*"&&(p=r[u]="**");const f=o.static?.[p];if(f)o=f;else{const g={key:p};o.static||(o.static=new $f),o.static[p]=g,o=g}}const l=a.length>0;o.methods||(o.methods=new $f),o.methods[t]??=[],o.methods[t].push({data:i||null,paramsRegexp:c,paramsMap:l?a:void 0}),l||(e.static["/"+r.join("/")]=o)}function LW(e){const t=e.replace(/:(\w+)/g,(n,i)=>`(?<${i}>[^/]+)`).replace(/\./g,"\\.");return new RegExp(`^${t}$`)}function MW(e,t="",n,i){n.charCodeAt(n.length-1)===47&&(n=n.slice(0,-1));const r=e.static[n];if(r&&r.methods){const a=r.methods[t]||r.methods[""];if(a!==void 0)return a[0]}const o=Ib(n),s=oy(e,e.root,t,o,0)?.[0];if(s!==void 0)return{data:s.data,params:s.paramsMap?pC(o,s.paramsMap):void 0}}function oy(e,t,n,i,r){if(r===i.length){if(t.methods){const s=t.methods[n]||t.methods[""];if(s)return s}if(t.param&&t.param.methods){const s=t.param.methods[n]||t.param.methods[""];if(s){const a=s[0].paramsMap;if(a?.[a?.length-1]?.[2])return s}}if(t.wildcard&&t.wildcard.methods){const s=t.wildcard.methods[n]||t.wildcard.methods[""];if(s){const a=s[0].paramsMap;if(a?.[a?.length-1]?.[2])return s}}return}const o=i[r];if(t.static){const s=t.static[o];if(s){const a=oy(e,s,n,i,r+1);if(a)return a}}if(t.param){const s=oy(e,t.param,n,i,r+1);if(s){if(t.param.hasRegexParam){const a=s.find(c=>c.paramsRegexp[r]?.test(o))||s.find(c=>!c.paramsRegexp[r]);return a?[a]:void 0}return s}}if(t.wildcard&&t.wildcard.methods)return t.wildcard.methods[n]||t.wildcard.methods[""]}function jW(e,t="",n,i){n.charCodeAt(n.length-1)===47&&(n=n.slice(0,-1));const r=Ib(n);return sy(e,e.root,t,r,0).map(s=>({data:s.data,params:s.paramsMap?pC(r,s.paramsMap):void 0}))}function sy(e,t,n,i,r,o=[]){const s=i[r];if(t.wildcard&&t.wildcard.methods){const c=t.wildcard.methods[n]||t.wildcard.methods[""];c&&o.push(...c)}if(t.param&&(sy(e,t.param,n,i,r+1,o),r===i.length&&t.param.methods)){const c=t.param.methods[n]||t.param.methods[""];if(c){const l=c[0].paramsMap;l?.[l?.length-1]?.[2]&&o.push(...c)}}const a=t.static?.[s];if(a&&sy(e,a,n,i,r+1,o),r===i.length&&t.methods){const c=t.methods[n]||t.methods[""];c&&o.push(...c)}return o}const zW=(e,t)=>{if(!t?.openapi?.disabled){const o={path:"/api/reference",...t?.openapi};e.openapi=Il(o.path,{method:"GET"},async s=>{const a=await DW(e);return new Response(UW(a,o.scalar),{headers:{"Content-Type":"text/html"}})})}const n=ex(),i=ex();for(const o of Object.values(e)){if(!o.options||!o.path||o.options?.metadata?.SERVER_ONLY)continue;const s=Array.isArray(o.options?.method)?o.options.method:[o.options?.method];for(const a of s)tx(n,a,o.path,o)}if(t?.routerMiddleware?.length)for(const{path:o,middleware:s}of t.routerMiddleware)tx(i,"*",o,s);const r=async o=>{const s=new URL(o.url),a=s.pathname,c=t?.basePath&&t.basePath!=="/"?a.split(t.basePath).reduce((f,g,h)=>(h!==0&&(h>1?f.push(`${t.basePath}${g}`):f.push(g)),f),[]).join(""):s.pathname;if(!c?.length)return new Response(null,{status:404,statusText:"Not Found"});if(/\/{2,}/.test(c))return new Response(null,{status:404,statusText:"Not Found"});const l=MW(n,o.method,c);if(c.endsWith("/")!==l?.data?.path?.endsWith("/")&&!t?.skipTrailingSlashes)return new Response(null,{status:404,statusText:"Not Found"});if(!l?.data)return new Response(null,{status:404,statusText:"Not Found"});const u={};s.searchParams.forEach((f,g)=>{g in u?Array.isArray(u[g])?u[g].push(f):u[g]=[u[g],f]:u[g]=f});const p=l.data;try{const f=p.options.metadata?.allowedMediaTypes||t?.allowedMediaTypes,g={path:c,method:o.method,headers:o.headers,params:l.params?JSON.parse(JSON.stringify(l.params)):{},request:o,body:p.options.disableBody?void 0:await _W(p.options.cloneRequest?o.clone():o,f),query:u,_flag:"router",asResponse:!0,context:t?.routerContext},h=jW(i,"*",c);if(h?.length)for(const{data:d,params:y}of h){const v=await d({...g,params:y,asResponse:!1});if(v instanceof Response)return v}return await p(g)}catch(f){if(t?.onError)try{const g=await t.onError(f);if(g instanceof Response)return Cs(g)}catch(g){if(Nf(g))return Cs(g);throw g}if(t?.throwError)throw f;return Nf(f)?Cs(f):(console.error("# SERVER_ERROR: ",f),new Response(null,{status:500,statusText:"Internal Server Error"}))}};return{handler:async o=>{const s=await t?.onRequest?.(o);if(s instanceof Response)return s;const a=await r(cC(s)?s:o),c=await t?.onResponse?.(a);return c instanceof Response?c:a},endpoints:e}},rg=new WeakMap;function Nb(e,t){const n=t.fields,i={};for(const r in e){const o=n[r];if(!o){i[r]=e[r];continue}o.returned===!1&&r!=="id"||(i[r]=e[r])}return i}function Xs(e,t,n){const i=`${t}:${n}`;rg.has(e)||rg.set(e,new Map);const r=rg.get(e);if(r.has(i))return r.get(i);const o=n==="output"?ts(e)[t]?.fields??{}:{},s=t==="user"||t==="session"||t==="account"?e[t]?.additionalFields:void 0;let a={...o,...s??{}};for(const c of e.plugins||[])c.schema&&c.schema[t]&&(a={...a,...c.schema[t].fields});return r.set(i,a),a}function Vn(e,t){return Nb(t,{fields:Xs(e,"user","output")})}function ei(e,t){return Nb(t,{fields:Xs(e,"session","output")})}function hC(e,t){const{accessToken:n,refreshToken:i,idToken:r,accessTokenExpiresAt:o,refreshTokenExpiresAt:s,password:a,...c}=Nb(t,{fields:Xs(e,"account","output")});return c}function Fu(e,t){const n=t.action||"create",i=t.fields,r=Object.assign(Object.create(null),null);for(const o in i){if(o in e){if(i[o].input===!1){if(i[o].defaultValue!==void 0&&n!=="update"){r[o]=i[o].defaultValue;continue}if(e[o])throw new le("BAD_REQUEST",{message:`${o} is not allowed to be set`});continue}if(i[o].validator?.input&&e[o]!==void 0){const s=i[o].validator.input["~standard"].validate(e[o]);if(s instanceof Promise)throw new le("INTERNAL_SERVER_ERROR",{message:"Async validation is not supported for additional fields"});if("issues"in s&&s.issues)throw new le("BAD_REQUEST",{message:s.issues[0]?.message||"Validation Error"});r[o]=s.value;continue}if(i[o].transform?.input&&e[o]!==void 0){r[o]=i[o].transform?.input(e[o]);continue}r[o]=e[o];continue}if(i[o].defaultValue!==void 0&&n==="create"){if(typeof i[o].defaultValue=="function"){r[o]=i[o].defaultValue();continue}r[o]=i[o].defaultValue;continue}if(i[o].required&&n==="create")throw new le("BAD_REQUEST",{message:`${o} is required`})}return r}function $b(e,t={},n){return Fu(t,{fields:Xs(e,"user","input"),action:n})}function BW(e,t){const n=Xs(e,"user","input");return Fu(t||{},{fields:n})}function FW(e,t){return Fu(t,{fields:Xs(e,"account","input")})}function mC(e,t){return Fu(t,{fields:Xs(e,"session","input")})}function WW(e,t){if(!t)return e;for(const n in t){const i=t[n]?.modelName;i&&(e[n].modelName=i);for(const r in e[n].fields){const o=t[n]?.fields?.[r];o&&(e[n].fields[r].fieldName=o)}}return e}const Cb=4096,ay=200,ig=Cb-ay;function VW(e){const t=e.headers?.get("cookie");if(!t)return{};const n={},i=t.split("; ");for(const r of i){const[o,...s]=r.split("=");o&&s.length>0&&(n[o]=s.join("="))}return n}function nx(e){const t=e.split("."),n=t[t.length-1],i=parseInt(n||"0",10);return isNaN(i)?0:i}function qW(e,t){const n={},i=VW(t);for(const[r,o]of Object.entries(i))r.startsWith(e)&&(n[r]=o);return n}function HW(e){return Object.keys(e).sort((t,n)=>nx(t)-nx(n)).map(t=>e[t]).join("")}function KW(e,t,n,i){const r=Math.ceil(t.value.length/ig);if(r===1)return n[t.name]=t.value,[t];const o=[];for(let s=0;s<r;s++){const a=`${t.name}.${s}`,c=s*ig,l=t.value.substring(c,c+ig);o.push({...t,name:a,value:l}),n[a]=l}return i.debug(`CHUNKING_${e.toUpperCase()}_COOKIE`,{message:`${e} cookie exceeds allowed ${Cb} bytes.`,emptyCookieSize:ay,valueSize:t.value.length,chunkCount:r,chunks:o.map(s=>s.value.length+ay)}),o}function rx(e,t){const n={};for(const i in e)n[i]={name:i,value:"",attributes:{...t,maxAge:0}};return n}const gC=e=>(t,n,i)=>{const r=qW(t,i),o=i.context.logger;return{getValue(){return HW(r)},hasChunks(){return Object.keys(r).length>0},chunk(s,a){const c=rx(r,n);for(const p in r)delete r[p];const l=c,u=KW(e,{name:t,value:s,attributes:{...n,...a}},r,o);for(const p of u)l[p.name]=p;return Object.values(l)},clean(){const s=rx(r,n);for(const a in r)delete r[a];return Object.values(s)},setCookies(s){for(const a of s)i.setCookie(a.name,a.value,a.attributes)}}},cy=gC("Session"),ly=gC("Account");function yC(e,t){const n=e.getCookie(t);if(n)return n;const i=[],r=e.headers?.get("cookie");if(!r)return null;const o={},s=r.split("; ");for(const a of s){const[c,...l]=a.split("=");c&&l.length>0&&(o[c]=l.join("="))}for(const[a,c]of Object.entries(o))if(a.startsWith(t+".")){const l=a.split(".").at(-1),u=parseInt(l||"0",10);isNaN(u)||i.push({index:u,value:c})}return i.length>0?(i.sort((a,c)=>a.index-c.index),i.map(a=>a.value).join("")):null}async function Nl(e,t){const n=e.context.authCookies.accountData,i={maxAge:300,...n.attributes},r=await V$(t,e.context.secret,"better-auth-account",i.maxAge);if(r.length>Cb){const o=ly(n.name,i,e),s=o.chunk(r,i);o.setCookies(s)}else{const o=ly(n.name,i,e);if(o.hasChunks()){const s=o.clean();o.setCookies(s)}e.setCookie(n.name,r,i)}}async function Ch(e){const t=yC(e,e.context.authCookies.accountData.name);if(t){const n=tr(await q$(t,e.context.secret,"better-auth-account"));if(n)return n}return null}const JW=wo(ce({disableCookieCache:Fg().meta({description:"Disable cookie cache and fetch session from database"}).optional(),disableRefresh:Fg().meta({description:"Disable session refresh. Useful for checking session status, without updating the session"}).optional()}));function Ob(e){return!!e&&(typeof e=="object"||typeof e=="function")&&typeof e.then=="function"}const wC=1e3,vC=wC*60,bC=vC*60,Oh=bC*24,GW=Oh*7,ZW=Oh*30,QW=Oh*365.25,YW=/^(\+|\-)? ?(\d+|\d+\.\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|months?|mo|years?|yrs?|y)(?: (ago|from now))?$/i;function XW(e){const t=YW.exec(e);if(!t||t[4]&&t[1])throw new TypeError(`Invalid time string format: "${e}". Use formats like "7d", "30m", "1 hour", etc.`);const n=parseFloat(t[2]),i=t[3].toLowerCase();let r;switch(i){case"years":case"year":case"yrs":case"yr":case"y":r=n*QW;break;case"months":case"month":case"mo":r=n*ZW;break;case"weeks":case"week":case"w":r=n*GW;break;case"days":case"day":case"d":r=n*Oh;break;case"hours":case"hour":case"hrs":case"hr":case"h":r=n*bC;break;case"minutes":case"minute":case"mins":case"min":case"m":r=n*vC;break;case"seconds":case"second":case"secs":case"sec":case"s":r=n*wC;break;default:throw new TypeError(`Unknown time unit: "${i}"`)}return t[1]==="-"||t[4]==="ago"?-r:r}function eV(e){return Math.round(XW(e)/1e3)}const tV="__Secure-",og=new Map,nV=new TextEncoder,rV={decode:(e,t="utf-8")=>(og.has(t)||og.set(t,new TextDecoder(t)),og.get(t).decode(e)),encode:nV.encode},_C=(e="SHA-256",t="none")=>{const n={importKey:async(i,r)=>$s().importKey("raw",typeof i=="string"?new TextEncoder().encode(i):i,{name:"HMAC",hash:{name:e}},!1,[r]),sign:async(i,r)=>{typeof i=="string"&&(i=await n.importKey(i,"sign"));const o=await $s().sign("HMAC",i,typeof r=="string"?new TextEncoder().encode(r):r);return t==="hex"?Af.encode(o):t==="base64"||t==="base64url"||t==="base64urlnopad"?$h.encode(o,{padding:t!=="base64urlnopad"}):o},verify:async(i,r,o)=>(typeof i=="string"&&(i=await n.importKey(i,"verify")),t==="hex"&&(o=Af.decode(o)),(t==="base64"||t==="base64url"||t==="base64urlnopad")&&(o=await bo.decode(o)),$s().verify("HMAC",i,typeof o=="string"?new TextEncoder().encode(o):o,typeof r=="string"?new TextEncoder().encode(r):r))};return n};function SC(e){const t=(e.advanced?.useSecureCookies!==void 0?e.advanced?.useSecureCookies:e.baseURL?e.baseURL.startsWith("https://"):Ih)?tV:"",n=!!e.advanced?.crossSubDomainCookies?.enabled,i=n?e.advanced?.crossSubDomainCookies?.domain||(e.baseURL?new URL(e.baseURL).hostname:void 0):void 0;if(n&&!i)throw new Fe("baseURL is required when crossSubdomainCookies are enabled");function r(o,s={}){const a=e.advanced?.cookiePrefix||"better-auth",c=e.advanced?.cookies?.[o]?.name||`${a}.${o}`,l=e.advanced?.cookies?.[o]?.attributes;return{name:`${t}${c}`,attributes:{secure:!!t,sameSite:"lax",path:"/",httpOnly:!0,...n?{domain:i}:{},...e.advanced?.defaultCookieAttributes,...s,...l}}}return r}function iV(e){const t=SC(e),n=t("session_token",{maxAge:e.session?.expiresIn||eV("7d")}),i=t("session_data",{maxAge:e.session?.cookieCache?.maxAge||300}),r=t("account_data",{maxAge:e.session?.cookieCache?.maxAge||300}),o=t("dont_remember");return{sessionToken:{name:n.name,attributes:n.attributes},sessionData:{name:i.name,attributes:i.attributes},dontRememberToken:{name:o.name,attributes:o.attributes},accountData:{name:r.name,attributes:r.attributes}}}async function uy(e,t,n){if(!e.context.options.session?.cookieCache?.enabled)return;const i=fF(t.session,e.context.options.session?.additionalFields),r=Vn(e.context.options,t.user),o=e.context.options.session?.cookieCache?.version;let s="1";if(o){if(typeof o=="string")s=o;else if(typeof o=="function"){const f=o(t.session,t.user);s=Ob(f)?await f:f}}const a={session:i,user:r,updatedAt:Date.now(),version:s},c={...e.context.authCookies.sessionData.attributes,maxAge:n?void 0:e.context.authCookies.sessionData.attributes.maxAge},l=Ga(c.maxAge||60,"sec").getTime(),u=e.context.options.session?.cookieCache?.strategy||"compact";let p;if(u==="jwe"?p=await V$(a,e.context.secret,"better-auth-session",c.maxAge||300):u==="jwt"?p=await z$(a,e.context.secret,c.maxAge||300):p=$h.encode(JSON.stringify({session:a,expiresAt:l,signature:await _C("SHA-256","base64urlnopad").sign(e.context.secret,JSON.stringify({...a,expiresAt:l}))}),{padding:!1}),p.length>4093){const f=cy(e.context.authCookies.sessionData.name,c,e),g=f.chunk(p,c);f.setCookies(g)}else{const f=cy(e.context.authCookies.sessionData.name,c,e);if(f.hasChunks()){const g=f.clean();f.setCookies(g)}e.setCookie(e.context.authCookies.sessionData.name,p,c)}if(e.context.options.account?.storeAccountCookie){const f=await Ch(e);f&&await Nl(e,f)}}async function ii(e,t,n,i){const r=await e.getSignedCookie(e.context.authCookies.dontRememberToken.name,e.context.secret);n=n!==void 0?n:!!r;const o=e.context.authCookies.sessionToken.attributes,s=n?void 0:e.context.sessionConfig.expiresIn;await e.setSignedCookie(e.context.authCookies.sessionToken.name,t.session.token,e.context.secret,{...o,maxAge:s,...i}),n&&await e.setSignedCookie(e.context.authCookies.dontRememberToken.name,"true",e.context.secret,e.context.authCookies.dontRememberToken.attributes),await uy(e,t,n),e.context.setNewSession(t)}function ni(e,t){e.setCookie(t.name,"",{...t.attributes,maxAge:0})}function $l(e,t){if(ni(e,e.context.authCookies.sessionToken),ni(e,e.context.authCookies.sessionData),e.context.options.account?.storeAccountCookie){ni(e,e.context.authCookies.accountData);const r=ly(e.context.authCookies.accountData.name,e.context.authCookies.accountData.attributes,e),o=r.clean();r.setCookies(o)}e.context.oauthConfig.storeStateStrategy==="cookie"&&ni(e,e.context.createAuthCookie("oauth_state"));const n=cy(e.context.authCookies.sessionData.name,e.context.authCookies.sessionData.attributes,e),i=n.clean();n.setCookies(i),ni(e,e.context.authCookies.dontRememberToken)}const ix=jp({callbackURL:W(),codeVerifier:W(),errorURL:W().optional(),newUserURL:W().optional(),expiresAt:Lt(),link:ce({email:W(),userId:wh()}).optional(),requestSignUp:nt().optional()});var vs=class extends Fe{code;details;constructor(e,t){super(e,t),this.code=t.code,this.details=t.details}};async function oV(e,t,n){const i=yb(32);if(e.context.oauthConfig.storeStateStrategy==="cookie"){const a=await iC({key:e.context.secret,data:JSON.stringify(t)}),c=e.context.createAuthCookie("oauth_state",{maxAge:600});return e.setCookie(c.name,a,c.attributes),{state:i,codeVerifier:t.codeVerifier}}const r=e.context.createAuthCookie("state",{maxAge:300});await e.setSignedCookie(r.name,i,e.context.secret,r.attributes);const o=new Date;o.setMinutes(o.getMinutes()+10);const s=await e.context.internalAdapter.createVerificationValue({value:JSON.stringify(t),identifier:i,expiresAt:o});if(!s)throw new vs("Unable to create verification. Make sure the database adapter is properly working and there is a verification table in the database",{code:"state_generation_error"});return{state:s.identifier,codeVerifier:t.codeVerifier}}async function sV(e,t,n){const i=e.context.oauthConfig.storeStateStrategy;let r;if(i==="cookie"){const o=e.context.createAuthCookie("oauth_state"),s=e.getCookie(o.name);if(!s)throw new vs("State mismatch: auth state cookie not found",{code:"state_mismatch",details:{state:t}});try{const a=await oC({key:e.context.secret,data:s});r=ix.parse(JSON.parse(a))}catch(a){throw new vs("State invalid: Failed to decrypt or parse auth state",{code:"state_invalid",details:{state:t},cause:a})}ni(e,o)}else{const o=await e.context.internalAdapter.findVerificationValue(t);if(!o)throw new vs("State mismatch: verification not found",{code:"state_mismatch",details:{state:t}});r=ix.parse(JSON.parse(o.value));const s=e.context.createAuthCookie("state"),a=await e.getSignedCookie(s.name,e.context.secret);if(!e.context.oauthConfig.skipStateCookieCheck&&(!a||a!==t))throw new vs("State mismatch: State not persisted correctly",{code:"state_security_mismatch",details:{state:t}});ni(e,s),await e.context.internalAdapter.deleteVerificationValue(o.id)}if(r.expiresAt<Date.now())throw new vs("Invalid state: request expired",{code:"state_mismatch",details:{expiresAt:r.expiresAt}});return r}const Vc=Symbol.for("better-auth:global");let qc=null;const aV={},sg="1.4.18";function Rh(){return globalThis[Vc]||(globalThis[Vc]={version:sg,epoch:1,context:aV},qc=globalThis[Vc]),qc=globalThis[Vc],qc.version!==sg&&(qc.version=sg,qc.epoch++),globalThis[Vc]}function cV(){return Rh().version}const lV=import("node:async_hooks").then(e=>e.AsyncLocalStorage).catch(e=>{if("AsyncLocalStorage"in globalThis)return globalThis.AsyncLocalStorage;if(typeof window<"u")return null;throw console.warn("[better-auth] Warning: AsyncLocalStorage is not available in this environment. Some features may not work as expected."),console.warn("[better-auth] Please read more about this warning at https://better-auth.com/docs/installation#mount-handler"),console.warn("[better-auth] If you are using Cloudflare Workers, please see: https://developers.cloudflare.com/workers/configuration/compatibility-flags/#nodejs-compatibility-flag"),e});async function Rb(){const e=await lV;if(e===null)throw new Error("getAsyncLocalStorage is only available in server code");return e}const xC=async()=>{const e=Rh();if(!e.context.endpointContextAsyncStorage){const t=await Rb();e.context.endpointContextAsyncStorage=new t}return e.context.endpointContextAsyncStorage};async function Ea(){const e=(await xC()).getStore();if(!e)throw new Error("No auth context found. Please make sure you are calling this function within a `runWithEndpointContext` callback.");return e}async function Cf(e,t){return(await xC()).run(e,t)}const Pb=async()=>{const e=Rh();if(!e.context.requestStateAsyncStorage){const t=await Rb();e.context.requestStateAsyncStorage=new t}return e.context.requestStateAsyncStorage};async function uV(){return(await Pb()).getStore()!==void 0}async function ox(){const e=(await Pb()).getStore();if(!e)throw new Error("No request state found. Please make sure you are calling this function within a `runWithRequestState` callback.");return e}async function dV(e,t){return(await Pb()).run(e,t)}function fV(e){const t=Object.freeze({});return{get ref(){return t},async get(){const n=await ox();if(!n.has(t)){const i=await e();return n.set(t,i),i}return n.get(t)},async set(n){(await ox()).set(t,n)}}}const Db=async()=>{const e=Rh();if(!e.context.adapterAsyncStorage){const t=await Rb();e.context.adapterAsyncStorage=new t}return e.context.adapterAsyncStorage},gn=async e=>Db().then(t=>t.getStore()||e).catch(()=>e),pV=async(e,t)=>{let n=!0;return Db().then(i=>(n=!0,i.run(e,t))).catch(i=>{if(!n)return t();throw i})},kC=async(e,t)=>{let n=!0;return Db().then(i=>(n=!0,e.transaction(async r=>i.run(r,t)))).catch(i=>{if(!n)return t();throw i})},{set:EC}=fV(()=>null);async function AC(e,t,n){const i=e.body?.callbackURL||e.context.options.baseURL;if(!i)throw new le("BAD_REQUEST",{message:"callbackURL is required"});const r=yb(128),o={...n||{},callbackURL:i,codeVerifier:r,errorURL:e.body?.errorCallbackURL,newUserURL:e.body?.newUserCallbackURL,link:t,expiresAt:Date.now()+600*1e3,requestSignUp:e.body?.requestSignUp};await EC(o);try{return oV(e,o)}catch(s){throw e.context.logger.error("Failed to create verification",s),new le("INTERNAL_SERVER_ERROR",{message:"Unable to create verification",cause:s})}}async function hV(e){const t=e.query.state||e.body.state,n=e.context.options.onAPIError?.errorURL||`${e.context.baseURL}/error`;let i;try{i=await sV(e,t)}catch(r){throw e.context.logger.error("Failed to parse state",r),r instanceof vs&&r.code==="state_security_mismatch"?e.redirect(`${n}?error=state_mismatch`):e.redirect(`${n}?error=please_restart_the_process`)}return i.errorURL||(i.errorURL=n),i&&await EC(i),i}const Ub={scope:"server"},mV="127.0.0.1";function TC(e,t){if(t.advanced?.ipAddress?.disableIpTracking)return null;const n="headers"in e?e.headers:e,i=t.advanced?.ipAddress?.ipAddressHeaders||["x-forwarded-for"];for(const r of i){const o="get"in n?n.get(r):n[r];if(typeof o=="string"){const s=o.split(",")[0].trim();if(pF(s))return yF(s,{ipv6Subnet:t.advanced?.ipAddress?.ipv6Subnet})}}return zu()||kb()?mV:null}function gV(e){try{return(new URL(e).pathname.replace(/\/+$/,"")||"/")!=="/"}catch{throw new Fe(`Invalid base URL: ${e}. Please provide a valid base URL.`)}}function yV(e){try{const t=new URL(e);if(t.protocol!=="http:"&&t.protocol!=="https:")throw new Fe(`Invalid base URL: ${e}. URL must include 'http://' or 'https://'`)}catch(t){throw t instanceof Fe?t:new Fe(`Invalid base URL: ${e}. Please provide a valid base URL.`,{cause:t})}}function Hc(e,t="/api/auth"){if(yV(e),gV(e))return e;const n=e.replace(/\/+$/,"");return!t||t==="/"?n:(t=t.startsWith("/")?t:`/${t}`,`${n}${t}`)}function sx(e,t){return!e||e.trim()===""?!1:t==="proto"?e==="http"||e==="https":t==="host"?[/\.\./,/\0/,/[\s]/,/^[.]/,/[<>'"]/,/javascript:/i,/file:/i,/data:/i].some(n=>n.test(e))?!1:/^[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?$/.test(e)||/^(\d{1,3}\.){3}\d{1,3}(:[0-9]{1,5})?$/.test(e)||/^\[[0-9a-fA-F:]+\](:[0-9]{1,5})?$/.test(e)||/^localhost(:[0-9]{1,5})?$/i.test(e):!1}function Lb(e,t,n,i,r){if(e)return Hc(e,t);{const a=qt.BETTER_AUTH_URL||qt.NEXT_PUBLIC_BETTER_AUTH_URL||qt.PUBLIC_BETTER_AUTH_URL||qt.NUXT_PUBLIC_BETTER_AUTH_URL||qt.NUXT_PUBLIC_AUTH_URL||(qt.BASE_URL!=="/"?qt.BASE_URL:void 0);if(a)return Hc(a,t)}const o=n?.headers.get("x-forwarded-host"),s=n?.headers.get("x-forwarded-proto");if(o&&s&&r&&sx(s,"proto")&&sx(o,"host"))try{return Hc(`${s}://${o}`,t)}catch{}if(n){const a=Of(n.url);if(!a)throw new Fe("Could not get origin from request. Please provide a valid base URL.");return Hc(a,t)}if(typeof window<"u"&&window.location)return Hc(window.location.origin,t)}function Of(e){try{const t=new URL(e);return t.origin==="null"?null:t.origin}catch{return null}}function wV(e){try{return new URL(e).protocol}catch{return null}}function vV(e){try{return new URL(e).host}catch{return null}}function dy(e){return e==="-"||e==="^"||e==="$"||e==="+"||e==="."||e==="("||e===")"||e==="|"||e==="["||e==="]"||e==="{"||e==="}"||e==="*"||e==="?"||e==="\\"?`\\${e}`:e}function bV(e){let t="";for(let n=0;n<e.length;n++)t+=dy(e[n]);return t}function IC(e,t=!0){if(Array.isArray(e))return`(?:${e.map(l=>`^${IC(l,t)}$`).join("|")})`;let n="",i="",r=".";t===!0?(n="/",i="[/\\\\]",r="[^/\\\\]"):t&&(n=t,i=bV(n),i.length>1?(i=`(?:${i})`,r=`((?!${i}).)`):r=`[^${i}]`);const o=t?`${i}+?`:"",s=t?`${i}*?`:"",a=t?e.split(n):[e];let c="";for(let l=0;l<a.length;l++){const u=a[l],p=a[l+1];let f="";if(!(!u&&l>0)){if(t&&(l===a.length-1?f=s:p!=="**"?f=o:f=""),t&&u==="**"){f&&(c+=l===0?"":f,c+=`(?:${r}*?${f})*?`);continue}for(let g=0;g<u.length;g++){const h=u[g];h==="\\"?g<u.length-1&&(c+=dy(u[g+1]),g++):h==="?"?c+=r:h==="*"?c+=`${r}*?`:c+=dy(h)}c+=f}}return c}function _V(e,t){if(typeof t!="string")throw new TypeError(`Sample must be a string, but ${typeof t} given`);return e.test(t)}function fy(e,t){if(typeof e!="string"&&!Array.isArray(e))throw new TypeError(`The first argument must be a single pattern string or an array of patterns, but ${typeof e} given`);if((typeof t=="string"||typeof t=="boolean")&&(t={separator:t}),arguments.length===2&&!(typeof t>"u"||typeof t=="object"&&t!==null&&!Array.isArray(t)))throw new TypeError(`The second argument must be an options object or a string/boolean separator, but ${typeof t} given`);if(t=t||{},t.separator==="\\")throw new Error("\\ is not a valid separator because it is used for escaping. Try setting the separator to `true` instead");const n=IC(e,t.separator),i=new RegExp(`^${n}$`,t.flags),r=_V.bind(null,i);return r.options=t,r.pattern=e,r.regexp=i,r}const NC=(e,t,n)=>{if(e.startsWith("/"))return n?.allowRelativePaths?e.startsWith("/")&&/^\/(?!\/|\\|%2f|%5c)[\w\-.\+/@]*(?:\?[\w\-.\+/=&%@]*)?$/.test(e):!1;if(t.includes("*")||t.includes("?")){if(t.includes("://"))return fy(t)(Of(e)||e);const r=vV(e);return r?fy(t)(r):!1}const i=wV(e);return i==="http:"||i==="https:"||!i?t===Of(e):e.startsWith(t)},$C=Ra(async()=>({})),ea=Ra.create({use:[$C,Ra(async()=>({}))]}),ax=[$C];function Ot(e,t,n){const i=typeof e=="string"?e:void 0,r=typeof t=="object"?t:e,o=typeof t=="function"?t:n;return i?Il(i,{...r,use:[...r?.use||[],...ax]},async s=>Cf(s,()=>o(s))):Il({...r,use:[...r?.use||[],...ax]},async s=>Cf(s,()=>o(s)))}function CC(e){return e.context.skipOriginCheck===!0&&e.context.options.advanced?.disableCSRFCheck===void 0}const SV=H$(function(){},"disableOriginCheck: true currently also disables CSRF checks. In a future version, disableOriginCheck will ONLY disable URL validation. To keep CSRF disabled, add disableCSRFCheck: true to your config."),xV=ea(async e=>{if(e.request?.method==="GET"||e.request?.method==="OPTIONS"||e.request?.method==="HEAD"||!e.request||(await py(e),e.context.skipOriginCheck))return;const{body:t,query:n}=e,i=t?.callbackURL||n?.callbackURL,r=t?.redirectTo,o=t?.errorCallbackURL,s=t?.newUserCallbackURL,a=(c,l)=>{if(c&&!e.context.isTrustedOrigin(c,{allowRelativePaths:l!=="origin"}))throw e.context.logger.error(`Invalid ${l}: ${c}`),e.context.logger.info(`If it's a valid URL, please add ${c} to trustedOrigins in your auth config
`,`Current list of trustedOrigins: ${e.context.trustedOrigins}`),new le("FORBIDDEN",{message:`Invalid ${l}`})};i&&a(i,"callbackURL"),r&&a(r,"redirectURL"),o&&a(o,"errorCallbackURL"),s&&a(s,"newUserCallbackURL")}),Mb=e=>ea(async t=>{if(!t.request||t.context.skipOriginCheck)return;const n=e(t),i=(o,s)=>{if(o&&!t.context.isTrustedOrigin(o,{allowRelativePaths:s!=="origin"}))throw t.context.logger.error(`Invalid ${s}: ${o}`),t.context.logger.info(`If it's a valid URL, please add ${o} to trustedOrigins in your auth config
`,`Current list of trustedOrigins: ${t.context.trustedOrigins}`),new le("FORBIDDEN",{message:`Invalid ${s}`})},r=Array.isArray(n)?n:[n];for(const o of r)i(o,"callbackURL")});async function py(e,t=!1){const n=e.request?.headers;if(!n||!e.request)return;const i=n.get("origin")||n.get("referer")||"",r=n.has("cookie");if(e.context.skipCSRFCheck)return;if(CC(e)){e.context.options.advanced?.disableOriginCheck===!0&&SV();return}const o=e.context.skipOriginCheck;if(Array.isArray(o))try{const a=new URL(e.context.baseURL).pathname,c=Eb(e.request.url,a);if(o.some(l=>c.startsWith(l)))return}catch{}if(!(t||r))return;if(!i||i==="null")throw new le("FORBIDDEN",{message:Re.MISSING_OR_NULL_ORIGIN});const s=Array.isArray(e.context.options.trustedOrigins)?e.context.trustedOrigins:[...e.context.trustedOrigins,...(await e.context.options.trustedOrigins?.(e.request))?.filter(a=>!!a)||[]];if(!s.some(a=>NC(i,a)))throw e.context.logger.error(`Invalid origin: ${i}`),e.context.logger.info(`If it's a valid URL, please add ${i} to trustedOrigins in your auth config
`,`Current list of trustedOrigins: ${s}`),new le("FORBIDDEN",{message:"Invalid origin"})}const OC=ea(async e=>{e.request&&await kV(e)});async function kV(e){const t=e.request;if(!t||e.context.skipCSRFCheck||CC(e))return;const n=t.headers;if(n.has("cookie"))return await py(e);const i=n.get("Sec-Fetch-Site"),r=n.get("Sec-Fetch-Mode"),o=n.get("Sec-Fetch-Dest");if(i&&i.trim()||r&&r.trim()||o&&o.trim()){if(i==="cross-site"&&r==="navigate")throw e.context.logger.error("Blocked cross-site navigation login attempt (CSRF protection)",{secFetchSite:i,secFetchMode:r,secFetchDest:o}),new le("FORBIDDEN",{message:Re.CROSS_SITE_NAVIGATION_LOGIN_BLOCKED});return await py(e,!0)}}const ag=new Map;function EV(e,t,n){const i=Date.now(),r=t*1e3;return i-n.lastRequest<r&&n.count>=e}function AV(e){return new Response(JSON.stringify({message:"Too many requests. Please try again later."}),{status:429,statusText:"Too Many Requests",headers:{"X-Retry-After":e.toString()}})}function TV(e,t){const n=Date.now(),i=t*1e3;return Math.ceil((e+i-n)/1e3)}function IV(e){const t="rateLimit",n=e.adapter;return{get:async i=>{const r=(await n.findMany({model:t,where:[{field:"key",value:i}]}))[0];return typeof r?.lastRequest=="bigint"&&(r.lastRequest=Number(r.lastRequest)),r},set:async(i,r,o)=>{try{o?await n.updateMany({model:t,where:[{field:"key",value:i}],update:{count:r.count,lastRequest:r.lastRequest}}):await n.create({model:t,data:{key:i,count:r.count,lastRequest:r.lastRequest}})}catch(s){e.logger.error("Error setting rate limit",s)}}}}function NV(e,t){if(e.options.rateLimit?.customStorage)return e.options.rateLimit.customStorage;const n=e.rateLimit.storage;return n==="secondary-storage"?{get:async i=>{const r=await e.options.secondaryStorage?.get(i);return r?tr(r):null},set:async(i,r,o)=>{const s=t?.window??e.options.rateLimit?.window??10;await e.options.secondaryStorage?.set?.(i,JSON.stringify(r),s)}}:n==="memory"?{async get(i){const r=ag.get(i);return r?Date.now()>=r.expiresAt?(ag.delete(i),null):r.data:null},async set(i,r,o){const s=t?.window??e.options.rateLimit?.window??10,a=Date.now()+s*1e3;ag.set(i,{data:r,expiresAt:a})}}:IV(e)}async function $V(e,t){if(!t.rateLimit.enabled)return;const n=new URL(t.baseURL).pathname,i=Eb(e.url,n);let r=t.rateLimit.window,o=t.rateLimit.max;const s=TC(e,t.options);if(!s)return;const a=wF(s,i),c=CV().find(f=>f.pathMatcher(i));c&&(r=c.window,o=c.max);for(const f of t.options.plugins||[])if(f.rateLimit){const g=f.rateLimit.find(h=>h.pathMatcher(i));if(g){r=g.window,o=g.max;break}}if(t.rateLimit.customRules){const f=Object.keys(t.rateLimit.customRules).find(g=>g.includes("*")?fy(g)(i):g===i);if(f){const g=t.rateLimit.customRules[f],h=typeof g=="function"?await g(e,{window:r,max:o}):g;if(h&&(r=h.window,o=h.max),h===!1)return}}const l=NV(t,{window:r}),u=await l.get(a),p=Date.now();if(!u)await l.set(a,{key:a,count:1,lastRequest:p});else{const f=p-u.lastRequest;if(EV(o,r,u))return AV(TV(u.lastRequest,r));f>r*1e3?await l.set(a,{...u,count:1,lastRequest:p},!0):await l.set(a,{...u,count:u.count+1,lastRequest:p},!0)}}function CV(){return[{pathMatcher(e){return e.startsWith("/sign-in")||e.startsWith("/sign-up")||e.startsWith("/change-password")||e.startsWith("/change-email")},window:10,max:3}]}var RC=Object.defineProperty,OV=Object.getOwnPropertyDescriptor,RV=Object.getOwnPropertyNames,PV=Object.prototype.hasOwnProperty,DV=(e,t)=>{let n={};for(var i in e)RC(n,i,{get:e[i],enumerable:!0});return n},UV=(e,t,n,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(var r=RV(t),o=0,s=r.length,a;o<s;o++)a=r[o],!PV.call(e,a)&&a!==n&&RC(e,a,{get:(c=>t[c]).bind(null,a),enumerable:!(i=OV(t,a))||i.enumerable});return e},LV=(e,t,n,i)=>{UV(e,t,"default")};async function PC(e,t){let n;if(e.database)typeof e.database=="function"?n=e.database(e):n=await t(e);else{const i=ts(e),r=Object.keys(i).reduce((s,a)=>(s[a]=[],s),{}),{memoryAdapter:o}=await import("./index-DH4VOXNy.mjs");n=o(r)(e)}return n.transaction||(Qe.warn("Adapter does not correctly implement transaction function, patching it automatically. Please update your adapter implementation."),n.transaction=async i=>i(n)),n}async function DC(e){return PC(e,async t=>{const{createKyselyAdapter:n}=await import("./index-BZUOGsgi.mjs"),{kysely:i,databaseType:r,transaction:o}=await n(t);if(!i)throw new Fe("Failed to initialize database adapter");const{kyselyAdapter:s}=await import("./index-BZUOGsgi.mjs");return s(i,{type:r||"sqlite",debugLogs:t.database&&"debugLogs"in t.database?t.database.debugLogs:!1,transaction:o})(t)})}const MV=(e,t)=>({type:e,...t});function jV(e,t){const n=t.id?{id:t.id}:{};for(const i in e){const r=e[i],o=t[i];o!==void 0&&(n[r.fieldName||i]=o)}return n}function zV(e,t){if(!t)return null;const n={id:t.id};for(const[i,r]of Object.entries(e))n[i]=t[r.fieldName||i];return n}function UC(e,t){const n=t.hooks;async function i(c,l,u){const p=await Ea().catch(()=>null);let f=c;for(const d of n||[]){const y=d[l]?.create?.before;if(y){const v=await y(f,p);if(v===!1)return null;typeof v=="object"&&"data"in v&&(f={...f,...v.data})}}const g=u?await u.fn(f):null,h=!u||u.executeMainFn?await(await gn(e)).create({model:l,data:f,forceAllowId:!0}):g;for(const d of n||[]){const y=d[l]?.create?.after;y&&await y(h,p)}return h}async function r(c,l,u,p){const f=await Ea().catch(()=>null);let g=c;for(const y of n||[]){const v=y[u]?.update?.before;if(v){const x=await v(c,f);if(x===!1)return null;typeof x=="object"&&"data"in x&&(g={...g,...x.data})}}const h=p?await p.fn(g):null,d=!p||p.executeMainFn?await(await gn(e)).update({model:u,update:g,where:l}):h;for(const y of n||[]){const v=y[u]?.update?.after;v&&await v(d,f)}return d}async function o(c,l,u,p){const f=await Ea().catch(()=>null);let g=c;for(const y of n||[]){const v=y[u]?.update?.before;if(v){const x=await v(c,f);if(x===!1)return null;typeof x=="object"&&"data"in x&&(g={...g,...x.data})}}const h=p?await p.fn(g):null,d=!p||p.executeMainFn?await(await gn(e)).updateMany({model:u,update:g,where:l}):h;for(const y of n||[]){const v=y[u]?.update?.after;v&&await v(d,f)}return d}async function s(c,l,u){const p=await Ea().catch(()=>null);let f=null;try{f=(await(await gn(e)).findMany({model:l,where:c,limit:1}))[0]||null}catch{}if(f)for(const d of n||[]){const y=d[l]?.delete?.before;if(y&&await y(f,p)===!1)return null}const g=u?await u.fn(c):null,h=!u||u.executeMainFn?await(await gn(e)).delete({model:l,where:c}):g;if(f)for(const d of n||[]){const y=d[l]?.delete?.after;y&&await y(f,p)}return h}async function a(c,l,u){const p=await Ea().catch(()=>null);let f=[];try{f=await(await gn(e)).findMany({model:l,where:c})}catch{}for(const d of f)for(const y of n||[]){const v=y[l]?.delete?.before;if(v&&await v(d,p)===!1)return null}const g=u?await u.fn(c):null,h=!u||u.executeMainFn?await(await gn(e)).deleteMany({model:l,where:c}):g;for(const d of f)for(const y of n||[]){const v=y[l]?.delete?.after;v&&await v(d,p)}return h}return{createWithHooks:i,updateWithHooks:r,updateManyWithHooks:o,deleteWithHooks:s,deleteManyWithHooks:a}}const jb=(e,t)=>{const n=t.logger,i=t.options,r=i.secondaryStorage,o=i.session?.expiresIn||3600*24*7,{createWithHooks:s,updateWithHooks:a,updateManyWithHooks:c,deleteWithHooks:l,deleteManyWithHooks:u}=UC(e,t);async function p(f){if(!r)return;const g=await r.get(`active-sessions-${f.id}`);if(!g)return;const h=Date.now(),d=(tr(g)||[]).filter(y=>y.expiresAt>h);await Promise.all(d.map(async({token:y})=>{const v=await r.get(y);if(!v)return;const x=tr(v);if(!x)return;const E=Math.max(Math.floor(new Date(x.session.expiresAt).getTime()-h)/1e3,0);await r.set(y,JSON.stringify({session:x.session,user:f}),Math.floor(E))}))}return{createOAuthUser:async(f,g)=>kC(e,async()=>{const h=await s({createdAt:new Date,updatedAt:new Date,...f},"user",void 0);return{user:h,account:await s({...g,userId:h.id,createdAt:new Date,updatedAt:new Date},"account",void 0)}}),createUser:async f=>await s({createdAt:new Date,updatedAt:new Date,...f,email:f.email?.toLowerCase()},"user",void 0),createAccount:async f=>await s({createdAt:new Date,updatedAt:new Date,...f},"account",void 0),listSessions:async f=>{if(r){const g=await r.get(`active-sessions-${f}`);if(!g)return[];const h=tr(g)||[],d=Date.now(),y=new Set,v=[];for(const{token:x,expiresAt:E}of h){if(E<=d||y.has(x))continue;y.add(x);const N=await r.get(x);if(N)try{const C=typeof N=="string"?JSON.parse(N):N;if(!C?.session)continue;v.push(ei(t.options,{...C.session,expiresAt:new Date(C.session.expiresAt)}))}catch{continue}}return v}return await(await gn(e)).findMany({model:"session",where:[{field:"userId",value:f}]})},listUsers:async(f,g,h,d)=>await(await gn(e)).findMany({model:"user",limit:f,offset:g,sortBy:h,where:d}),countTotalUsers:async f=>{const g=await(await gn(e)).count({model:"user",where:f});return typeof g=="string"?parseInt(g):g},deleteUser:async f=>{(!r||i.session?.storeSessionInDatabase)&&await u([{field:"userId",value:f}],"session",void 0),await u([{field:"userId",value:f}],"account",void 0),await l([{field:"id",value:f}],"user",void 0)},createSession:async(f,g,h,d)=>{const y=await Ea().catch(()=>null),v=y?.headers||y?.request?.headers,{id:x,...E}=h||{},N=mC(y?.context.options??i,{}),C={ipAddress:(y?.request||y?.headers)&&TC(y?.request||y?.headers,y?.context.options)||"",userAgent:v?.get("user-agent")||"",...E,expiresAt:Ga(g?3600*24:o,"sec"),userId:f,token:Al(32),createdAt:new Date,updatedAt:new Date,...N,...d?E:{}};return await s(C,"session",r?{fn:async b=>{const P=await r.get(`active-sessions-${f}`);let $=[];const k=Date.now();P&&($=tr(P)||[],$=$.filter(z=>z.expiresAt>k&&z.token!==C.token));const D=[...$,{token:C.token,expiresAt:C.expiresAt.getTime()}].sort((z,L)=>z.expiresAt-L.expiresAt),B=D.at(-1)?.expiresAt??C.expiresAt.getTime(),J=Math.max(Math.floor((B-k)/1e3),0);J>0&&await r.set(`active-sessions-${f}`,JSON.stringify(D),J);const S=await e.findOne({model:"user",where:[{field:"id",value:f}]}),T=Math.max(Math.floor((C.expiresAt.getTime()-k)/1e3),0);return T>0&&await r.set(C.token,JSON.stringify({session:b,user:S}),T),b},executeMainFn:i.session?.storeSessionInDatabase}:void 0)},findSession:async f=>{if(r){const y=await r.get(f);if(!y&&!i.session?.storeSessionInDatabase)return null;if(y){const v=tr(y);return v?{session:ei(t.options,{...v.session,expiresAt:new Date(v.session.expiresAt),createdAt:new Date(v.session.createdAt),updatedAt:new Date(v.session.updatedAt)}),user:Vn(t.options,{...v.user,createdAt:new Date(v.user.createdAt),updatedAt:new Date(v.user.updatedAt)})}:null}}const g=await(await gn(e)).findOne({model:"session",where:[{value:f,field:"token"}],join:{user:!0}});if(!g)return null;const{user:h,...d}=g;return h?{session:ei(t.options,d),user:Vn(t.options,h)}:null},findSessions:async f=>{if(r){const h=[];for(const d of f){const y=await r.get(d);if(y)try{const v=typeof y=="string"?JSON.parse(y):y;if(!v?.session)continue;const x={session:{...v.session,expiresAt:new Date(v.session.expiresAt)},user:{...v.user,createdAt:new Date(v.user.createdAt),updatedAt:new Date(v.user.updatedAt)}};h.push(x)}catch{continue}}return h}const g=await(await gn(e)).findMany({model:"session",where:[{field:"token",value:f,operator:"in"}],join:{user:!0}});return g.length?g.some(h=>!h.user)?[]:g.map(h=>{const{user:d,...y}=h;return{session:y,user:d}}):[]},updateSession:async(f,g)=>await a(g,[{field:"token",value:f}],"session",r?{async fn(h){const d=await r.get(f);if(!d)return null;const y=tr(d);if(!y)return null;const v={...y.session,...h,expiresAt:new Date(h.expiresAt??y.session.expiresAt),createdAt:new Date(y.session.createdAt),updatedAt:new Date(h.updatedAt??y.session.updatedAt)},x=ei(t.options,v),E=Date.now(),N=new Date(x.expiresAt).getTime(),C=Math.max(Math.floor((N-E)/1e3),0);if(C>0){await r.set(f,JSON.stringify({session:x,user:y.user}),C);const b=`active-sessions-${x.userId}`,P=await r.get(b),$=(P?tr(P)||[]:[]).filter(D=>D.token!==f&&D.expiresAt>E).concat([{token:f,expiresAt:N}]).sort((D,B)=>D.expiresAt-B.expiresAt),k=$.at(-1)?.expiresAt;k&&k>E?await r.set(b,JSON.stringify($),Math.floor((k-E)/1e3)):await r.delete(b)}return x},executeMainFn:i.session?.storeSessionInDatabase}:void 0),deleteSession:async f=>{if(r){const g=await r.get(f);if(g){const{session:h}=tr(g)??{};if(!h){n.error("Session not found in secondary storage");return}const d=h.userId,y=await r.get(`active-sessions-${d}`);if(y){const v=tr(y)||[],x=Date.now(),E=v.filter(C=>C.expiresAt>x&&C.token!==f),N=E.sort((C,b)=>C.expiresAt-b.expiresAt).at(-1)?.expiresAt;E.length>0&&N&&N>Date.now()?await r.set(`active-sessions-${d}`,JSON.stringify(E),Math.floor((N-x)/1e3)):await r.delete(`active-sessions-${d}`)}else n.error("Active sessions list not found in secondary storage")}if(await r.delete(f),!i.session?.storeSessionInDatabase||t.options.session?.preserveSessionInDatabase)return}await l([{field:"token",value:f}],"session",void 0)},deleteAccounts:async f=>{await u([{field:"userId",value:f}],"account",void 0)},deleteAccount:async f=>{await l([{field:"id",value:f}],"account",void 0)},deleteSessions:async f=>{if(r){if(typeof f=="string"){const g=await r.get(`active-sessions-${f}`),h=g?tr(g):[];if(!h)return;for(const d of h)await r.delete(d.token);await r.delete(`active-sessions-${f}`)}else for(const g of f)await r.get(g)&&await r.delete(g);if(!i.session?.storeSessionInDatabase||t.options.session?.preserveSessionInDatabase)return}await u([{field:Array.isArray(f)?"token":"userId",value:f,operator:Array.isArray(f)?"in":void 0}],"session",void 0)},findOAuthUser:async(f,g,h)=>{const d=await(await gn(e)).findOne({model:"account",where:[{value:g,field:"accountId"},{value:h,field:"providerId"}],join:{user:!0}});if(d){if(d.user)return{user:d.user,linkedAccount:d,accounts:[d]};{const y=await(await gn(e)).findOne({model:"user",where:[{value:f.toLowerCase(),field:"email"}]});return y?{user:y,linkedAccount:d,accounts:[d]}:null}}else{const y=await(await gn(e)).findOne({model:"user",where:[{value:f.toLowerCase(),field:"email"}]});return y?{user:y,linkedAccount:null,accounts:await(await gn(e)).findMany({model:"account",where:[{value:y.id,field:"userId"}]})||[]}:null}},findUserByEmail:async(f,g)=>{const h=await(await gn(e)).findOne({model:"user",where:[{value:f.toLowerCase(),field:"email"}],join:{...g?.includeAccounts?{account:!0}:{}}});if(!h)return null;const{account:d,...y}=h;return{user:y,accounts:d??[]}},findUserById:async f=>f?await(await gn(e)).findOne({model:"user",where:[{field:"id",value:f}]}):null,linkAccount:async f=>await s({createdAt:new Date,updatedAt:new Date,...f},"account",void 0),updateUser:async(f,g)=>{const h=await a(g,[{field:"id",value:f}],"user",void 0);return await p(h),h},updateUserByEmail:async(f,g)=>{const h=await a(g,[{field:"email",value:f.toLowerCase()}],"user",void 0);return await p(h),h},updatePassword:async(f,g)=>{await c({password:g},[{field:"userId",value:f},{field:"providerId",value:"credential"}],"account",void 0)},findAccounts:async f=>await(await gn(e)).findMany({model:"account",where:[{field:"userId",value:f}]}),findAccount:async f=>await(await gn(e)).findOne({model:"account",where:[{field:"accountId",value:f}]}),findAccountByProviderId:async(f,g)=>await(await gn(e)).findOne({model:"account",where:[{field:"accountId",value:f},{field:"providerId",value:g}]}),findAccountByUserId:async f=>await(await gn(e)).findMany({model:"account",where:[{field:"userId",value:f}]}),updateAccount:async(f,g)=>await a(g,[{field:"id",value:f}],"account",void 0),createVerificationValue:async f=>await s({createdAt:new Date,updatedAt:new Date,...f},"verification",void 0),findVerificationValue:async f=>{const g=await(await gn(e)).findMany({model:"verification",where:[{field:"identifier",value:f}],sortBy:{field:"createdAt",direction:"desc"},limit:1});return i.verification?.disableCleanup||await u([{field:"expiresAt",value:new Date,operator:"lt"}],"verification",void 0),g[0]},deleteVerificationValue:async f=>{await l([{field:"id",value:f}],"verification",void 0)},deleteVerificationByIdentifier:async f=>{await l([{field:"identifier",value:f}],"verification",void 0)},updateVerificationValue:async(f,g)=>await a(g,[{field:"id",value:f}],"verification",void 0)}};function BV({fields:e,isClientSide:t}){const n=Object.keys(e).reduce((i,r)=>{const o=e[r];if(!o||t&&o.input===!1)return i;let s;return o.type==="json"?s=kl?kl():Hn():o.type==="string[]"||o.type==="number[]"?s=yt(o.type==="string[]"?W():Lt()):Array.isArray(o.type)?s=Hn():s=u6[o.type](),o?.required===!1&&(s=s.optional()),!t&&o?.returned===!1?i:{...i,[r]:s}},{});return ce(n)}function LC(e){const t=(0,DO.getAuthTables)(e),n={};for(const i in t){const r=t[i],o=r.fields,s={};if(Object.entries(o).forEach(([a,c])=>{if(s[c.fieldName||a]=c,c.references){const l=t[c.references.model];l&&(s[c.fieldName||a].references={...c.references,model:l.modelName,field:c.references.field})}}),n[r.modelName]){n[r.modelName].fields={...n[r.modelName].fields,...s};continue}n[r.modelName]={fields:s,order:r.order||1/0}}return n}function uo(e){return typeof e>"u"||e===void 0}function Zn(e){return typeof e=="string"}function Za(e){return typeof e=="number"}function Cl(e){return typeof e=="boolean"}function Ph(e){return e===null}function MC(e){return e instanceof Date}function Dh(e){return typeof e=="bigint"}function FV(e){return typeof Buffer<"u"&&Buffer.isBuffer(e)}function or(e){return typeof e=="function"}function Mr(e){return typeof e=="object"&&e!==null}function R(e){return Object.freeze(e)}function Nd(e){return _o(e)?e:[e]}function _o(e){return Array.isArray(e)}function Lr(e){return e}const Ut=R({is(e){return e.kind==="AlterTableNode"},create(e){return R({kind:"AlterTableNode",table:e})},cloneWithTableProps(e,t){return R({...e,...t})},cloneWithColumnAlteration(e,t){return R({...e,columnAlterations:e.columnAlterations?[...e.columnAlterations,t]:[t]})}}),zt=R({is(e){return e.kind==="IdentifierNode"},create(e){return R({kind:"IdentifierNode",name:e})}}),eo=R({is(e){return e.kind==="CreateIndexNode"},create(e){return R({kind:"CreateIndexNode",name:zt.create(e)})},cloneWith(e,t){return R({...e,...t})},cloneWithColumns(e,t){return R({...e,columns:[...e.columns||[],...t]})}}),jC=R({is(e){return e.kind==="CreateSchemaNode"},create(e,t){return R({kind:"CreateSchemaNode",schema:zt.create(e),...t})},cloneWith(e,t){return R({...e,...t})}}),WV=["preserve rows","delete rows","drop"],Nr=R({is(e){return e.kind==="CreateTableNode"},create(e){return R({kind:"CreateTableNode",table:e,columns:R([])})},cloneWithColumn(e,t){return R({...e,columns:R([...e.columns,t])})},cloneWithConstraint(e,t){return R({...e,constraints:e.constraints?R([...e.constraints,t]):R([t])})},cloneWithFrontModifier(e,t){return R({...e,frontModifiers:e.frontModifiers?R([...e.frontModifiers,t]):R([t])})},cloneWithEndModifier(e,t){return R({...e,endModifiers:e.endModifiers?R([...e.endModifiers,t]):R([t])})},cloneWith(e,t){return R({...e,...t})}}),So=R({is(e){return e.kind==="SchemableIdentifierNode"},create(e){return R({kind:"SchemableIdentifierNode",identifier:zt.create(e)})},createWithSchema(e,t){return R({kind:"SchemableIdentifierNode",schema:zt.create(e),identifier:zt.create(t)})}}),ol=R({is(e){return e.kind==="DropIndexNode"},create(e,t){return R({kind:"DropIndexNode",name:So.create(e),...t})},cloneWith(e,t){return R({...e,...t})}}),hy=R({is(e){return e.kind==="DropSchemaNode"},create(e,t){return R({kind:"DropSchemaNode",schema:zt.create(e),...t})},cloneWith(e,t){return R({...e,...t})}}),my=R({is(e){return e.kind==="DropTableNode"},create(e,t){return R({kind:"DropTableNode",table:e,...t})},cloneWith(e,t){return R({...e,...t})}}),To=R({is(e){return e.kind==="AliasNode"},create(e,t){return R({kind:"AliasNode",node:e,alias:t})}}),Oi=R({is(e){return e.kind==="TableNode"},create(e){return R({kind:"TableNode",table:So.create(e)})},createWithSchema(e,t){return R({kind:"TableNode",table:So.createWithSchema(e,t)})}});function hr(e){return Mr(e)&&or(e.toOperationNode)}function zC(e){return Mr(e)&&"expressionType"in e&&hr(e)}function VV(e){return Mr(e)&&"expression"in e&&Zn(e.alias)&&hr(e)}const Yi=R({is(e){return e.kind==="SelectModifierNode"},create(e,t){return R({kind:"SelectModifierNode",modifier:e,of:t})},createWithExpression(e){return R({kind:"SelectModifierNode",rawModifier:e})}}),ns=R({is(e){return e.kind==="AndNode"},create(e,t){return R({kind:"AndNode",left:e,right:t})}}),bc=R({is(e){return e.kind==="OrNode"},create(e,t){return R({kind:"OrNode",left:e,right:t})}}),cg=R({is(e){return e.kind==="OnNode"},create(e){return R({kind:"OnNode",on:e})},cloneWithOperation(e,t,n){return R({...e,on:t==="And"?ns.create(e.on,n):bc.create(e.on,n)})}}),Os=R({is(e){return e.kind==="JoinNode"},create(e,t){return R({kind:"JoinNode",joinType:e,table:t,on:void 0})},createWithOn(e,t,n){return R({kind:"JoinNode",joinType:e,table:t,on:cg.create(n)})},cloneWithOn(e,t){return R({...e,on:e.on?cg.cloneWithOperation(e.on,"And",t):cg.create(t)})}}),Qa=R({is(e){return e.kind==="BinaryOperationNode"},create(e,t,n){return R({kind:"BinaryOperationNode",leftOperand:e,operator:t,rightOperand:n})}}),qV=["=","==","!=","<>",">",">=","<","<=","in","not in","is","is not","like","not like","match","ilike","not ilike","@>","<@","^@","&&","?","?&","?|","!<","!>","<=>","!~","~","~*","!~*","@@","@@@","!!","<->","regexp","is distinct from","is not distinct from"],HV=["+","-","*","/","%","^","&","|","#","<<",">>"],BC=["->","->>"],KV=[...qV,...HV,"&&","||"],JV=["exists","not exists"],GV=["not","-",...JV],ZV=[...KV,...BC,...GV,"between","between symmetric"],rs=R({is(e){return e.kind==="OperatorNode"},create(e){return R({kind:"OperatorNode",operator:e})}});function cx(e){return Zn(e)&&BC.includes(e)}const Sn=R({is(e){return e.kind==="ColumnNode"},create(e){return R({kind:"ColumnNode",column:zt.create(e)})}}),zb=R({is(e){return e.kind==="SelectAllNode"},create(){return R({kind:"SelectAllNode"})}}),Uh=R({is(e){return e.kind==="ReferenceNode"},create(e,t){return R({kind:"ReferenceNode",table:t,column:e})},createSelectAll(e){return R({kind:"ReferenceNode",table:e,column:zb.create()})}});class QV{#e;get dynamicReference(){return this.#e}get refType(){}constructor(t){this.#e=t}toOperationNode(){return HC(this.#e)}}function FC(e){return Mr(e)&&hr(e)&&Zn(e.dynamicReference)}const ao=R({is(e){return e.kind==="OrderByItemNode"},create(e,t){return R({kind:"OrderByItemNode",orderBy:e,direction:t})},cloneWith(e,t){return R({...e,...t})}}),dn=R({is(e){return e.kind==="RawNode"},create(e,t){return R({kind:"RawNode",sqlFragments:R(e),parameters:R(t)})},createWithSql(e){return dn.create([e],[])},createWithChild(e){return dn.create(["",""],[e])},createWithChildren(e){return dn.create(new Array(e.length+1).fill(""),e)}}),YV=R({is(e){return e.kind==="CollateNode"},create(e){return R({kind:"CollateNode",collation:zt.create(e)})}});class bs{#e;constructor(t){this.#e=R(t)}desc(){return new bs({node:ao.cloneWith(this.#e.node,{direction:dn.createWithSql("desc")})})}asc(){return new bs({node:ao.cloneWith(this.#e.node,{direction:dn.createWithSql("asc")})})}nullsLast(){return new bs({node:ao.cloneWith(this.#e.node,{nulls:"last"})})}nullsFirst(){return new bs({node:ao.cloneWith(this.#e.node,{nulls:"first"})})}collate(t){return new bs({node:ao.cloneWith(this.#e.node,{collation:YV.create(t)})})}toOperationNode(){return this.#e.node}}const lx=new Set;function _c(e){lx.has(e)||(lx.add(e),console.log(e))}function WC(e){return e==="asc"||e==="desc"}function Bs(e){if(e.length===2)return[lg(e[0],e[1])];if(e.length===1){const[t]=e;return Array.isArray(t)?(_c("orderBy(array) is deprecated, use multiple orderBy calls instead."),t.map(n=>lg(n))):[lg(t)]}throw new Error(`Invalid number of arguments at order by! expected 1-2, received ${e.length}`)}function lg(e,t){const n=XV(e);if(ao.is(n)){if(t)throw new Error("Cannot specify direction twice!");return n}return VC(n,t)}function XV(e){if(qu(e))return ta(e);if(FC(e))return e.toOperationNode();const[t,n]=e.split(" ");return n?(_c("`orderBy('column asc')` is deprecated. Use `orderBy('column', 'asc')` instead."),VC(xo(t),n)):xo(e)}function VC(e,t){if(typeof t=="string"){if(!WC(t))throw new Error(`Invalid order by direction: ${t}`);return ao.create(e,dn.createWithSql(t))}if(zC(t))return _c("`orderBy(..., expr)` is deprecated. Use `orderBy(..., 'asc')` or `orderBy(..., (ob) => ...)` instead."),ao.create(e,t.toOperationNode());const n=ao.create(e);return t?t(new bs({node:n})).toOperationNode():n}const Rf=R({is(e){return e.kind==="JSONReferenceNode"},create(e,t){return R({kind:"JSONReferenceNode",reference:e,traversal:t})},cloneWithTraversal(e,t){return R({...e,traversal:t})}}),qC=R({is(e){return e.kind==="JSONOperatorChainNode"},create(e){return R({kind:"JSONOperatorChainNode",operator:e,values:R([])})},cloneWithValue(e,t){return R({...e,values:R([...e.values,t])})}}),sl=R({is(e){return e.kind==="JSONPathNode"},create(e){return R({kind:"JSONPathNode",inOperator:e,pathLegs:R([])})},cloneWithLeg(e,t){return R({...e,pathLegs:R([...e.pathLegs,t])})}});function HC(e){return Zn(e)?xo(e):e.toOperationNode()}function Ol(e){return _o(e)?e.map(t=>jr(t)):[jr(e)]}function jr(e){return qu(e)?ta(e):HC(e)}function eq(e,t){const n=xo(e);if(cx(t))return Rf.create(n,qC.create(rs.create(t)));const i=t.slice(0,-1);if(cx(i))return Rf.create(n,sl.create(rs.create(i)));throw new Error(`Invalid JSON operator: ${t}`)}function xo(e){if(!e.includes("."))return Uh.create(Sn.create(e));const n=e.split(".").map(Bb);if(n.length===3)return nq(n);if(n.length===2)return rq(n);throw new Error(`invalid column reference ${e}`)}function tq(e){const t=" as ";if(e.includes(t)){const[n,i]=e.split(t).map(Bb);return To.create(xo(n),zt.create(i))}else return xo(e)}function KC(e){return Sn.create(e)}function Pf(e){if(e.includes(" ")){const[n,i]=e.split(" ").map(Bb);if(!WC(i))throw new Error(`invalid order direction "${i}" next to "${n}"`);return Bs([n,i])[0]}else return KC(e)}function nq(e){const[t,n,i]=e;return Uh.create(Sn.create(i),Oi.createWithSchema(t,n))}function rq(e){const[t,n]=e;return Uh.create(Sn.create(n),Oi.create(t))}function Bb(e){return e.trim()}const JC=R({is(e){return e.kind==="PrimitiveValueListNode"},create(e){return R({kind:"PrimitiveValueListNode",values:R([...e])})}}),Lh=R({is(e){return e.kind==="ValueListNode"},create(e){return R({kind:"ValueListNode",values:R(e)})}}),ci=R({is(e){return e.kind==="ValueNode"},create(e){return R({kind:"ValueNode",value:e})},createImmediate(e){return R({kind:"ValueNode",value:e,immediate:!0})}});function iq(e){return _o(e)?oq(e):xn(e)}function xn(e){return qu(e)?ta(e):ci.create(e)}function Fb(e){return Za(e)||Cl(e)||Ph(e)}function Wb(e){if(!Fb(e))throw new Error(`unsafe immediate value ${JSON.stringify(e)}`);return ci.createImmediate(e)}function oq(e){return e.some(qu)?Lh.create(e.map(t=>xn(t))):JC.create(e)}const co=R({is(e){return e.kind==="ParensNode"},create(e){return R({kind:"ParensNode",node:e})}});function Qn(e){if(e.length===3)return Vb(e[0],e[1],e[2]);if(e.length===1)return xn(e[0]);throw new Error(`invalid arguments: ${JSON.stringify(e)}`)}function Vb(e,t,n){return sq(t)&&GC(n)?Qa.create(jr(e),gy(t),ci.createImmediate(n)):Qa.create(jr(e),gy(t),iq(n))}function Mi(e,t,n){return Qa.create(jr(e),gy(t),jr(n))}function ux(e,t){return Df(Object.entries(e).filter(([,n])=>!uo(n)).map(([n,i])=>Vb(n,GC(i)?"is":"=",i)),t)}function Df(e,t,n=!0){const i=t==="and"?ns.create:bc.create;if(e.length===0)return Qa.create(ci.createImmediate(1),rs.create("="),ci.createImmediate(t==="and"?1:0));let r=dx(e[0]);for(let o=1;o<e.length;++o)r=i(r,dx(e[o]));return e.length>1&&n?co.create(r):r}function sq(e){return e==="is"||e==="is not"}function GC(e){return Ph(e)||Cl(e)}function gy(e){if(Zn(e)&&ZV.includes(e))return rs.create(e);if(hr(e))return e.toOperationNode();throw new Error(`invalid operator ${JSON.stringify(e)}`)}function dx(e){return hr(e)?e.toOperationNode():e}const Ya=R({is(e){return e.kind==="OrderByNode"},create(e){return R({kind:"OrderByNode",items:R([...e])})},cloneWithItems(e,t){return R({...e,items:R([...e.items,...t])})}}),fx=R({is(e){return e.kind==="PartitionByNode"},create(e){return R({kind:"PartitionByNode",items:R(e)})},cloneWithItems(e,t){return R({...e,items:R([...e.items,...t])})}}),yy=R({is(e){return e.kind==="OverNode"},create(){return R({kind:"OverNode"})},cloneWithOrderByItems(e,t){return R({...e,orderBy:e.orderBy?Ya.cloneWithItems(e.orderBy,t):Ya.create(t)})},cloneWithPartitionByItems(e,t){return R({...e,partitionBy:e.partitionBy?fx.cloneWithItems(e.partitionBy,t):fx.create(t)})}}),Uf=R({is(e){return e.kind==="FromNode"},create(e){return R({kind:"FromNode",froms:R(e)})},cloneWithFroms(e,t){return R({...e,froms:R([...e.froms,...t])})}}),px=R({is(e){return e.kind==="GroupByNode"},create(e){return R({kind:"GroupByNode",items:R(e)})},cloneWithItems(e,t){return R({...e,items:R([...e.items,...t])})}}),hx=R({is(e){return e.kind==="HavingNode"},create(e){return R({kind:"HavingNode",having:e})},cloneWithOperation(e,t,n){return R({...e,having:t==="And"?ns.create(e.having,n):bc.create(e.having,n)})}}),On=R({is(e){return e.kind==="InsertQueryNode"},create(e,t,n){return R({kind:"InsertQueryNode",into:e,...t&&{with:t},replace:n})},createWithoutInto(){return R({kind:"InsertQueryNode"})},cloneWith(e,t){return R({...e,...t})}}),ZC=R({is(e){return e.kind==="ListNode"},create(e){return R({kind:"ListNode",items:R(e)})}}),Pa=R({is(e){return e.kind==="UpdateQueryNode"},create(e,t){return R({kind:"UpdateQueryNode",table:e.length===1?e[0]:ZC.create(e),...t&&{with:t}})},createWithoutTable(){return R({kind:"UpdateQueryNode"})},cloneWithFromItems(e,t){return R({...e,from:e.from?Uf.cloneWithFroms(e.from,t):Uf.create(t)})},cloneWithUpdates(e,t){return R({...e,updates:e.updates?R([...e.updates,...t]):t})},cloneWithLimit(e,t){return R({...e,limit:t})}}),wy=R({is(e){return e.kind==="UsingNode"},create(e){return R({kind:"UsingNode",tables:R(e)})},cloneWithTables(e,t){return R({...e,tables:R([...e.tables,...t])})}}),al=R({is(e){return e.kind==="DeleteQueryNode"},create(e,t){return R({kind:"DeleteQueryNode",from:Uf.create(e),...t&&{with:t}})},cloneWithOrderByItems:(e,t)=>Se.cloneWithOrderByItems(e,t),cloneWithoutOrderBy:e=>Se.cloneWithoutOrderBy(e),cloneWithLimit(e,t){return R({...e,limit:t})},cloneWithoutLimit(e){return R({...e,limit:void 0})},cloneWithUsing(e,t){return R({...e,using:e.using!==void 0?wy.cloneWithTables(e.using,t):wy.create(t)})}}),br=R({is(e){return e.kind==="WhereNode"},create(e){return R({kind:"WhereNode",where:e})},cloneWithOperation(e,t,n){return R({...e,where:t==="And"?ns.create(e.where,n):bc.create(e.where,n)})}}),mx=R({is(e){return e.kind==="ReturningNode"},create(e){return R({kind:"ReturningNode",selections:R(e)})},cloneWithSelections(e,t){return R({...e,selections:e.selections?R([...e.selections,...t]):R(t)})}}),aq=R({is(e){return e.kind==="ExplainNode"},create(e,t){return R({kind:"ExplainNode",format:e,options:t})}}),Fs=R({is(e){return e.kind==="WhenNode"},create(e){return R({kind:"WhenNode",condition:e})},cloneWithResult(e,t){return R({...e,result:t})}}),Pi=R({is(e){return e.kind==="MergeQueryNode"},create(e,t){return R({kind:"MergeQueryNode",into:e,...t&&{with:t}})},cloneWithUsing(e,t){return R({...e,using:t})},cloneWithWhen(e,t){return R({...e,whens:e.whens?R([...e.whens,t]):R([t])})},cloneWithThen(e,t){return R({...e,whens:e.whens?R([...e.whens.slice(0,-1),Fs.cloneWithResult(e.whens[e.whens.length-1],t)]):void 0})}}),gx=R({is(e){return e.kind==="OutputNode"},create(e){return R({kind:"OutputNode",selections:R(e)})},cloneWithSelections(e,t){return R({...e,selections:e.selections?R([...e.selections,...t]):R(t)})}}),Se=R({is(e){return Gt.is(e)||On.is(e)||Pa.is(e)||al.is(e)||Pi.is(e)},cloneWithEndModifier(e,t){return R({...e,endModifiers:e.endModifiers?R([...e.endModifiers,t]):R([t])})},cloneWithWhere(e,t){return R({...e,where:e.where?br.cloneWithOperation(e.where,"And",t):br.create(t)})},cloneWithJoin(e,t){return R({...e,joins:e.joins?R([...e.joins,t]):R([t])})},cloneWithReturning(e,t){return R({...e,returning:e.returning?mx.cloneWithSelections(e.returning,t):mx.create(t)})},cloneWithoutReturning(e){return R({...e,returning:void 0})},cloneWithoutWhere(e){return R({...e,where:void 0})},cloneWithExplain(e,t,n){return R({...e,explain:aq.create(t,n?.toOperationNode())})},cloneWithTop(e,t){return R({...e,top:t})},cloneWithOutput(e,t){return R({...e,output:e.output?gx.cloneWithSelections(e.output,t):gx.create(t)})},cloneWithOrderByItems(e,t){return R({...e,orderBy:e.orderBy?Ya.cloneWithItems(e.orderBy,t):Ya.create(t)})},cloneWithoutOrderBy(e){return R({...e,orderBy:void 0})}}),Gt=R({is(e){return e.kind==="SelectQueryNode"},create(e){return R({kind:"SelectQueryNode",...e&&{with:e}})},createFrom(e,t){return R({kind:"SelectQueryNode",from:Uf.create(e),...t&&{with:t}})},cloneWithSelections(e,t){return R({...e,selections:e.selections?R([...e.selections,...t]):R(t)})},cloneWithDistinctOn(e,t){return R({...e,distinctOn:e.distinctOn?R([...e.distinctOn,...t]):R(t)})},cloneWithFrontModifier(e,t){return R({...e,frontModifiers:e.frontModifiers?R([...e.frontModifiers,t]):R([t])})},cloneWithOrderByItems:(e,t)=>Se.cloneWithOrderByItems(e,t),cloneWithGroupByItems(e,t){return R({...e,groupBy:e.groupBy?px.cloneWithItems(e.groupBy,t):px.create(t)})},cloneWithLimit(e,t){return R({...e,limit:t})},cloneWithOffset(e,t){return R({...e,offset:t})},cloneWithFetch(e,t){return R({...e,fetch:t})},cloneWithHaving(e,t){return R({...e,having:e.having?hx.cloneWithOperation(e.having,"And",t):hx.create(t)})},cloneWithSetOperations(e,t){return R({...e,setOperations:e.setOperations?R([...e.setOperations,...t]):R([...t])})},cloneWithoutSelections(e){return R({...e,selections:[]})},cloneWithoutLimit(e){return R({...e,limit:void 0})},cloneWithoutOffset(e){return R({...e,offset:void 0})},cloneWithoutOrderBy:e=>Se.cloneWithoutOrderBy(e),cloneWithoutGroupBy(e){return R({...e,groupBy:void 0})}});class cl{#e;constructor(t){this.#e=R(t)}on(...t){return new cl({...this.#e,joinNode:Os.cloneWithOn(this.#e.joinNode,Qn(t))})}onRef(t,n,i){return new cl({...this.#e,joinNode:Os.cloneWithOn(this.#e.joinNode,Mi(t,n,i))})}onTrue(){return new cl({...this.#e,joinNode:Os.cloneWithOn(this.#e.joinNode,dn.createWithSql("true"))})}$call(t){return t(this)}toOperationNode(){return this.#e.joinNode}}const cq=R({is(e){return e.kind==="PartitionByItemNode"},create(e){return R({kind:"PartitionByItemNode",partitionBy:e})}});function lq(e){return Ol(e).map(cq.create)}class ll{#e;constructor(t){this.#e=R(t)}orderBy(...t){return new ll({overNode:yy.cloneWithOrderByItems(this.#e.overNode,Bs(t))})}clearOrderBy(){return new ll({overNode:Se.cloneWithoutOrderBy(this.#e.overNode)})}partitionBy(t){return new ll({overNode:yy.cloneWithPartitionByItems(this.#e.overNode,lq(t))})}$call(t){return t(this)}toOperationNode(){return this.#e.overNode}}const ul=R({is(e){return e.kind==="SelectionNode"},create(e){return R({kind:"SelectionNode",selection:e})},createSelectAll(){return R({kind:"SelectionNode",selection:zb.create()})},createSelectAllFromTable(e){return R({kind:"SelectionNode",selection:Uh.createSelectAll(e)})}});function Fr(e){return or(e)?Fr(e(kc())):_o(e)?e.map(t=>yx(t)):[yx(e)]}function yx(e){return Zn(e)?ul.create(tq(e)):FC(e)?ul.create(e.toOperationNode()):ul.create(cO(e))}function li(e){return e?Array.isArray(e)?e.map(wx):[wx(e)]:[ul.createSelectAll()]}function wx(e){if(Zn(e))return ul.createSelectAllFromTable(_n(e));throw new Error(`invalid value selectAll expression: ${JSON.stringify(e)}`)}const uq=R({is(e){return e.kind==="ValuesNode"},create(e){return R({kind:"ValuesNode",values:R(e)})}}),dq=R({is(e){return e.kind==="DefaultInsertValueNode"},create(){return R({kind:"DefaultInsertValueNode"})}});function QC(e){const t=or(e)?e(kc()):e,n=_o(t)?t:R([t]);return fq(n)}function fq(e){const t=pq(e);return[R([...t.keys()].map(Sn.create)),uq.create(e.map(n=>hq(n,t)))]}function pq(e){const t=new Map;for(const n of e){const i=Object.keys(n);for(const r of i)!t.has(r)&&n[r]!==void 0&&t.set(r,t.size)}return t}function hq(e,t){const n=Object.keys(e),i=Array.from({length:t.size});let r=!1,o=n.length;for(const a of n){const c=t.get(a);if(uo(c)){o--;continue}const l=e[a];(uo(l)||qu(l))&&(r=!0),i[c]=l}if(o<t.size||r){const a=dq.create();return Lh.create(i.map(c=>uo(c)?a:xn(c)))}return JC.create(i)}const YC=R({is(e){return e.kind==="ColumnUpdateNode"},create(e,t){return R({kind:"ColumnUpdateNode",column:e,value:t})}});function mq(...e){return e.length===2?[YC.create(jr(e[0]),xn(e[1]))]:qb(e[0])}function qb(e){const t=or(e)?e(kc()):e;return Object.entries(t).filter(([n,i])=>i!==void 0).map(([n,i])=>YC.create(Sn.create(n),xn(i)))}const gq=R({is(e){return e.kind==="OnDuplicateKeyNode"},create(e){return R({kind:"OnDuplicateKeyNode",updates:e})}});class yq{insertId;numInsertedOrUpdatedRows;constructor(t,n){this.insertId=t,this.numInsertedOrUpdatedRows=n}}class Wu extends Error{node;constructor(t){super("no result"),this.node=t}}function Vu(e){return Object.prototype.hasOwnProperty.call(e,"prototype")}const Or=R({is(e){return e.kind==="OnConflictNode"},create(){return R({kind:"OnConflictNode"})},cloneWith(e,t){return R({...e,...t})},cloneWithIndexWhere(e,t){return R({...e,indexWhere:e.indexWhere?br.cloneWithOperation(e.indexWhere,"And",t):br.create(t)})},cloneWithIndexOrWhere(e,t){return R({...e,indexWhere:e.indexWhere?br.cloneWithOperation(e.indexWhere,"Or",t):br.create(t)})},cloneWithUpdateWhere(e,t){return R({...e,updateWhere:e.updateWhere?br.cloneWithOperation(e.updateWhere,"And",t):br.create(t)})},cloneWithUpdateOrWhere(e,t){return R({...e,updateWhere:e.updateWhere?br.cloneWithOperation(e.updateWhere,"Or",t):br.create(t)})},cloneWithoutIndexWhere(e){return R({...e,indexWhere:void 0})},cloneWithoutUpdateWhere(e){return R({...e,updateWhere:void 0})}});class no{#e;constructor(t){this.#e=R(t)}column(t){const n=Sn.create(t);return new no({...this.#e,onConflictNode:Or.cloneWith(this.#e.onConflictNode,{columns:this.#e.onConflictNode.columns?R([...this.#e.onConflictNode.columns,n]):R([n])})})}columns(t){const n=t.map(Sn.create);return new no({...this.#e,onConflictNode:Or.cloneWith(this.#e.onConflictNode,{columns:this.#e.onConflictNode.columns?R([...this.#e.onConflictNode.columns,...n]):R(n)})})}constraint(t){return new no({...this.#e,onConflictNode:Or.cloneWith(this.#e.onConflictNode,{constraint:zt.create(t)})})}expression(t){return new no({...this.#e,onConflictNode:Or.cloneWith(this.#e.onConflictNode,{indexExpression:t.toOperationNode()})})}where(...t){return new no({...this.#e,onConflictNode:Or.cloneWithIndexWhere(this.#e.onConflictNode,Qn(t))})}whereRef(t,n,i){return new no({...this.#e,onConflictNode:Or.cloneWithIndexWhere(this.#e.onConflictNode,Mi(t,n,i))})}clearWhere(){return new no({...this.#e,onConflictNode:Or.cloneWithoutIndexWhere(this.#e.onConflictNode)})}doNothing(){return new wq({...this.#e,onConflictNode:Or.cloneWith(this.#e.onConflictNode,{doNothing:!0})})}doUpdateSet(t){return new dl({...this.#e,onConflictNode:Or.cloneWith(this.#e.onConflictNode,{updates:qb(t)})})}$call(t){return t(this)}}class wq{#e;constructor(t){this.#e=R(t)}toOperationNode(){return this.#e.onConflictNode}}class dl{#e;constructor(t){this.#e=R(t)}where(...t){return new dl({...this.#e,onConflictNode:Or.cloneWithUpdateWhere(this.#e.onConflictNode,Qn(t))})}whereRef(t,n,i){return new dl({...this.#e,onConflictNode:Or.cloneWithUpdateWhere(this.#e.onConflictNode,Mi(t,n,i))})}clearWhere(){return new dl({...this.#e,onConflictNode:Or.cloneWithoutUpdateWhere(this.#e.onConflictNode)})}$call(t){return t(this)}toOperationNode(){return this.#e.onConflictNode}}const vq=R({is(e){return e.kind==="TopNode"},create(e,t){return R({kind:"TopNode",expression:e,modifiers:t})}});function Sc(e,t){if(!Za(e)&&!Dh(e))throw new Error(`Invalid top expression: ${e}`);if(!uo(t)&&!bq(t))throw new Error(`Invalid top modifiers: ${t}`);return vq.create(e,t)}function bq(e){return e==="percent"||e==="with ties"||e==="percent with ties"}const va=R({is(e){return e.kind==="OrActionNode"},create(e){return R({kind:"OrActionNode",action:e})}});class Wt{#e;constructor(t){this.#e=R(t)}values(t){const[n,i]=QC(t);return new Wt({...this.#e,queryNode:On.cloneWith(this.#e.queryNode,{columns:n,values:i})})}columns(t){return new Wt({...this.#e,queryNode:On.cloneWith(this.#e.queryNode,{columns:R(t.map(Sn.create))})})}expression(t){return new Wt({...this.#e,queryNode:On.cloneWith(this.#e.queryNode,{values:ta(t)})})}defaultValues(){return new Wt({...this.#e,queryNode:On.cloneWith(this.#e.queryNode,{defaultValues:!0})})}modifyEnd(t){return new Wt({...this.#e,queryNode:Se.cloneWithEndModifier(this.#e.queryNode,t.toOperationNode())})}ignore(){return new Wt({...this.#e,queryNode:On.cloneWith(this.#e.queryNode,{orAction:va.create("ignore")})})}orIgnore(){return new Wt({...this.#e,queryNode:On.cloneWith(this.#e.queryNode,{orAction:va.create("ignore")})})}orAbort(){return new Wt({...this.#e,queryNode:On.cloneWith(this.#e.queryNode,{orAction:va.create("abort")})})}orFail(){return new Wt({...this.#e,queryNode:On.cloneWith(this.#e.queryNode,{orAction:va.create("fail")})})}orReplace(){return new Wt({...this.#e,queryNode:On.cloneWith(this.#e.queryNode,{orAction:va.create("replace")})})}orRollback(){return new Wt({...this.#e,queryNode:On.cloneWith(this.#e.queryNode,{orAction:va.create("rollback")})})}top(t,n){return new Wt({...this.#e,queryNode:Se.cloneWithTop(this.#e.queryNode,Sc(t,n))})}onConflict(t){return new Wt({...this.#e,queryNode:On.cloneWith(this.#e.queryNode,{onConflict:t(new no({onConflictNode:Or.create()})).toOperationNode()})})}onDuplicateKeyUpdate(t){return new Wt({...this.#e,queryNode:On.cloneWith(this.#e.queryNode,{onDuplicateKey:gq.create(qb(t))})})}returning(t){return new Wt({...this.#e,queryNode:Se.cloneWithReturning(this.#e.queryNode,Fr(t))})}returningAll(){return new Wt({...this.#e,queryNode:Se.cloneWithReturning(this.#e.queryNode,li())})}output(t){return new Wt({...this.#e,queryNode:Se.cloneWithOutput(this.#e.queryNode,Fr(t))})}outputAll(t){return new Wt({...this.#e,queryNode:Se.cloneWithOutput(this.#e.queryNode,li(t))})}clearReturning(){return new Wt({...this.#e,queryNode:Se.cloneWithoutReturning(this.#e.queryNode)})}$call(t){return t(this)}$if(t,n){return t?n(this):new Wt({...this.#e})}$castTo(){return new Wt(this.#e)}$narrowType(){return new Wt(this.#e)}$assertType(){return new Wt(this.#e)}withPlugin(t){return new Wt({...this.#e,executor:this.#e.executor.withPlugin(t)})}toOperationNode(){return this.#e.executor.transformQuery(this.#e.queryNode,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){const t=this.compile(),n=await this.#e.executor.executeQuery(t),{adapter:i}=this.#e.executor,r=t.query;return r.returning&&i.supportsReturning||r.output&&i.supportsOutput?n.rows:[new yq(n.insertId,n.numAffectedRows??BigInt(0))]}async executeTakeFirst(){const[t]=await this.execute();return t}async executeTakeFirstOrThrow(t=Wu){const n=await this.executeTakeFirst();if(n===void 0)throw Vu(t)?new t(this.toOperationNode()):t(this.toOperationNode());return n}async*stream(t=100){const n=this.compile(),i=this.#e.executor.stream(n,t);for await(const r of i)yield*r.rows}async explain(t,n){return await new Wt({...this.#e,queryNode:Se.cloneWithExplain(this.#e.queryNode,t,n)}).execute()}}class _q{numDeletedRows;constructor(t){this.numDeletedRows=t}}const Hb=R({is(e){return e.kind==="LimitNode"},create(e){return R({kind:"LimitNode",limit:e})}});class cn{#e;constructor(t){this.#e=R(t)}where(...t){return new cn({...this.#e,queryNode:Se.cloneWithWhere(this.#e.queryNode,Qn(t))})}whereRef(t,n,i){return new cn({...this.#e,queryNode:Se.cloneWithWhere(this.#e.queryNode,Mi(t,n,i))})}clearWhere(){return new cn({...this.#e,queryNode:Se.cloneWithoutWhere(this.#e.queryNode)})}top(t,n){return new cn({...this.#e,queryNode:Se.cloneWithTop(this.#e.queryNode,Sc(t,n))})}using(t){return new cn({...this.#e,queryNode:al.cloneWithUsing(this.#e.queryNode,Da(t))})}innerJoin(...t){return this.#t("InnerJoin",t)}leftJoin(...t){return this.#t("LeftJoin",t)}rightJoin(...t){return this.#t("RightJoin",t)}fullJoin(...t){return this.#t("FullJoin",t)}#t(t,n){return new cn({...this.#e,queryNode:Se.cloneWithJoin(this.#e.queryNode,jh(t,n))})}returning(t){return new cn({...this.#e,queryNode:Se.cloneWithReturning(this.#e.queryNode,Fr(t))})}returningAll(t){return new cn({...this.#e,queryNode:Se.cloneWithReturning(this.#e.queryNode,li(t))})}output(t){return new cn({...this.#e,queryNode:Se.cloneWithOutput(this.#e.queryNode,Fr(t))})}outputAll(t){return new cn({...this.#e,queryNode:Se.cloneWithOutput(this.#e.queryNode,li(t))})}clearReturning(){return new cn({...this.#e,queryNode:Se.cloneWithoutReturning(this.#e.queryNode)})}clearLimit(){return new cn({...this.#e,queryNode:al.cloneWithoutLimit(this.#e.queryNode)})}orderBy(...t){return new cn({...this.#e,queryNode:Se.cloneWithOrderByItems(this.#e.queryNode,Bs(t))})}clearOrderBy(){return new cn({...this.#e,queryNode:Se.cloneWithoutOrderBy(this.#e.queryNode)})}limit(t){return new cn({...this.#e,queryNode:al.cloneWithLimit(this.#e.queryNode,Hb.create(xn(t)))})}modifyEnd(t){return new cn({...this.#e,queryNode:Se.cloneWithEndModifier(this.#e.queryNode,t.toOperationNode())})}$call(t){return t(this)}$if(t,n){return t?n(this):new cn({...this.#e})}$castTo(){return new cn(this.#e)}$narrowType(){return new cn(this.#e)}$assertType(){return new cn(this.#e)}withPlugin(t){return new cn({...this.#e,executor:this.#e.executor.withPlugin(t)})}toOperationNode(){return this.#e.executor.transformQuery(this.#e.queryNode,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){const t=this.compile(),n=await this.#e.executor.executeQuery(t),{adapter:i}=this.#e.executor,r=t.query;return r.returning&&i.supportsReturning||r.output&&i.supportsOutput?n.rows:[new _q(n.numAffectedRows??BigInt(0))]}async executeTakeFirst(){const[t]=await this.execute();return t}async executeTakeFirstOrThrow(t=Wu){const n=await this.executeTakeFirst();if(n===void 0)throw Vu(t)?new t(this.toOperationNode()):t(this.toOperationNode());return n}async*stream(t=100){const n=this.compile(),i=this.#e.executor.stream(n,t);for await(const r of i)yield*r.rows}async explain(t,n){return await new cn({...this.#e,queryNode:Se.cloneWithExplain(this.#e.queryNode,t,n)}).execute()}}class Sq{numUpdatedRows;numChangedRows;constructor(t,n){this.numUpdatedRows=t,this.numChangedRows=n}}class en{#e;constructor(t){this.#e=R(t)}where(...t){return new en({...this.#e,queryNode:Se.cloneWithWhere(this.#e.queryNode,Qn(t))})}whereRef(t,n,i){return new en({...this.#e,queryNode:Se.cloneWithWhere(this.#e.queryNode,Mi(t,n,i))})}clearWhere(){return new en({...this.#e,queryNode:Se.cloneWithoutWhere(this.#e.queryNode)})}top(t,n){return new en({...this.#e,queryNode:Se.cloneWithTop(this.#e.queryNode,Sc(t,n))})}from(t){return new en({...this.#e,queryNode:Pa.cloneWithFromItems(this.#e.queryNode,Da(t))})}innerJoin(...t){return this.#t("InnerJoin",t)}leftJoin(...t){return this.#t("LeftJoin",t)}rightJoin(...t){return this.#t("RightJoin",t)}fullJoin(...t){return this.#t("FullJoin",t)}#t(t,n){return new en({...this.#e,queryNode:Se.cloneWithJoin(this.#e.queryNode,jh(t,n))})}orderBy(...t){return new en({...this.#e,queryNode:Se.cloneWithOrderByItems(this.#e.queryNode,Bs(t))})}clearOrderBy(){return new en({...this.#e,queryNode:Se.cloneWithoutOrderBy(this.#e.queryNode)})}limit(t){return new en({...this.#e,queryNode:Pa.cloneWithLimit(this.#e.queryNode,Hb.create(xn(t)))})}set(...t){return new en({...this.#e,queryNode:Pa.cloneWithUpdates(this.#e.queryNode,mq(...t))})}returning(t){return new en({...this.#e,queryNode:Se.cloneWithReturning(this.#e.queryNode,Fr(t))})}returningAll(t){return new en({...this.#e,queryNode:Se.cloneWithReturning(this.#e.queryNode,li(t))})}output(t){return new en({...this.#e,queryNode:Se.cloneWithOutput(this.#e.queryNode,Fr(t))})}outputAll(t){return new en({...this.#e,queryNode:Se.cloneWithOutput(this.#e.queryNode,li(t))})}modifyEnd(t){return new en({...this.#e,queryNode:Se.cloneWithEndModifier(this.#e.queryNode,t.toOperationNode())})}clearReturning(){return new en({...this.#e,queryNode:Se.cloneWithoutReturning(this.#e.queryNode)})}$call(t){return t(this)}$if(t,n){return t?n(this):new en({...this.#e})}$castTo(){return new en(this.#e)}$narrowType(){return new en(this.#e)}$assertType(){return new en(this.#e)}withPlugin(t){return new en({...this.#e,executor:this.#e.executor.withPlugin(t)})}toOperationNode(){return this.#e.executor.transformQuery(this.#e.queryNode,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){const t=this.compile(),n=await this.#e.executor.executeQuery(t),{adapter:i}=this.#e.executor,r=t.query;return r.returning&&i.supportsReturning||r.output&&i.supportsOutput?n.rows:[new Sq(n.numAffectedRows??BigInt(0),n.numChangedRows)]}async executeTakeFirst(){const[t]=await this.execute();return t}async executeTakeFirstOrThrow(t=Wu){const n=await this.executeTakeFirst();if(n===void 0)throw Vu(t)?new t(this.toOperationNode()):t(this.toOperationNode());return n}async*stream(t=100){const n=this.compile(),i=this.#e.executor.stream(n,t);for await(const r of i)yield*r.rows}async explain(t,n){return await new en({...this.#e,queryNode:Se.cloneWithExplain(this.#e.queryNode,t,n)}).execute()}}const vx=R({is(e){return e.kind==="CommonTableExpressionNameNode"},create(e,t){return R({kind:"CommonTableExpressionNameNode",table:Oi.create(e),columns:t?R(t.map(Sn.create)):void 0})}}),Lf=R({is(e){return e.kind==="CommonTableExpressionNode"},create(e,t){return R({kind:"CommonTableExpressionNode",name:e,expression:t})},cloneWith(e,t){return R({...e,...t})}});class Mf{#e;constructor(t){this.#e=R(t)}materialized(){return new Mf({...this.#e,node:Lf.cloneWith(this.#e.node,{materialized:!0})})}notMaterialized(){return new Mf({...this.#e,node:Lf.cloneWith(this.#e.node,{materialized:!1})})}toOperationNode(){return this.#e.node}}function bx(e,t){const n=t(Rq()).toOperationNode();return or(e)?e(xq(n)).toOperationNode():Lf.create(XC(e),n)}function xq(e){return t=>new Mf({node:Lf.create(XC(t),e)})}function XC(e){if(e.includes("(")){const t=e.split(/[\(\)]/),n=t[0],i=t[1].split(",").map(r=>r.trim());return vx.create(n,i)}else return vx.create(e)}const $d=R({is(e){return e.kind==="WithNode"},create(e,t){return R({kind:"WithNode",expressions:R([e]),...t})},cloneWithExpression(e,t){return R({...e,expressions:R([...e.expressions,t])})}}),_x=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","0","1","2","3","4","5","6","7","8","9"];function eO(e){let t="";for(let n=0;n<e;++n)t+=kq();return t}function kq(){return _x[~~(Math.random()*_x.length)]}function pt(){return new Eq}class Eq{#e;get queryId(){return this.#e===void 0&&(this.#e=eO(8)),this.#e}}class tO{nodeStack=[];#e=R({AliasNode:this.transformAlias.bind(this),ColumnNode:this.transformColumn.bind(this),IdentifierNode:this.transformIdentifier.bind(this),SchemableIdentifierNode:this.transformSchemableIdentifier.bind(this),RawNode:this.transformRaw.bind(this),ReferenceNode:this.transformReference.bind(this),SelectQueryNode:this.transformSelectQuery.bind(this),SelectionNode:this.transformSelection.bind(this),TableNode:this.transformTable.bind(this),FromNode:this.transformFrom.bind(this),SelectAllNode:this.transformSelectAll.bind(this),AndNode:this.transformAnd.bind(this),OrNode:this.transformOr.bind(this),ValueNode:this.transformValue.bind(this),ValueListNode:this.transformValueList.bind(this),PrimitiveValueListNode:this.transformPrimitiveValueList.bind(this),ParensNode:this.transformParens.bind(this),JoinNode:this.transformJoin.bind(this),OperatorNode:this.transformOperator.bind(this),WhereNode:this.transformWhere.bind(this),InsertQueryNode:this.transformInsertQuery.bind(this),DeleteQueryNode:this.transformDeleteQuery.bind(this),ReturningNode:this.transformReturning.bind(this),CreateTableNode:this.transformCreateTable.bind(this),AddColumnNode:this.transformAddColumn.bind(this),ColumnDefinitionNode:this.transformColumnDefinition.bind(this),DropTableNode:this.transformDropTable.bind(this),DataTypeNode:this.transformDataType.bind(this),OrderByNode:this.transformOrderBy.bind(this),OrderByItemNode:this.transformOrderByItem.bind(this),GroupByNode:this.transformGroupBy.bind(this),GroupByItemNode:this.transformGroupByItem.bind(this),UpdateQueryNode:this.transformUpdateQuery.bind(this),ColumnUpdateNode:this.transformColumnUpdate.bind(this),LimitNode:this.transformLimit.bind(this),OffsetNode:this.transformOffset.bind(this),OnConflictNode:this.transformOnConflict.bind(this),OnDuplicateKeyNode:this.transformOnDuplicateKey.bind(this),CreateIndexNode:this.transformCreateIndex.bind(this),DropIndexNode:this.transformDropIndex.bind(this),ListNode:this.transformList.bind(this),PrimaryKeyConstraintNode:this.transformPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.transformUniqueConstraint.bind(this),ReferencesNode:this.transformReferences.bind(this),CheckConstraintNode:this.transformCheckConstraint.bind(this),WithNode:this.transformWith.bind(this),CommonTableExpressionNode:this.transformCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.transformCommonTableExpressionName.bind(this),HavingNode:this.transformHaving.bind(this),CreateSchemaNode:this.transformCreateSchema.bind(this),DropSchemaNode:this.transformDropSchema.bind(this),AlterTableNode:this.transformAlterTable.bind(this),DropColumnNode:this.transformDropColumn.bind(this),RenameColumnNode:this.transformRenameColumn.bind(this),AlterColumnNode:this.transformAlterColumn.bind(this),ModifyColumnNode:this.transformModifyColumn.bind(this),AddConstraintNode:this.transformAddConstraint.bind(this),DropConstraintNode:this.transformDropConstraint.bind(this),RenameConstraintNode:this.transformRenameConstraint.bind(this),ForeignKeyConstraintNode:this.transformForeignKeyConstraint.bind(this),CreateViewNode:this.transformCreateView.bind(this),RefreshMaterializedViewNode:this.transformRefreshMaterializedView.bind(this),DropViewNode:this.transformDropView.bind(this),GeneratedNode:this.transformGenerated.bind(this),DefaultValueNode:this.transformDefaultValue.bind(this),OnNode:this.transformOn.bind(this),ValuesNode:this.transformValues.bind(this),SelectModifierNode:this.transformSelectModifier.bind(this),CreateTypeNode:this.transformCreateType.bind(this),DropTypeNode:this.transformDropType.bind(this),ExplainNode:this.transformExplain.bind(this),DefaultInsertValueNode:this.transformDefaultInsertValue.bind(this),AggregateFunctionNode:this.transformAggregateFunction.bind(this),OverNode:this.transformOver.bind(this),PartitionByNode:this.transformPartitionBy.bind(this),PartitionByItemNode:this.transformPartitionByItem.bind(this),SetOperationNode:this.transformSetOperation.bind(this),BinaryOperationNode:this.transformBinaryOperation.bind(this),UnaryOperationNode:this.transformUnaryOperation.bind(this),UsingNode:this.transformUsing.bind(this),FunctionNode:this.transformFunction.bind(this),CaseNode:this.transformCase.bind(this),WhenNode:this.transformWhen.bind(this),JSONReferenceNode:this.transformJSONReference.bind(this),JSONPathNode:this.transformJSONPath.bind(this),JSONPathLegNode:this.transformJSONPathLeg.bind(this),JSONOperatorChainNode:this.transformJSONOperatorChain.bind(this),TupleNode:this.transformTuple.bind(this),MergeQueryNode:this.transformMergeQuery.bind(this),MatchedNode:this.transformMatched.bind(this),AddIndexNode:this.transformAddIndex.bind(this),CastNode:this.transformCast.bind(this),FetchNode:this.transformFetch.bind(this),TopNode:this.transformTop.bind(this),OutputNode:this.transformOutput.bind(this),OrActionNode:this.transformOrAction.bind(this),CollateNode:this.transformCollate.bind(this)});transformNode(t,n){if(!t)return t;this.nodeStack.push(t);const i=this.transformNodeImpl(t,n);return this.nodeStack.pop(),R(i)}transformNodeImpl(t,n){return this.#e[t.kind](t,n)}transformNodeList(t,n){return t&&R(t.map(i=>this.transformNode(i,n)))}transformSelectQuery(t,n){return{kind:"SelectQueryNode",from:this.transformNode(t.from,n),selections:this.transformNodeList(t.selections,n),distinctOn:this.transformNodeList(t.distinctOn,n),joins:this.transformNodeList(t.joins,n),groupBy:this.transformNode(t.groupBy,n),orderBy:this.transformNode(t.orderBy,n),where:this.transformNode(t.where,n),frontModifiers:this.transformNodeList(t.frontModifiers,n),endModifiers:this.transformNodeList(t.endModifiers,n),limit:this.transformNode(t.limit,n),offset:this.transformNode(t.offset,n),with:this.transformNode(t.with,n),having:this.transformNode(t.having,n),explain:this.transformNode(t.explain,n),setOperations:this.transformNodeList(t.setOperations,n),fetch:this.transformNode(t.fetch,n),top:this.transformNode(t.top,n)}}transformSelection(t,n){return{kind:"SelectionNode",selection:this.transformNode(t.selection,n)}}transformColumn(t,n){return{kind:"ColumnNode",column:this.transformNode(t.column,n)}}transformAlias(t,n){return{kind:"AliasNode",node:this.transformNode(t.node,n),alias:this.transformNode(t.alias,n)}}transformTable(t,n){return{kind:"TableNode",table:this.transformNode(t.table,n)}}transformFrom(t,n){return{kind:"FromNode",froms:this.transformNodeList(t.froms,n)}}transformReference(t,n){return{kind:"ReferenceNode",column:this.transformNode(t.column,n),table:this.transformNode(t.table,n)}}transformAnd(t,n){return{kind:"AndNode",left:this.transformNode(t.left,n),right:this.transformNode(t.right,n)}}transformOr(t,n){return{kind:"OrNode",left:this.transformNode(t.left,n),right:this.transformNode(t.right,n)}}transformValueList(t,n){return{kind:"ValueListNode",values:this.transformNodeList(t.values,n)}}transformParens(t,n){return{kind:"ParensNode",node:this.transformNode(t.node,n)}}transformJoin(t,n){return{kind:"JoinNode",joinType:t.joinType,table:this.transformNode(t.table,n),on:this.transformNode(t.on,n)}}transformRaw(t,n){return{kind:"RawNode",sqlFragments:R([...t.sqlFragments]),parameters:this.transformNodeList(t.parameters,n)}}transformWhere(t,n){return{kind:"WhereNode",where:this.transformNode(t.where,n)}}transformInsertQuery(t,n){return{kind:"InsertQueryNode",into:this.transformNode(t.into,n),columns:this.transformNodeList(t.columns,n),values:this.transformNode(t.values,n),returning:this.transformNode(t.returning,n),onConflict:this.transformNode(t.onConflict,n),onDuplicateKey:this.transformNode(t.onDuplicateKey,n),endModifiers:this.transformNodeList(t.endModifiers,n),with:this.transformNode(t.with,n),ignore:t.ignore,orAction:this.transformNode(t.orAction,n),replace:t.replace,explain:this.transformNode(t.explain,n),defaultValues:t.defaultValues,top:this.transformNode(t.top,n),output:this.transformNode(t.output,n)}}transformValues(t,n){return{kind:"ValuesNode",values:this.transformNodeList(t.values,n)}}transformDeleteQuery(t,n){return{kind:"DeleteQueryNode",from:this.transformNode(t.from,n),using:this.transformNode(t.using,n),joins:this.transformNodeList(t.joins,n),where:this.transformNode(t.where,n),returning:this.transformNode(t.returning,n),endModifiers:this.transformNodeList(t.endModifiers,n),with:this.transformNode(t.with,n),orderBy:this.transformNode(t.orderBy,n),limit:this.transformNode(t.limit,n),explain:this.transformNode(t.explain,n),top:this.transformNode(t.top,n),output:this.transformNode(t.output,n)}}transformReturning(t,n){return{kind:"ReturningNode",selections:this.transformNodeList(t.selections,n)}}transformCreateTable(t,n){return{kind:"CreateTableNode",table:this.transformNode(t.table,n),columns:this.transformNodeList(t.columns,n),constraints:this.transformNodeList(t.constraints,n),temporary:t.temporary,ifNotExists:t.ifNotExists,onCommit:t.onCommit,frontModifiers:this.transformNodeList(t.frontModifiers,n),endModifiers:this.transformNodeList(t.endModifiers,n),selectQuery:this.transformNode(t.selectQuery,n)}}transformColumnDefinition(t,n){return{kind:"ColumnDefinitionNode",column:this.transformNode(t.column,n),dataType:this.transformNode(t.dataType,n),references:this.transformNode(t.references,n),primaryKey:t.primaryKey,autoIncrement:t.autoIncrement,unique:t.unique,notNull:t.notNull,unsigned:t.unsigned,defaultTo:this.transformNode(t.defaultTo,n),check:this.transformNode(t.check,n),generated:this.transformNode(t.generated,n),frontModifiers:this.transformNodeList(t.frontModifiers,n),endModifiers:this.transformNodeList(t.endModifiers,n),nullsNotDistinct:t.nullsNotDistinct,identity:t.identity,ifNotExists:t.ifNotExists}}transformAddColumn(t,n){return{kind:"AddColumnNode",column:this.transformNode(t.column,n)}}transformDropTable(t,n){return{kind:"DropTableNode",table:this.transformNode(t.table,n),ifExists:t.ifExists,cascade:t.cascade}}transformOrderBy(t,n){return{kind:"OrderByNode",items:this.transformNodeList(t.items,n)}}transformOrderByItem(t,n){return{kind:"OrderByItemNode",orderBy:this.transformNode(t.orderBy,n),direction:this.transformNode(t.direction,n),collation:this.transformNode(t.collation,n),nulls:t.nulls}}transformGroupBy(t,n){return{kind:"GroupByNode",items:this.transformNodeList(t.items,n)}}transformGroupByItem(t,n){return{kind:"GroupByItemNode",groupBy:this.transformNode(t.groupBy,n)}}transformUpdateQuery(t,n){return{kind:"UpdateQueryNode",table:this.transformNode(t.table,n),from:this.transformNode(t.from,n),joins:this.transformNodeList(t.joins,n),where:this.transformNode(t.where,n),updates:this.transformNodeList(t.updates,n),returning:this.transformNode(t.returning,n),endModifiers:this.transformNodeList(t.endModifiers,n),with:this.transformNode(t.with,n),explain:this.transformNode(t.explain,n),limit:this.transformNode(t.limit,n),top:this.transformNode(t.top,n),output:this.transformNode(t.output,n),orderBy:this.transformNode(t.orderBy,n)}}transformColumnUpdate(t,n){return{kind:"ColumnUpdateNode",column:this.transformNode(t.column,n),value:this.transformNode(t.value,n)}}transformLimit(t,n){return{kind:"LimitNode",limit:this.transformNode(t.limit,n)}}transformOffset(t,n){return{kind:"OffsetNode",offset:this.transformNode(t.offset,n)}}transformOnConflict(t,n){return{kind:"OnConflictNode",columns:this.transformNodeList(t.columns,n),constraint:this.transformNode(t.constraint,n),indexExpression:this.transformNode(t.indexExpression,n),indexWhere:this.transformNode(t.indexWhere,n),updates:this.transformNodeList(t.updates,n),updateWhere:this.transformNode(t.updateWhere,n),doNothing:t.doNothing}}transformOnDuplicateKey(t,n){return{kind:"OnDuplicateKeyNode",updates:this.transformNodeList(t.updates,n)}}transformCreateIndex(t,n){return{kind:"CreateIndexNode",name:this.transformNode(t.name,n),table:this.transformNode(t.table,n),columns:this.transformNodeList(t.columns,n),unique:t.unique,using:this.transformNode(t.using,n),ifNotExists:t.ifNotExists,where:this.transformNode(t.where,n),nullsNotDistinct:t.nullsNotDistinct}}transformList(t,n){return{kind:"ListNode",items:this.transformNodeList(t.items,n)}}transformDropIndex(t,n){return{kind:"DropIndexNode",name:this.transformNode(t.name,n),table:this.transformNode(t.table,n),ifExists:t.ifExists,cascade:t.cascade}}transformPrimaryKeyConstraint(t,n){return{kind:"PrimaryKeyConstraintNode",columns:this.transformNodeList(t.columns,n),name:this.transformNode(t.name,n),deferrable:t.deferrable,initiallyDeferred:t.initiallyDeferred}}transformUniqueConstraint(t,n){return{kind:"UniqueConstraintNode",columns:this.transformNodeList(t.columns,n),name:this.transformNode(t.name,n),nullsNotDistinct:t.nullsNotDistinct,deferrable:t.deferrable,initiallyDeferred:t.initiallyDeferred}}transformForeignKeyConstraint(t,n){return{kind:"ForeignKeyConstraintNode",columns:this.transformNodeList(t.columns,n),references:this.transformNode(t.references,n),name:this.transformNode(t.name,n),onDelete:t.onDelete,onUpdate:t.onUpdate,deferrable:t.deferrable,initiallyDeferred:t.initiallyDeferred}}transformSetOperation(t,n){return{kind:"SetOperationNode",operator:t.operator,expression:this.transformNode(t.expression,n),all:t.all}}transformReferences(t,n){return{kind:"ReferencesNode",table:this.transformNode(t.table,n),columns:this.transformNodeList(t.columns,n),onDelete:t.onDelete,onUpdate:t.onUpdate}}transformCheckConstraint(t,n){return{kind:"CheckConstraintNode",expression:this.transformNode(t.expression,n),name:this.transformNode(t.name,n)}}transformWith(t,n){return{kind:"WithNode",expressions:this.transformNodeList(t.expressions,n),recursive:t.recursive}}transformCommonTableExpression(t,n){return{kind:"CommonTableExpressionNode",name:this.transformNode(t.name,n),materialized:t.materialized,expression:this.transformNode(t.expression,n)}}transformCommonTableExpressionName(t,n){return{kind:"CommonTableExpressionNameNode",table:this.transformNode(t.table,n),columns:this.transformNodeList(t.columns,n)}}transformHaving(t,n){return{kind:"HavingNode",having:this.transformNode(t.having,n)}}transformCreateSchema(t,n){return{kind:"CreateSchemaNode",schema:this.transformNode(t.schema,n),ifNotExists:t.ifNotExists}}transformDropSchema(t,n){return{kind:"DropSchemaNode",schema:this.transformNode(t.schema,n),ifExists:t.ifExists,cascade:t.cascade}}transformAlterTable(t,n){return{kind:"AlterTableNode",table:this.transformNode(t.table,n),renameTo:this.transformNode(t.renameTo,n),setSchema:this.transformNode(t.setSchema,n),columnAlterations:this.transformNodeList(t.columnAlterations,n),addConstraint:this.transformNode(t.addConstraint,n),dropConstraint:this.transformNode(t.dropConstraint,n),renameConstraint:this.transformNode(t.renameConstraint,n),addIndex:this.transformNode(t.addIndex,n),dropIndex:this.transformNode(t.dropIndex,n)}}transformDropColumn(t,n){return{kind:"DropColumnNode",column:this.transformNode(t.column,n)}}transformRenameColumn(t,n){return{kind:"RenameColumnNode",column:this.transformNode(t.column,n),renameTo:this.transformNode(t.renameTo,n)}}transformAlterColumn(t,n){return{kind:"AlterColumnNode",column:this.transformNode(t.column,n),dataType:this.transformNode(t.dataType,n),dataTypeExpression:this.transformNode(t.dataTypeExpression,n),setDefault:this.transformNode(t.setDefault,n),dropDefault:t.dropDefault,setNotNull:t.setNotNull,dropNotNull:t.dropNotNull}}transformModifyColumn(t,n){return{kind:"ModifyColumnNode",column:this.transformNode(t.column,n)}}transformAddConstraint(t,n){return{kind:"AddConstraintNode",constraint:this.transformNode(t.constraint,n)}}transformDropConstraint(t,n){return{kind:"DropConstraintNode",constraintName:this.transformNode(t.constraintName,n),ifExists:t.ifExists,modifier:t.modifier}}transformRenameConstraint(t,n){return{kind:"RenameConstraintNode",oldName:this.transformNode(t.oldName,n),newName:this.transformNode(t.newName,n)}}transformCreateView(t,n){return{kind:"CreateViewNode",name:this.transformNode(t.name,n),temporary:t.temporary,orReplace:t.orReplace,ifNotExists:t.ifNotExists,materialized:t.materialized,columns:this.transformNodeList(t.columns,n),as:this.transformNode(t.as,n)}}transformRefreshMaterializedView(t,n){return{kind:"RefreshMaterializedViewNode",name:this.transformNode(t.name,n),concurrently:t.concurrently,withNoData:t.withNoData}}transformDropView(t,n){return{kind:"DropViewNode",name:this.transformNode(t.name,n),ifExists:t.ifExists,materialized:t.materialized,cascade:t.cascade}}transformGenerated(t,n){return{kind:"GeneratedNode",byDefault:t.byDefault,always:t.always,identity:t.identity,stored:t.stored,expression:this.transformNode(t.expression,n)}}transformDefaultValue(t,n){return{kind:"DefaultValueNode",defaultValue:this.transformNode(t.defaultValue,n)}}transformOn(t,n){return{kind:"OnNode",on:this.transformNode(t.on,n)}}transformSelectModifier(t,n){return{kind:"SelectModifierNode",modifier:t.modifier,rawModifier:this.transformNode(t.rawModifier,n),of:this.transformNodeList(t.of,n)}}transformCreateType(t,n){return{kind:"CreateTypeNode",name:this.transformNode(t.name,n),enum:this.transformNode(t.enum,n)}}transformDropType(t,n){return{kind:"DropTypeNode",name:this.transformNode(t.name,n),ifExists:t.ifExists}}transformExplain(t,n){return{kind:"ExplainNode",format:t.format,options:this.transformNode(t.options,n)}}transformSchemableIdentifier(t,n){return{kind:"SchemableIdentifierNode",schema:this.transformNode(t.schema,n),identifier:this.transformNode(t.identifier,n)}}transformAggregateFunction(t,n){return{kind:"AggregateFunctionNode",func:t.func,aggregated:this.transformNodeList(t.aggregated,n),distinct:t.distinct,orderBy:this.transformNode(t.orderBy,n),withinGroup:this.transformNode(t.withinGroup,n),filter:this.transformNode(t.filter,n),over:this.transformNode(t.over,n)}}transformOver(t,n){return{kind:"OverNode",orderBy:this.transformNode(t.orderBy,n),partitionBy:this.transformNode(t.partitionBy,n)}}transformPartitionBy(t,n){return{kind:"PartitionByNode",items:this.transformNodeList(t.items,n)}}transformPartitionByItem(t,n){return{kind:"PartitionByItemNode",partitionBy:this.transformNode(t.partitionBy,n)}}transformBinaryOperation(t,n){return{kind:"BinaryOperationNode",leftOperand:this.transformNode(t.leftOperand,n),operator:this.transformNode(t.operator,n),rightOperand:this.transformNode(t.rightOperand,n)}}transformUnaryOperation(t,n){return{kind:"UnaryOperationNode",operator:this.transformNode(t.operator,n),operand:this.transformNode(t.operand,n)}}transformUsing(t,n){return{kind:"UsingNode",tables:this.transformNodeList(t.tables,n)}}transformFunction(t,n){return{kind:"FunctionNode",func:t.func,arguments:this.transformNodeList(t.arguments,n)}}transformCase(t,n){return{kind:"CaseNode",value:this.transformNode(t.value,n),when:this.transformNodeList(t.when,n),else:this.transformNode(t.else,n),isStatement:t.isStatement}}transformWhen(t,n){return{kind:"WhenNode",condition:this.transformNode(t.condition,n),result:this.transformNode(t.result,n)}}transformJSONReference(t,n){return{kind:"JSONReferenceNode",reference:this.transformNode(t.reference,n),traversal:this.transformNode(t.traversal,n)}}transformJSONPath(t,n){return{kind:"JSONPathNode",inOperator:this.transformNode(t.inOperator,n),pathLegs:this.transformNodeList(t.pathLegs,n)}}transformJSONPathLeg(t,n){return{kind:"JSONPathLegNode",type:t.type,value:t.value}}transformJSONOperatorChain(t,n){return{kind:"JSONOperatorChainNode",operator:this.transformNode(t.operator,n),values:this.transformNodeList(t.values,n)}}transformTuple(t,n){return{kind:"TupleNode",values:this.transformNodeList(t.values,n)}}transformMergeQuery(t,n){return{kind:"MergeQueryNode",into:this.transformNode(t.into,n),using:this.transformNode(t.using,n),whens:this.transformNodeList(t.whens,n),with:this.transformNode(t.with,n),top:this.transformNode(t.top,n),endModifiers:this.transformNodeList(t.endModifiers,n),output:this.transformNode(t.output,n),returning:this.transformNode(t.returning,n)}}transformMatched(t,n){return{kind:"MatchedNode",not:t.not,bySource:t.bySource}}transformAddIndex(t,n){return{kind:"AddIndexNode",name:this.transformNode(t.name,n),columns:this.transformNodeList(t.columns,n),unique:t.unique,using:this.transformNode(t.using,n),ifNotExists:t.ifNotExists}}transformCast(t,n){return{kind:"CastNode",expression:this.transformNode(t.expression,n),dataType:this.transformNode(t.dataType,n)}}transformFetch(t,n){return{kind:"FetchNode",rowCount:this.transformNode(t.rowCount,n),modifier:t.modifier}}transformTop(t,n){return{kind:"TopNode",expression:t.expression,modifiers:t.modifiers}}transformOutput(t,n){return{kind:"OutputNode",selections:this.transformNodeList(t.selections,n)}}transformDataType(t,n){return t}transformSelectAll(t,n){return t}transformIdentifier(t,n){return t}transformValue(t,n){return t}transformPrimitiveValueList(t,n){return t}transformOperator(t,n){return t}transformDefaultInsertValue(t,n){return t}transformOrAction(t,n){return t}transformCollate(t,n){return t}}const Aq=R({AlterTableNode:!0,CreateIndexNode:!0,CreateSchemaNode:!0,CreateTableNode:!0,CreateTypeNode:!0,CreateViewNode:!0,RefreshMaterializedViewNode:!0,DeleteQueryNode:!0,DropIndexNode:!0,DropSchemaNode:!0,DropTableNode:!0,DropTypeNode:!0,DropViewNode:!0,InsertQueryNode:!0,RawNode:!0,SelectQueryNode:!0,UpdateQueryNode:!0,MergeQueryNode:!0}),Tq={json_agg:!0,to_json:!0};class Iq extends tO{#e;#t=new Set;#n=new Set;constructor(t){super(),this.#e=t}transformNodeImpl(t,n){if(!this.#i(t))return super.transformNodeImpl(t,n);const i=this.#a(t);for(const s of i)this.#n.add(s);const r=this.#s(t);for(const s of r)this.#t.add(s);const o=super.transformNodeImpl(t,n);for(const s of r)this.#t.delete(s);for(const s of i)this.#n.delete(s);return o}transformSchemableIdentifier(t,n){const i=super.transformSchemableIdentifier(t,n);return i.schema||!this.#t.has(t.identifier.name)?i:{...i,schema:zt.create(this.#e)}}transformReferences(t,n){const i=super.transformReferences(t,n);return i.table.table.schema?i:{...i,table:Oi.createWithSchema(this.#e,i.table.table.identifier.name)}}transformAggregateFunction(t,n){return{...super.transformAggregateFunction({...t,aggregated:[]},n),aggregated:this.#r(t,n,"aggregated")}}transformFunction(t,n){return{...super.transformFunction({...t,arguments:[]},n),arguments:this.#r(t,n,"arguments")}}transformSelectModifier(t,n){return{...super.transformSelectModifier({...t,of:void 0},n),of:t.of?.map(i=>Oi.is(i)&&!i.table.schema?{...i,table:this.transformIdentifier(i.table.identifier,n)}:this.transformNode(i,n))}}#r(t,n,i){return Tq[t.func]?t[i].map(r=>!Oi.is(r)||r.table.schema?this.transformNode(r,n):{...r,table:this.transformIdentifier(r.table.identifier,n)}):this.transformNodeList(t[i],n)}#i(t){return t.kind in Aq}#s(t){const n=new Set;if("name"in t&&t.name&&So.is(t.name)&&this.#c(t.name,n),"from"in t&&t.from)for(const i of t.from.froms)this.#o(i,n);if("into"in t&&t.into&&this.#o(t.into,n),"table"in t&&t.table&&this.#o(t.table,n),"joins"in t&&t.joins)for(const i of t.joins)this.#o(i.table,n);return"using"in t&&t.using&&(Os.is(t.using)?this.#o(t.using.table,n):this.#o(t.using,n)),n}#a(t){const n=new Set;return"with"in t&&t.with&&this.#l(t.with,n),n}#o(t,n){if(Oi.is(t))return this.#c(t.table,n);if(To.is(t)&&Oi.is(t.node))return this.#c(t.node.table,n);if(ZC.is(t)){for(const i of t.items)this.#o(i,n);return}if(wy.is(t)){for(const i of t.tables)this.#o(i,n);return}}#c(t,n){const i=t.identifier.name;!this.#t.has(i)&&!this.#n.has(i)&&n.add(i)}#l(t,n){for(const i of t.expressions){const r=i.name.table.table.identifier.name;this.#n.has(r)||n.add(r)}}}class xc{#e;constructor(t){this.#e=new Iq(t)}transformQuery(t){return this.#e.transformNode(t.node,t.queryId)}async transformResult(t){return t.result}}const Nq=R({is(e){return e.kind==="MatchedNode"},create(e,t=!1){return R({kind:"MatchedNode",not:e,bySource:t})}});function Sx(e,t,n){return Fs.create(Df([Nq.create(!e.isMatched,e.bySource),...t&&t.length>0?[t.length===3&&n?Mi(t[0],t[1],t[2]):Qn(t)]:[]],"and",!1))}function fl(e){return Zn(e)?dn.create([e],[]):hr(e)?e.toOperationNode():e}class pl{#e;#t;#n;constructor(){this.#e=new Promise((t,n)=>{this.#n=n,this.#t=t})}get promise(){return this.#e}resolve=t=>{this.#t&&this.#t(t)};reject=t=>{this.#n&&this.#n(t)}}async function nO(e){const t=new pl,n=new pl;return e.provideConnection(async i=>(t.resolve(i),await n.promise)).catch(i=>t.reject(i)),R({connection:await t.promise,release:n.resolve})}const $q=R([]);class rO{#e;constructor(t=$q){this.#e=t}get plugins(){return this.#e}transformQuery(t,n){for(const i of this.#e){const r=i.transformQuery({node:t,queryId:n});if(r.kind===t.kind)t=r;else throw new Error(["KyselyPlugin.transformQuery must return a node","of the same kind that was given to it.",`The plugin was given a ${t.kind}`,`but it returned a ${r.kind}`].join(" "))}return t}async executeQuery(t){return await this.provideConnection(async n=>{const i=await n.executeQuery(t);return"numUpdatedOrDeletedRows"in i&&_c("kysely:warning: outdated driver/plugin detected! `QueryResult.numUpdatedOrDeletedRows` has been replaced with `QueryResult.numAffectedRows`."),await this.#t(i,t.queryId)})}async*stream(t,n){const{connection:i,release:r}=await nO(this);try{for await(const o of i.streamQuery(t,n))yield await this.#t(o,t.queryId)}finally{r()}}async#t(t,n){for(const i of this.#e)t=await i.transformResult({result:t,queryId:n});return t}}class Ta extends rO{get adapter(){throw new Error("this query cannot be compiled to SQL")}compileQuery(){throw new Error("this query cannot be compiled to SQL")}provideConnection(){throw new Error("this query cannot be executed")}withConnectionProvider(){throw new Error("this query cannot have a connection provider")}withPlugin(t){return new Ta([...this.plugins,t])}withPlugins(t){return new Ta([...this.plugins,...t])}withPluginAtFront(t){return new Ta([t,...this.plugins])}withoutPlugins(){return new Ta([])}}const Mh=new Ta;class Cq{numChangedRows;constructor(t){this.numChangedRows=t}}class Mo{#e;constructor(t){this.#e=R(t)}modifyEnd(t){return new Mo({...this.#e,queryNode:Se.cloneWithEndModifier(this.#e.queryNode,t.toOperationNode())})}top(t,n){return new Mo({...this.#e,queryNode:Se.cloneWithTop(this.#e.queryNode,Sc(t,n))})}using(...t){return new _r({...this.#e,queryNode:Pi.cloneWithUsing(this.#e.queryNode,jh("Using",t))})}returning(t){return new Mo({...this.#e,queryNode:Se.cloneWithReturning(this.#e.queryNode,Fr(t))})}returningAll(t){return new Mo({...this.#e,queryNode:Se.cloneWithReturning(this.#e.queryNode,li(t))})}output(t){return new Mo({...this.#e,queryNode:Se.cloneWithOutput(this.#e.queryNode,Fr(t))})}outputAll(t){return new Mo({...this.#e,queryNode:Se.cloneWithOutput(this.#e.queryNode,li(t))})}}class _r{#e;constructor(t){this.#e=R(t)}modifyEnd(t){return new _r({...this.#e,queryNode:Se.cloneWithEndModifier(this.#e.queryNode,t.toOperationNode())})}top(t,n){return new _r({...this.#e,queryNode:Se.cloneWithTop(this.#e.queryNode,Sc(t,n))})}whenMatched(){return this.#t([])}whenMatchedAnd(...t){return this.#t(t)}whenMatchedAndRef(t,n,i){return this.#t([t,n,i],!0)}#t(t,n){return new xx({...this.#e,queryNode:Pi.cloneWithWhen(this.#e.queryNode,Sx({isMatched:!0},t,n))})}whenNotMatched(){return this.#n([])}whenNotMatchedAnd(...t){return this.#n(t)}whenNotMatchedAndRef(t,n,i){return this.#n([t,n,i],!0)}whenNotMatchedBySource(){return this.#n([],!1,!0)}whenNotMatchedBySourceAnd(...t){return this.#n(t,!1,!0)}whenNotMatchedBySourceAndRef(t,n,i){return this.#n([t,n,i],!0,!0)}returning(t){return new _r({...this.#e,queryNode:Se.cloneWithReturning(this.#e.queryNode,Fr(t))})}returningAll(t){return new _r({...this.#e,queryNode:Se.cloneWithReturning(this.#e.queryNode,li(t))})}output(t){return new _r({...this.#e,queryNode:Se.cloneWithOutput(this.#e.queryNode,Fr(t))})}outputAll(t){return new _r({...this.#e,queryNode:Se.cloneWithOutput(this.#e.queryNode,li(t))})}#n(t,n=!1,i=!1){const r={...this.#e,queryNode:Pi.cloneWithWhen(this.#e.queryNode,Sx({isMatched:!1,bySource:i},t,n))},o=i?xx:Oq;return new o(r)}$call(t){return t(this)}$if(t,n){return t?n(this):new _r({...this.#e})}toOperationNode(){return this.#e.executor.transformQuery(this.#e.queryNode,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){const t=this.compile(),n=await this.#e.executor.executeQuery(t),{adapter:i}=this.#e.executor,r=t.query;return r.returning&&i.supportsReturning||r.output&&i.supportsOutput?n.rows:[new Cq(n.numAffectedRows)]}async executeTakeFirst(){const[t]=await this.execute();return t}async executeTakeFirstOrThrow(t=Wu){const n=await this.executeTakeFirst();if(n===void 0)throw Vu(t)?new t(this.toOperationNode()):t(this.toOperationNode());return n}}class xx{#e;constructor(t){this.#e=R(t)}thenDelete(){return new _r({...this.#e,queryNode:Pi.cloneWithThen(this.#e.queryNode,fl("delete"))})}thenDoNothing(){return new _r({...this.#e,queryNode:Pi.cloneWithThen(this.#e.queryNode,fl("do nothing"))})}thenUpdate(t){return new _r({...this.#e,queryNode:Pi.cloneWithThen(this.#e.queryNode,fl(t(new en({queryId:this.#e.queryId,executor:Mh,queryNode:Pa.createWithoutTable()}))))})}thenUpdateSet(...t){return this.thenUpdate(n=>n.set(...t))}}class Oq{#e;constructor(t){this.#e=R(t)}thenDoNothing(){return new _r({...this.#e,queryNode:Pi.cloneWithThen(this.#e.queryNode,fl("do nothing"))})}thenInsertValues(t){const[n,i]=QC(t);return new _r({...this.#e,queryNode:Pi.cloneWithThen(this.#e.queryNode,fl(On.cloneWith(On.createWithoutInto(),{columns:n,values:i})))})}}class Wo{#e;constructor(t){this.#e=R(t)}selectFrom(t){return vy({queryId:pt(),executor:this.#e.executor,queryNode:Gt.createFrom(Da(t),this.#e.withNode)})}selectNoFrom(t){return vy({queryId:pt(),executor:this.#e.executor,queryNode:Gt.cloneWithSelections(Gt.create(this.#e.withNode),Fr(t))})}insertInto(t){return new Wt({queryId:pt(),executor:this.#e.executor,queryNode:On.create(_n(t),this.#e.withNode)})}replaceInto(t){return new Wt({queryId:pt(),executor:this.#e.executor,queryNode:On.create(_n(t),this.#e.withNode,!0)})}deleteFrom(t){return new cn({queryId:pt(),executor:this.#e.executor,queryNode:al.create(Da(t),this.#e.withNode)})}updateTable(t){return new en({queryId:pt(),executor:this.#e.executor,queryNode:Pa.create(Da(t),this.#e.withNode)})}mergeInto(t){return new Mo({queryId:pt(),executor:this.#e.executor,queryNode:Pi.create(lO(t),this.#e.withNode)})}with(t,n){const i=bx(t,n);return new Wo({...this.#e,withNode:this.#e.withNode?$d.cloneWithExpression(this.#e.withNode,i):$d.create(i)})}withRecursive(t,n){const i=bx(t,n);return new Wo({...this.#e,withNode:this.#e.withNode?$d.cloneWithExpression(this.#e.withNode,i):$d.create(i,{recursive:!0})})}withPlugin(t){return new Wo({...this.#e,executor:this.#e.executor.withPlugin(t)})}withoutPlugins(){return new Wo({...this.#e,executor:this.#e.executor.withoutPlugins()})}withSchema(t){return new Wo({...this.#e,executor:this.#e.executor.withPluginAtFront(new xc(t))})}}function Rq(){return new Wo({executor:Mh})}function Pq(e,t){return new cl({joinNode:Os.create(e,Pl(t))})}function Dq(){return new ll({overNode:yy.create()})}function jh(e,t){if(t.length===3)return Lq(e,t[0],t[1],t[2]);if(t.length===2)return Uq(e,t[0],t[1]);if(t.length===1)return Mq(e,t[0]);throw new Error("not implemented")}function Uq(e,t,n){return n(Pq(e,t)).toOperationNode()}function Lq(e,t,n,i){return Os.createWithOn(e,Pl(t),Mi(n,"=",i))}function Mq(e,t){return Os.create(e,Pl(t))}const jq=R({is(e){return e.kind==="OffsetNode"},create(e){return R({kind:"OffsetNode",offset:e})}}),zq=R({is(e){return e.kind==="GroupByItemNode"},create(e){return R({kind:"GroupByItemNode",groupBy:e})}});function Bq(e){return e=or(e)?e(kc()):e,Ol(e).map(zq.create)}const iO=R({is(e){return e.kind==="SetOperationNode"},create(e,t,n){return R({kind:"SetOperationNode",operator:e,expression:t,all:n})}});function ba(e,t,n){return or(t)&&(t=t(Jb())),_o(t)||(t=[t]),t.map(i=>iO.create(e,ta(i),n))}class Vt{#e;constructor(t){this.#e=t}get expressionType(){}as(t){return new Kb(this,t)}or(...t){return new jf(bc.create(this.#e,Qn(t)))}and(...t){return new zf(ns.create(this.#e,Qn(t)))}$castTo(){return new Vt(this.#e)}$notNull(){return new Vt(this.#e)}toOperationNode(){return this.#e}}class Kb{#e;#t;constructor(t,n){this.#e=t,this.#t=n}get expression(){return this.#e}get alias(){return this.#t}toOperationNode(){return To.create(this.#e.toOperationNode(),hr(this.#t)?this.#t.toOperationNode():zt.create(this.#t))}}class jf{#e;constructor(t){this.#e=t}get expressionType(){}as(t){return new Kb(this,t)}or(...t){return new jf(bc.create(this.#e,Qn(t)))}$castTo(){return new jf(this.#e)}toOperationNode(){return co.create(this.#e)}}class zf{#e;constructor(t){this.#e=t}get expressionType(){}as(t){return new Kb(this,t)}and(...t){return new zf(ns.create(this.#e,Qn(t)))}$castTo(){return new zf(this.#e)}toOperationNode(){return co.create(this.#e)}}const Fq=R({is(e){return e.kind==="FetchNode"},create(e,t){return{kind:"FetchNode",rowCount:ci.create(e),modifier:t}}});function Wq(e,t){if(!Za(e)&&!Dh(e))throw new Error(`Invalid fetch row count: ${e}`);if(!Vq(t))throw new Error(`Invalid fetch modifier: ${t}`);return Fq.create(e,t)}function Vq(e){return e==="only"||e==="with ties"}class et{#e;constructor(t){this.#e=R(t)}get expressionType(){}get isSelectQueryBuilder(){return!0}where(...t){return new et({...this.#e,queryNode:Se.cloneWithWhere(this.#e.queryNode,Qn(t))})}whereRef(t,n,i){return new et({...this.#e,queryNode:Se.cloneWithWhere(this.#e.queryNode,Mi(t,n,i))})}having(...t){return new et({...this.#e,queryNode:Gt.cloneWithHaving(this.#e.queryNode,Qn(t))})}havingRef(t,n,i){return new et({...this.#e,queryNode:Gt.cloneWithHaving(this.#e.queryNode,Mi(t,n,i))})}select(t){return new et({...this.#e,queryNode:Gt.cloneWithSelections(this.#e.queryNode,Fr(t))})}distinctOn(t){return new et({...this.#e,queryNode:Gt.cloneWithDistinctOn(this.#e.queryNode,Ol(t))})}modifyFront(t){return new et({...this.#e,queryNode:Gt.cloneWithFrontModifier(this.#e.queryNode,Yi.createWithExpression(t.toOperationNode()))})}modifyEnd(t){return new et({...this.#e,queryNode:Se.cloneWithEndModifier(this.#e.queryNode,Yi.createWithExpression(t.toOperationNode()))})}distinct(){return new et({...this.#e,queryNode:Gt.cloneWithFrontModifier(this.#e.queryNode,Yi.create("Distinct"))})}forUpdate(t){return new et({...this.#e,queryNode:Se.cloneWithEndModifier(this.#e.queryNode,Yi.create("ForUpdate",t?Nd(t).map(_n):void 0))})}forShare(t){return new et({...this.#e,queryNode:Se.cloneWithEndModifier(this.#e.queryNode,Yi.create("ForShare",t?Nd(t).map(_n):void 0))})}forKeyShare(t){return new et({...this.#e,queryNode:Se.cloneWithEndModifier(this.#e.queryNode,Yi.create("ForKeyShare",t?Nd(t).map(_n):void 0))})}forNoKeyUpdate(t){return new et({...this.#e,queryNode:Se.cloneWithEndModifier(this.#e.queryNode,Yi.create("ForNoKeyUpdate",t?Nd(t).map(_n):void 0))})}skipLocked(){return new et({...this.#e,queryNode:Se.cloneWithEndModifier(this.#e.queryNode,Yi.create("SkipLocked"))})}noWait(){return new et({...this.#e,queryNode:Se.cloneWithEndModifier(this.#e.queryNode,Yi.create("NoWait"))})}selectAll(t){return new et({...this.#e,queryNode:Gt.cloneWithSelections(this.#e.queryNode,li(t))})}innerJoin(...t){return this.#t("InnerJoin",t)}leftJoin(...t){return this.#t("LeftJoin",t)}rightJoin(...t){return this.#t("RightJoin",t)}fullJoin(...t){return this.#t("FullJoin",t)}crossJoin(...t){return this.#t("CrossJoin",t)}innerJoinLateral(...t){return this.#t("LateralInnerJoin",t)}leftJoinLateral(...t){return this.#t("LateralLeftJoin",t)}crossJoinLateral(...t){return this.#t("LateralCrossJoin",t)}crossApply(...t){return this.#t("CrossApply",t)}outerApply(...t){return this.#t("OuterApply",t)}#t(t,n){return new et({...this.#e,queryNode:Se.cloneWithJoin(this.#e.queryNode,jh(t,n))})}orderBy(...t){return new et({...this.#e,queryNode:Se.cloneWithOrderByItems(this.#e.queryNode,Bs(t))})}groupBy(t){return new et({...this.#e,queryNode:Gt.cloneWithGroupByItems(this.#e.queryNode,Bq(t))})}limit(t){return new et({...this.#e,queryNode:Gt.cloneWithLimit(this.#e.queryNode,Hb.create(xn(t)))})}offset(t){return new et({...this.#e,queryNode:Gt.cloneWithOffset(this.#e.queryNode,jq.create(xn(t)))})}fetch(t,n="only"){return new et({...this.#e,queryNode:Gt.cloneWithFetch(this.#e.queryNode,Wq(t,n))})}top(t,n){return new et({...this.#e,queryNode:Se.cloneWithTop(this.#e.queryNode,Sc(t,n))})}union(t){return new et({...this.#e,queryNode:Gt.cloneWithSetOperations(this.#e.queryNode,ba("union",t,!1))})}unionAll(t){return new et({...this.#e,queryNode:Gt.cloneWithSetOperations(this.#e.queryNode,ba("union",t,!0))})}intersect(t){return new et({...this.#e,queryNode:Gt.cloneWithSetOperations(this.#e.queryNode,ba("intersect",t,!1))})}intersectAll(t){return new et({...this.#e,queryNode:Gt.cloneWithSetOperations(this.#e.queryNode,ba("intersect",t,!0))})}except(t){return new et({...this.#e,queryNode:Gt.cloneWithSetOperations(this.#e.queryNode,ba("except",t,!1))})}exceptAll(t){return new et({...this.#e,queryNode:Gt.cloneWithSetOperations(this.#e.queryNode,ba("except",t,!0))})}as(t){return new qq(this,t)}clearSelect(){return new et({...this.#e,queryNode:Gt.cloneWithoutSelections(this.#e.queryNode)})}clearWhere(){return new et({...this.#e,queryNode:Se.cloneWithoutWhere(this.#e.queryNode)})}clearLimit(){return new et({...this.#e,queryNode:Gt.cloneWithoutLimit(this.#e.queryNode)})}clearOffset(){return new et({...this.#e,queryNode:Gt.cloneWithoutOffset(this.#e.queryNode)})}clearOrderBy(){return new et({...this.#e,queryNode:Se.cloneWithoutOrderBy(this.#e.queryNode)})}clearGroupBy(){return new et({...this.#e,queryNode:Gt.cloneWithoutGroupBy(this.#e.queryNode)})}$call(t){return t(this)}$if(t,n){return t?n(this):new et({...this.#e})}$castTo(){return new et(this.#e)}$narrowType(){return new et(this.#e)}$assertType(){return new et(this.#e)}$asTuple(){return new Vt(this.toOperationNode())}$asScalar(){return new Vt(this.toOperationNode())}withPlugin(t){return new et({...this.#e,executor:this.#e.executor.withPlugin(t)})}toOperationNode(){return this.#e.executor.transformQuery(this.#e.queryNode,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){const t=this.compile();return(await this.#e.executor.executeQuery(t)).rows}async executeTakeFirst(){const[t]=await this.execute();return t}async executeTakeFirstOrThrow(t=Wu){const n=await this.executeTakeFirst();if(n===void 0)throw Vu(t)?new t(this.toOperationNode()):t(this.toOperationNode());return n}async*stream(t=100){const n=this.compile(),i=this.#e.executor.stream(n,t);for await(const r of i)yield*r.rows}async explain(t,n){return await new et({...this.#e,queryNode:Se.cloneWithExplain(this.#e.queryNode,t,n)}).execute()}}function vy(e){return new et(e)}class qq{#e;#t;constructor(t,n){this.#e=t,this.#t=n}get expression(){return this.#e}get alias(){return this.#t}get isAliasedSelectQueryBuilder(){return!0}toOperationNode(){return To.create(this.#e.toOperationNode(),zt.create(this.#t))}}const Vo=R({is(e){return e.kind==="AggregateFunctionNode"},create(e,t=[]){return R({kind:"AggregateFunctionNode",func:e,aggregated:t})},cloneWithDistinct(e){return R({...e,distinct:!0})},cloneWithOrderBy(e,t,n=!1){const i=n?"withinGroup":"orderBy";return R({...e,[i]:e[i]?Ya.cloneWithItems(e[i],t):Ya.create(t)})},cloneWithFilter(e,t){return R({...e,filter:e.filter?br.cloneWithOperation(e.filter,"And",t):br.create(t)})},cloneWithOrFilter(e,t){return R({...e,filter:e.filter?br.cloneWithOperation(e.filter,"Or",t):br.create(t)})},cloneWithOver(e,t){return R({...e,over:t})}}),kx=R({is(e){return e.kind==="FunctionNode"},create(e,t){return R({kind:"FunctionNode",func:e,arguments:t})}});class Rr{#e;constructor(t){this.#e=R(t)}get expressionType(){}as(t){return new Hq(this,t)}distinct(){return new Rr({...this.#e,aggregateFunctionNode:Vo.cloneWithDistinct(this.#e.aggregateFunctionNode)})}orderBy(...t){return new Rr({...this.#e,aggregateFunctionNode:Se.cloneWithOrderByItems(this.#e.aggregateFunctionNode,Bs(t))})}clearOrderBy(){return new Rr({...this.#e,aggregateFunctionNode:Se.cloneWithoutOrderBy(this.#e.aggregateFunctionNode)})}withinGroupOrderBy(...t){return new Rr({...this.#e,aggregateFunctionNode:Vo.cloneWithOrderBy(this.#e.aggregateFunctionNode,Bs(t),!0)})}filterWhere(...t){return new Rr({...this.#e,aggregateFunctionNode:Vo.cloneWithFilter(this.#e.aggregateFunctionNode,Qn(t))})}filterWhereRef(t,n,i){return new Rr({...this.#e,aggregateFunctionNode:Vo.cloneWithFilter(this.#e.aggregateFunctionNode,Mi(t,n,i))})}over(t){const n=Dq();return new Rr({...this.#e,aggregateFunctionNode:Vo.cloneWithOver(this.#e.aggregateFunctionNode,(t?t(n):n).toOperationNode())})}$call(t){return t(this)}$castTo(){return new Rr(this.#e)}$notNull(){return new Rr(this.#e)}toOperationNode(){return this.#e.aggregateFunctionNode}}class Hq{#e;#t;constructor(t,n){this.#e=t,this.#t=n}get expression(){return this.#e}get alias(){return this.#t}toOperationNode(){return To.create(this.#e.toOperationNode(),zt.create(this.#t))}}function oO(){const e=(n,i)=>new Vt(kx.create(n,Ol(i??[]))),t=(n,i)=>new Rr({aggregateFunctionNode:Vo.create(n,i?Ol(i):void 0)});return Object.assign(e,{agg:t,avg(n){return t("avg",[n])},coalesce(...n){return e("coalesce",n)},count(n){return t("count",[n])},countAll(n){return new Rr({aggregateFunctionNode:Vo.create("count",li(n))})},max(n){return t("max",[n])},min(n){return t("min",[n])},sum(n){return t("sum",[n])},any(n){return e("any",[n])},jsonAgg(n){return new Rr({aggregateFunctionNode:Vo.create("json_agg",[Zn(n)?_n(n):n.toOperationNode()])})},toJson(n){return new Vt(kx.create("to_json",[Zn(n)?_n(n):n.toOperationNode()]))}})}const Kq=R({is(e){return e.kind==="UnaryOperationNode"},create(e,t){return R({kind:"UnaryOperationNode",operator:e,operand:t})}});function Jq(e,t){return Kq.create(rs.create(e),jr(t))}const Ri=R({is(e){return e.kind==="CaseNode"},create(e){return R({kind:"CaseNode",value:e})},cloneWithWhen(e,t){return R({...e,when:R(e.when?[...e.when,t]:[t])})},cloneWithThen(e,t){return R({...e,when:e.when?R([...e.when.slice(0,-1),Fs.cloneWithResult(e.when[e.when.length-1],t)]):void 0})},cloneWith(e,t){return R({...e,...t})}});class sO{#e;constructor(t){this.#e=R(t)}when(...t){return new aO({...this.#e,node:Ri.cloneWithWhen(this.#e.node,Fs.create(Qn(t)))})}}class aO{#e;constructor(t){this.#e=R(t)}then(t){return new Gq({...this.#e,node:Ri.cloneWithThen(this.#e.node,Fb(t)?Wb(t):xn(t))})}}class Gq{#e;constructor(t){this.#e=R(t)}when(...t){return new aO({...this.#e,node:Ri.cloneWithWhen(this.#e.node,Fs.create(Qn(t)))})}else(t){return new Zq({...this.#e,node:Ri.cloneWith(this.#e.node,{else:Fb(t)?Wb(t):xn(t)})})}end(){return new Vt(Ri.cloneWith(this.#e.node,{isStatement:!1}))}endCase(){return new Vt(Ri.cloneWith(this.#e.node,{isStatement:!0}))}}class Zq{#e;constructor(t){this.#e=R(t)}end(){return new Vt(Ri.cloneWith(this.#e.node,{isStatement:!1}))}endCase(){return new Vt(Ri.cloneWith(this.#e.node,{isStatement:!0}))}}const Ex=R({is(e){return e.kind==="JSONPathLegNode"},create(e,t){return R({kind:"JSONPathLegNode",type:e,value:t})}});class by{#e;constructor(t){this.#e=t}at(t){return this.#t("ArrayLocation",t)}key(t){return this.#t("Member",t)}#t(t,n){return Rf.is(this.#e)?new Rl(Rf.cloneWithTraversal(this.#e,sl.is(this.#e.traversal)?sl.cloneWithLeg(this.#e.traversal,Ex.create(t,n)):qC.cloneWithValue(this.#e.traversal,ci.createImmediate(n)))):new Rl(sl.cloneWithLeg(this.#e,Ex.create(t,n)))}}class Rl extends by{#e;constructor(t){super(t),this.#e=t}get expressionType(){}as(t){return new Qq(this,t)}$castTo(){return new Rl(this.#e)}$notNull(){return new Rl(this.#e)}toOperationNode(){return this.#e}}class Qq{#e;#t;constructor(t,n){this.#e=t,this.#t=n}get expression(){return this.#e}get alias(){return this.#t}toOperationNode(){return To.create(this.#e.toOperationNode(),hr(this.#t)?this.#t.toOperationNode():zt.create(this.#t))}}const Ax=R({is(e){return e.kind==="TupleNode"},create(e){return R({kind:"TupleNode",values:R(e)})}}),Yq=["varchar","char","text","integer","int2","int4","int8","smallint","bigint","boolean","real","double precision","float4","float8","decimal","numeric","binary","bytea","date","datetime","time","timetz","timestamp","timestamptz","serial","bigserial","uuid","json","jsonb","blob","varbinary","int4range","int4multirange","int8range","int8multirange","numrange","nummultirange","tsrange","tsmultirange","tstzrange","tstzmultirange","daterange","datemultirange"],Xq=[/^varchar\(\d+\)$/,/^char\(\d+\)$/,/^decimal\(\d+, \d+\)$/,/^numeric\(\d+, \d+\)$/,/^binary\(\d+\)$/,/^datetime\(\d+\)$/,/^time\(\d+\)$/,/^timetz\(\d+\)$/,/^timestamp\(\d+\)$/,/^timestamptz\(\d+\)$/,/^varbinary\(\d+\)$/],e7=R({is(e){return e.kind==="DataTypeNode"},create(e){return R({kind:"DataTypeNode",dataType:e})}});function t7(e){return!!(Yq.includes(e)||Xq.some(t=>t.test(e)))}function Ws(e){if(hr(e))return e.toOperationNode();if(t7(e))return e7.create(e);throw new Error(`invalid column data type ${JSON.stringify(e)}`)}const n7=R({is(e){return e.kind==="CastNode"},create(e,t){return R({kind:"CastNode",expression:e,dataType:t})}});function Jb(e=Mh){function t(r,o,s){return new Vt(Vb(r,o,s))}function n(r,o){return new Vt(Jq(r,o))}const i=Object.assign(t,{fn:void 0,eb:void 0,selectFrom(r){return vy({queryId:pt(),executor:e,queryNode:Gt.createFrom(Da(r))})},case(r){return new sO({node:Ri.create(uo(r)?void 0:jr(r))})},ref(r,o){return uo(o)?new Vt(xo(r)):new by(eq(r,o))},jsonPath(){return new by(sl.create())},table(r){return new Vt(_n(r))},val(r){return new Vt(xn(r))},refTuple(...r){return new Vt(Ax.create(r.map(jr)))},tuple(...r){return new Vt(Ax.create(r.map(xn)))},lit(r){return new Vt(Wb(r))},unary:n,not(r){return n("not",r)},exists(r){return n("exists",r)},neg(r){return n("-",r)},between(r,o,s){return new Vt(Qa.create(jr(r),rs.create("between"),ns.create(xn(o),xn(s))))},betweenSymmetric(r,o,s){return new Vt(Qa.create(jr(r),rs.create("between symmetric"),ns.create(xn(o),xn(s))))},and(r){return _o(r)?new Vt(Df(r,"and")):new Vt(ux(r,"and"))},or(r){return _o(r)?new Vt(Df(r,"or")):new Vt(ux(r,"or"))},parens(...r){const o=Qn(r);return co.is(o)?new Vt(o):new Vt(co.create(o))},cast(r,o){return new Vt(n7.create(jr(r),Ws(o)))},withSchema(r){return Jb(e.withPluginAtFront(new xc(r)))}});return i.fn=oO(),i.eb=i,i}function kc(e){return Jb()}function ta(e){if(hr(e))return e.toOperationNode();if(or(e))return e(kc()).toOperationNode();throw new Error(`invalid expression: ${JSON.stringify(e)}`)}function cO(e){if(hr(e))return e.toOperationNode();if(or(e))return e(kc()).toOperationNode();throw new Error(`invalid aliased expression: ${JSON.stringify(e)}`)}function qu(e){return zC(e)||VV(e)||or(e)}class r7{#e;get table(){return this.#e}constructor(t){this.#e=t}as(t){return new i7(this.#e,t)}}class i7{#e;#t;get table(){return this.#e}get alias(){return this.#t}constructor(t,n){this.#e=t,this.#t=n}toOperationNode(){return To.create(_n(this.#e),zt.create(this.#t))}}function o7(e){return Mr(e)&&hr(e)&&Zn(e.table)&&Zn(e.alias)}function Da(e){return _o(e)?e.map(t=>Pl(t)):[Pl(e)]}function Pl(e){return Zn(e)?lO(e):o7(e)?e.toOperationNode():cO(e)}function lO(e){const t=" as ";if(e.includes(t)){const[n,i]=e.split(t).map(uO);return To.create(_n(n),zt.create(i))}else return _n(e)}function _n(e){if(e.includes(".")){const[n,i]=e.split(".").map(uO);return Oi.createWithSchema(n,i)}else return Oi.create(e)}function uO(e){return e.trim()}const dO=R({is(e){return e.kind==="AddColumnNode"},create(e){return R({kind:"AddColumnNode",column:e})}}),ln=R({is(e){return e.kind==="ColumnDefinitionNode"},create(e,t){return R({kind:"ColumnDefinitionNode",column:Sn.create(e),dataType:t})},cloneWithFrontModifier(e,t){return R({...e,frontModifiers:e.frontModifiers?R([...e.frontModifiers,t]):[t]})},cloneWithEndModifier(e,t){return R({...e,endModifiers:e.endModifiers?R([...e.endModifiers,t]):[t]})},cloneWith(e,t){return R({...e,...t})}}),fO=R({is(e){return e.kind==="DropColumnNode"},create(e){return R({kind:"DropColumnNode",column:Sn.create(e)})}}),pO=R({is(e){return e.kind==="RenameColumnNode"},create(e,t){return R({kind:"RenameColumnNode",column:Sn.create(e),renameTo:Sn.create(t)})}}),Gb=R({is(e){return e.kind==="CheckConstraintNode"},create(e,t){return R({kind:"CheckConstraintNode",expression:e,name:t?zt.create(t):void 0})}}),s7=["no action","restrict","cascade","set null","set default"],qd=R({is(e){return e.kind==="ReferencesNode"},create(e,t){return R({kind:"ReferencesNode",table:e,columns:R([...t])})},cloneWithOnDelete(e,t){return R({...e,onDelete:t})},cloneWithOnUpdate(e,t){return R({...e,onUpdate:t})}});function hO(e){return hr(e)?e.toOperationNode():ci.createImmediate(e)}const Cd=R({is(e){return e.kind==="GeneratedNode"},create(e){return R({kind:"GeneratedNode",...e})},createWithExpression(e){return R({kind:"GeneratedNode",always:!0,expression:e})},cloneWith(e,t){return R({...e,...t})}}),a7=R({is(e){return e.kind==="DefaultValueNode"},create(e){return R({kind:"DefaultValueNode",defaultValue:e})}});function Bf(e){if(s7.includes(e))return e;throw new Error(`invalid OnModifyForeignAction ${e}`)}class tn{#e;constructor(t){this.#e=t}autoIncrement(){return new tn(ln.cloneWith(this.#e,{autoIncrement:!0}))}identity(){return new tn(ln.cloneWith(this.#e,{identity:!0}))}primaryKey(){return new tn(ln.cloneWith(this.#e,{primaryKey:!0}))}references(t){const n=xo(t);if(!n.table||zb.is(n.column))throw new Error(`invalid call references('${t}'). The reference must have format table.column or schema.table.column`);return new tn(ln.cloneWith(this.#e,{references:qd.create(n.table,[n.column])}))}onDelete(t){if(!this.#e.references)throw new Error("on delete constraint can only be added for foreign keys");return new tn(ln.cloneWith(this.#e,{references:qd.cloneWithOnDelete(this.#e.references,Bf(t))}))}onUpdate(t){if(!this.#e.references)throw new Error("on update constraint can only be added for foreign keys");return new tn(ln.cloneWith(this.#e,{references:qd.cloneWithOnUpdate(this.#e.references,Bf(t))}))}unique(){return new tn(ln.cloneWith(this.#e,{unique:!0}))}notNull(){return new tn(ln.cloneWith(this.#e,{notNull:!0}))}unsigned(){return new tn(ln.cloneWith(this.#e,{unsigned:!0}))}defaultTo(t){return new tn(ln.cloneWith(this.#e,{defaultTo:a7.create(hO(t))}))}check(t){return new tn(ln.cloneWith(this.#e,{check:Gb.create(t.toOperationNode())}))}generatedAlwaysAs(t){return new tn(ln.cloneWith(this.#e,{generated:Cd.createWithExpression(t.toOperationNode())}))}generatedAlwaysAsIdentity(){return new tn(ln.cloneWith(this.#e,{generated:Cd.create({identity:!0,always:!0})}))}generatedByDefaultAsIdentity(){return new tn(ln.cloneWith(this.#e,{generated:Cd.create({identity:!0,byDefault:!0})}))}stored(){if(!this.#e.generated)throw new Error("stored() can only be called after generatedAlwaysAs");return new tn(ln.cloneWith(this.#e,{generated:Cd.cloneWith(this.#e.generated,{stored:!0})}))}modifyFront(t){return new tn(ln.cloneWithFrontModifier(this.#e,t.toOperationNode()))}nullsNotDistinct(){return new tn(ln.cloneWith(this.#e,{nullsNotDistinct:!0}))}ifNotExists(){return new tn(ln.cloneWith(this.#e,{ifNotExists:!0}))}modifyEnd(t){return new tn(ln.cloneWithEndModifier(this.#e,t.toOperationNode()))}$call(t){return t(this)}toOperationNode(){return this.#e}}const mO=R({is(e){return e.kind==="ModifyColumnNode"},create(e){return R({kind:"ModifyColumnNode",column:e})}}),jo=R({is(e){return e.kind==="ForeignKeyConstraintNode"},create(e,t,n,i){return R({kind:"ForeignKeyConstraintNode",columns:e,references:qd.create(t,n),name:i?zt.create(i):void 0})},cloneWith(e,t){return R({...e,...t})}});class oo{#e;constructor(t){this.#e=t}onDelete(t){return new oo(jo.cloneWith(this.#e,{onDelete:Bf(t)}))}onUpdate(t){return new oo(jo.cloneWith(this.#e,{onUpdate:Bf(t)}))}deferrable(){return new oo(jo.cloneWith(this.#e,{deferrable:!0}))}notDeferrable(){return new oo(jo.cloneWith(this.#e,{deferrable:!1}))}initiallyDeferred(){return new oo(jo.cloneWith(this.#e,{initiallyDeferred:!0}))}initiallyImmediate(){return new oo(jo.cloneWith(this.#e,{initiallyDeferred:!1}))}$call(t){return t(this)}toOperationNode(){return this.#e}}const Hd=R({is(e){return e.kind==="AddConstraintNode"},create(e){return R({kind:"AddConstraintNode",constraint:e})}}),_s=R({is(e){return e.kind==="UniqueConstraintNode"},create(e,t,n){return R({kind:"UniqueConstraintNode",columns:R(e.map(Sn.create)),name:t?zt.create(t):void 0,nullsNotDistinct:n})},cloneWith(e,t){return R({...e,...t})}}),Kd=R({is(e){return e.kind==="DropConstraintNode"},create(e){return R({kind:"DropConstraintNode",constraintName:zt.create(e)})},cloneWith(e,t){return R({...e,...t})}}),Kc=R({is(e){return e.kind==="AlterColumnNode"},create(e,t,n){return R({kind:"AlterColumnNode",column:Sn.create(e),[t]:n})}});class gO{#e;constructor(t){this.#e=t}setDataType(t){return new Jc(Kc.create(this.#e,"dataType",Ws(t)))}setDefault(t){return new Jc(Kc.create(this.#e,"setDefault",hO(t)))}dropDefault(){return new Jc(Kc.create(this.#e,"dropDefault",!0))}setNotNull(){return new Jc(Kc.create(this.#e,"setNotNull",!0))}dropNotNull(){return new Jc(Kc.create(this.#e,"dropNotNull",!0))}$call(t){return t(this)}}class Jc{#e;constructor(t){this.#e=t}toOperationNode(){return this.#e}}class _a{#e;constructor(t){this.#e=R(t)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile())}}class zo{#e;constructor(t){this.#e=R(t)}onDelete(t){return new zo({...this.#e,constraintBuilder:this.#e.constraintBuilder.onDelete(t)})}onUpdate(t){return new zo({...this.#e,constraintBuilder:this.#e.constraintBuilder.onUpdate(t)})}deferrable(){return new zo({...this.#e,constraintBuilder:this.#e.constraintBuilder.deferrable()})}notDeferrable(){return new zo({...this.#e,constraintBuilder:this.#e.constraintBuilder.notDeferrable()})}initiallyDeferred(){return new zo({...this.#e,constraintBuilder:this.#e.constraintBuilder.initiallyDeferred()})}initiallyImmediate(){return new zo({...this.#e,constraintBuilder:this.#e.constraintBuilder.initiallyImmediate()})}$call(t){return t(this)}toOperationNode(){return this.#e.executor.transformQuery(Ut.cloneWithTableProps(this.#e.node,{addConstraint:Hd.create(this.#e.constraintBuilder.toOperationNode())}),this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile())}}class Ua{#e;constructor(t){this.#e=R(t)}ifExists(){return new Ua({...this.#e,node:Ut.cloneWithTableProps(this.#e.node,{dropConstraint:Kd.cloneWith(this.#e.node.dropConstraint,{ifExists:!0})})})}cascade(){return new Ua({...this.#e,node:Ut.cloneWithTableProps(this.#e.node,{dropConstraint:Kd.cloneWith(this.#e.node.dropConstraint,{modifier:"cascade"})})})}restrict(){return new Ua({...this.#e,node:Ut.cloneWithTableProps(this.#e.node,{dropConstraint:Kd.cloneWith(this.#e.node.dropConstraint,{modifier:"restrict"})})})}$call(t){return t(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile())}}const Ia=R({is(e){return e.kind==="PrimaryKeyConstraintNode"},create(e,t){return R({kind:"PrimaryKeyConstraintNode",columns:R(e.map(Sn.create)),name:t?zt.create(t):void 0})},cloneWith(e,t){return R({...e,...t})}}),Aa=R({is(e){return e.kind==="AddIndexNode"},create(e){return R({kind:"AddIndexNode",name:zt.create(e)})},cloneWith(e,t){return R({...e,...t})},cloneWithColumns(e,t){return R({...e,columns:[...e.columns||[],...t]})}});class Ss{#e;constructor(t){this.#e=R(t)}unique(){return new Ss({...this.#e,node:Ut.cloneWithTableProps(this.#e.node,{addIndex:Aa.cloneWith(this.#e.node.addIndex,{unique:!0})})})}column(t){return new Ss({...this.#e,node:Ut.cloneWithTableProps(this.#e.node,{addIndex:Aa.cloneWithColumns(this.#e.node.addIndex,[Pf(t)])})})}columns(t){return new Ss({...this.#e,node:Ut.cloneWithTableProps(this.#e.node,{addIndex:Aa.cloneWithColumns(this.#e.node.addIndex,t.map(Pf))})})}expression(t){return new Ss({...this.#e,node:Ut.cloneWithTableProps(this.#e.node,{addIndex:Aa.cloneWithColumns(this.#e.node.addIndex,[t.toOperationNode()])})})}using(t){return new Ss({...this.#e,node:Ut.cloneWithTableProps(this.#e.node,{addIndex:Aa.cloneWith(this.#e.node.addIndex,{using:dn.createWithSql(t)})})})}$call(t){return t(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile())}}class qo{#e;constructor(t){this.#e=t}nullsNotDistinct(){return new qo(_s.cloneWith(this.#e,{nullsNotDistinct:!0}))}deferrable(){return new qo(_s.cloneWith(this.#e,{deferrable:!0}))}notDeferrable(){return new qo(_s.cloneWith(this.#e,{deferrable:!1}))}initiallyDeferred(){return new qo(_s.cloneWith(this.#e,{initiallyDeferred:!0}))}initiallyImmediate(){return new qo(_s.cloneWith(this.#e,{initiallyDeferred:!1}))}$call(t){return t(this)}toOperationNode(){return this.#e}}class As{#e;constructor(t){this.#e=t}deferrable(){return new As(Ia.cloneWith(this.#e,{deferrable:!0}))}notDeferrable(){return new As(Ia.cloneWith(this.#e,{deferrable:!1}))}initiallyDeferred(){return new As(Ia.cloneWith(this.#e,{initiallyDeferred:!0}))}initiallyImmediate(){return new As(Ia.cloneWith(this.#e,{initiallyDeferred:!1}))}$call(t){return t(this)}toOperationNode(){return this.#e}}class yO{#e;constructor(t){this.#e=t}$call(t){return t(this)}toOperationNode(){return this.#e}}const c7=R({is(e){return e.kind==="RenameConstraintNode"},create(e,t){return R({kind:"RenameConstraintNode",oldName:zt.create(e),newName:zt.create(t)})}});class l7{#e;constructor(t){this.#e=R(t)}renameTo(t){return new _a({...this.#e,node:Ut.cloneWithTableProps(this.#e.node,{renameTo:_n(t)})})}setSchema(t){return new _a({...this.#e,node:Ut.cloneWithTableProps(this.#e.node,{setSchema:zt.create(t)})})}alterColumn(t,n){const i=n(new gO(t));return new yi({...this.#e,node:Ut.cloneWithColumnAlteration(this.#e.node,i.toOperationNode())})}dropColumn(t){return new yi({...this.#e,node:Ut.cloneWithColumnAlteration(this.#e.node,fO.create(t))})}renameColumn(t,n){return new yi({...this.#e,node:Ut.cloneWithColumnAlteration(this.#e.node,pO.create(t,n))})}addColumn(t,n,i=Lr){const r=i(new tn(ln.create(t,Ws(n))));return new yi({...this.#e,node:Ut.cloneWithColumnAlteration(this.#e.node,dO.create(r.toOperationNode()))})}modifyColumn(t,n,i=Lr){const r=i(new tn(ln.create(t,Ws(n))));return new yi({...this.#e,node:Ut.cloneWithColumnAlteration(this.#e.node,mO.create(r.toOperationNode()))})}addUniqueConstraint(t,n,i=Lr){const r=i(new qo(_s.create(n,t)));return new _a({...this.#e,node:Ut.cloneWithTableProps(this.#e.node,{addConstraint:Hd.create(r.toOperationNode())})})}addCheckConstraint(t,n,i=Lr){const r=i(new yO(Gb.create(n.toOperationNode(),t)));return new _a({...this.#e,node:Ut.cloneWithTableProps(this.#e.node,{addConstraint:Hd.create(r.toOperationNode())})})}addForeignKeyConstraint(t,n,i,r,o=Lr){const s=o(new oo(jo.create(n.map(Sn.create),_n(i),r.map(Sn.create),t)));return new zo({...this.#e,constraintBuilder:s})}addPrimaryKeyConstraint(t,n,i=Lr){const r=i(new As(Ia.create(n,t)));return new _a({...this.#e,node:Ut.cloneWithTableProps(this.#e.node,{addConstraint:Hd.create(r.toOperationNode())})})}dropConstraint(t){return new Ua({...this.#e,node:Ut.cloneWithTableProps(this.#e.node,{dropConstraint:Kd.create(t)})})}renameConstraint(t,n){return new Ua({...this.#e,node:Ut.cloneWithTableProps(this.#e.node,{renameConstraint:c7.create(t,n)})})}addIndex(t){return new Ss({...this.#e,node:Ut.cloneWithTableProps(this.#e.node,{addIndex:Aa.create(t)})})}dropIndex(t){return new _a({...this.#e,node:Ut.cloneWithTableProps(this.#e.node,{dropIndex:ol.create(t)})})}$call(t){return t(this)}}class yi{#e;constructor(t){this.#e=R(t)}alterColumn(t,n){const i=n(new gO(t));return new yi({...this.#e,node:Ut.cloneWithColumnAlteration(this.#e.node,i.toOperationNode())})}dropColumn(t){return new yi({...this.#e,node:Ut.cloneWithColumnAlteration(this.#e.node,fO.create(t))})}renameColumn(t,n){return new yi({...this.#e,node:Ut.cloneWithColumnAlteration(this.#e.node,pO.create(t,n))})}addColumn(t,n,i=Lr){const r=i(new tn(ln.create(t,Ws(n))));return new yi({...this.#e,node:Ut.cloneWithColumnAlteration(this.#e.node,dO.create(r.toOperationNode()))})}modifyColumn(t,n,i=Lr){const r=i(new tn(ln.create(t,Ws(n))));return new yi({...this.#e,node:Ut.cloneWithColumnAlteration(this.#e.node,mO.create(r.toOperationNode()))})}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile())}}class wO extends tO{transformPrimitiveValueList(t){return Lh.create(t.values.map(ci.createImmediate))}transformValue(t){return ci.createImmediate(t.value)}}class mi{#e;constructor(t){this.#e=R(t)}ifNotExists(){return new mi({...this.#e,node:eo.cloneWith(this.#e.node,{ifNotExists:!0})})}unique(){return new mi({...this.#e,node:eo.cloneWith(this.#e.node,{unique:!0})})}nullsNotDistinct(){return new mi({...this.#e,node:eo.cloneWith(this.#e.node,{nullsNotDistinct:!0})})}on(t){return new mi({...this.#e,node:eo.cloneWith(this.#e.node,{table:_n(t)})})}column(t){return new mi({...this.#e,node:eo.cloneWithColumns(this.#e.node,[Pf(t)])})}columns(t){return new mi({...this.#e,node:eo.cloneWithColumns(this.#e.node,t.map(Pf))})}expression(t){return new mi({...this.#e,node:eo.cloneWithColumns(this.#e.node,[t.toOperationNode()])})}using(t){return new mi({...this.#e,node:eo.cloneWith(this.#e.node,{using:dn.createWithSql(t)})})}where(...t){const n=new wO;return new mi({...this.#e,node:Se.cloneWithWhere(this.#e.node,n.transformNode(Qn(t),this.#e.queryId))})}$call(t){return t(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile())}}class Zb{#e;constructor(t){this.#e=R(t)}ifNotExists(){return new Zb({...this.#e,node:jC.cloneWith(this.#e.node,{ifNotExists:!0})})}$call(t){return t(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile())}}function u7(e){if(WV.includes(e))return e;throw new Error(`invalid OnCommitAction ${e}`)}class $r{#e;constructor(t){this.#e=R(t)}temporary(){return new $r({...this.#e,node:Nr.cloneWith(this.#e.node,{temporary:!0})})}onCommit(t){return new $r({...this.#e,node:Nr.cloneWith(this.#e.node,{onCommit:u7(t)})})}ifNotExists(){return new $r({...this.#e,node:Nr.cloneWith(this.#e.node,{ifNotExists:!0})})}addColumn(t,n,i=Lr){const r=i(new tn(ln.create(t,Ws(n))));return new $r({...this.#e,node:Nr.cloneWithColumn(this.#e.node,r.toOperationNode())})}addPrimaryKeyConstraint(t,n,i=Lr){const r=i(new As(Ia.create(n,t)));return new $r({...this.#e,node:Nr.cloneWithConstraint(this.#e.node,r.toOperationNode())})}addUniqueConstraint(t,n,i=Lr){const r=i(new qo(_s.create(n,t)));return new $r({...this.#e,node:Nr.cloneWithConstraint(this.#e.node,r.toOperationNode())})}addCheckConstraint(t,n,i=Lr){const r=i(new yO(Gb.create(n.toOperationNode(),t)));return new $r({...this.#e,node:Nr.cloneWithConstraint(this.#e.node,r.toOperationNode())})}addForeignKeyConstraint(t,n,i,r,o=Lr){const s=o(new oo(jo.create(n.map(Sn.create),_n(i),r.map(Sn.create),t)));return new $r({...this.#e,node:Nr.cloneWithConstraint(this.#e.node,s.toOperationNode())})}modifyFront(t){return new $r({...this.#e,node:Nr.cloneWithFrontModifier(this.#e.node,t.toOperationNode())})}modifyEnd(t){return new $r({...this.#e,node:Nr.cloneWithEndModifier(this.#e.node,t.toOperationNode())})}as(t){return new $r({...this.#e,node:Nr.cloneWith(this.#e.node,{selectQuery:ta(t)})})}$call(t){return t(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile())}}class hl{#e;constructor(t){this.#e=R(t)}on(t){return new hl({...this.#e,node:ol.cloneWith(this.#e.node,{table:_n(t)})})}ifExists(){return new hl({...this.#e,node:ol.cloneWith(this.#e.node,{ifExists:!0})})}cascade(){return new hl({...this.#e,node:ol.cloneWith(this.#e.node,{cascade:!0})})}$call(t){return t(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile())}}class Ff{#e;constructor(t){this.#e=R(t)}ifExists(){return new Ff({...this.#e,node:hy.cloneWith(this.#e.node,{ifExists:!0})})}cascade(){return new Ff({...this.#e,node:hy.cloneWith(this.#e.node,{cascade:!0})})}$call(t){return t(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile())}}class Wf{#e;constructor(t){this.#e=R(t)}ifExists(){return new Wf({...this.#e,node:my.cloneWith(this.#e.node,{ifExists:!0})})}cascade(){return new Wf({...this.#e,node:my.cloneWith(this.#e.node,{cascade:!0})})}$call(t){return t(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile())}}const Bo=R({is(e){return e.kind==="CreateViewNode"},create(e){return R({kind:"CreateViewNode",name:So.create(e)})},cloneWith(e,t){return R({...e,...t})}});class d7{#e=new wO;transformQuery(t){return this.#e.transformNode(t.node,t.queryId)}transformResult(t){return Promise.resolve(t.result)}}class Fo{#e;constructor(t){this.#e=R(t)}temporary(){return new Fo({...this.#e,node:Bo.cloneWith(this.#e.node,{temporary:!0})})}materialized(){return new Fo({...this.#e,node:Bo.cloneWith(this.#e.node,{materialized:!0})})}ifNotExists(){return new Fo({...this.#e,node:Bo.cloneWith(this.#e.node,{ifNotExists:!0})})}orReplace(){return new Fo({...this.#e,node:Bo.cloneWith(this.#e.node,{orReplace:!0})})}columns(t){return new Fo({...this.#e,node:Bo.cloneWith(this.#e.node,{columns:t.map(KC)})})}as(t){const n=t.withPlugin(new d7).toOperationNode();return new Fo({...this.#e,node:Bo.cloneWith(this.#e.node,{as:n})})}$call(t){return t(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile())}}const Jd=R({is(e){return e.kind==="DropViewNode"},create(e){return R({kind:"DropViewNode",name:So.create(e)})},cloneWith(e,t){return R({...e,...t})}});class ml{#e;constructor(t){this.#e=R(t)}materialized(){return new ml({...this.#e,node:Jd.cloneWith(this.#e.node,{materialized:!0})})}ifExists(){return new ml({...this.#e,node:Jd.cloneWith(this.#e.node,{ifExists:!0})})}cascade(){return new ml({...this.#e,node:Jd.cloneWith(this.#e.node,{cascade:!0})})}$call(t){return t(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile())}}const vO=R({is(e){return e.kind==="CreateTypeNode"},create(e){return R({kind:"CreateTypeNode",name:e})},cloneWithEnum(e,t){return R({...e,enum:Lh.create(t.map(ci.createImmediate))})}});class Qb{#e;constructor(t){this.#e=R(t)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}asEnum(t){return new Qb({...this.#e,node:vO.cloneWithEnum(this.#e.node,t)})}$call(t){return t(this)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile())}}const bO=R({is(e){return e.kind==="DropTypeNode"},create(e){return R({kind:"DropTypeNode",name:e})},cloneWith(e,t){return R({...e,...t})}});class Yb{#e;constructor(t){this.#e=R(t)}ifExists(){return new Yb({...this.#e,node:bO.cloneWith(this.#e.node,{ifExists:!0})})}$call(t){return t(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile())}}function Tx(e){if(e.includes(".")){const n=e.split(".").map(f7);if(n.length===2)return So.createWithSchema(n[0],n[1]);throw new Error(`invalid schemable identifier ${e}`)}else return So.create(e)}function f7(e){return e.trim()}const Gd=R({is(e){return e.kind==="RefreshMaterializedViewNode"},create(e){return R({kind:"RefreshMaterializedViewNode",name:So.create(e)})},cloneWith(e,t){return R({...e,...t})}});class gl{#e;constructor(t){this.#e=R(t)}concurrently(){return new gl({...this.#e,node:Gd.cloneWith(this.#e.node,{concurrently:!0,withNoData:!1})})}withData(){return new gl({...this.#e,node:Gd.cloneWith(this.#e.node,{withNoData:!1})})}withNoData(){return new gl({...this.#e,node:Gd.cloneWith(this.#e.node,{withNoData:!0,concurrently:!1})})}$call(t){return t(this)}toOperationNode(){return this.#e.executor.transformQuery(this.#e.node,this.#e.queryId)}compile(){return this.#e.executor.compileQuery(this.toOperationNode(),this.#e.queryId)}async execute(){await this.#e.executor.executeQuery(this.compile())}}class yl{#e;constructor(t){this.#e=t}createTable(t){return new $r({queryId:pt(),executor:this.#e,node:Nr.create(_n(t))})}dropTable(t){return new Wf({queryId:pt(),executor:this.#e,node:my.create(_n(t))})}createIndex(t){return new mi({queryId:pt(),executor:this.#e,node:eo.create(t)})}dropIndex(t){return new hl({queryId:pt(),executor:this.#e,node:ol.create(t)})}createSchema(t){return new Zb({queryId:pt(),executor:this.#e,node:jC.create(t)})}dropSchema(t){return new Ff({queryId:pt(),executor:this.#e,node:hy.create(t)})}alterTable(t){return new l7({queryId:pt(),executor:this.#e,node:Ut.create(_n(t))})}createView(t){return new Fo({queryId:pt(),executor:this.#e,node:Bo.create(t)})}refreshMaterializedView(t){return new gl({queryId:pt(),executor:this.#e,node:Gd.create(t)})}dropView(t){return new ml({queryId:pt(),executor:this.#e,node:Jd.create(t)})}createType(t){return new Qb({queryId:pt(),executor:this.#e,node:vO.create(Tx(t))})}dropType(t){return new Yb({queryId:pt(),executor:this.#e,node:bO.create(Tx(t))})}withPlugin(t){return new yl(this.#e.withPlugin(t))}withoutPlugins(){return new yl(this.#e.withoutPlugins())}withSchema(t){return new yl(this.#e.withPluginAtFront(new xc(t)))}}class p7{ref(t){return new QV(t)}table(t){return new r7(t)}}class h7{#e;constructor(t){this.#e=t}async provideConnection(t){const n=await this.#e.acquireConnection();try{return await t(n)}finally{await this.#e.releaseConnection(n)}}}class xs extends rO{#e;#t;#n;constructor(t,n,i,r=[]){super(r),this.#e=t,this.#t=n,this.#n=i}get adapter(){return this.#t}compileQuery(t,n){return this.#e.compileQuery(t,n)}provideConnection(t){return this.#n.provideConnection(t)}withPlugins(t){return new xs(this.#e,this.#t,this.#n,[...this.plugins,...t])}withPlugin(t){return new xs(this.#e,this.#t,this.#n,[...this.plugins,t])}withPluginAtFront(t){return new xs(this.#e,this.#t,this.#n,[t,...this.plugins])}withConnectionProvider(t){return new xs(this.#e,this.#t,t,[...this.plugins])}withoutPlugins(){return new xs(this.#e,this.#t,this.#n,[])}}function ug(){return typeof performance<"u"&&or(performance.now)?performance.now():Date.now()}class m7{#e;#t;#n;#r;#i;#s=new WeakSet;constructor(t,n){this.#r=!1,this.#e=t,this.#t=n}async init(){if(this.#i)throw new Error("driver has already been destroyed");this.#n||(this.#n=this.#e.init().then(()=>{this.#r=!0}).catch(t=>(this.#n=void 0,Promise.reject(t)))),await this.#n}async acquireConnection(){if(this.#i)throw new Error("driver has already been destroyed");this.#r||await this.init();const t=await this.#e.acquireConnection();return this.#s.has(t)||(this.#a()&&this.#o(t),this.#s.add(t)),t}async releaseConnection(t){await this.#e.releaseConnection(t)}beginTransaction(t,n){return this.#e.beginTransaction(t,n)}commitTransaction(t){return this.#e.commitTransaction(t)}rollbackTransaction(t){return this.#e.rollbackTransaction(t)}savepoint(t,n,i){if(this.#e.savepoint)return this.#e.savepoint(t,n,i);throw new Error("The `savepoint` method is not supported by this driver")}rollbackToSavepoint(t,n,i){if(this.#e.rollbackToSavepoint)return this.#e.rollbackToSavepoint(t,n,i);throw new Error("The `rollbackToSavepoint` method is not supported by this driver")}releaseSavepoint(t,n,i){if(this.#e.releaseSavepoint)return this.#e.releaseSavepoint(t,n,i);throw new Error("The `releaseSavepoint` method is not supported by this driver")}async destroy(){this.#n&&(await this.#n,this.#i||(this.#i=this.#e.destroy().catch(t=>(this.#i=void 0,Promise.reject(t)))),await this.#i)}#a(){return this.#t.isLevelEnabled("query")||this.#t.isLevelEnabled("error")}#o(t){const n=t.executeQuery,i=t.streamQuery,r=this;t.executeQuery=async o=>{let s;const a=ug();try{return await n.call(t,o)}catch(c){throw s=c,await r.#c(c,o,a),c}finally{s||await r.#l(o,a)}},t.streamQuery=async function*(o,s){let a;const c=ug();try{for await(const l of i.call(t,o,s))yield l}catch(l){throw a=l,await r.#c(l,o,c),l}finally{a||await r.#l(o,c,!0)}}}async#c(t,n,i){await this.#t.error(()=>({level:"error",error:t,query:n,queryDurationMillis:this.#u(i)}))}async#l(t,n,i=!1){await this.#t.query(()=>({level:"query",isStream:i,query:t,queryDurationMillis:this.#u(n)}))}#u(t){return ug()-t}}const g7=()=>{};class Xb{#e;#t;constructor(t){this.#e=t}async provideConnection(t){for(;this.#t;)await this.#t.catch(g7);return this.#t=this.#n(t).finally(()=>{this.#t=void 0}),this.#t}async#n(t){return await t(this.#e)}}const y7=["read only","read write"],w7=["read uncommitted","read committed","repeatable read","serializable","snapshot"];function _O(e){if(e.accessMode&&!y7.includes(e.accessMode))throw new Error(`invalid transaction access mode ${e.accessMode}`);if(e.isolationLevel&&!w7.includes(e.isolationLevel))throw new Error(`invalid transaction isolation level ${e.isolationLevel}`)}const v7=["query","error"];R(v7);class b7{#e;#t;constructor(t){or(t)?(this.#t=t,this.#e=R({query:!0,error:!0})):(this.#t=_7,this.#e=R({query:t.includes("query"),error:t.includes("error")}))}isLevelEnabled(t){return this.#e[t]}async query(t){this.#e.query&&await this.#t(t())}async error(t){this.#e.error&&await this.#t(t())}}function _7(e){if(e.level==="query"){const t=`kysely:query:${e.isStream?"stream:":""}`;console.log(`${t} ${e.query.sql}`),console.log(`${t} duration: ${e.queryDurationMillis.toFixed(1)}ms`)}else e.level==="error"&&(e.error instanceof Error?console.error(`kysely:error: ${e.error.stack??e.error.message}`):console.error(`kysely:error: ${JSON.stringify({error:e.error,query:e.query.sql,queryDurationMillis:e.queryDurationMillis})}`))}function S7(e){return Mr(e)&&or(e.compile)}Symbol.asyncDispose??=Symbol("Symbol.asyncDispose");class lo extends Wo{#e;constructor(t){let n,i;if(x7(t))n={executor:t.executor},i={...t};else{const r=t.dialect,o=r.createDriver(),s=r.createQueryCompiler(),a=r.createAdapter(),c=new b7(t.log??[]),l=new m7(o,c),u=new h7(l),p=new xs(s,a,u,t.plugins??[]);n={executor:p},i={config:t,executor:p,dialect:r,driver:l}}super(n),this.#e=R(i)}get schema(){return new yl(this.#e.executor)}get dynamic(){return new p7}get introspection(){return this.#e.dialect.createIntrospector(this.withoutPlugins())}case(t){return new sO({node:Ri.create(uo(t)?void 0:ta(t))})}get fn(){return oO()}transaction(){return new Vf({...this.#e})}startTransaction(){return new qf({...this.#e})}connection(){return new k7({...this.#e})}withPlugin(t){return new lo({...this.#e,executor:this.#e.executor.withPlugin(t)})}withoutPlugins(){return new lo({...this.#e,executor:this.#e.executor.withoutPlugins()})}withSchema(t){return new lo({...this.#e,executor:this.#e.executor.withPluginAtFront(new xc(t))})}withTables(){return new lo({...this.#e})}async destroy(){await this.#e.driver.destroy()}get isTransaction(){return!1}getExecutor(){return this.#e.executor}executeQuery(t,n){n!==void 0&&_c("Passing `queryId` in `db.executeQuery` is deprecated and will result in a compile-time error in the future.");const i=S7(t)?t.compile():t;return this.getExecutor().executeQuery(i)}async[Symbol.asyncDispose](){await this.destroy()}}class Ts extends lo{#e;constructor(t){super(t),this.#e=t}get isTransaction(){return!0}transaction(){throw new Error("calling the transaction method for a Transaction is not supported")}connection(){throw new Error("calling the connection method for a Transaction is not supported")}async destroy(){throw new Error("calling the destroy method for a Transaction is not supported")}withPlugin(t){return new Ts({...this.#e,executor:this.#e.executor.withPlugin(t)})}withoutPlugins(){return new Ts({...this.#e,executor:this.#e.executor.withoutPlugins()})}withSchema(t){return new Ts({...this.#e,executor:this.#e.executor.withPluginAtFront(new xc(t))})}withTables(){return new Ts({...this.#e})}}function x7(e){return Mr(e)&&Mr(e.config)&&Mr(e.driver)&&Mr(e.executor)&&Mr(e.dialect)}class k7{#e;constructor(t){this.#e=R(t)}async execute(t){return this.#e.executor.provideConnection(async n=>{const i=this.#e.executor.withConnectionProvider(new Xb(n)),r=new lo({...this.#e,executor:i});return await t(r)})}}class Vf{#e;constructor(t){this.#e=R(t)}setAccessMode(t){return new Vf({...this.#e,accessMode:t})}setIsolationLevel(t){return new Vf({...this.#e,isolationLevel:t})}async execute(t){const{isolationLevel:n,accessMode:i,...r}=this.#e,o={isolationLevel:n,accessMode:i};return _O(o),this.#e.executor.provideConnection(async s=>{const a={isCommitted:!1,isRolledBack:!1},c=new so(this.#e.executor.withConnectionProvider(new Xb(s)),a),l=new Ts({...r,executor:c});let u=!1;try{await this.#e.driver.beginTransaction(s,o),u=!0;const p=await t(l);return await this.#e.driver.commitTransaction(s),a.isCommitted=!0,p}catch(p){throw u&&(await this.#e.driver.rollbackTransaction(s),a.isRolledBack=!0),p}})}}class qf{#e;constructor(t){this.#e=R(t)}setAccessMode(t){return new qf({...this.#e,accessMode:t})}setIsolationLevel(t){return new qf({...this.#e,isolationLevel:t})}async execute(){const{isolationLevel:t,accessMode:n,...i}=this.#e,r={isolationLevel:t,accessMode:n};_O(r);const o=await nO(this.#e.executor);return await this.#e.driver.beginTransaction(o.connection,r),new ro({...i,connection:o,executor:this.#e.executor.withConnectionProvider(new Xb(o.connection))})}}class ro extends Ts{#e;#t;#n;constructor(t){const n={isCommitted:!1,isRolledBack:!1};t={...t,executor:new so(t.executor,n)};const{connection:i,...r}=t;super(r),this.#e=R(t),this.#n=n;const o=pt();this.#t=s=>t.executor.compileQuery(s,o)}get isCommitted(){return this.#n.isCommitted}get isRolledBack(){return this.#n.isRolledBack}commit(){return ks(this.#n),new Gc(async()=>{await this.#e.driver.commitTransaction(this.#e.connection.connection),this.#n.isCommitted=!0,this.#e.connection.release()})}rollback(){return ks(this.#n),new Gc(async()=>{await this.#e.driver.rollbackTransaction(this.#e.connection.connection),this.#n.isRolledBack=!0,this.#e.connection.release()})}savepoint(t){return ks(this.#n),new Gc(async()=>(await this.#e.driver.savepoint?.(this.#e.connection.connection,t,this.#t),new ro({...this.#e})))}rollbackToSavepoint(t){return ks(this.#n),new Gc(async()=>(await this.#e.driver.rollbackToSavepoint?.(this.#e.connection.connection,t,this.#t),new ro({...this.#e})))}releaseSavepoint(t){return ks(this.#n),new Gc(async()=>(await this.#e.driver.releaseSavepoint?.(this.#e.connection.connection,t,this.#t),new ro({...this.#e})))}withPlugin(t){return new ro({...this.#e,executor:this.#e.executor.withPlugin(t)})}withoutPlugins(){return new ro({...this.#e,executor:this.#e.executor.withoutPlugins()})}withSchema(t){return new ro({...this.#e,executor:this.#e.executor.withPluginAtFront(new xc(t))})}withTables(){return new ro({...this.#e})}}class Gc{#e;constructor(t){this.#e=t}async execute(){return await this.#e()}}function ks(e){if(e.isCommitted)throw new Error("Transaction is already committed");if(e.isRolledBack)throw new Error("Transaction is already rolled back")}class so{#e;#t;constructor(t,n){t instanceof so?this.#e=t.#e:this.#e=t,this.#t=n}get adapter(){return this.#e.adapter}get plugins(){return this.#e.plugins}transformQuery(t,n){return this.#e.transformQuery(t,n)}compileQuery(t,n){return this.#e.compileQuery(t,n)}provideConnection(t){return this.#e.provideConnection(t)}executeQuery(t){return ks(this.#t),this.#e.executeQuery(t)}stream(t,n){return ks(this.#t),this.#e.stream(t,n)}withConnectionProvider(t){return new so(this.#e.withConnectionProvider(t),this.#t)}withPlugin(t){return new so(this.#e.withPlugin(t),this.#t)}withPlugins(t){return new so(this.#e.withPlugins(t),this.#t)}withPluginAtFront(t){return new so(this.#e.withPluginAtFront(t),this.#t)}withoutPlugins(){return new so(this.#e.withoutPlugins(),this.#t)}}class wl{#e;constructor(t){this.#e=R(t)}get expressionType(){}get isRawBuilder(){return!0}as(t){return new E7(this,t)}$castTo(){return new wl({...this.#e})}$notNull(){return new wl(this.#e)}withPlugin(t){return new wl({...this.#e,plugins:this.#e.plugins!==void 0?R([...this.#e.plugins,t]):R([t])})}toOperationNode(){return this.#n(this.#t())}compile(t){return this.#r(this.#t(t))}async execute(t){const n=this.#t(t);return n.executeQuery(this.#r(n))}#t(t){const n=t!==void 0?t.getExecutor():Mh;return this.#e.plugins!==void 0?n.withPlugins(this.#e.plugins):n}#n(t){return t.transformQuery(this.#e.rawNode,this.#e.queryId)}#r(t){return t.compileQuery(this.#n(t),this.#e.queryId)}}function Po(e){return new wl(e)}class E7{#e;#t;constructor(t,n){this.#e=t,this.#t=n}get expression(){return this.#e}get alias(){return this.#t}get rawBuilder(){return this.#e}toOperationNode(){return To.create(this.#e.toOperationNode(),hr(this.#t)?this.#t.toOperationNode():zt.create(this.#t))}}const Zt=Object.assign((e,...t)=>Po({queryId:pt(),rawNode:dn.create(e,t?.map(Ix)??[])}),{ref(e){return Po({queryId:pt(),rawNode:dn.createWithChild(xo(e))})},val(e){return Po({queryId:pt(),rawNode:dn.createWithChild(xn(e))})},value(e){return this.val(e)},table(e){return Po({queryId:pt(),rawNode:dn.createWithChild(_n(e))})},id(...e){const t=new Array(e.length+1).fill(".");return t[0]="",t[t.length-1]="",Po({queryId:pt(),rawNode:dn.create(t,e.map(zt.create))})},lit(e){return Po({queryId:pt(),rawNode:dn.createWithChild(ci.createImmediate(e))})},literal(e){return this.lit(e)},raw(e){return Po({queryId:pt(),rawNode:dn.createWithSql(e)})},join(e,t=Zt`, `){const n=new Array(Math.max(2*e.length-1,0)),i=t.toOperationNode();for(let r=0;r<e.length;++r)n[2*r]=Ix(e[r]),r!==e.length-1&&(n[2*r+1]=i);return Po({queryId:pt(),rawNode:dn.createWithChildren(n)})}});function Ix(e){return hr(e)?e.toOperationNode():xn(e)}class A7{nodeStack=[];get parentNode(){return this.nodeStack[this.nodeStack.length-2]}#e=R({AliasNode:this.visitAlias.bind(this),ColumnNode:this.visitColumn.bind(this),IdentifierNode:this.visitIdentifier.bind(this),SchemableIdentifierNode:this.visitSchemableIdentifier.bind(this),RawNode:this.visitRaw.bind(this),ReferenceNode:this.visitReference.bind(this),SelectQueryNode:this.visitSelectQuery.bind(this),SelectionNode:this.visitSelection.bind(this),TableNode:this.visitTable.bind(this),FromNode:this.visitFrom.bind(this),SelectAllNode:this.visitSelectAll.bind(this),AndNode:this.visitAnd.bind(this),OrNode:this.visitOr.bind(this),ValueNode:this.visitValue.bind(this),ValueListNode:this.visitValueList.bind(this),PrimitiveValueListNode:this.visitPrimitiveValueList.bind(this),ParensNode:this.visitParens.bind(this),JoinNode:this.visitJoin.bind(this),OperatorNode:this.visitOperator.bind(this),WhereNode:this.visitWhere.bind(this),InsertQueryNode:this.visitInsertQuery.bind(this),DeleteQueryNode:this.visitDeleteQuery.bind(this),ReturningNode:this.visitReturning.bind(this),CreateTableNode:this.visitCreateTable.bind(this),AddColumnNode:this.visitAddColumn.bind(this),ColumnDefinitionNode:this.visitColumnDefinition.bind(this),DropTableNode:this.visitDropTable.bind(this),DataTypeNode:this.visitDataType.bind(this),OrderByNode:this.visitOrderBy.bind(this),OrderByItemNode:this.visitOrderByItem.bind(this),GroupByNode:this.visitGroupBy.bind(this),GroupByItemNode:this.visitGroupByItem.bind(this),UpdateQueryNode:this.visitUpdateQuery.bind(this),ColumnUpdateNode:this.visitColumnUpdate.bind(this),LimitNode:this.visitLimit.bind(this),OffsetNode:this.visitOffset.bind(this),OnConflictNode:this.visitOnConflict.bind(this),OnDuplicateKeyNode:this.visitOnDuplicateKey.bind(this),CreateIndexNode:this.visitCreateIndex.bind(this),DropIndexNode:this.visitDropIndex.bind(this),ListNode:this.visitList.bind(this),PrimaryKeyConstraintNode:this.visitPrimaryKeyConstraint.bind(this),UniqueConstraintNode:this.visitUniqueConstraint.bind(this),ReferencesNode:this.visitReferences.bind(this),CheckConstraintNode:this.visitCheckConstraint.bind(this),WithNode:this.visitWith.bind(this),CommonTableExpressionNode:this.visitCommonTableExpression.bind(this),CommonTableExpressionNameNode:this.visitCommonTableExpressionName.bind(this),HavingNode:this.visitHaving.bind(this),CreateSchemaNode:this.visitCreateSchema.bind(this),DropSchemaNode:this.visitDropSchema.bind(this),AlterTableNode:this.visitAlterTable.bind(this),DropColumnNode:this.visitDropColumn.bind(this),RenameColumnNode:this.visitRenameColumn.bind(this),AlterColumnNode:this.visitAlterColumn.bind(this),ModifyColumnNode:this.visitModifyColumn.bind(this),AddConstraintNode:this.visitAddConstraint.bind(this),DropConstraintNode:this.visitDropConstraint.bind(this),RenameConstraintNode:this.visitRenameConstraint.bind(this),ForeignKeyConstraintNode:this.visitForeignKeyConstraint.bind(this),CreateViewNode:this.visitCreateView.bind(this),RefreshMaterializedViewNode:this.visitRefreshMaterializedView.bind(this),DropViewNode:this.visitDropView.bind(this),GeneratedNode:this.visitGenerated.bind(this),DefaultValueNode:this.visitDefaultValue.bind(this),OnNode:this.visitOn.bind(this),ValuesNode:this.visitValues.bind(this),SelectModifierNode:this.visitSelectModifier.bind(this),CreateTypeNode:this.visitCreateType.bind(this),DropTypeNode:this.visitDropType.bind(this),ExplainNode:this.visitExplain.bind(this),DefaultInsertValueNode:this.visitDefaultInsertValue.bind(this),AggregateFunctionNode:this.visitAggregateFunction.bind(this),OverNode:this.visitOver.bind(this),PartitionByNode:this.visitPartitionBy.bind(this),PartitionByItemNode:this.visitPartitionByItem.bind(this),SetOperationNode:this.visitSetOperation.bind(this),BinaryOperationNode:this.visitBinaryOperation.bind(this),UnaryOperationNode:this.visitUnaryOperation.bind(this),UsingNode:this.visitUsing.bind(this),FunctionNode:this.visitFunction.bind(this),CaseNode:this.visitCase.bind(this),WhenNode:this.visitWhen.bind(this),JSONReferenceNode:this.visitJSONReference.bind(this),JSONPathNode:this.visitJSONPath.bind(this),JSONPathLegNode:this.visitJSONPathLeg.bind(this),JSONOperatorChainNode:this.visitJSONOperatorChain.bind(this),TupleNode:this.visitTuple.bind(this),MergeQueryNode:this.visitMergeQuery.bind(this),MatchedNode:this.visitMatched.bind(this),AddIndexNode:this.visitAddIndex.bind(this),CastNode:this.visitCast.bind(this),FetchNode:this.visitFetch.bind(this),TopNode:this.visitTop.bind(this),OutputNode:this.visitOutput.bind(this),OrActionNode:this.visitOrAction.bind(this),CollateNode:this.visitCollate.bind(this)});visitNode=t=>{this.nodeStack.push(t),this.#e[t.kind](t),this.nodeStack.pop()}}const T7=/'/g;class zh extends A7{#e="";#t=[];get numParameters(){return this.#t.length}compileQuery(t,n){return this.#e="",this.#t=[],this.nodeStack.splice(0,this.nodeStack.length),this.visitNode(t),R({query:t,queryId:n,sql:this.getSql(),parameters:[...this.#t]})}getSql(){return this.#e}visitSelectQuery(t){const n=this.parentNode!==void 0&&!co.is(this.parentNode)&&!On.is(this.parentNode)&&!Nr.is(this.parentNode)&&!Bo.is(this.parentNode)&&!iO.is(this.parentNode);this.parentNode===void 0&&t.explain&&(this.visitNode(t.explain),this.append(" ")),n&&this.append("("),t.with&&(this.visitNode(t.with),this.append(" ")),this.append("select"),t.distinctOn&&(this.append(" "),this.compileDistinctOn(t.distinctOn)),t.frontModifiers?.length&&(this.append(" "),this.compileList(t.frontModifiers," ")),t.top&&(this.append(" "),this.visitNode(t.top)),t.selections&&(this.append(" "),this.compileList(t.selections)),t.from&&(this.append(" "),this.visitNode(t.from)),t.joins&&(this.append(" "),this.compileList(t.joins," ")),t.where&&(this.append(" "),this.visitNode(t.where)),t.groupBy&&(this.append(" "),this.visitNode(t.groupBy)),t.having&&(this.append(" "),this.visitNode(t.having)),t.setOperations&&(this.append(" "),this.compileList(t.setOperations," ")),t.orderBy&&(this.append(" "),this.visitNode(t.orderBy)),t.limit&&(this.append(" "),this.visitNode(t.limit)),t.offset&&(this.append(" "),this.visitNode(t.offset)),t.fetch&&(this.append(" "),this.visitNode(t.fetch)),t.endModifiers?.length&&(this.append(" "),this.compileList(this.sortSelectModifiers([...t.endModifiers])," ")),n&&this.append(")")}visitFrom(t){this.append("from "),this.compileList(t.froms)}visitSelection(t){this.visitNode(t.selection)}visitColumn(t){this.visitNode(t.column)}compileDistinctOn(t){this.append("distinct on ("),this.compileList(t),this.append(")")}compileList(t,n=", "){const i=t.length-1;for(let r=0;r<=i;r++)this.visitNode(t[r]),r<i&&this.append(n)}visitWhere(t){this.append("where "),this.visitNode(t.where)}visitHaving(t){this.append("having "),this.visitNode(t.having)}visitInsertQuery(t){const n=this.parentNode!==void 0&&!co.is(this.parentNode)&&!dn.is(this.parentNode)&&!Fs.is(this.parentNode);this.parentNode===void 0&&t.explain&&(this.visitNode(t.explain),this.append(" ")),n&&this.append("("),t.with&&(this.visitNode(t.with),this.append(" ")),this.append(t.replace?"replace":"insert"),t.ignore&&(_c("`InsertQueryNode.ignore` is deprecated. Use `InsertQueryNode.orAction` instead."),this.append(" ignore")),t.orAction&&(this.append(" "),this.visitNode(t.orAction)),t.top&&(this.append(" "),this.visitNode(t.top)),t.into&&(this.append(" into "),this.visitNode(t.into)),t.columns&&(this.append(" ("),this.compileList(t.columns),this.append(")")),t.output&&(this.append(" "),this.visitNode(t.output)),t.values&&(this.append(" "),this.visitNode(t.values)),t.defaultValues&&(this.append(" "),this.append("default values")),t.onConflict&&(this.append(" "),this.visitNode(t.onConflict)),t.onDuplicateKey&&(this.append(" "),this.visitNode(t.onDuplicateKey)),t.returning&&(this.append(" "),this.visitNode(t.returning)),n&&this.append(")"),t.endModifiers?.length&&(this.append(" "),this.compileList(t.endModifiers," "))}visitValues(t){this.append("values "),this.compileList(t.values)}visitDeleteQuery(t){const n=this.parentNode!==void 0&&!co.is(this.parentNode)&&!dn.is(this.parentNode);this.parentNode===void 0&&t.explain&&(this.visitNode(t.explain),this.append(" ")),n&&this.append("("),t.with&&(this.visitNode(t.with),this.append(" ")),this.append("delete "),t.top&&(this.visitNode(t.top),this.append(" ")),this.visitNode(t.from),t.output&&(this.append(" "),this.visitNode(t.output)),t.using&&(this.append(" "),this.visitNode(t.using)),t.joins&&(this.append(" "),this.compileList(t.joins," ")),t.where&&(this.append(" "),this.visitNode(t.where)),t.orderBy&&(this.append(" "),this.visitNode(t.orderBy)),t.limit&&(this.append(" "),this.visitNode(t.limit)),t.returning&&(this.append(" "),this.visitNode(t.returning)),n&&this.append(")"),t.endModifiers?.length&&(this.append(" "),this.compileList(t.endModifiers," "))}visitReturning(t){this.append("returning "),this.compileList(t.selections)}visitAlias(t){this.visitNode(t.node),this.append(" as "),this.visitNode(t.alias)}visitReference(t){t.table&&(this.visitNode(t.table),this.append(".")),this.visitNode(t.column)}visitSelectAll(t){this.append("*")}visitIdentifier(t){this.append(this.getLeftIdentifierWrapper()),this.compileUnwrappedIdentifier(t),this.append(this.getRightIdentifierWrapper())}compileUnwrappedIdentifier(t){if(!Zn(t.name))throw new Error("a non-string identifier was passed to compileUnwrappedIdentifier.");this.append(this.sanitizeIdentifier(t.name))}visitAnd(t){this.visitNode(t.left),this.append(" and "),this.visitNode(t.right)}visitOr(t){this.visitNode(t.left),this.append(" or "),this.visitNode(t.right)}visitValue(t){t.immediate?this.appendImmediateValue(t.value):this.appendValue(t.value)}visitValueList(t){this.append("("),this.compileList(t.values),this.append(")")}visitTuple(t){this.append("("),this.compileList(t.values),this.append(")")}visitPrimitiveValueList(t){this.append("(");const{values:n}=t;for(let i=0;i<n.length;++i)this.appendValue(n[i]),i!==n.length-1&&this.append(", ");this.append(")")}visitParens(t){this.append("("),this.visitNode(t.node),this.append(")")}visitJoin(t){this.append(N7[t.joinType]),this.append(" "),this.visitNode(t.table),t.on&&(this.append(" "),this.visitNode(t.on))}visitOn(t){this.append("on "),this.visitNode(t.on)}visitRaw(t){const{sqlFragments:n,parameters:i}=t;for(let r=0;r<n.length;++r)this.append(n[r]),i.length>r&&this.visitNode(i[r])}visitOperator(t){this.append(t.operator)}visitTable(t){this.visitNode(t.table)}visitSchemableIdentifier(t){t.schema&&(this.visitNode(t.schema),this.append(".")),this.visitNode(t.identifier)}visitCreateTable(t){this.append("create "),t.frontModifiers&&t.frontModifiers.length>0&&(this.compileList(t.frontModifiers," "),this.append(" ")),t.temporary&&this.append("temporary "),this.append("table "),t.ifNotExists&&this.append("if not exists "),this.visitNode(t.table),t.selectQuery?(this.append(" as "),this.visitNode(t.selectQuery)):(this.append(" ("),this.compileList([...t.columns,...t.constraints??[]]),this.append(")"),t.onCommit&&(this.append(" on commit "),this.append(t.onCommit)),t.endModifiers&&t.endModifiers.length>0&&(this.append(" "),this.compileList(t.endModifiers," ")))}visitColumnDefinition(t){t.ifNotExists&&this.append("if not exists "),this.visitNode(t.column),this.append(" "),this.visitNode(t.dataType),t.unsigned&&this.append(" unsigned"),t.frontModifiers&&t.frontModifiers.length>0&&(this.append(" "),this.compileList(t.frontModifiers," ")),t.generated&&(this.append(" "),this.visitNode(t.generated)),t.identity&&this.append(" identity"),t.defaultTo&&(this.append(" "),this.visitNode(t.defaultTo)),t.notNull&&this.append(" not null"),t.unique&&this.append(" unique"),t.nullsNotDistinct&&this.append(" nulls not distinct"),t.primaryKey&&this.append(" primary key"),t.autoIncrement&&(this.append(" "),this.append(this.getAutoIncrement())),t.references&&(this.append(" "),this.visitNode(t.references)),t.check&&(this.append(" "),this.visitNode(t.check)),t.endModifiers&&t.endModifiers.length>0&&(this.append(" "),this.compileList(t.endModifiers," "))}getAutoIncrement(){return"auto_increment"}visitReferences(t){this.append("references "),this.visitNode(t.table),this.append(" ("),this.compileList(t.columns),this.append(")"),t.onDelete&&(this.append(" on delete "),this.append(t.onDelete)),t.onUpdate&&(this.append(" on update "),this.append(t.onUpdate))}visitDropTable(t){this.append("drop table "),t.ifExists&&this.append("if exists "),this.visitNode(t.table),t.cascade&&this.append(" cascade")}visitDataType(t){this.append(t.dataType)}visitOrderBy(t){this.append("order by "),this.compileList(t.items)}visitOrderByItem(t){this.visitNode(t.orderBy),t.collation&&(this.append(" "),this.visitNode(t.collation)),t.direction&&(this.append(" "),this.visitNode(t.direction)),t.nulls&&(this.append(" nulls "),this.append(t.nulls))}visitGroupBy(t){this.append("group by "),this.compileList(t.items)}visitGroupByItem(t){this.visitNode(t.groupBy)}visitUpdateQuery(t){const n=this.parentNode!==void 0&&!co.is(this.parentNode)&&!dn.is(this.parentNode)&&!Fs.is(this.parentNode);if(this.parentNode===void 0&&t.explain&&(this.visitNode(t.explain),this.append(" ")),n&&this.append("("),t.with&&(this.visitNode(t.with),this.append(" ")),this.append("update "),t.top&&(this.visitNode(t.top),this.append(" ")),t.table&&(this.visitNode(t.table),this.append(" ")),this.append("set "),t.updates&&this.compileList(t.updates),t.output&&(this.append(" "),this.visitNode(t.output)),t.from&&(this.append(" "),this.visitNode(t.from)),t.joins){if(!t.from)throw new Error("Joins in an update query are only supported as a part of a PostgreSQL 'update set from join' query. If you want to create a MySQL 'update join set' query, see https://kysely.dev/docs/examples/update/my-sql-joins");this.append(" "),this.compileList(t.joins," ")}t.where&&(this.append(" "),this.visitNode(t.where)),t.returning&&(this.append(" "),this.visitNode(t.returning)),t.orderBy&&(this.append(" "),this.visitNode(t.orderBy)),t.limit&&(this.append(" "),this.visitNode(t.limit)),n&&this.append(")"),t.endModifiers?.length&&(this.append(" "),this.compileList(t.endModifiers," "))}visitColumnUpdate(t){this.visitNode(t.column),this.append(" = "),this.visitNode(t.value)}visitLimit(t){this.append("limit "),this.visitNode(t.limit)}visitOffset(t){this.append("offset "),this.visitNode(t.offset)}visitOnConflict(t){this.append("on conflict"),t.columns?(this.append(" ("),this.compileList(t.columns),this.append(")")):t.constraint?(this.append(" on constraint "),this.visitNode(t.constraint)):t.indexExpression&&(this.append(" ("),this.visitNode(t.indexExpression),this.append(")")),t.indexWhere&&(this.append(" "),this.visitNode(t.indexWhere)),t.doNothing===!0?this.append(" do nothing"):t.updates&&(this.append(" do update set "),this.compileList(t.updates),t.updateWhere&&(this.append(" "),this.visitNode(t.updateWhere)))}visitOnDuplicateKey(t){this.append("on duplicate key update "),this.compileList(t.updates)}visitCreateIndex(t){this.append("create "),t.unique&&this.append("unique "),this.append("index "),t.ifNotExists&&this.append("if not exists "),this.visitNode(t.name),t.table&&(this.append(" on "),this.visitNode(t.table)),t.using&&(this.append(" using "),this.visitNode(t.using)),t.columns&&(this.append(" ("),this.compileList(t.columns),this.append(")")),t.nullsNotDistinct&&this.append(" nulls not distinct"),t.where&&(this.append(" "),this.visitNode(t.where))}visitDropIndex(t){this.append("drop index "),t.ifExists&&this.append("if exists "),this.visitNode(t.name),t.table&&(this.append(" on "),this.visitNode(t.table)),t.cascade&&this.append(" cascade")}visitCreateSchema(t){this.append("create schema "),t.ifNotExists&&this.append("if not exists "),this.visitNode(t.schema)}visitDropSchema(t){this.append("drop schema "),t.ifExists&&this.append("if exists "),this.visitNode(t.schema),t.cascade&&this.append(" cascade")}visitPrimaryKeyConstraint(t){t.name&&(this.append("constraint "),this.visitNode(t.name),this.append(" ")),this.append("primary key ("),this.compileList(t.columns),this.append(")"),this.buildDeferrable(t)}buildDeferrable(t){t.deferrable!==void 0&&(t.deferrable?this.append(" deferrable"):this.append(" not deferrable")),t.initiallyDeferred!==void 0&&(t.initiallyDeferred?this.append(" initially deferred"):this.append(" initially immediate"))}visitUniqueConstraint(t){t.name&&(this.append("constraint "),this.visitNode(t.name),this.append(" ")),this.append("unique"),t.nullsNotDistinct&&this.append(" nulls not distinct"),this.append(" ("),this.compileList(t.columns),this.append(")"),this.buildDeferrable(t)}visitCheckConstraint(t){t.name&&(this.append("constraint "),this.visitNode(t.name),this.append(" ")),this.append("check ("),this.visitNode(t.expression),this.append(")")}visitForeignKeyConstraint(t){t.name&&(this.append("constraint "),this.visitNode(t.name),this.append(" ")),this.append("foreign key ("),this.compileList(t.columns),this.append(") "),this.visitNode(t.references),t.onDelete&&(this.append(" on delete "),this.append(t.onDelete)),t.onUpdate&&(this.append(" on update "),this.append(t.onUpdate)),this.buildDeferrable(t)}visitList(t){this.compileList(t.items)}visitWith(t){this.append("with "),t.recursive&&this.append("recursive "),this.compileList(t.expressions)}visitCommonTableExpression(t){this.visitNode(t.name),this.append(" as "),Cl(t.materialized)&&(t.materialized||this.append("not "),this.append("materialized ")),this.visitNode(t.expression)}visitCommonTableExpressionName(t){this.visitNode(t.table),t.columns&&(this.append("("),this.compileList(t.columns),this.append(")"))}visitAlterTable(t){this.append("alter table "),this.visitNode(t.table),this.append(" "),t.renameTo&&(this.append("rename to "),this.visitNode(t.renameTo)),t.setSchema&&(this.append("set schema "),this.visitNode(t.setSchema)),t.addConstraint&&this.visitNode(t.addConstraint),t.dropConstraint&&this.visitNode(t.dropConstraint),t.renameConstraint&&this.visitNode(t.renameConstraint),t.columnAlterations&&this.compileColumnAlterations(t.columnAlterations),t.addIndex&&this.visitNode(t.addIndex),t.dropIndex&&this.visitNode(t.dropIndex)}visitAddColumn(t){this.append("add column "),this.visitNode(t.column)}visitRenameColumn(t){this.append("rename column "),this.visitNode(t.column),this.append(" to "),this.visitNode(t.renameTo)}visitDropColumn(t){this.append("drop column "),this.visitNode(t.column)}visitAlterColumn(t){this.append("alter column "),this.visitNode(t.column),this.append(" "),t.dataType&&(this.announcesNewColumnDataType()&&this.append("type "),this.visitNode(t.dataType),t.dataTypeExpression&&(this.append("using "),this.visitNode(t.dataTypeExpression))),t.setDefault&&(this.append("set default "),this.visitNode(t.setDefault)),t.dropDefault&&this.append("drop default"),t.setNotNull&&this.append("set not null"),t.dropNotNull&&this.append("drop not null")}visitModifyColumn(t){this.append("modify column "),this.visitNode(t.column)}visitAddConstraint(t){this.append("add "),this.visitNode(t.constraint)}visitDropConstraint(t){this.append("drop constraint "),t.ifExists&&this.append("if exists "),this.visitNode(t.constraintName),t.modifier==="cascade"?this.append(" cascade"):t.modifier==="restrict"&&this.append(" restrict")}visitRenameConstraint(t){this.append("rename constraint "),this.visitNode(t.oldName),this.append(" to "),this.visitNode(t.newName)}visitSetOperation(t){this.append(t.operator),this.append(" "),t.all&&this.append("all "),this.visitNode(t.expression)}visitCreateView(t){this.append("create "),t.orReplace&&this.append("or replace "),t.materialized&&this.append("materialized "),t.temporary&&this.append("temporary "),this.append("view "),t.ifNotExists&&this.append("if not exists "),this.visitNode(t.name),this.append(" "),t.columns&&(this.append("("),this.compileList(t.columns),this.append(") ")),t.as&&(this.append("as "),this.visitNode(t.as))}visitRefreshMaterializedView(t){this.append("refresh materialized view "),t.concurrently&&this.append("concurrently "),this.visitNode(t.name),t.withNoData?this.append(" with no data"):this.append(" with data")}visitDropView(t){this.append("drop "),t.materialized&&this.append("materialized "),this.append("view "),t.ifExists&&this.append("if exists "),this.visitNode(t.name),t.cascade&&this.append(" cascade")}visitGenerated(t){this.append("generated "),t.always&&this.append("always "),t.byDefault&&this.append("by default "),this.append("as "),t.identity&&this.append("identity"),t.expression&&(this.append("("),this.visitNode(t.expression),this.append(")")),t.stored&&this.append(" stored")}visitDefaultValue(t){this.append("default "),this.visitNode(t.defaultValue)}visitSelectModifier(t){t.rawModifier?this.visitNode(t.rawModifier):this.append(I7[t.modifier]),t.of&&(this.append(" of "),this.compileList(t.of,", "))}visitCreateType(t){this.append("create type "),this.visitNode(t.name),t.enum&&(this.append(" as enum "),this.visitNode(t.enum))}visitDropType(t){this.append("drop type "),t.ifExists&&this.append("if exists "),this.visitNode(t.name)}visitExplain(t){this.append("explain"),(t.options||t.format)&&(this.append(" "),this.append(this.getLeftExplainOptionsWrapper()),t.options&&(this.visitNode(t.options),t.format&&this.append(this.getExplainOptionsDelimiter())),t.format&&(this.append("format"),this.append(this.getExplainOptionAssignment()),this.append(t.format)),this.append(this.getRightExplainOptionsWrapper()))}visitDefaultInsertValue(t){this.append("default")}visitAggregateFunction(t){this.append(t.func),this.append("("),t.distinct&&this.append("distinct "),this.compileList(t.aggregated),t.orderBy&&(this.append(" "),this.visitNode(t.orderBy)),this.append(")"),t.withinGroup&&(this.append(" within group ("),this.visitNode(t.withinGroup),this.append(")")),t.filter&&(this.append(" filter("),this.visitNode(t.filter),this.append(")")),t.over&&(this.append(" "),this.visitNode(t.over))}visitOver(t){this.append("over("),t.partitionBy&&(this.visitNode(t.partitionBy),t.orderBy&&this.append(" ")),t.orderBy&&this.visitNode(t.orderBy),this.append(")")}visitPartitionBy(t){this.append("partition by "),this.compileList(t.items)}visitPartitionByItem(t){this.visitNode(t.partitionBy)}visitBinaryOperation(t){this.visitNode(t.leftOperand),this.append(" "),this.visitNode(t.operator),this.append(" "),this.visitNode(t.rightOperand)}visitUnaryOperation(t){this.visitNode(t.operator),this.isMinusOperator(t.operator)||this.append(" "),this.visitNode(t.operand)}isMinusOperator(t){return rs.is(t)&&t.operator==="-"}visitUsing(t){this.append("using "),this.compileList(t.tables)}visitFunction(t){this.append(t.func),this.append("("),this.compileList(t.arguments),this.append(")")}visitCase(t){this.append("case"),t.value&&(this.append(" "),this.visitNode(t.value)),t.when&&(this.append(" "),this.compileList(t.when," ")),t.else&&(this.append(" else "),this.visitNode(t.else)),this.append(" end"),t.isStatement&&this.append(" case")}visitWhen(t){this.append("when "),this.visitNode(t.condition),t.result&&(this.append(" then "),this.visitNode(t.result))}visitJSONReference(t){this.visitNode(t.reference),this.visitNode(t.traversal)}visitJSONPath(t){t.inOperator&&this.visitNode(t.inOperator),this.append("'$");for(const n of t.pathLegs)this.visitNode(n);this.append("'")}visitJSONPathLeg(t){const n=t.type==="ArrayLocation";this.append(n?"[":"."),this.append(String(t.value)),n&&this.append("]")}visitJSONOperatorChain(t){for(let n=0,i=t.values.length;n<i;n++)n===i-1?this.visitNode(t.operator):this.append("->"),this.visitNode(t.values[n])}visitMergeQuery(t){t.with&&(this.visitNode(t.with),this.append(" ")),this.append("merge "),t.top&&(this.visitNode(t.top),this.append(" ")),this.append("into "),this.visitNode(t.into),t.using&&(this.append(" "),this.visitNode(t.using)),t.whens&&(this.append(" "),this.compileList(t.whens," ")),t.returning&&(this.append(" "),this.visitNode(t.returning)),t.output&&(this.append(" "),this.visitNode(t.output)),t.endModifiers?.length&&(this.append(" "),this.compileList(t.endModifiers," "))}visitMatched(t){t.not&&this.append("not "),this.append("matched"),t.bySource&&this.append(" by source")}visitAddIndex(t){this.append("add "),t.unique&&this.append("unique "),this.append("index "),this.visitNode(t.name),t.columns&&(this.append(" ("),this.compileList(t.columns),this.append(")")),t.using&&(this.append(" using "),this.visitNode(t.using))}visitCast(t){this.append("cast("),this.visitNode(t.expression),this.append(" as "),this.visitNode(t.dataType),this.append(")")}visitFetch(t){this.append("fetch next "),this.visitNode(t.rowCount),this.append(` rows ${t.modifier}`)}visitOutput(t){this.append("output "),this.compileList(t.selections)}visitTop(t){this.append(`top(${t.expression})`),t.modifiers&&this.append(` ${t.modifiers}`)}visitOrAction(t){this.append(t.action)}visitCollate(t){this.append("collate "),this.visitNode(t.collation)}append(t){this.#e+=t}appendValue(t){this.addParameter(t),this.append(this.getCurrentParameterPlaceholder())}getLeftIdentifierWrapper(){return'"'}getRightIdentifierWrapper(){return'"'}getCurrentParameterPlaceholder(){return"$"+this.numParameters}getLeftExplainOptionsWrapper(){return"("}getExplainOptionAssignment(){return" "}getExplainOptionsDelimiter(){return", "}getRightExplainOptionsWrapper(){return")"}sanitizeIdentifier(t){const n=this.getLeftIdentifierWrapper(),i=this.getRightIdentifierWrapper();let r="";for(const o of t)r+=o,o===n?r+=n:o===i&&(r+=i);return r}sanitizeStringLiteral(t){return t.replace(T7,"''")}addParameter(t){this.#t.push(t)}appendImmediateValue(t){if(Zn(t))this.appendStringLiteral(t);else if(Za(t)||Cl(t)||Dh(t))this.append(t.toString());else if(Ph(t))this.append("null");else if(MC(t))this.appendImmediateValue(t.toISOString());else throw new Error(`invalid immediate value ${t}`)}appendStringLiteral(t){this.append("'"),this.append(this.sanitizeStringLiteral(t)),this.append("'")}sortSelectModifiers(t){return t.sort((n,i)=>n.modifier&&i.modifier?Nx[n.modifier]-Nx[i.modifier]:1),R(t)}compileColumnAlterations(t){this.compileList(t)}announcesNewColumnDataType(){return!0}}const I7=R({ForKeyShare:"for key share",ForNoKeyUpdate:"for no key update",ForUpdate:"for update",ForShare:"for share",NoWait:"nowait",SkipLocked:"skip locked",Distinct:"distinct"}),Nx=R({ForKeyShare:1,ForNoKeyUpdate:1,ForUpdate:1,ForShare:1,NoWait:2,SkipLocked:2,Distinct:0}),N7=R({InnerJoin:"inner join",LeftJoin:"left join",RightJoin:"right join",FullJoin:"full join",CrossJoin:"cross join",LateralInnerJoin:"inner join lateral",LateralLeftJoin:"left join lateral",LateralCrossJoin:"cross join lateral",OuterApply:"outer apply",CrossApply:"cross apply",Using:"using"}),oi=R({raw(e,t=[]){return R({sql:e,query:dn.createWithSql(e),parameters:R(t),queryId:pt()})}});class Bh{get supportsCreateIfNotExists(){return!0}get supportsTransactionalDdl(){return!1}get supportsReturning(){return!1}get supportsOutput(){return!1}}function fo(e,t){return dn.createWithChildren([dn.createWithSql(`${e} `),zt.create(t)])}class $7{#e;#t=new O7;#n;#r;constructor(t){this.#e=R({...t})}async init(){this.#n=or(this.#e.database)?await this.#e.database():this.#e.database,this.#r=new C7(this.#n),this.#e.onCreateConnection&&await this.#e.onCreateConnection(this.#r)}async acquireConnection(){return await this.#t.lock(),this.#r}async beginTransaction(t){await t.executeQuery(oi.raw("begin"))}async commitTransaction(t){await t.executeQuery(oi.raw("commit"))}async rollbackTransaction(t){await t.executeQuery(oi.raw("rollback"))}async savepoint(t,n,i){await t.executeQuery(i(fo("savepoint",n),pt()))}async rollbackToSavepoint(t,n,i){await t.executeQuery(i(fo("rollback to",n),pt()))}async releaseSavepoint(t,n,i){await t.executeQuery(i(fo("release",n),pt()))}async releaseConnection(){this.#t.unlock()}async destroy(){this.#n?.close()}}class C7{#e;constructor(t){this.#e=t}executeQuery(t){const{sql:n,parameters:i}=t,r=this.#e.prepare(n);if(r.reader)return Promise.resolve({rows:r.all(i)});const{changes:o,lastInsertRowid:s}=r.run(i);return Promise.resolve({numAffectedRows:o!=null?BigInt(o):void 0,insertId:s!=null?BigInt(s):void 0,rows:[]})}async*streamQuery(t,n){const{sql:i,parameters:r,query:o}=t,s=this.#e.prepare(i);if(Gt.is(o)){const a=s.iterate(r);for(const c of a)yield{rows:[c]}}else throw new Error("Sqlite driver only supports streaming of select queries")}}class O7{#e;#t;async lock(){for(;this.#e;)await this.#e;this.#e=new Promise(t=>{this.#t=t})}unlock(){const t=this.#t;this.#e=void 0,this.#t=void 0,t?.()}}const R7=/"/g;class P7 extends zh{visitOrAction(t){this.append("or "),this.append(t.action)}getCurrentParameterPlaceholder(){return"?"}getLeftExplainOptionsWrapper(){return""}getRightExplainOptionsWrapper(){return""}getLeftIdentifierWrapper(){return'"'}getRightIdentifierWrapper(){return'"'}getAutoIncrement(){return"autoincrement"}sanitizeIdentifier(t){return t.replace(R7,'""')}visitDefaultInsertValue(t){this.append("null")}}const Hu="kysely_migration",Fh="kysely_migration_lock";R({__noMigrations__:!0});class D7{#e;constructor(t){this.#e=t}async getSchemas(){return[]}async getTables(t={withInternalKyselyTables:!1}){return await this.#n(t)}async getMetadata(t){return{tables:await this.getTables(t)}}#t(t,n){let i=t.selectFrom("sqlite_master").where("type","in",["table","view"]).where("name","not like","sqlite_%").select(["name","sql","type"]).orderBy("name");return n.withInternalKyselyTables||(i=i.where("name","!=",Hu).where("name","!=",Fh)),i}async#n(t){const n=await this.#t(this.#e,t).execute(),i=await this.#e.with("table_list",o=>this.#t(o,t)).selectFrom(["table_list as tl",Zt`pragma_table_info(tl.name)`.as("p")]).select(["tl.name as table","p.cid","p.name","p.type","p.notnull","p.dflt_value","p.pk"]).orderBy("tl.name").orderBy("p.cid").execute(),r={};for(const o of i)r[o.table]??=[],r[o.table].push(o);return n.map(({name:o,sql:s,type:a})=>{let c=s?.split(/[\(\),]/)?.find(u=>u.toLowerCase().includes("autoincrement"))?.trimStart()?.split(/\s+/)?.[0]?.replace(/["`]/g,"");const l=r[o]??[];if(!c){const u=l.filter(p=>p.pk>0);u.length===1&&u[0].type.toLowerCase()==="integer"&&(c=u[0].name)}return{name:o,isView:a==="view",columns:l.map(u=>({name:u.name,dataType:u.type,isNullable:!u.notnull,isAutoIncrementing:u.name===c,hasDefaultValue:u.dflt_value!=null,comment:void 0}))}})}}class U7 extends Bh{get supportsTransactionalDdl(){return!1}get supportsReturning(){return!0}async acquireMigrationLock(t,n){}async releaseMigrationLock(t,n){}}class SO{#e;constructor(t){this.#e=R({...t})}createDriver(){return new $7(this.#e)}createQueryCompiler(){return new P7}createAdapter(){return new U7}createIntrospector(t){return new D7(t)}}const L7=/"/g;class M7 extends zh{sanitizeIdentifier(t){return t.replace(L7,'""')}}class j7{#e;constructor(t){this.#e=t}async getSchemas(){return(await this.#e.selectFrom("pg_catalog.pg_namespace").select("nspname").$castTo().execute()).map(n=>({name:n.nspname}))}async getTables(t={withInternalKyselyTables:!1}){let n=this.#e.selectFrom("pg_catalog.pg_attribute as a").innerJoin("pg_catalog.pg_class as c","a.attrelid","c.oid").innerJoin("pg_catalog.pg_namespace as ns","c.relnamespace","ns.oid").innerJoin("pg_catalog.pg_type as typ","a.atttypid","typ.oid").innerJoin("pg_catalog.pg_namespace as dtns","typ.typnamespace","dtns.oid").select(["a.attname as column","a.attnotnull as not_null","a.atthasdef as has_default","c.relname as table","c.relkind as table_type","ns.nspname as schema","typ.typname as type","dtns.nspname as type_schema",Zt`col_description(a.attrelid, a.attnum)`.as("column_description"),Zt`pg_get_serial_sequence(quote_ident(ns.nspname) || '.' || quote_ident(c.relname), a.attname)`.as("auto_incrementing")]).where("c.relkind","in",["r","v","p"]).where("ns.nspname","!~","^pg_").where("ns.nspname","!=","information_schema").where("ns.nspname","!=","crdb_internal").where(Zt`has_schema_privilege(ns.nspname, 'USAGE')`).where("a.attnum",">=",0).where("a.attisdropped","!=",!0).orderBy("ns.nspname").orderBy("c.relname").orderBy("a.attnum").$castTo();t.withInternalKyselyTables||(n=n.where("c.relname","!=",Hu).where("c.relname","!=",Fh));const i=await n.execute();return this.#t(i)}async getMetadata(t){return{tables:await this.getTables(t)}}#t(t){return t.reduce((n,i)=>{let r=n.find(o=>o.name===i.table&&o.schema===i.schema);return r||(r=R({name:i.table,isView:i.table_type==="v",schema:i.schema,columns:[]}),n.push(r)),r.columns.push(R({name:i.column,dataType:i.type,dataTypeSchema:i.type_schema,isNullable:!i.not_null,isAutoIncrementing:i.auto_incrementing!==null,hasDefaultValue:i.has_default,comment:i.column_description??void 0})),n},[])}}const z7=BigInt("3853314791062309107");class B7 extends Bh{get supportsTransactionalDdl(){return!0}get supportsReturning(){return!0}async acquireMigrationLock(t,n){await Zt`select pg_advisory_xact_lock(${Zt.lit(z7)})`.execute(t)}async releaseMigrationLock(t,n){}}function e0(e,t){if(F7(e)&&t.stack){const n=t.stack.split(`
`).slice(1).join(`
`);return e.stack+=`
${n}`,e}return e}function F7(e){return Mr(e)&&Zn(e.stack)}const xO=Symbol();class W7{#e;#t=new WeakMap;#n;constructor(t){this.#e=R({...t})}async init(){this.#n=or(this.#e.pool)?await this.#e.pool():this.#e.pool}async acquireConnection(){const t=await this.#r();let n=this.#t.get(t);return n||(n=new q7(t),this.#t.set(t,n),this.#e?.onCreateConnection&&await this.#e.onCreateConnection(n)),this.#e?.onReserveConnection&&await this.#e.onReserveConnection(n),n}async#r(){return new Promise((t,n)=>{this.#n.getConnection(async(i,r)=>{i?n(i):t(r)})})}async beginTransaction(t,n){if(n.isolationLevel||n.accessMode){const i=[];n.isolationLevel&&i.push(`isolation level ${n.isolationLevel}`),n.accessMode&&i.push(n.accessMode);const r=`set transaction ${i.join(", ")}`;await t.executeQuery(oi.raw(r))}await t.executeQuery(oi.raw("begin"))}async commitTransaction(t){await t.executeQuery(oi.raw("commit"))}async rollbackTransaction(t){await t.executeQuery(oi.raw("rollback"))}async savepoint(t,n,i){await t.executeQuery(i(fo("savepoint",n),pt()))}async rollbackToSavepoint(t,n,i){await t.executeQuery(i(fo("rollback to",n),pt()))}async releaseSavepoint(t,n,i){await t.executeQuery(i(fo("release savepoint",n),pt()))}async releaseConnection(t){t[xO]()}async destroy(){return new Promise((t,n)=>{this.#n.end(i=>{i?n(i):t()})})}}function V7(e){return Mr(e)&&"insertId"in e&&"affectedRows"in e}class q7{#e;constructor(t){this.#e=t}async executeQuery(t){try{const n=await this.#t(t);if(V7(n)){const{insertId:i,affectedRows:r,changedRows:o}=n;return{insertId:i!=null&&i.toString()!=="0"?BigInt(i):void 0,numAffectedRows:r!=null?BigInt(r):void 0,numChangedRows:o!=null?BigInt(o):void 0,rows:[]}}else if(Array.isArray(n))return{rows:n};return{rows:[]}}catch(n){throw e0(n,new Error)}}#t(t){return new Promise((n,i)=>{this.#e.query(t.sql,t.parameters,(r,o)=>{r?i(r):n(o)})})}async*streamQuery(t,n){const i=this.#e.query(t.sql,t.parameters).stream({objectMode:!0});try{for await(const r of i)yield{rows:[r]}}catch(r){if(r&&typeof r=="object"&&"code"in r&&r.code==="ERR_STREAM_PREMATURE_CLOSE")return;throw r}}[xO](){this.#e.release()}}const H7=/`/g;class K7 extends zh{getCurrentParameterPlaceholder(){return"?"}getLeftExplainOptionsWrapper(){return""}getExplainOptionAssignment(){return"="}getExplainOptionsDelimiter(){return" "}getRightExplainOptionsWrapper(){return""}getLeftIdentifierWrapper(){return"`"}getRightIdentifierWrapper(){return"`"}sanitizeIdentifier(t){return t.replace(H7,"``")}visitCreateIndex(t){this.append("create "),t.unique&&this.append("unique "),this.append("index "),t.ifNotExists&&this.append("if not exists "),this.visitNode(t.name),t.using&&(this.append(" using "),this.visitNode(t.using)),t.table&&(this.append(" on "),this.visitNode(t.table)),t.columns&&(this.append(" ("),this.compileList(t.columns),this.append(")")),t.where&&(this.append(" "),this.visitNode(t.where))}}class J7{#e;constructor(t){this.#e=t}async getSchemas(){return(await this.#e.selectFrom("information_schema.schemata").select("schema_name").$castTo().execute()).map(n=>({name:n.SCHEMA_NAME}))}async getTables(t={withInternalKyselyTables:!1}){let n=this.#e.selectFrom("information_schema.columns as columns").innerJoin("information_schema.tables as tables",r=>r.onRef("columns.TABLE_CATALOG","=","tables.TABLE_CATALOG").onRef("columns.TABLE_SCHEMA","=","tables.TABLE_SCHEMA").onRef("columns.TABLE_NAME","=","tables.TABLE_NAME")).select(["columns.COLUMN_NAME","columns.COLUMN_DEFAULT","columns.TABLE_NAME","columns.TABLE_SCHEMA","tables.TABLE_TYPE","columns.IS_NULLABLE","columns.DATA_TYPE","columns.EXTRA","columns.COLUMN_COMMENT"]).where("columns.TABLE_SCHEMA","=",Zt`database()`).orderBy("columns.TABLE_NAME").orderBy("columns.ORDINAL_POSITION").$castTo();t.withInternalKyselyTables||(n=n.where("columns.TABLE_NAME","!=",Hu).where("columns.TABLE_NAME","!=",Fh));const i=await n.execute();return this.#t(i)}async getMetadata(t){return{tables:await this.getTables(t)}}#t(t){return t.reduce((n,i)=>{let r=n.find(o=>o.name===i.TABLE_NAME);return r||(r=R({name:i.TABLE_NAME,isView:i.TABLE_TYPE==="VIEW",schema:i.TABLE_SCHEMA,columns:[]}),n.push(r)),r.columns.push(R({name:i.COLUMN_NAME,dataType:i.DATA_TYPE,isNullable:i.IS_NULLABLE==="YES",isAutoIncrementing:i.EXTRA.toLowerCase().includes("auto_increment"),hasDefaultValue:i.COLUMN_DEFAULT!==null,comment:i.COLUMN_COMMENT===""?void 0:i.COLUMN_COMMENT})),n},[])}}const $x="ea586330-2c93-47c8-908d-981d9d270f9d",G7=3600;class Z7 extends Bh{get supportsTransactionalDdl(){return!1}get supportsReturning(){return!1}async acquireMigrationLock(t,n){await Zt`select get_lock(${Zt.lit($x)}, ${Zt.lit(G7)})`.execute(t)}async releaseMigrationLock(t,n){await Zt`select release_lock(${Zt.lit($x)})`.execute(t)}}class kO{#e;constructor(t){this.#e=t}createDriver(){return new W7(this.#e)}createQueryCompiler(){return new K7}createAdapter(){return new Z7}createIntrospector(t){return new J7(t)}}const EO=Symbol();class Q7{#e;#t=new WeakMap;#n;constructor(t){this.#e=R({...t})}async init(){this.#n=or(this.#e.pool)?await this.#e.pool():this.#e.pool}async acquireConnection(){const t=await this.#n.connect();let n=this.#t.get(t);return n||(n=new Y7(t,{cursor:this.#e.cursor??null}),this.#t.set(t,n),this.#e.onCreateConnection&&await this.#e.onCreateConnection(n)),this.#e.onReserveConnection&&await this.#e.onReserveConnection(n),n}async beginTransaction(t,n){if(n.isolationLevel||n.accessMode){let i="start transaction";n.isolationLevel&&(i+=` isolation level ${n.isolationLevel}`),n.accessMode&&(i+=` ${n.accessMode}`),await t.executeQuery(oi.raw(i))}else await t.executeQuery(oi.raw("begin"))}async commitTransaction(t){await t.executeQuery(oi.raw("commit"))}async rollbackTransaction(t){await t.executeQuery(oi.raw("rollback"))}async savepoint(t,n,i){await t.executeQuery(i(fo("savepoint",n),pt()))}async rollbackToSavepoint(t,n,i){await t.executeQuery(i(fo("rollback to",n),pt()))}async releaseSavepoint(t,n,i){await t.executeQuery(i(fo("release",n),pt()))}async releaseConnection(t){t[EO]()}async destroy(){if(this.#n){const t=this.#n;this.#n=void 0,await t.end()}}}class Y7{#e;#t;constructor(t,n){this.#e=t,this.#t=n}async executeQuery(t){try{const{command:n,rowCount:i,rows:r}=await this.#e.query(t.sql,[...t.parameters]);return{numAffectedRows:n==="INSERT"||n==="UPDATE"||n==="DELETE"||n==="MERGE"?BigInt(i):void 0,rows:r??[]}}catch(n){throw e0(n,new Error)}}async*streamQuery(t,n){if(!this.#t.cursor)throw new Error("'cursor' is not present in your postgres dialect config. It's required to make streaming work in postgres.");if(!Number.isInteger(n)||n<=0)throw new Error("chunkSize must be a positive integer");const i=this.#e.query(new this.#t.cursor(t.sql,t.parameters.slice()));try{for(;;){const r=await i.read(n);if(r.length===0)break;yield{rows:r}}}finally{await i.close()}}[EO](){this.#e.release()}}class AO{#e;constructor(t){this.#e=t}createDriver(){return new Q7(this.#e)}createQueryCompiler(){return new M7}createAdapter(){return new B7}createIntrospector(t){return new j7(t)}}class X7 extends Bh{get supportsCreateIfNotExists(){return!1}get supportsTransactionalDdl(){return!0}get supportsOutput(){return!0}async acquireMigrationLock(t){await Zt`exec sp_getapplock @DbPrincipal = ${Zt.lit("dbo")}, @Resource = ${Zt.lit(Hu)}, @LockMode = ${Zt.lit("Exclusive")}`.execute(t)}async releaseMigrationLock(){}}const TO=Symbol(),IO=Symbol(),NO=Symbol();class eH{#e;#t;constructor(t){this.#e=R({...t});const{tarn:n,tedious:i,validateConnections:r}=this.#e,{validateConnections:o,...s}=n.options;this.#t=new n.Pool({...s,create:async()=>{const a=await i.connectionFactory();return await new tH(a,i).connect()},destroy:async a=>{await a[IO]()},validate:r===!1||o===!1?void 0:a=>a[NO]()})}async init(){}async acquireConnection(){return await this.#t.acquire().promise}async beginTransaction(t,n){await t.beginTransaction(n)}async commitTransaction(t){await t.commitTransaction()}async rollbackTransaction(t){await t.rollbackTransaction()}async savepoint(t,n){await t.savepoint(n)}async rollbackToSavepoint(t,n){await t.rollbackTransaction(n)}async releaseConnection(t){(this.#e.resetConnectionsOnRelease||this.#e.tedious.resetConnectionOnRelease)&&await t[TO](),this.#t.release(t)}async destroy(){await this.#t.destroy()}}class tH{#e;#t;#n;constructor(t,n){this.#e=t,this.#t=!1,this.#n=n}async beginTransaction(t){const{isolationLevel:n}=t;await new Promise((i,r)=>this.#e.beginTransaction(o=>{o?r(o):i(void 0)},n?eO(8):void 0,n?this.#r(n):void 0))}async commitTransaction(){await new Promise((t,n)=>this.#e.commitTransaction(i=>{i?n(i):t(void 0)}))}async connect(){const{promise:t,reject:n,resolve:i}=new pl;this.#e.connect(o=>{if(o)return n(o);i()}),this.#e.on("error",o=>{o instanceof Error&&"code"in o&&o.code==="ESOCKET"&&(this.#t=!0),console.error(o),n(o)});function r(){n(new Error("The connection ended without ever completing the connection"))}return this.#e.once("end",r),await t,this.#e.off("end",r),this}async executeQuery(t){try{const n=new pl,i=new dg({compiledQuery:t,tedious:this.#n,onDone:n});this.#e.execSql(i.request);const{rowCount:r,rows:o}=await n.promise;return{numAffectedRows:r!==void 0?BigInt(r):void 0,rows:o}}catch(n){throw e0(n,new Error)}}async rollbackTransaction(t){await new Promise((n,i)=>this.#e.rollbackTransaction(r=>{r?i(r):n(void 0)},t))}async savepoint(t){await new Promise((n,i)=>this.#e.saveTransaction(r=>{r?i(r):n(void 0)},t))}async*streamQuery(t,n){if(!Number.isInteger(n)||n<=0)throw new Error("chunkSize must be a positive integer");const i=new dg({compiledQuery:t,streamChunkSize:n,tedious:this.#n});this.#e.execSql(i.request);try{for(;;){const r=await i.readChunk();if(r.length===0||(yield{rows:r},r.length<n))break}}finally{await this.#i(i)}}#r(t){const{ISOLATION_LEVEL:n}=this.#n,r={"read committed":n.READ_COMMITTED,"read uncommitted":n.READ_UNCOMMITTED,"repeatable read":n.REPEATABLE_READ,serializable:n.SERIALIZABLE,snapshot:n.SNAPSHOT}[t];if(r===void 0)throw new Error(`Unknown isolation level: ${t}`);return r}#i(t){return new Promise(n=>{t.request.once("requestCompleted",n),this.#e.cancel()||(t.request.off("requestCompleted",n),n())})}[IO](){return"closed"in this.#e&&this.#e.closed?Promise.resolve():new Promise(t=>{this.#e.once("end",t),this.#e.close()})}async[TO](){await new Promise((t,n)=>{this.#e.reset(i=>{if(i)return n(i);t()})})}async[NO](){if(this.#t||this.#s())return!1;try{const t=new pl,n=new dg({compiledQuery:oi.raw("select 1"),onDone:t,tedious:this.#n});return this.#e.execSql(n.request),await t.promise,!0}catch{return!1}}#s(){return"closed"in this.#e&&!!this.#e.closed}}class dg{#e;#t;#n;#r;#i;#s;constructor(t){const{compiledQuery:n,onDone:i,streamChunkSize:r,tedious:o}=t;if(this.#t=[],this.#n=r,this.#r={},this.#i=o,i){const s="onDone";this.#r[s]=(a,c)=>{if(a!=="chunkReady"){if(delete this.#r[s],a==="error")return i.reject(c);i.resolve({rowCount:this.#s,rows:this.#t})}}}this.#e=new this.#i.Request(n.sql,(s,a)=>{if(s)return Object.values(this.#r).forEach(c=>c("error",s instanceof AggregateError?s.errors:s));this.#s=a}),this.#a(n.parameters),this.#o()}get request(){return this.#e}readChunk(){const t=this.readChunk.name;return new Promise((n,i)=>{this.#r[t]=(r,o)=>{if(delete this.#r[t],r==="error")return i(o);n(this.#t.splice(0,this.#n))},this.#e.resume()})}#a(t){for(let n=0;n<t.length;n++){const i=t[n];this.#e.addParameter(String(n+1),this.#c(i),i)}}#o(){const t=this.#n?()=>{this.#n<=this.#t.length&&(this.#e.pause(),Object.values(this.#r).forEach(i=>i("chunkReady")))}:()=>{},n=i=>{const r={};for(const o of i)r[o.metadata.colName]=o.value;this.#t.push(r),t()};this.#e.on("row",n),this.#e.once("requestCompleted",()=>{Object.values(this.#r).forEach(i=>i("completed")),this.#e.off("row",n)})}#c(t){return Ph(t)||uo(t)||Zn(t)?this.#i.TYPES.NVarChar:Dh(t)||Za(t)&&t%1===0?t<-2147483648||t>2147483647?this.#i.TYPES.BigInt:this.#i.TYPES.Int:Za(t)?this.#i.TYPES.Float:Cl(t)?this.#i.TYPES.Bit:MC(t)?this.#i.TYPES.DateTime:FV(t)?this.#i.TYPES.VarBinary:this.#i.TYPES.NVarChar}}class nH{#e;constructor(t){this.#e=t}async getSchemas(){return await this.#e.selectFrom("sys.schemas").select("name").execute()}async getTables(t={withInternalKyselyTables:!1}){const n=await this.#e.selectFrom("sys.tables as tables").leftJoin("sys.schemas as table_schemas","table_schemas.schema_id","tables.schema_id").innerJoin("sys.columns as columns","columns.object_id","tables.object_id").innerJoin("sys.types as types","types.user_type_id","columns.user_type_id").leftJoin("sys.schemas as type_schemas","type_schemas.schema_id","types.schema_id").leftJoin("sys.extended_properties as comments",r=>r.onRef("comments.major_id","=","tables.object_id").onRef("comments.minor_id","=","columns.column_id").on("comments.name","=","MS_Description")).$if(!t.withInternalKyselyTables,r=>r.where("tables.name","!=",Hu).where("tables.name","!=",Fh)).select(["tables.name as table_name",r=>r.ref("tables.type").$castTo().as("table_type"),"table_schemas.name as table_schema_name","columns.default_object_id as column_default_object_id","columns.generated_always_type_desc as column_generated_always_type","columns.is_computed as column_is_computed","columns.is_identity as column_is_identity","columns.is_nullable as column_is_nullable","columns.is_rowguidcol as column_is_rowguidcol","columns.name as column_name","types.is_nullable as type_is_nullable","types.name as type_name","type_schemas.name as type_schema_name","comments.value as column_comment"]).unionAll(this.#e.selectFrom("sys.views as views").leftJoin("sys.schemas as view_schemas","view_schemas.schema_id","views.schema_id").innerJoin("sys.columns as columns","columns.object_id","views.object_id").innerJoin("sys.types as types","types.user_type_id","columns.user_type_id").leftJoin("sys.schemas as type_schemas","type_schemas.schema_id","types.schema_id").leftJoin("sys.extended_properties as comments",r=>r.onRef("comments.major_id","=","views.object_id").onRef("comments.minor_id","=","columns.column_id").on("comments.name","=","MS_Description")).select(["views.name as table_name","views.type as table_type","view_schemas.name as table_schema_name","columns.default_object_id as column_default_object_id","columns.generated_always_type_desc as column_generated_always_type","columns.is_computed as column_is_computed","columns.is_identity as column_is_identity","columns.is_nullable as column_is_nullable","columns.is_rowguidcol as column_is_rowguidcol","columns.name as column_name","types.is_nullable as type_is_nullable","types.name as type_name","type_schemas.name as type_schema_name","comments.value as column_comment"])).orderBy("table_schema_name").orderBy("table_name").orderBy("column_name").execute(),i={};for(const r of n){const o=`${r.table_schema_name}.${r.table_name}`;(i[o]=i[o]||R({columns:[],isView:r.table_type==="V ",name:r.table_name,schema:r.table_schema_name??void 0})).columns.push(R({dataType:r.type_name,dataTypeSchema:r.type_schema_name??void 0,hasDefaultValue:r.column_default_object_id>0||r.column_generated_always_type!=="NOT_APPLICABLE"||r.column_is_identity||r.column_is_computed||r.column_is_rowguidcol,isAutoIncrementing:r.column_is_identity,isNullable:r.column_is_nullable&&r.type_is_nullable,name:r.column_name,comment:r.column_comment??void 0}))}return Object.values(i)}async getMetadata(t){return{tables:await this.getTables(t)}}}const rH=/^[a-z0-9_]$/i;class iH extends zh{getCurrentParameterPlaceholder(){return`@${this.numParameters}`}visitOffset(t){super.visitOffset(t),this.append(" rows")}compileColumnAlterations(t){const n={};for(const r of t)n[r.kind]||(n[r.kind]=[]),n[r.kind].push(r);let i=!0;n.AddColumnNode&&(this.append("add "),this.compileList(n.AddColumnNode),i=!1),n.AlterColumnNode&&(i||this.append(", "),this.compileList(n.AlterColumnNode)),n.DropColumnNode&&(i||this.append(", "),this.append("drop column "),this.compileList(n.DropColumnNode)),n.ModifyColumnNode&&(i||this.append(", "),this.compileList(n.ModifyColumnNode)),n.RenameColumnNode&&(i||this.append(", "),this.compileList(n.RenameColumnNode))}visitAddColumn(t){this.visitNode(t.column)}visitDropColumn(t){this.visitNode(t.column)}visitMergeQuery(t){super.visitMergeQuery(t),this.append(";")}visitCollate(t){this.append("collate ");const{name:n}=t.collation;for(const i of n)if(!rH.test(i))throw new Error(`Invalid collation: ${n}`);this.append(n)}announcesNewColumnDataType(){return!1}}class oH{#e;constructor(t){this.#e=t}createDriver(){return new eH(this.#e)}createQueryCompiler(){return new iH}createAdapter(){return new X7}createIntrospector(t){return new nH(t)}}function t0(e){if(!e)return null;if("dialect"in e)return t0(e.dialect);if("createDriver"in e){if(e instanceof SO)return"sqlite";if(e instanceof kO)return"mysql";if(e instanceof AO)return"postgres";if(e instanceof oH)return"mssql"}return"aggregate"in e?"sqlite":"getConnection"in e?"mysql":"connect"in e?"postgres":"fileControl"in e||"open"in e&&"close"in e&&"prepare"in e?"sqlite":null}const sH=async e=>{const t=e.database;if(!t)return{kysely:null,databaseType:null,transaction:void 0};if("db"in t)return{kysely:t.db,databaseType:t.type,transaction:t.transaction};if("dialect"in t)return{kysely:new lo({dialect:t.dialect}),databaseType:t.type,transaction:t.transaction};let n;const i=t0(t);if("createDriver"in t&&(n=t),"aggregate"in t&&!("createSession"in t)&&(n=new SO({database:t})),"getConnection"in t&&(n=new kO(t)),"connect"in t&&(n=new AO({pool:t})),"fileControl"in t){const{BunSqliteDialect:r}=await import("./bun-sqlite-dialect-BSGVsdYI.mjs");n=new r({database:t})}if("createSession"in t){let r;try{({DatabaseSync:r}=await import("node:sqlite"))}catch(o){if(o!==null&&typeof o=="object"&&"code"in o&&o.code!=="ERR_UNKNOWN_BUILTIN_MODULE")throw o}if(r&&t instanceof r){const{NodeSqliteDialect:o}=await import("./node-sqlite-dialect-DdrqUnes.mjs");n=new o({database:t})}}return{kysely:n?new lo({dialect:n}):null,databaseType:i,transaction:void 0}},Ec=({usePlural:e,schema:t})=>i=>{if(e&&i.charAt(i.length-1)==="s"){const o=i.slice(0,-1);let s=t[o]?o:void 0;if(s||(s=Object.entries(t).find(([a,c])=>c.modelName===o)?.[0]),s)return s}let r=t[i]?i:void 0;if(r||(r=Object.entries(t).find(([o,s])=>s.modelName===i)?.[0]),!r)throw new Fe(`Model "${i}" not found in schema`);return r},n0=({schema:e,usePlural:t})=>{const n=Ec({schema:e,usePlural:t});return({field:r,model:o})=>{if(r==="id"||r==="_id")return"id";const s=n(o);let a=e[s]?.fields[r];if(!a){const c=Object.entries(e[s].fields).find(([l,u])=>u.fieldName===r);c&&(a=c[1],r=c[0])}if(!a)throw new Fe(`Field ${r} not found in model ${s}`);return r}},$O=({usePlural:e,schema:t,disableIdGeneration:n,options:i,customIdGenerator:r,supportsUUIDs:o})=>{const s=Ec({usePlural:e,schema:t});return({customModelName:c,forceAllowId:l})=>{const u=i.advanced?.database?.useNumberId||i.advanced?.database?.generateId==="serial",p=i.advanced?.database?.generateId==="uuid",f=n||u&&!l?!1:p?!o:!0,g=s(c??"id");return{type:u?"number":"string",required:!!f,...f?{defaultValue(){if(n)return;const h=i.advanced?.database?.generateId;if(!(h===!1||u))return typeof h=="function"?h({model:g}):r?r({model:g}):h==="uuid"?crypto.randomUUID():Al()}}:{},transform:{input:h=>{if(h){if(u){const d=Number(h);return isNaN(d)?void 0:d}if(p){if(f&&!l)return h;if(n||o)return;if(l&&typeof h=="string"){if(/^[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(h))return h;{const d=new Error().stack?.split(`
`).filter((y,v)=>v!==1).join(`
`).replace("Error:","");Qe.warn("[Adapter Factory] - Invalid UUID value for field `id` provided when `forceAllowId` is true. Generating a new UUID.",d)}}return typeof h!="string"&&!o?crypto.randomUUID():void 0}return h}},output:h=>{if(h)return String(h)}}}}},aH=({usePlural:e,schema:t,options:n,customIdGenerator:i,disableIdGeneration:r})=>{const o=Ec({usePlural:e,schema:t}),s=n0({usePlural:e,schema:t}),a=$O({usePlural:e,schema:t,options:n,customIdGenerator:i,disableIdGeneration:r});return({model:l,field:u})=>{const p=o(l),f=s({field:u,model:p}),g=t[p].fields;g.id=a({customModelName:p});const h=g[f];if(!h)throw new Fe(`Field ${u} not found in model ${l}`);return h}},CO=({schema:e,usePlural:t})=>{const n=Ec({schema:e,usePlural:t}),i=n0({schema:e,usePlural:t});function r({model:o,field:s}){const a=n(o),c=i({model:a,field:s});return e[a]?.fields[c]?.fieldName||c}return r},OO=({usePlural:e,schema:t})=>{const n=Ec({schema:t,usePlural:e});return r=>{const o=n(r);return t&&t[o]&&t[o].modelName!==r?e?`${t[o].modelName}s`:t[o].modelName:e?`${r}s`:r}};function cH(e,t,n){return n==="update"?e===void 0&&t.onUpdate!==void 0?typeof t.onUpdate=="function"?t.onUpdate():t.onUpdate:e:n==="create"&&(e===void 0||t.required===!0&&e===null)&&t.defaultValue!==void 0?typeof t.defaultValue=="function"?t.defaultValue():t.defaultValue:e}let Od=[],Xn=-1;const lH=e=>t=>t(e),Cx=({adapter:e,config:t})=>n=>{const i=Math.random().toString(36).substring(2,15),r={...t,supportsBooleans:t.supportsBooleans??!0,supportsDates:t.supportsDates??!0,supportsJSON:t.supportsJSON??!1,adapterName:t.adapterName??t.adapterId,supportsNumericIds:t.supportsNumericIds??!0,supportsUUIDs:t.supportsUUIDs??!1,supportsArrays:t.supportsArrays??!1,transaction:t.transaction??!1,disableTransformInput:t.disableTransformInput??!1,disableTransformOutput:t.disableTransformOutput??!1,disableTransformJoin:t.disableTransformJoin??!1};if((n.advanced?.database?.useNumberId===!0||n.advanced?.database?.generateId==="serial")&&r.supportsNumericIds===!1)throw new Fe(`[${r.adapterName}] Your database or database adapter does not support numeric ids. Please disable "useNumberId" in your config.`);const o=ts(n),s=(...b)=>{if(r.debugLogs===!0||typeof r.debugLogs=="object"){const P=Tl({level:"info"});if(typeof r.debugLogs=="object"&&"isRunningAdapterTests"in r.debugLogs){r.debugLogs.isRunningAdapterTests&&(b.shift(),Od.push({instance:i,args:b}));return}if(typeof r.debugLogs=="object"&&r.debugLogs.logCondition&&!r.debugLogs.logCondition?.())return;if(typeof b[0]=="object"&&"method"in b[0]){const $=b.shift().method;if(typeof r.debugLogs=="object"){if($==="create"&&!r.debugLogs.create)return;if($==="update"&&!r.debugLogs.update)return;if($==="updateMany"&&!r.debugLogs.updateMany)return;if($==="findOne"&&!r.debugLogs.findOne)return;if($==="findMany"&&!r.debugLogs.findMany)return;if($==="delete"&&!r.debugLogs.delete)return;if($==="deleteMany"&&!r.debugLogs.deleteMany)return;if($==="count"&&!r.debugLogs.count)return}P.info(`[${r.adapterName}]`,...b)}else P.info(`[${r.adapterName}]`,...b)}},a=Tl(n.logger),c=Ec({usePlural:r.usePlural,schema:o}),l=n0({usePlural:r.usePlural,schema:o}),u=OO({usePlural:r.usePlural,schema:o}),p=CO({schema:o,usePlural:r.usePlural}),f=$O({schema:o,options:n,usePlural:r.usePlural,disableIdGeneration:r.disableIdGeneration,customIdGenerator:r.customIdGenerator,supportsUUIDs:r.supportsUUIDs}),g=aH({schema:o,options:n,usePlural:r.usePlural,disableIdGeneration:r.disableIdGeneration,customIdGenerator:r.customIdGenerator}),h=async(b,P,$,k)=>{const D={},B=o[P].fields,J=r.mapKeysTransformInput??{},S=n.advanced?.database?.useNumberId||n.advanced?.database?.generateId==="serial";B.id=f({customModelName:P,forceAllowId:k&&"id"in b});for(const T in B){let z=b[T];const L=B[T],q=J[T]||B[T].fieldName||T;if(z===void 0&&(L.defaultValue===void 0&&!L.transform?.input&&!($==="update"&&L.onUpdate)||$==="update"&&!L.onUpdate))continue;if(L&&L.type==="date"&&!(z instanceof Date)&&typeof z=="string")try{z=new Date(z)}catch{a.error("[Adapter Factory] Failed to convert string to date",{value:z,field:T})}let V=cH(z,L,$);L.transform?.input&&(V=await L.transform.input(V)),L.references?.field==="id"&&S?Array.isArray(V)?V=V.map(K=>K!==null?Number(K):null):V=V!==null?Number(V):null:r.supportsJSON===!1&&typeof V=="object"&&L.type==="json"||r.supportsArrays===!1&&Array.isArray(V)&&(L.type==="string[]"||L.type==="number[]")?V=JSON.stringify(V):r.supportsDates===!1&&V instanceof Date&&L.type==="date"?V=V.toISOString():r.supportsBooleans===!1&&typeof V=="boolean"&&(V=V?1:0),r.customTransformInput&&(V=r.customTransformInput({data:V,action:$,field:q,fieldAttributes:L,model:u(P),schema:o,options:n})),V!==void 0&&(D[q]=V)}return D},d=async(b,P,$=[],k)=>{const D=async(S,T,z=[])=>{if(!S)return null;const L=r.mapKeysTransformOutput??{},q={},V=o[c(T)].fields,K=Object.entries(L).find(([oe,ne])=>ne==="id")?.[0];V[K??"id"]={type:n.advanced?.database?.useNumberId||n.advanced?.database?.generateId==="serial"?"number":"string"};for(const oe in V){if(z.length&&!z.includes(oe))continue;const ne=V[oe];if(ne){const X=ne.fieldName||oe;let ae=S[Object.entries(L).find(([ge,pe])=>pe===X)?.[0]||X];ne.transform?.output&&(ae=await ne.transform.output(ae));const he=L[oe]||oe;X==="id"||ne.references?.field==="id"?typeof ae<"u"&&ae!==null&&(ae=String(ae)):r.supportsJSON===!1&&typeof ae=="string"&&ne.type==="json"||r.supportsArrays===!1&&typeof ae=="string"&&(ne.type==="string[]"||ne.type==="number[]")?ae=tr(ae):r.supportsDates===!1&&typeof ae=="string"&&ne.type==="date"?ae=new Date(ae):r.supportsBooleans===!1&&typeof ae=="number"&&ne.type==="boolean"&&(ae=ae===1),r.customTransformOutput&&(ae=r.customTransformOutput({data:ae,field:he,fieldAttributes:ne,select:z,model:u(T),schema:o,options:n})),q[he]=ae}}return q};if(!k||Object.keys(k).length===0)return await D(b,P,$);P=c(P);const B=await D(b,P,$),J=Object.entries(k).map(([S,T])=>({modelName:u(S),defaultModelName:c(S),joinConfig:T}));if(!b)return null;for(const{modelName:S,defaultModelName:T,joinConfig:z}of J){let L=await(async()=>n.experimental?.joins?b[S]:await x({baseModel:P,baseData:B,joinModel:S,specificJoinConfig:z}))();L==null&&(L=z.relation==="one-to-one"?null:[]),z.relation==="one-to-many"&&!Array.isArray(L)&&(L=[L]);const q=[];if(Array.isArray(L))for(const V of L){const K=await D(V,S,[]);q.push(K)}else{const V=await D(L,S,[]);q.push(V)}B[T]=(z.relation==="one-to-one"?q[0]:q)??null}return B},y=({model:b,where:P,action:$})=>{if(!P)return;const k=r.mapKeysTransformInput??{};return P.map(D=>{const{field:B,value:J,operator:S="eq",connector:T="AND"}=D;if(S==="in"&&!Array.isArray(J))throw new Fe("Value must be an array");let z=J;const L=c(b),q=l({field:B,model:b}),V=k[q]||p({field:q,model:L}),K=g({field:q,model:L}),oe=n.advanced?.database?.useNumberId||n.advanced?.database?.generateId==="serial";if((q==="id"||K.references?.field==="id")&&oe&&(Array.isArray(J)?z=J.map(Number):z=Number(J)),K.type==="date"&&J instanceof Date&&!r.supportsDates&&(z=J.toISOString()),K.type==="boolean"&&typeof J=="boolean"&&!r.supportsBooleans&&(z=J?1:0),K.type==="json"&&typeof J=="object"&&!r.supportsJSON)try{z=JSON.stringify(J)}catch(ne){throw new Error(`Failed to stringify JSON value for field ${V}`,{cause:ne})}return r.customTransformInput&&(z=r.customTransformInput({data:z,fieldAttributes:K,field:V,model:u(b),schema:o,options:n,action:$})),{operator:S,connector:T,field:V,value:z}})},v=(b,P,$)=>{if(!P||Object.keys(P).length===0)return;const k={};for(const[D,B]of Object.entries(P)){if(!B)continue;const J=c(D),S=c(b);let T=Object.entries(o[J].fields).filter(([ae,he])=>he.references&&c(he.references.model)===S),z=!0;if(T.length||(T=Object.entries(o[S].fields).filter(([ae,he])=>he.references&&c(he.references.model)===J),z=!1),T.length){if(T.length>1)throw new Fe(`Multiple foreign keys found for model ${D} and base model ${b} while performing join operation. Only one foreign key is supported.`)}else throw new Fe(`No foreign key found for model ${D} and base model ${b} while performing join operation.`);const[L,q]=T[0];if(!q.references)throw new Fe(`No references found for foreign key ${L} on model ${D} while performing join operation.`);let V,K,oe;z?(oe=q.references.field,V=p({model:b,field:oe}),K=p({model:D,field:L})):(oe=L,V=p({model:b,field:oe}),K=p({model:D,field:q.references.field})),$&&!$.includes(oe)&&$.push(oe);const ne=K==="id"?!0:q.unique??!1;let X=n.advanced?.database?.defaultFindManyLimit??100;ne?X=1:typeof B=="object"&&typeof B.limit=="number"&&(X=B.limit),k[u(D)]={on:{from:V,to:K},limit:X,relation:ne?"one-to-one":"one-to-many"}}return{join:k,select:$}},x=async({baseModel:b,baseData:P,joinModel:$,specificJoinConfig:k})=>{if(!P)return P;const D=u($),B=k.on.to,J=P[l({field:k.on.from,model:b})];if(J==null)return k.relation==="one-to-one"?null:[];let S;const T=y({model:D,where:[{field:B,value:J,operator:"eq",connector:"AND"}],action:"findOne"});try{if(k.relation==="one-to-one")S=await E.findOne({model:D,where:T});else{const z=k.limit??n.advanced?.database?.defaultFindManyLimit??100;S=await E.findMany({model:D,where:T,limit:z})}}catch(z){throw a.error(`Failed to query fallback join for model ${D}:`,{where:T,limit:k.limit}),console.error(z),z}return S},E=e({options:n,schema:o,debugLog:s,getFieldName:p,getModelName:u,getDefaultModelName:c,getDefaultFieldName:l,getFieldAttributes:g,transformInput:h,transformOutput:d,transformWhereClause:y});let N=null;const C={transaction:async b=>(N||(r.transaction?(a.debug(`[${r.adapterName}] - Using provided transaction implementation.`),N=r.transaction):N=lH(C)),N(b)),create:async({data:b,model:P,select:$,forceAllowId:k=!1})=>{Xn++;const D=Xn,B=u(P);if(P=c(P),"id"in b&&typeof b.id<"u"&&!k){a.warn(`[${r.adapterName}] - You are trying to create a record with an id. This is not allowed as we handle id generation for you, unless you pass in the \`forceAllowId\` parameter. The id will be ignored.`);const z=new Error().stack?.split(`
`).filter((L,q)=>q!==1).join(`
`).replace("Error:","Create method with `id` being called at:");console.log(z),b.id=void 0}s({method:"create"},`${on(D)} ${sn(1,4)}`,`${an("create")} ${Tn("Unsafe Input")}:`,{model:B,data:b});let J=b;r.disableTransformInput||(J=await h(b,P,"create",k)),s({method:"create"},`${on(D)} ${sn(2,4)}`,`${an("create")} ${Tn("Parsed Input")}:`,{model:B,data:J});const S=await E.create({data:J,model:B});s({method:"create"},`${on(D)} ${sn(3,4)}`,`${an("create")} ${Tn("DB Result")}:`,{model:B,res:S});let T=S;return r.disableTransformOutput||(T=await d(S,P,$,void 0)),s({method:"create"},`${on(D)} ${sn(4,4)}`,`${an("create")} ${Tn("Parsed Result")}:`,{model:B,data:T}),T},update:async({model:b,where:P,update:$})=>{Xn++;const k=Xn;b=c(b);const D=u(b),B=y({model:b,where:P,action:"update"});s({method:"update"},`${on(k)} ${sn(1,4)}`,`${an("update")} ${Tn("Unsafe Input")}:`,{model:D,data:$});let J=$;r.disableTransformInput||(J=await h($,b,"update")),s({method:"update"},`${on(k)} ${sn(2,4)}`,`${an("update")} ${Tn("Parsed Input")}:`,{model:D,data:J});const S=await E.update({model:D,where:B,update:J});s({method:"update"},`${on(k)} ${sn(3,4)}`,`${an("update")} ${Tn("DB Result")}:`,{model:D,data:S});let T=S;return r.disableTransformOutput||(T=await d(S,b,void 0,void 0)),s({method:"update"},`${on(k)} ${sn(4,4)}`,`${an("update")} ${Tn("Parsed Result")}:`,{model:D,data:T}),T},updateMany:async({model:b,where:P,update:$})=>{Xn++;const k=Xn,D=u(b),B=y({model:b,where:P,action:"updateMany"});b=c(b),s({method:"updateMany"},`${on(k)} ${sn(1,4)}`,`${an("updateMany")} ${Tn("Unsafe Input")}:`,{model:D,data:$});let J=$;r.disableTransformInput||(J=await h($,b,"update")),s({method:"updateMany"},`${on(k)} ${sn(2,4)}`,`${an("updateMany")} ${Tn("Parsed Input")}:`,{model:D,data:J});const S=await E.updateMany({model:D,where:B,update:J});return s({method:"updateMany"},`${on(k)} ${sn(3,4)}`,`${an("updateMany")} ${Tn("DB Result")}:`,{model:D,data:S}),s({method:"updateMany"},`${on(k)} ${sn(4,4)}`,`${an("updateMany")} ${Tn("Parsed Result")}:`,{model:D,data:S}),S},findOne:async({model:b,where:P,select:$,join:k})=>{Xn++;const D=Xn,B=u(b),J=y({model:b,where:P,action:"findOne"});b=c(b);let S,T=!0;if(r.disableTransformJoin)S=k;else{const q=v(b,k,$);q&&(S=q.join,$=q.select),!n.experimental?.joins&&S&&Object.keys(S).length>0&&(T=!1)}s({method:"findOne"},`${on(D)} ${sn(1,3)}`,`${an("findOne")}:`,{model:B,where:J,select:$,join:S});const z=await E.findOne({model:B,where:J,select:$,join:T?S:void 0});s({method:"findOne"},`${on(D)} ${sn(2,3)}`,`${an("findOne")} ${Tn("DB Result")}:`,{model:B,data:z});let L=z;return r.disableTransformOutput||(L=await d(z,b,$,S)),s({method:"findOne"},`${on(D)} ${sn(3,3)}`,`${an("findOne")} ${Tn("Parsed Result")}:`,{model:B,data:L}),L},findMany:async({model:b,where:P,limit:$,sortBy:k,offset:D,join:B})=>{Xn++;const J=Xn,S=$??n.advanced?.database?.defaultFindManyLimit??100,T=u(b),z=y({model:b,where:P,action:"findMany"});b=c(b);let L,q=!0;if(r.disableTransformJoin)L=B;else{const oe=v(b,B,void 0);oe&&(L=oe.join),!n.experimental?.joins&&L&&Object.keys(L).length>0&&(q=!1)}s({method:"findMany"},`${on(J)} ${sn(1,3)}`,`${an("findMany")}:`,{model:T,where:z,limit:S,sortBy:k,offset:D,join:L});const V=await E.findMany({model:T,where:z,limit:S,sortBy:k,offset:D,join:q?L:void 0});s({method:"findMany"},`${on(J)} ${sn(2,3)}`,`${an("findMany")} ${Tn("DB Result")}:`,{model:T,data:V});let K=V;return r.disableTransformOutput||(K=await Promise.all(V.map(async oe=>await d(oe,b,void 0,L)))),s({method:"findMany"},`${on(J)} ${sn(3,3)}`,`${an("findMany")} ${Tn("Parsed Result")}:`,{model:T,data:K}),K},delete:async({model:b,where:P})=>{Xn++;const $=Xn,k=u(b),D=y({model:b,where:P,action:"delete"});b=c(b),s({method:"delete"},`${on($)} ${sn(1,2)}`,`${an("delete")}:`,{model:k,where:D}),await E.delete({model:k,where:D}),s({method:"delete"},`${on($)} ${sn(2,2)}`,`${an("delete")} ${Tn("DB Result")}:`,{model:k})},deleteMany:async({model:b,where:P})=>{Xn++;const $=Xn,k=u(b),D=y({model:b,where:P,action:"deleteMany"});b=c(b),s({method:"deleteMany"},`${on($)} ${sn(1,2)}`,`${an("deleteMany")} ${Tn("DeleteMany")}:`,{model:k,where:D});const B=await E.deleteMany({model:k,where:D});return s({method:"deleteMany"},`${on($)} ${sn(2,2)}`,`${an("deleteMany")} ${Tn("DB Result")}:`,{model:k,data:B}),B},count:async({model:b,where:P})=>{Xn++;const $=Xn,k=u(b),D=y({model:b,where:P,action:"count"});b=c(b),s({method:"count"},`${on($)} ${sn(1,2)}`,`${an("count")}:`,{model:k,where:D});const B=await E.count({model:k,where:D});return s({method:"count"},`${on($)} ${sn(2,2)}`,`${an("count")}:`,{model:k,data:B}),B},createSchema:E.createSchema?async(b,P)=>{const $=ts(n);return n.secondaryStorage&&!n.session?.storeSessionInDatabase&&delete $.session,E.createSchema({file:P,tables:$})}:void 0,options:{adapterConfig:r,...E.options??{}},id:r.adapterId,...r.debugLogs?.isRunningAdapterTests?{adapterTestDebugLogs:{resetDebugLogs(){Od=Od.filter(b=>b.instance!==i)},printDebugLogs(){const b="".repeat(80),P=Od.filter(k=>k.instance===i);if(P.length===0)return;const $=P.reverse().map(k=>(k.args[0]=`
${k.args[0]}`,[...k.args,`
`])).reduce((k,D)=>[...D,...k],[`
${b}`]);console.log(...$)}}}:{}};return C};function on(e){return J$()<8?`#${e}`:`${Nn.fg.magenta}#${e}${Nn.reset}`}function sn(e,t){return`${Nn.bg.black}${Nn.fg.yellow}[${e}/${t}]${Nn.reset}`}function an(e){return`${Nn.bright}${e}${Nn.reset}`}function Tn(e){return`${Nn.dim}(${e})${Nn.reset}`}const uH={postgres:{string:["character varying","varchar","text","uuid"],number:["int4","integer","bigint","smallint","numeric","real","double precision"],boolean:["bool","boolean"],date:["timestamptz","timestamp","date"],json:["json","jsonb"]},mysql:{string:["varchar","text","uuid"],number:["integer","int","bigint","smallint","decimal","float","double"],boolean:["boolean","tinyint"],date:["timestamp","datetime","date"],json:["json"]},sqlite:{string:["TEXT"],number:["INTEGER","REAL"],boolean:["INTEGER","BOOLEAN"],date:["DATE","INTEGER"],json:["TEXT"]},mssql:{string:["varchar","nvarchar","uniqueidentifier"],number:["int","bigint","smallint","decimal","float","double"],boolean:["bit","smallint"],date:["datetime2","date","datetime"],json:["varchar","nvarchar"]}};function RO(e,t,n){function i(o){return o.toLowerCase().split("(")[0].trim()}if(t==="string[]"||t==="number[]")return e.toLowerCase().includes("json");const r=uH[n];return(Array.isArray(t)?r.string.map(o=>o.toLowerCase()):r[t].map(o=>o.toLowerCase())).includes(i(e))}async function dH(e){try{const t=await Zt`SHOW search_path`.execute(e);if(t.rows[0]?.search_path)return t.rows[0].search_path.split(",").map(n=>n.trim()).map(n=>n.replace(/^["']|["']$/g,"")).filter(n=>!n.startsWith("$"))[0]||"public"}catch{}return"public"}async function PO(e){const t=LC(e),n=Tl(e.logger);let{kysely:i,databaseType:r}=await sH(e);r||(n.warn("Could not determine database type, defaulting to sqlite. Please provide a type in the database options to avoid this."),r="sqlite"),i||(n.error("Only kysely adapter is supported for migrations. You can use `generate` command to generate the schema, if you're using a different adapter."),process.exit(1));let o="public";if(r==="postgres"){o=await dH(i),n.debug(`PostgreSQL migration: Using schema '${o}' (from search_path)`);try{(await Zt`
				SELECT schema_name 
				FROM information_schema.schemata 
				WHERE schema_name = ${o}
			`.execute(i)).rows[0]||n.warn(`Schema '${o}' does not exist. Tables will be inspected from available schemas. Consider creating the schema first or checking your database configuration.`)}catch(N){n.debug(`Could not verify schema existence: ${N instanceof Error?N.message:String(N)}`)}}const s=await i.introspection.getTables();let a=s;if(r==="postgres")try{const N=await Zt`
				SELECT table_name 
				FROM information_schema.tables 
				WHERE table_schema = ${o}
				AND table_type = 'BASE TABLE'
			`.execute(i),C=new Set(N.rows.map(b=>b.table_name));a=s.filter(b=>b.schema===o&&C.has(b.name)),n.debug(`Found ${a.length} table(s) in schema '${o}': ${a.map(b=>b.name).join(", ")||"(none)"}`)}catch(N){n.warn(`Could not filter tables by schema. Using all discovered tables. Error: ${N instanceof Error?N.message:String(N)}`)}const c=[],l=[];for(const[N,C]of Object.entries(t)){const b=a.find($=>$.name===N);if(!b){const $=c.findIndex(B=>B.table===N),k={table:N,fields:C.fields,order:C.order||1/0},D=c.findIndex(B=>(B.order||1/0)>k.order);D===-1?$===-1?c.push(k):c[$].fields={...c[$].fields,...C.fields}:c.splice(D,0,k);continue}const P={};for(const[$,k]of Object.entries(C.fields)){const D=b.columns.find(B=>B.name===$);if(!D){P[$]=k;continue}RO(D.dataType,k.type,r)||n.warn(`Field ${$} in table ${N} has a different type in the database. Expected ${k.type} but got ${D.dataType}.`)}Object.keys(P).length>0&&l.push({table:N,fields:P,order:C.order||1/0})}const u=[],p=e.advanced?.database?.generateId==="uuid",f=e.advanced?.database?.useNumberId||e.advanced?.database?.generateId==="serial";function g(N,C){const b=N.type,P=r||"sqlite",$={string:{sqlite:"text",postgres:"text",mysql:N.unique?"varchar(255)":N.references?"varchar(36)":N.sortable||N.index?"varchar(255)":"text",mssql:N.unique||N.sortable?"varchar(255)":N.references?"varchar(36)":"varchar(8000)"},boolean:{sqlite:"integer",postgres:"boolean",mysql:"boolean",mssql:"smallint"},number:{sqlite:N.bigint?"bigint":"integer",postgres:N.bigint?"bigint":"integer",mysql:N.bigint?"bigint":"integer",mssql:N.bigint?"bigint":"integer"},date:{sqlite:"date",postgres:"timestamptz",mysql:"timestamp(3)",mssql:Zt`datetime2(3)`},json:{sqlite:"text",postgres:"jsonb",mysql:"json",mssql:"varchar(8000)"},id:{postgres:f?Zt`integer GENERATED BY DEFAULT AS IDENTITY`:p?"uuid":"text",mysql:f?"integer":"varchar(36)",mssql:f?"integer":"varchar(36)",sqlite:f?"integer":"text"},foreignKeyId:{postgres:f?"integer":p?"uuid":"text",mysql:f?"integer":"varchar(36)",mssql:f?"integer":"varchar(36)",sqlite:f?"integer":"text"},"string[]":{sqlite:"text",postgres:"jsonb",mysql:"json",mssql:"varchar(8000)"},"number[]":{sqlite:"text",postgres:"jsonb",mysql:"json",mssql:"varchar(8000)"}};if(C==="id"||N.references?.field==="id")return C==="id"?$.id[P]:$.foreignKeyId[P];if(Array.isArray(b))return"text";if(!(b in $))throw new Error(`Unsupported field type '${String(b)}' for field '${C}'. Allowed types are: string, number, boolean, date, string[], number[]. If you need to store structured data, store it as a JSON string (type: "string") or split it into primitive fields. See https://better-auth.com/docs/advanced/schema#additional-fields`);return $[b][P]}const h=OO({schema:ts(e),usePlural:!1}),d=CO({schema:ts(e),usePlural:!1});function y(N,C){try{return`${h(N)}.${d({model:N,field:C})}`}catch{return`${N}.${C}`}}if(l.length)for(const N of l)for(const[C,b]of Object.entries(N.fields)){const P=g(b,C),$=i.schema.alterTable(N.table);if(b.index){const D=i.schema.alterTable(N.table).addIndex(`${N.table}_${C}_idx`);u.push(D)}const k=$.addColumn(C,P,D=>(D=b.required!==!1?D.notNull():D,b.references&&(D=D.references(y(b.references.model,b.references.field)).onDelete(b.references.onDelete||"cascade")),b.unique&&(D=D.unique()),b.type==="date"&&typeof b.defaultValue=="function"&&(r==="postgres"||r==="mysql"||r==="mssql")&&(r==="mysql"?D=D.defaultTo(Zt`CURRENT_TIMESTAMP(3)`):D=D.defaultTo(Zt`CURRENT_TIMESTAMP`)),D));u.push(k)}const v=[];if(e.advanced?.database?.useNumberId&&n.warn("`useNumberId` is deprecated. Please use `generateId` with `serial` instead."),c.length)for(const N of c){const C=g({type:f?"number":"string"},"id");let b=i.schema.createTable(N.table).addColumn("id",C,P=>f?r==="postgres"||r==="sqlite"?P.primaryKey().notNull():r==="mssql"?P.identity().primaryKey().notNull():P.autoIncrement().primaryKey().notNull():p&&r==="postgres"?P.primaryKey().defaultTo(Zt`pg_catalog.gen_random_uuid()`).notNull():P.primaryKey().notNull());for(const[P,$]of Object.entries(N.fields)){const k=g($,P);if(b=b.addColumn(P,k,D=>(D=$.required!==!1?D.notNull():D,$.references&&(D=D.references(y($.references.model,$.references.field)).onDelete($.references.onDelete||"cascade")),$.unique&&(D=D.unique()),$.type==="date"&&typeof $.defaultValue=="function"&&(r==="postgres"||r==="mysql"||r==="mssql")&&(r==="mysql"?D=D.defaultTo(Zt`CURRENT_TIMESTAMP(3)`):D=D.defaultTo(Zt`CURRENT_TIMESTAMP`)),D)),$.index){const D=i.schema.createIndex(`${N.table}_${P}_${$.unique?"uidx":"idx"}`).on(N.table).columns([P]);v.push($.unique?D.unique():D)}}u.push(b)}if(v.length)for(const N of v)u.push(N);async function x(){for(const N of u)await N.execute()}async function E(){return u.map(N=>N.compile().sql).join(`;

`)+";"}return{toBeCreated:c,toBeAdded:l,runMigrations:x,compileMigrations:E}}var DO=DV({convertFromDB:()=>zV,convertToDB:()=>jV,createFieldAttribute:()=>MV,createInternalAdapter:()=>jb,getAdapter:()=>DC,getBaseAdapter:()=>PC,getMigrations:()=>PO,getSchema:()=>LC,getWithHooks:()=>UC,matchType:()=>RO,mergeSchema:()=>WW,parseAccountInput:()=>FW,parseAccountOutput:()=>hC,parseAdditionalUserInput:()=>BW,parseInputData:()=>Fu,parseSessionInput:()=>mC,parseSessionOutput:()=>ei,parseUserInput:()=>$b,parseUserOutput:()=>Vn,toZodSchema:()=>BV});LV(DO,mW);const UO=()=>Ot("/get-session",{method:"GET",operationId:"getSession",query:JW,requireHeaders:!0,metadata:{openapi:{operationId:"getSession",description:"Get the current session",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",nullable:!0,properties:{session:{$ref:"#/components/schemas/Session"},user:{$ref:"#/components/schemas/User"}},required:["session","user"]}}}}}}}},async e=>{try{const t=await e.getSignedCookie(e.context.authCookies.sessionToken.name,e.context.secret);if(!t)return null;const n=yC(e,e.context.authCookies.sessionData.name);let i=null;if(n){const u=e.context.options.session?.cookieCache?.strategy||"compact";if(u==="jwe"){const p=await q$(n,e.context.secret,"better-auth-session");if(p&&p.session&&p.user)i={session:{session:p.session,user:p.user,updatedAt:p.updatedAt,version:p.version},expiresAt:p.exp?p.exp*1e3:Date.now()};else return ni(e,e.context.authCookies.sessionData),e.json(null)}else if(u==="jwt"){const p=await uF(n,e.context.secret);if(p&&p.session&&p.user)i={session:{session:p.session,user:p.user,updatedAt:p.updatedAt,version:p.version},expiresAt:p.exp?p.exp*1e3:Date.now()};else return ni(e,e.context.authCookies.sessionData),e.json(null)}else{const p=tr(rV.decode($h.decode(n)));if(p)if(await _C("SHA-256","base64urlnopad").verify(e.context.secret,JSON.stringify({...p.session,expiresAt:p.expiresAt}),p.signature))i=p;else return ni(e,e.context.authCookies.sessionData),e.json(null)}}const r=await e.getSignedCookie(e.context.authCookies.dontRememberToken.name,e.context.secret);if(i?.session&&e.context.options.session?.cookieCache?.enabled&&!e.query?.disableCookieCache){const u=i.session,p=e.context.options.session?.cookieCache?.version;let f="1";if(p){if(typeof p=="string")f=p;else if(typeof p=="function"){const g=p(u.session,u.user);f=g instanceof Promise?await g:g}}if((u.version||"1")!==f)ni(e,e.context.authCookies.sessionData);else{const g=new Date(u.session.expiresAt);if(i.expiresAt<Date.now()||g<new Date)ni(e,e.context.authCookies.sessionData);else{const h=e.context.sessionConfig.cookieRefreshCache;if(h===!1){e.context.session=u;const v=ei(e.context.options,{...u.session,expiresAt:new Date(u.session.expiresAt),createdAt:new Date(u.session.createdAt),updatedAt:new Date(u.session.updatedAt)}),x=Vn(e.context.options,{...u.user,createdAt:new Date(u.user.createdAt),updatedAt:new Date(u.user.updatedAt)});return e.json({session:v,user:x})}if(i.expiresAt-Date.now()<h.updateAge*1e3){const v=Ga(e.context.options.session?.cookieCache?.maxAge||300,"sec"),x={session:{...u.session,expiresAt:v},user:u.user,updatedAt:Date.now()};await uy(e,x,!1);const E=ei(e.context.options,{...x.session,expiresAt:new Date(x.session.expiresAt),createdAt:new Date(x.session.createdAt),updatedAt:new Date(x.session.updatedAt)}),N=Vn(e.context.options,{...x.user,createdAt:new Date(x.user.createdAt),updatedAt:new Date(x.user.updatedAt)});return e.context.session={session:E,user:N},e.json({session:E,user:N})}const d=ei(e.context.options,{...u.session,expiresAt:new Date(u.session.expiresAt),createdAt:new Date(u.session.createdAt),updatedAt:new Date(u.session.updatedAt)}),y=Vn(e.context.options,{...u.user,createdAt:new Date(u.user.createdAt),updatedAt:new Date(u.user.updatedAt)});return e.context.session={session:d,user:y},e.json({session:d,user:y})}}}const o=await e.context.internalAdapter.findSession(t);if(e.context.session=o,!o||o.session.expiresAt<new Date)return $l(e),o&&await e.context.internalAdapter.deleteSession(o.session.token),e.json(null);if(r||e.query?.disableRefresh){const u=ei(e.context.options,o.session),p=Vn(e.context.options,o.user);return e.json({session:u,user:p})}const s=e.context.sessionConfig.expiresIn,a=e.context.sessionConfig.updateAge;if(o.session.expiresAt.valueOf()-s*1e3+a*1e3<=Date.now()&&(!e.query?.disableRefresh||!e.context.options.session?.disableSessionRefresh)){const u=await e.context.internalAdapter.updateSession(o.session.token,{expiresAt:Ga(e.context.sessionConfig.expiresIn,"sec"),updatedAt:new Date});if(!u)return $l(e),e.json(null,{status:401});const p=(u.expiresAt.valueOf()-Date.now())/1e3;await ii(e,{session:u,user:o.user},!1,{maxAge:p});const f=ei(e.context.options,u),g=Vn(e.context.options,o.user);return e.json({session:f,user:g})}await uy(e,o,!!r);const c=ei(e.context.options,o.session),l=Vn(e.context.options,o.user);return e.json({session:c,user:l})}catch(t){throw e.context.logger.error("INTERNAL_SERVER_ERROR",t),new le("INTERNAL_SERVER_ERROR",{message:Re.FAILED_TO_GET_SESSION})}}),ji=async(e,t)=>{if(e.context.session)return e.context.session;const n=await UO()({...e,asResponse:!1,headers:e.headers,returnHeaders:!1,returnStatus:!1,query:{...t,...e.query}}).catch(i=>null);return e.context.session=n,n},Ku=ea(async e=>{const t=await ji(e);if(!t?.session)throw new le("UNAUTHORIZED");return{session:t}}),cs=ea(async e=>{const t=await ji(e,{disableCookieCache:!0});if(!t?.session)throw new le("UNAUTHORIZED");return{session:t}});ea(async e=>{const t=await ji(e);if(!t?.session&&(e.request||e.headers))throw new le("UNAUTHORIZED");return{session:t}});const fH=ea(async e=>{const t=await ji(e);if(!t?.session)throw new le("UNAUTHORIZED");if(e.context.sessionConfig.freshAge===0)return{session:t};const n=e.context.sessionConfig.freshAge,i=new Date(t.session.updatedAt||t.session.createdAt).getTime();if(!(Date.now()-i<n*1e3))throw new le("FORBIDDEN",{message:"Session is not fresh"});return{session:t}}),pH=()=>Ot("/list-sessions",{method:"GET",operationId:"listUserSessions",use:[Ku],requireHeaders:!0,metadata:{openapi:{operationId:"listUserSessions",description:"List all active sessions for the user",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"array",items:{$ref:"#/components/schemas/Session"}}}}}}}}},async e=>{try{const t=(await e.context.internalAdapter.listSessions(e.context.session.user.id)).filter(n=>n.expiresAt>new Date);return e.json(t.map(n=>ei(e.context.options,n)))}catch(t){throw e.context.logger.error(t),e.error("INTERNAL_SERVER_ERROR")}}),hH=Ot("/revoke-session",{method:"POST",body:ce({token:W().meta({description:"The token to revoke"})}),use:[cs],requireHeaders:!0,metadata:{openapi:{description:"Revoke a single session",requestBody:{content:{"application/json":{schema:{type:"object",properties:{token:{type:"string",description:"The token to revoke"}},required:["token"]}}}},responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean",description:"Indicates if the session was revoked successfully"}},required:["status"]}}}}}}}},async e=>{const t=e.body.token;if((await e.context.internalAdapter.findSession(t))?.session.userId===e.context.session.user.id)try{await e.context.internalAdapter.deleteSession(t)}catch(n){throw e.context.logger.error(n&&typeof n=="object"&&"name"in n?n.name:"",n),new le("INTERNAL_SERVER_ERROR")}return e.json({status:!0})}),mH=Ot("/revoke-sessions",{method:"POST",use:[cs],requireHeaders:!0,metadata:{openapi:{description:"Revoke all sessions for the user",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean",description:"Indicates if all sessions were revoked successfully"}},required:["status"]}}}}}}}},async e=>{try{await e.context.internalAdapter.deleteSessions(e.context.session.user.id)}catch(t){throw e.context.logger.error(t&&typeof t=="object"&&"name"in t?t.name:"",t),new le("INTERNAL_SERVER_ERROR")}return e.json({status:!0})}),gH=Ot("/revoke-other-sessions",{method:"POST",requireHeaders:!0,use:[cs],metadata:{openapi:{description:"Revoke all other sessions for the user except the current one",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean",description:"Indicates if all other sessions were revoked successfully"}},required:["status"]}}}}}}}},async e=>{const t=e.context.session;if(!t.user)throw new le("UNAUTHORIZED");const n=(await e.context.internalAdapter.listSessions(t.user.id)).filter(i=>i.expiresAt>new Date).filter(i=>i.token!==e.context.session.session.token);return await Promise.all(n.map(i=>e.context.internalAdapter.deleteSession(i.token))),e.json({status:!0})});function _y(e,t){return e&&(t.options.account?.encryptOAuthTokens?oC({key:t.secret,data:e}):e)}function nr(e,t){return t.options.account?.encryptOAuthTokens&&e?iC({key:t.secret,data:e}):e}function r0(e){const t=n=>{const i=new Date;return new Date(i.getTime()+n*1e3)};return{tokenType:e.token_type,accessToken:e.access_token,refreshToken:e.refresh_token,accessTokenExpiresAt:e.expires_in?t(e.expires_in):void 0,refreshTokenExpiresAt:e.refresh_token_expires_in?t(e.refresh_token_expires_in):void 0,scopes:e?.scope?typeof e.scope=="string"?e.scope.split(" "):e.scope:[],idToken:e.id_token,raw:e}}async function LO(e){const t=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",t);return $h.encode(new Uint8Array(n),{padding:!1})}async function Jt({id:e,options:t,authorizationEndpoint:n,state:i,codeVerifier:r,scopes:o,claims:s,redirectURI:a,duration:c,prompt:l,accessType:u,responseType:p,display:f,loginHint:g,hd:h,responseMode:d,additionalParams:y,scopeJoiner:v}){const x=new URL(t.authorizationEndpoint||n);x.searchParams.set("response_type",p||"code");const E=Array.isArray(t.clientId)?t.clientId[0]:t.clientId;if(x.searchParams.set("client_id",E),x.searchParams.set("state",i),o&&x.searchParams.set("scope",o.join(v||" ")),x.searchParams.set("redirect_uri",t.redirectURI||a),c&&x.searchParams.set("duration",c),f&&x.searchParams.set("display",f),g&&x.searchParams.set("login_hint",g),l&&x.searchParams.set("prompt",l),h&&x.searchParams.set("hd",h),u&&x.searchParams.set("access_type",u),d&&x.searchParams.set("response_mode",d),r){const N=await LO(r);x.searchParams.set("code_challenge_method","S256"),x.searchParams.set("code_challenge",N)}if(s){const N=s.reduce((C,b)=>(C[b]=null,C),{});x.searchParams.set("claims",JSON.stringify({id_token:{email:null,email_verified:null,...N}}))}return y&&Object.entries(y).forEach(([N,C])=>{x.searchParams.set(N,C)}),x}var yH=Object.defineProperty,wH=Object.defineProperties,vH=Object.getOwnPropertyDescriptors,Ox=Object.getOwnPropertySymbols,bH=Object.prototype.hasOwnProperty,_H=Object.prototype.propertyIsEnumerable,Rx=(e,t,n)=>t in e?yH(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ps=(e,t)=>{for(var n in t||(t={}))bH.call(t,n)&&Rx(e,n,t[n]);if(Ox)for(var n of Ox(t))_H.call(t,n)&&Rx(e,n,t[n]);return e},hs=(e,t)=>wH(e,vH(t)),SH=class extends Error{constructor(e,t,n){super(t||e.toString(),{cause:n}),this.status=e,this.statusText=t,this.error=n,Error.captureStackTrace(this,this.constructor)}},xH=async(e,t)=>{var n,i,r,o,s,a;let c=t||{};const l={onRequest:[t?.onRequest],onResponse:[t?.onResponse],onSuccess:[t?.onSuccess],onError:[t?.onError],onRetry:[t?.onRetry]};if(!t||!t?.plugins)return{url:e,options:c,hooks:l};for(const u of t?.plugins||[]){if(u.init){const p=await((n=u.init)==null?void 0:n.call(u,e.toString(),t));c=p.options||c,e=p.url}l.onRequest.push((i=u.hooks)==null?void 0:i.onRequest),l.onResponse.push((r=u.hooks)==null?void 0:r.onResponse),l.onSuccess.push((o=u.hooks)==null?void 0:o.onSuccess),l.onError.push((s=u.hooks)==null?void 0:s.onError),l.onRetry.push((a=u.hooks)==null?void 0:a.onRetry)}return{url:e,options:c,hooks:l}},Px=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(){return this.options.delay}},kH=class{constructor(e){this.options=e}shouldAttemptRetry(e,t){return this.options.shouldRetry?Promise.resolve(e<this.options.attempts&&this.options.shouldRetry(t)):Promise.resolve(e<this.options.attempts)}getDelay(e){return Math.min(this.options.maxDelay,this.options.baseDelay*2**e)}};function EH(e){if(typeof e=="number")return new Px({type:"linear",attempts:e,delay:1e3});switch(e.type){case"linear":return new Px(e);case"exponential":return new kH(e);default:throw new Error("Invalid retry strategy")}}var AH=async e=>{const t={},n=async i=>typeof i=="function"?await i():i;if(e?.auth){if(e.auth.type==="Bearer"){const i=await n(e.auth.token);if(!i)return t;t.authorization=`Bearer ${i}`}else if(e.auth.type==="Basic"){const[i,r]=await Promise.all([n(e.auth.username),n(e.auth.password)]);if(!i||!r)return t;t.authorization=`Basic ${btoa(`${i}:${r}`)}`}else if(e.auth.type==="Custom"){const[i,r]=await Promise.all([n(e.auth.prefix),n(e.auth.value)]);if(!r)return t;t.authorization=`${i??""} ${r}`}}return t},TH=/^application\/(?:[\w!#$%&*.^`~-]*\+)?json(;.+)?$/i;function IH(e){const t=e.headers.get("content-type"),n=new Set(["image/svg","application/xml","application/xhtml","application/html"]);if(!t)return"json";const i=t.split(";").shift()||"";return TH.test(i)?"json":n.has(i)||i.startsWith("text/")?"text":"blob"}function NH(e){try{return JSON.parse(e),!0}catch{return!1}}function Sy(e){if(e===void 0)return!1;const t=typeof e;return t==="string"||t==="number"||t==="boolean"||t===null?!0:t!=="object"?!1:Array.isArray(e)?!0:e.buffer?!1:e.constructor&&e.constructor.name==="Object"||typeof e.toJSON=="function"}function Dx(e){try{return JSON.parse(e)}catch{return e}}function Ux(e){return typeof e=="function"}function $H(e){if(e?.customFetchImpl)return e.customFetchImpl;if(typeof globalThis<"u"&&Ux(globalThis.fetch))return globalThis.fetch;if(typeof window<"u"&&Ux(window.fetch))return window.fetch;throw new Error("No fetch implementation found")}async function CH(e){const t=new Headers(e?.headers),n=await AH(e);for(const[i,r]of Object.entries(n||{}))t.set(i,r);if(!t.has("content-type")){const i=OH(e?.body);i&&t.set("content-type",i)}return t}function OH(e){return Sy(e)?"application/json":null}function RH(e){if(!e?.body)return null;const t=new Headers(e?.headers);if(Sy(e.body)&&!t.has("content-type")){for(const[n,i]of Object.entries(e?.body))i instanceof Date&&(e.body[n]=i.toISOString());return JSON.stringify(e.body)}return t.has("content-type")&&t.get("content-type")==="application/x-www-form-urlencoded"&&Sy(e.body)?new URLSearchParams(e.body).toString():e.body}function PH(e,t){var n;if(t?.method)return t.method.toUpperCase();if(e.startsWith("@")){const i=(n=e.split("@")[1])==null?void 0:n.split("/")[0];return jO.includes(i)?i.toUpperCase():t?.body?"POST":"GET"}return t?.body?"POST":"GET"}function DH(e,t){let n;return!e?.signal&&e?.timeout&&(n=setTimeout(()=>t?.abort(),e?.timeout)),{abortTimeout:n,clearTimeout:()=>{n&&clearTimeout(n)}}}var UH=class MO extends Error{constructor(t,n){super(n||JSON.stringify(t,null,2)),this.issues=t,Object.setPrototypeOf(this,MO.prototype)}};async function LH(e,t){const n=await e["~standard"].validate(t);if(n.issues)throw new UH(n.issues);return n.value}var jO=["get","post","put","patch","delete"];function MH(e,t){const{baseURL:n,params:i,query:r}=t||{query:{},params:{},baseURL:""};let o=e.startsWith("http")?e.split("/").slice(0,3).join("/"):n||"";if(e.startsWith("@")){const p=e.toString().split("@")[1].split("/")[0];jO.includes(p)&&(e=e.replace(`@${p}/`,"/"))}o.endsWith("/")||(o+="/");let[s,a]=e.replace(o,"").split("?");const c=new URLSearchParams(a);for(const[p,f]of Object.entries(r||{})){if(f==null)continue;let g;if(typeof f=="string")g=f;else if(Array.isArray(f)){for(const h of f)c.append(p,h);continue}else g=JSON.stringify(f);c.set(p,g)}if(i)if(Array.isArray(i)){const p=s.split("/").filter(f=>f.startsWith(":"));for(const[f,g]of p.entries()){const h=i[f];s=s.replace(g,h)}}else for(const[p,f]of Object.entries(i))s=s.replace(`:${p}`,String(f));s=s.split("/").map(encodeURIComponent).join("/"),s.startsWith("/")&&(s=s.slice(1));let l=c.toString();return l=l.length>0?`?${l}`.replace(/\+/g,"%20"):"",o.startsWith("http")?new URL(`${s}${l}`,o):`${o}${s}${l}`}var rt=async(e,t)=>{var n,i,r,o,s,a,c,l;const{hooks:u,url:p,options:f}=await xH(e,t),g=$H(f),h=new AbortController,d=(n=f.signal)!=null?n:h.signal,y=MH(p,f),v=RH(f),x=await CH(f),E=PH(p,f);let N=hs(ps({},f),{url:y,headers:x,body:v,method:E,signal:d});for(const S of u.onRequest)if(S){const T=await S(N);typeof T=="object"&&T!==null&&(N=T)}("pipeTo"in N&&typeof N.pipeTo=="function"||typeof((i=t?.body)==null?void 0:i.pipe)=="function")&&("duplex"in N||(N.duplex="half"));const{clearTimeout:C}=DH(f,h);let b=await g(N.url,N);C();const P={response:b,request:N};for(const S of u.onResponse)if(S){const T=await S(hs(ps({},P),{response:(r=t?.hookOptions)!=null&&r.cloneResponse?b.clone():b}));T instanceof Response?b=T:typeof T=="object"&&T!==null&&(b=T.response)}if(b.ok){if(!(N.method!=="HEAD"))return{data:"",error:null};const T=IH(b),z={data:null,response:b,request:N};if(T==="json"||T==="text"){const L=await b.text(),q=(o=N.jsonParser)!=null?o:Dx;z.data=await q(L)}else z.data=await b[T]();N?.output&&N.output&&!N.disableValidation&&(z.data=await LH(N.output,z.data));for(const L of u.onSuccess)L&&await L(hs(ps({},z),{response:(s=t?.hookOptions)!=null&&s.cloneResponse?b.clone():b}));return t?.throw?z.data:{data:z.data,error:null}}const $=(a=t?.jsonParser)!=null?a:Dx,k=await b.text(),D=NH(k),B=D?await $(k):null,J={response:b,responseText:k,request:N,error:hs(ps({},B),{status:b.status,statusText:b.statusText})};for(const S of u.onError)S&&await S(hs(ps({},J),{response:(c=t?.hookOptions)!=null&&c.cloneResponse?b.clone():b}));if(t?.retry){const S=EH(t.retry),T=(l=t.retryAttempt)!=null?l:0;if(await S.shouldAttemptRetry(T,b)){for(const L of u.onRetry)L&&await L(P);const z=S.getDelay(T);return await new Promise(L=>setTimeout(L,z)),await rt(e,hs(ps({},t),{retryAttempt:T+1}))}}if(t?.throw)throw new SH(b.status,b.statusText,D?B:k);return{data:null,error:hs(ps({},B),{status:b.status,statusText:b.statusText})}};function jH({refreshToken:e,options:t,authentication:n,extraParams:i,resource:r}){const o=new URLSearchParams,s={"content-type":"application/x-www-form-urlencoded",accept:"application/json"};if(o.set("grant_type","refresh_token"),o.set("refresh_token",e),n==="basic"){const a=Array.isArray(t.clientId)?t.clientId[0]:t.clientId;a?s.authorization="Basic "+bo.encode(`${a}:${t.clientSecret??""}`):s.authorization="Basic "+bo.encode(`:${t.clientSecret??""}`)}else{const a=Array.isArray(t.clientId)?t.clientId[0]:t.clientId;o.set("client_id",a),t.clientSecret&&o.set("client_secret",t.clientSecret)}if(r)if(typeof r=="string")o.append("resource",r);else for(const a of r)o.append("resource",a);if(i)for(const[a,c]of Object.entries(i))o.set(a,c);return{body:o,headers:s}}async function $t({refreshToken:e,options:t,tokenEndpoint:n,authentication:i,extraParams:r}){const{body:o,headers:s}=jH({refreshToken:e,options:t,authentication:i,extraParams:r}),{data:a,error:c}=await rt(n,{method:"POST",body:o,headers:s});if(c)throw c;const l={accessToken:a.access_token,refreshToken:a.refresh_token,tokenType:a.token_type,scopes:a.scope?.split(" "),idToken:a.id_token};if(a.expires_in){const u=new Date;l.accessTokenExpiresAt=new Date(u.getTime()+a.expires_in*1e3)}return l}function zO({code:e,codeVerifier:t,redirectURI:n,options:i,authentication:r,deviceId:o,headers:s,additionalParams:a={},resource:c}){const l=new URLSearchParams,u={"content-type":"application/x-www-form-urlencoded",accept:"application/json",...s};if(l.set("grant_type","authorization_code"),l.set("code",e),t&&l.set("code_verifier",t),i.clientKey&&l.set("client_key",i.clientKey),o&&l.set("device_id",o),l.set("redirect_uri",i.redirectURI||n),c)if(typeof c=="string")l.append("resource",c);else for(const p of c)l.append("resource",p);if(r==="basic"){const p=Array.isArray(i.clientId)?i.clientId[0]:i.clientId;u.authorization=`Basic ${bo.encode(`${p}:${i.clientSecret??""}`)}`}else{const p=Array.isArray(i.clientId)?i.clientId[0]:i.clientId;l.set("client_id",p),i.clientSecret&&l.set("client_secret",i.clientSecret)}for(const[p,f]of Object.entries(a))l.has(p)||l.append(p,f);return{body:l,headers:u}}async function Rt({code:e,codeVerifier:t,redirectURI:n,options:i,tokenEndpoint:r,authentication:o,deviceId:s,headers:a,additionalParams:c={},resource:l}){const{body:u,headers:p}=zO({code:e,codeVerifier:t,redirectURI:n,options:i,authentication:o,deviceId:s,headers:a,additionalParams:c,resource:l}),{data:f,error:g}=await rt(r,{method:"POST",body:u,headers:p});if(g)throw g;return r0(f)}const zH=e=>{const t="https://appleid.apple.com/auth/token";return{id:"apple",name:"Apple",async createAuthorizationURL({state:n,scopes:i,redirectURI:r}){const o=e.disableDefaultScope?[]:["email","name"];return e.scope&&o.push(...e.scope),i&&o.push(...i),await Jt({id:"apple",options:e,authorizationEndpoint:"https://appleid.apple.com/auth/authorize",scopes:o,state:n,redirectURI:r,responseMode:"form_post",responseType:"code id_token"})},validateAuthorizationCode:async({code:n,codeVerifier:i,redirectURI:r})=>Rt({code:n,codeVerifier:i,redirectURI:r,options:e,tokenEndpoint:t}),async verifyIdToken(n,i){if(e.disableIdTokenSignIn)return!1;if(e.verifyIdToken)return e.verifyIdToken(n,i);const{kid:r,alg:o}=xb(n);if(!r||!o)return!1;const{payload:s}=await vc(n,await BH(r),{algorithms:[o],issuer:"https://appleid.apple.com",audience:e.audience&&e.audience.length?e.audience:e.appBundleIdentifier?e.appBundleIdentifier:e.clientId,maxTokenAge:"1h"});return["email_verified","is_private_email"].forEach(a=>{s[a]!==void 0&&(s[a]=!!s[a])}),i&&s.nonce!==i?!1:!!s},refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async n=>$t({refreshToken:n,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://appleid.apple.com/auth/token"}),async getUserInfo(n){if(e.getUserInfo)return e.getUserInfo(n);if(!n.idToken)return null;const i=Ao(n.idToken);if(!i)return null;let r;n.user?.name?r=`${n.user.name.firstName||""} ${n.user.name.lastName||""}`.trim()||" ":r=i.name||" ";const o=typeof i.email_verified=="boolean"?i.email_verified:i.email_verified==="true",s={...i,name:r},a=await e.mapProfileToUser?.(s);return{user:{id:i.sub,name:s.name,emailVerified:o,email:i.email,...a},data:s}},options:e}},BH=async e=>{const{data:t}=await rt("https://appleid.apple.com/auth/keys");if(!t?.keys)throw new le("BAD_REQUEST",{message:"Keys not found"});const n=t.keys.find(i=>i.kid===e);if(!n)throw new Error(`JWK with kid ${e} not found`);return await Mu(n,n.alg)},FH=e=>({id:"atlassian",name:"Atlassian",async createAuthorizationURL({state:t,scopes:n,codeVerifier:i,redirectURI:r}){if(!e.clientId||!e.clientSecret)throw Qe.error("Client Id and Secret are required for Atlassian"),new Fe("CLIENT_ID_AND_SECRET_REQUIRED");if(!i)throw new Fe("codeVerifier is required for Atlassian");const o=e.disableDefaultScope?[]:["read:jira-user","offline_access"];return e.scope&&o.push(...e.scope),n&&o.push(...n),Jt({id:"atlassian",options:e,authorizationEndpoint:"https://auth.atlassian.com/authorize",scopes:o,state:t,codeVerifier:i,redirectURI:r,additionalParams:{audience:"api.atlassian.com"},prompt:e.prompt})},validateAuthorizationCode:async({code:t,codeVerifier:n,redirectURI:i})=>Rt({code:t,codeVerifier:n,redirectURI:i,options:e,tokenEndpoint:"https://auth.atlassian.com/oauth/token"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>$t({refreshToken:t,options:{clientId:e.clientId,clientSecret:e.clientSecret},tokenEndpoint:"https://auth.atlassian.com/oauth/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);if(!t.accessToken)return null;try{const{data:n}=await rt("https://api.atlassian.com/me",{headers:{Authorization:`Bearer ${t.accessToken}`}});if(!n)return null;const i=await e.mapProfileToUser?.(n);return{user:{id:n.account_id,name:n.name,email:n.email,image:n.picture,emailVerified:!1,...i},data:n}}catch(n){return Qe.error("Failed to fetch user info from Figma:",n),null}},options:e}),WH=e=>{if(!e.domain||!e.region||!e.userPoolId)throw Qe.error("Domain, region and userPoolId are required for Amazon Cognito. Make sure to provide them in the options."),new Fe("DOMAIN_AND_REGION_REQUIRED");const t=e.domain.replace(/^https?:\/\//,""),n=`https://${t}/oauth2/authorize`,i=`https://${t}/oauth2/token`,r=`https://${t}/oauth2/userinfo`;return{id:"cognito",name:"Cognito",async createAuthorizationURL({state:o,scopes:s,codeVerifier:a,redirectURI:c}){if(!e.clientId)throw Qe.error("ClientId is required for Amazon Cognito. Make sure to provide them in the options."),new Fe("CLIENT_ID_AND_SECRET_REQUIRED");if(e.requireClientSecret&&!e.clientSecret)throw Qe.error("Client Secret is required when requireClientSecret is true. Make sure to provide it in the options."),new Fe("CLIENT_SECRET_REQUIRED");const l=e.disableDefaultScope?[]:["openid","profile","email"];e.scope&&l.push(...e.scope),s&&l.push(...s);const u=await Jt({id:"cognito",options:{...e},authorizationEndpoint:n,scopes:l,state:o,codeVerifier:a,redirectURI:c,prompt:e.prompt}),p=u.searchParams.get("scope");if(p){u.searchParams.delete("scope");const f=encodeURIComponent(p),g=u.toString(),h=g.includes("?")?"&":"?";return new URL(`${g}${h}scope=${f}`)}return u},validateAuthorizationCode:async({code:o,codeVerifier:s,redirectURI:a})=>Rt({code:o,codeVerifier:s,redirectURI:a,options:e,tokenEndpoint:i}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async o=>$t({refreshToken:o,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:i}),async verifyIdToken(o,s){if(e.disableIdTokenSignIn)return!1;if(e.verifyIdToken)return e.verifyIdToken(o,s);try{const{kid:a,alg:c}=xb(o);if(!a||!c)return!1;const l=await VH(a,e.region,e.userPoolId),u=`https://cognito-idp.${e.region}.amazonaws.com/${e.userPoolId}`,{payload:p}=await vc(o,l,{algorithms:[c],issuer:u,audience:e.clientId,maxTokenAge:"1h"});return!(s&&p.nonce!==s)}catch(a){return Qe.error("Failed to verify ID token:",a),!1}},async getUserInfo(o){if(e.getUserInfo)return e.getUserInfo(o);if(o.idToken)try{const s=Ao(o.idToken);if(!s)return null;const a=s.name||s.given_name||s.username||s.email,c={...s,name:a},l=await e.mapProfileToUser?.(c);return{user:{id:s.sub,name:c.name,email:s.email,image:s.picture,emailVerified:s.email_verified,...l},data:c}}catch(s){Qe.error("Failed to decode ID token:",s)}if(o.accessToken)try{const{data:s}=await rt(r,{headers:{Authorization:`Bearer ${o.accessToken}`}});if(s){const a=await e.mapProfileToUser?.(s);return{user:{id:s.sub,name:s.name||s.given_name||s.username,email:s.email,image:s.picture,emailVerified:s.email_verified,...a},data:s}}}catch(s){Qe.error("Failed to fetch user info from Cognito:",s)}return null},options:e}},VH=async(e,t,n)=>{const i=`https://cognito-idp.${t}.amazonaws.com/${n}/.well-known/jwks.json`;try{const{data:r}=await rt(i);if(!r?.keys)throw new le("BAD_REQUEST",{message:"Keys not found"});const o=r.keys.find(s=>s.kid===e);if(!o)throw new Error(`JWK with kid ${e} not found`);return await Mu(o,o.alg)}catch(r){throw Qe.error("Failed to fetch Cognito public key:",r),r}},qH=e=>({id:"discord",name:"Discord",createAuthorizationURL({state:t,scopes:n,redirectURI:i}){const r=e.disableDefaultScope?[]:["identify","email"];n&&r.push(...n),e.scope&&r.push(...e.scope);const o=r.includes("bot")&&e.permissions!==void 0?`&permissions=${e.permissions}`:"";return new URL(`https://discord.com/api/oauth2/authorize?scope=${r.join("+")}&response_type=code&client_id=${e.clientId}&redirect_uri=${encodeURIComponent(e.redirectURI||i)}&state=${t}&prompt=${e.prompt||"none"}${o}`)},validateAuthorizationCode:async({code:t,redirectURI:n})=>Rt({code:t,redirectURI:n,options:e,tokenEndpoint:"https://discord.com/api/oauth2/token"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>$t({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://discord.com/api/oauth2/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:n,error:i}=await rt("https://discord.com/api/users/@me",{headers:{authorization:`Bearer ${t.accessToken}`}});if(i)return null;if(n.avatar===null)n.image_url=`https://cdn.discordapp.com/embed/avatars/${n.discriminator==="0"?Number(BigInt(n.id)>>BigInt(22))%6:parseInt(n.discriminator)%5}.png`;else{const o=n.avatar.startsWith("a_")?"gif":"png";n.image_url=`https://cdn.discordapp.com/avatars/${n.id}/${n.avatar}.${o}`}const r=await e.mapProfileToUser?.(n);return{user:{id:n.id,name:n.global_name||n.username||"",email:n.email,emailVerified:n.verified,image:n.image_url,...r},data:n}},options:e}),HH=e=>{const t="https://api.dropboxapi.com/oauth2/token";return{id:"dropbox",name:"Dropbox",createAuthorizationURL:async({state:n,scopes:i,codeVerifier:r,redirectURI:o})=>{const s=e.disableDefaultScope?[]:["account_info.read"];e.scope&&s.push(...e.scope),i&&s.push(...i);const a={};return e.accessType&&(a.token_access_type=e.accessType),await Jt({id:"dropbox",options:e,authorizationEndpoint:"https://www.dropbox.com/oauth2/authorize",scopes:s,state:n,redirectURI:o,codeVerifier:r,additionalParams:a})},validateAuthorizationCode:async({code:n,codeVerifier:i,redirectURI:r})=>await Rt({code:n,codeVerifier:i,redirectURI:r,options:e,tokenEndpoint:t}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async n=>$t({refreshToken:n,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://api.dropbox.com/oauth2/token"}),async getUserInfo(n){if(e.getUserInfo)return e.getUserInfo(n);const{data:i,error:r}=await rt("https://api.dropboxapi.com/2/users/get_current_account",{method:"POST",headers:{Authorization:`Bearer ${n.accessToken}`}});if(r)return null;const o=await e.mapProfileToUser?.(i);return{user:{id:i.account_id,name:i.name?.display_name,email:i.email,emailVerified:i.email_verified||!1,image:i.profile_photo_url,...o},data:i}},options:e}},KH=e=>({id:"facebook",name:"Facebook",async createAuthorizationURL({state:t,scopes:n,redirectURI:i,loginHint:r}){const o=e.disableDefaultScope?[]:["email","public_profile"];return e.scope&&o.push(...e.scope),n&&o.push(...n),await Jt({id:"facebook",options:e,authorizationEndpoint:"https://www.facebook.com/v24.0/dialog/oauth",scopes:o,state:t,redirectURI:i,loginHint:r,additionalParams:e.configId?{config_id:e.configId}:{}})},validateAuthorizationCode:async({code:t,redirectURI:n})=>Rt({code:t,redirectURI:n,options:e,tokenEndpoint:"https://graph.facebook.com/v24.0/oauth/access_token"}),async verifyIdToken(t,n){if(e.disableIdTokenSignIn)return!1;if(e.verifyIdToken)return e.verifyIdToken(t,n);if(t.split(".").length===3)try{const{payload:i}=await vc(t,lF(new URL("https://limited.facebook.com/.well-known/oauth/openid/jwks/")),{algorithms:["RS256"],audience:e.clientId,issuer:"https://www.facebook.com"});return n&&i.nonce!==n?!1:!!i}catch{return!1}return!0},refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>$t({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://graph.facebook.com/v24.0/oauth/access_token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);if(t.idToken&&t.idToken.split(".").length===3){const o=Ao(t.idToken),s={id:o.sub,name:o.name,email:o.email,picture:{data:{url:o.picture,height:100,width:100,is_silhouette:!1}}},a=await e.mapProfileToUser?.({...s,email_verified:!1});return{user:{...s,emailVerified:!1,...a},data:o}}const{data:n,error:i}=await rt("https://graph.facebook.com/me?fields="+["id","name","email","picture",...e?.fields||[]].join(","),{auth:{type:"Bearer",token:t.accessToken}});if(i)return null;const r=await e.mapProfileToUser?.(n);return{user:{id:n.id,name:n.name,email:n.email,image:n.picture.data.url,emailVerified:n.email_verified,...r},data:n}},options:e}),JH=e=>({id:"figma",name:"Figma",async createAuthorizationURL({state:t,scopes:n,codeVerifier:i,redirectURI:r}){if(!e.clientId||!e.clientSecret)throw Qe.error("Client Id and Client Secret are required for Figma. Make sure to provide them in the options."),new Fe("CLIENT_ID_AND_SECRET_REQUIRED");if(!i)throw new Fe("codeVerifier is required for Figma");const o=e.disableDefaultScope?[]:["current_user:read"];return e.scope&&o.push(...e.scope),n&&o.push(...n),await Jt({id:"figma",options:e,authorizationEndpoint:"https://www.figma.com/oauth",scopes:o,state:t,codeVerifier:i,redirectURI:r})},validateAuthorizationCode:async({code:t,codeVerifier:n,redirectURI:i})=>Rt({code:t,codeVerifier:n,redirectURI:i,options:e,tokenEndpoint:"https://api.figma.com/v1/oauth/token",authentication:"basic"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>$t({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://api.figma.com/v1/oauth/token",authentication:"basic"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);try{const{data:n}=await rt("https://api.figma.com/v1/me",{headers:{Authorization:`Bearer ${t.accessToken}`}});if(!n)return Qe.error("Failed to fetch user from Figma"),null;const i=await e.mapProfileToUser?.(n);return{user:{id:n.id,name:n.handle,email:n.email,image:n.img_url,emailVerified:!1,...i},data:n}}catch(n){return Qe.error("Failed to fetch user info from Figma:",n),null}},options:e}),GH=e=>{const t="https://github.com/login/oauth/access_token";return{id:"github",name:"GitHub",createAuthorizationURL({state:n,scopes:i,loginHint:r,codeVerifier:o,redirectURI:s}){const a=e.disableDefaultScope?[]:["read:user","user:email"];return e.scope&&a.push(...e.scope),i&&a.push(...i),Jt({id:"github",options:e,authorizationEndpoint:"https://github.com/login/oauth/authorize",scopes:a,state:n,codeVerifier:o,redirectURI:s,loginHint:r,prompt:e.prompt})},validateAuthorizationCode:async({code:n,codeVerifier:i,redirectURI:r})=>{const{body:o,headers:s}=zO({code:n,codeVerifier:i,redirectURI:r,options:e}),{data:a,error:c}=await rt(t,{method:"POST",body:o,headers:s});return c?(Qe.error("GitHub OAuth token exchange failed:",c),null):"error"in a?(Qe.error("GitHub OAuth token exchange failed:",a),null):r0(a)},refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async n=>$t({refreshToken:n,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://github.com/login/oauth/access_token"}),async getUserInfo(n){if(e.getUserInfo)return e.getUserInfo(n);const{data:i,error:r}=await rt("https://api.github.com/user",{headers:{"User-Agent":"better-auth",authorization:`Bearer ${n.accessToken}`}});if(r)return null;const{data:o}=await rt("https://api.github.com/user/emails",{headers:{Authorization:`Bearer ${n.accessToken}`,"User-Agent":"better-auth"}});!i.email&&o&&(i.email=(o.find(c=>c.primary)??o[0])?.email);const s=o?.find(c=>c.email===i.email)?.verified??!1,a=await e.mapProfileToUser?.(i);return{user:{id:i.id,name:i.name||i.login,email:i.email,image:i.avatar_url,emailVerified:s,...a},data:i}},options:e}},fg=(e="")=>e.split("://").map(t=>t.replace(/\/{2,}/g,"/")).join("://"),ZH=e=>{const t=e||"https://gitlab.com";return{authorizationEndpoint:fg(`${t}/oauth/authorize`),tokenEndpoint:fg(`${t}/oauth/token`),userinfoEndpoint:fg(`${t}/api/v4/user`)}},QH=e=>{const{authorizationEndpoint:t,tokenEndpoint:n,userinfoEndpoint:i}=ZH(e.issuer),r="gitlab";return{id:r,name:"Gitlab",createAuthorizationURL:async({state:o,scopes:s,codeVerifier:a,loginHint:c,redirectURI:l})=>{const u=e.disableDefaultScope?[]:["read_user"];return e.scope&&u.push(...e.scope),s&&u.push(...s),await Jt({id:r,options:e,authorizationEndpoint:t,scopes:u,state:o,redirectURI:l,codeVerifier:a,loginHint:c})},validateAuthorizationCode:async({code:o,redirectURI:s,codeVerifier:a})=>Rt({code:o,redirectURI:s,options:e,codeVerifier:a,tokenEndpoint:n}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async o=>$t({refreshToken:o,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:n}),async getUserInfo(o){if(e.getUserInfo)return e.getUserInfo(o);const{data:s,error:a}=await rt(i,{headers:{authorization:`Bearer ${o.accessToken}`}});if(a||s.state!=="active"||s.locked)return null;const c=await e.mapProfileToUser?.(s);return{user:{id:s.id,name:s.name??s.username,email:s.email,image:s.avatar_url,emailVerified:s.email_verified??!1,...c},data:s}},options:e}},YH=e=>({id:"google",name:"Google",async createAuthorizationURL({state:t,scopes:n,codeVerifier:i,redirectURI:r,loginHint:o,display:s}){if(!e.clientId||!e.clientSecret)throw Qe.error("Client Id and Client Secret is required for Google. Make sure to provide them in the options."),new Fe("CLIENT_ID_AND_SECRET_REQUIRED");if(!i)throw new Fe("codeVerifier is required for Google");const a=e.disableDefaultScope?[]:["email","profile","openid"];return e.scope&&a.push(...e.scope),n&&a.push(...n),await Jt({id:"google",options:e,authorizationEndpoint:"https://accounts.google.com/o/oauth2/v2/auth",scopes:a,state:t,codeVerifier:i,redirectURI:r,prompt:e.prompt,accessType:e.accessType,display:s||e.display,loginHint:o,hd:e.hd,additionalParams:{include_granted_scopes:"true"}})},validateAuthorizationCode:async({code:t,codeVerifier:n,redirectURI:i})=>Rt({code:t,codeVerifier:n,redirectURI:i,options:e,tokenEndpoint:"https://oauth2.googleapis.com/token"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>$t({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://oauth2.googleapis.com/token"}),async verifyIdToken(t,n){if(e.disableIdTokenSignIn)return!1;if(e.verifyIdToken)return e.verifyIdToken(t,n);const{kid:i,alg:r}=xb(t);if(!i||!r)return!1;const{payload:o}=await vc(t,await XH(i),{algorithms:[r],issuer:["https://accounts.google.com","accounts.google.com"],audience:e.clientId,maxTokenAge:"1h"});return!(n&&o.nonce!==n)},async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);if(!t.idToken)return null;const n=Ao(t.idToken),i=await e.mapProfileToUser?.(n);return{user:{id:n.sub,name:n.name,email:n.email,image:n.picture,emailVerified:n.email_verified,...i},data:n}},options:e}),XH=async e=>{const{data:t}=await rt("https://www.googleapis.com/oauth2/v3/certs");if(!t?.keys)throw new le("BAD_REQUEST",{message:"Keys not found"});const n=t.keys.find(i=>i.kid===e);if(!n)throw new Error(`JWK with kid ${e} not found`);return await Mu(n,n.alg)},eK=e=>({id:"huggingface",name:"Hugging Face",createAuthorizationURL({state:t,scopes:n,codeVerifier:i,redirectURI:r}){const o=e.disableDefaultScope?[]:["openid","profile","email"];return e.scope&&o.push(...e.scope),n&&o.push(...n),Jt({id:"huggingface",options:e,authorizationEndpoint:"https://huggingface.co/oauth/authorize",scopes:o,state:t,codeVerifier:i,redirectURI:r})},validateAuthorizationCode:async({code:t,codeVerifier:n,redirectURI:i})=>Rt({code:t,codeVerifier:n,redirectURI:i,options:e,tokenEndpoint:"https://huggingface.co/oauth/token"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>$t({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://huggingface.co/oauth/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:n,error:i}=await rt("https://huggingface.co/oauth/userinfo",{method:"GET",headers:{Authorization:`Bearer ${t.accessToken}`}});if(i)return null;const r=await e.mapProfileToUser?.(n);return{user:{id:n.sub,name:n.name||n.preferred_username,email:n.email,image:n.picture,emailVerified:n.email_verified??!1,...r},data:n}},options:e}),tK=e=>({id:"kakao",name:"Kakao",createAuthorizationURL({state:t,scopes:n,redirectURI:i}){const r=e.disableDefaultScope?[]:["account_email","profile_image","profile_nickname"];return e.scope&&r.push(...e.scope),n&&r.push(...n),Jt({id:"kakao",options:e,authorizationEndpoint:"https://kauth.kakao.com/oauth/authorize",scopes:r,state:t,redirectURI:i})},validateAuthorizationCode:async({code:t,redirectURI:n})=>Rt({code:t,redirectURI:n,options:e,tokenEndpoint:"https://kauth.kakao.com/oauth/token"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>$t({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://kauth.kakao.com/oauth/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:n,error:i}=await rt("https://kapi.kakao.com/v2/user/me",{headers:{Authorization:`Bearer ${t.accessToken}`}});if(i||!n)return null;const r=await e.mapProfileToUser?.(n),o=n.kakao_account||{},s=o.profile||{};return{user:{id:String(n.id),name:s.nickname||o.name||void 0,email:o.email,image:s.profile_image_url||s.thumbnail_image_url,emailVerified:!!o.is_email_valid&&!!o.is_email_verified,...r},data:n}},options:e}),nK=e=>({id:"kick",name:"Kick",createAuthorizationURL({state:t,scopes:n,redirectURI:i,codeVerifier:r}){const o=e.disableDefaultScope?[]:["user:read"];return e.scope&&o.push(...e.scope),n&&o.push(...n),Jt({id:"kick",redirectURI:i,options:e,authorizationEndpoint:"https://id.kick.com/oauth/authorize",scopes:o,codeVerifier:r,state:t})},async validateAuthorizationCode({code:t,redirectURI:n,codeVerifier:i}){return Rt({code:t,redirectURI:n,options:e,tokenEndpoint:"https://id.kick.com/oauth/token",codeVerifier:i})},refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>$t({refreshToken:t,options:{clientId:e.clientId,clientSecret:e.clientSecret},tokenEndpoint:"https://id.kick.com/oauth/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:n,error:i}=await rt("https://api.kick.com/public/v1/users",{method:"GET",headers:{Authorization:`Bearer ${t.accessToken}`}});if(i)return null;const r=n.data[0],o=await e.mapProfileToUser?.(r);return{user:{id:r.user_id,name:r.name,email:r.email,image:r.profile_picture,emailVerified:!1,...o},data:r}},options:e}),rK=e=>{const t="https://access.line.me/oauth2/v2.1/authorize",n="https://api.line.me/oauth2/v2.1/token",i="https://api.line.me/oauth2/v2.1/userinfo",r="https://api.line.me/oauth2/v2.1/verify";return{id:"line",name:"LINE",async createAuthorizationURL({state:o,scopes:s,codeVerifier:a,redirectURI:c,loginHint:l}){const u=e.disableDefaultScope?[]:["openid","profile","email"];return e.scope&&u.push(...e.scope),s&&u.push(...s),await Jt({id:"line",options:e,authorizationEndpoint:t,scopes:u,state:o,codeVerifier:a,redirectURI:c,loginHint:l})},validateAuthorizationCode:async({code:o,codeVerifier:s,redirectURI:a})=>Rt({code:o,codeVerifier:s,redirectURI:a,options:e,tokenEndpoint:n}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async o=>$t({refreshToken:o,options:{clientId:e.clientId,clientSecret:e.clientSecret},tokenEndpoint:n}),async verifyIdToken(o,s){if(e.disableIdTokenSignIn)return!1;if(e.verifyIdToken)return e.verifyIdToken(o,s);const a=new URLSearchParams;a.set("id_token",o),a.set("client_id",e.clientId),s&&a.set("nonce",s);const{data:c,error:l}=await rt(r,{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded"},body:a});return!(l||!c||c.aud!==e.clientId||c.nonce&&c.nonce!==s)},async getUserInfo(o){if(e.getUserInfo)return e.getUserInfo(o);let s=null;if(o.idToken)try{s=Ao(o.idToken)}catch{}if(!s){const{data:p}=await rt(i,{headers:{authorization:`Bearer ${o.accessToken}`}});s=p||null}if(!s)return null;const a=await e.mapProfileToUser?.(s),c=s.sub||s.userId,l=s.name||s.displayName,u=s.picture||s.pictureUrl||void 0;return{user:{id:c,name:l,email:s.email,image:u,emailVerified:!1,...a},data:s}},options:e}},iK=e=>{const t="https://api.linear.app/oauth/token";return{id:"linear",name:"Linear",createAuthorizationURL({state:n,scopes:i,loginHint:r,redirectURI:o}){const s=e.disableDefaultScope?[]:["read"];return e.scope&&s.push(...e.scope),i&&s.push(...i),Jt({id:"linear",options:e,authorizationEndpoint:"https://linear.app/oauth/authorize",scopes:s,state:n,redirectURI:o,loginHint:r})},validateAuthorizationCode:async({code:n,redirectURI:i})=>Rt({code:n,redirectURI:i,options:e,tokenEndpoint:t}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async n=>$t({refreshToken:n,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:t}),async getUserInfo(n){if(e.getUserInfo)return e.getUserInfo(n);const{data:i,error:r}=await rt("https://api.linear.app/graphql",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n.accessToken}`},body:JSON.stringify({query:`
							query {
								viewer {
									id
									name
									email
									avatarUrl
									active
									createdAt
									updatedAt
								}
							}
						`})});if(r||!i?.data?.viewer)return null;const o=i.data.viewer,s=await e.mapProfileToUser?.(o);return{user:{id:i.data.viewer.id,name:i.data.viewer.name,email:i.data.viewer.email,image:i.data.viewer.avatarUrl,emailVerified:!1,...s},data:o}},options:e}},oK=e=>{const t="https://www.linkedin.com/oauth/v2/authorization",n="https://www.linkedin.com/oauth/v2/accessToken";return{id:"linkedin",name:"Linkedin",createAuthorizationURL:async({state:i,scopes:r,redirectURI:o,loginHint:s})=>{const a=e.disableDefaultScope?[]:["profile","email","openid"];return e.scope&&a.push(...e.scope),r&&a.push(...r),await Jt({id:"linkedin",options:e,authorizationEndpoint:t,scopes:a,state:i,loginHint:s,redirectURI:o})},validateAuthorizationCode:async({code:i,redirectURI:r})=>await Rt({code:i,redirectURI:r,options:e,tokenEndpoint:n}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async i=>$t({refreshToken:i,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:n}),async getUserInfo(i){if(e.getUserInfo)return e.getUserInfo(i);const{data:r,error:o}=await rt("https://api.linkedin.com/v2/userinfo",{method:"GET",headers:{Authorization:`Bearer ${i.accessToken}`}});if(o)return null;const s=await e.mapProfileToUser?.(r);return{user:{id:r.sub,name:r.name,email:r.email,emailVerified:r.email_verified||!1,image:r.picture,...s},data:r}},options:e}},sK=e=>{const t=e.tenantId||"common",n=e.authority||"https://login.microsoftonline.com",i=`${n}/${t}/oauth2/v2.0/authorize`,r=`${n}/${t}/oauth2/v2.0/token`;return{id:"microsoft",name:"Microsoft EntraID",createAuthorizationURL(o){const s=e.disableDefaultScope?[]:["openid","profile","email","User.Read","offline_access"];return e.scope&&s.push(...e.scope),o.scopes&&s.push(...o.scopes),Jt({id:"microsoft",options:e,authorizationEndpoint:i,state:o.state,codeVerifier:o.codeVerifier,scopes:s,redirectURI:o.redirectURI,prompt:e.prompt,loginHint:o.loginHint})},validateAuthorizationCode({code:o,codeVerifier:s,redirectURI:a}){return Rt({code:o,codeVerifier:s,redirectURI:a,options:e,tokenEndpoint:r})},async getUserInfo(o){if(e.getUserInfo)return e.getUserInfo(o);if(!o.idToken)return null;const s=Ao(o.idToken),a=e.profilePhotoSize||48;await rt(`https://graph.microsoft.com/v1.0/me/photos/${a}x${a}/$value`,{headers:{Authorization:`Bearer ${o.accessToken}`},async onResponse(u){if(!(e.disableProfilePhoto||!u.response.ok))try{const p=await u.response.clone().arrayBuffer();s.picture=`data:image/jpeg;base64, ${bo.encode(p)}`}catch(p){Qe.error(p&&typeof p=="object"&&"name"in p?p.name:"",p)}}});const c=await e.mapProfileToUser?.(s),l=s.email_verified!==void 0?s.email_verified:!!(s.email&&(s.verified_primary_email?.includes(s.email)||s.verified_secondary_email?.includes(s.email)));return{user:{id:s.sub,name:s.name,email:s.email,image:s.picture,emailVerified:l,...c},data:s}},refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async o=>{const s=e.disableDefaultScope?[]:["openid","profile","email","User.Read","offline_access"];return e.scope&&s.push(...e.scope),$t({refreshToken:o,options:{clientId:e.clientId,clientSecret:e.clientSecret},extraParams:{scope:s.join(" ")},tokenEndpoint:r})},options:e}},aK=e=>({id:"naver",name:"Naver",createAuthorizationURL({state:t,scopes:n,redirectURI:i}){const r=e.disableDefaultScope?[]:["profile","email"];return e.scope&&r.push(...e.scope),n&&r.push(...n),Jt({id:"naver",options:e,authorizationEndpoint:"https://nid.naver.com/oauth2.0/authorize",scopes:r,state:t,redirectURI:i})},validateAuthorizationCode:async({code:t,redirectURI:n})=>Rt({code:t,redirectURI:n,options:e,tokenEndpoint:"https://nid.naver.com/oauth2.0/token"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>$t({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://nid.naver.com/oauth2.0/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:n,error:i}=await rt("https://openapi.naver.com/v1/nid/me",{headers:{Authorization:`Bearer ${t.accessToken}`}});if(i||!n||n.resultcode!=="00")return null;const r=await e.mapProfileToUser?.(n),o=n.response||{};return{user:{id:o.id,name:o.name||o.nickname,email:o.email,image:o.profile_image,emailVerified:!1,...r},data:n}},options:e}),cK=e=>{const t="https://api.notion.com/v1/oauth/token";return{id:"notion",name:"Notion",createAuthorizationURL({state:n,scopes:i,loginHint:r,redirectURI:o}){const s=e.disableDefaultScope?[]:[];return e.scope&&s.push(...e.scope),i&&s.push(...i),Jt({id:"notion",options:e,authorizationEndpoint:"https://api.notion.com/v1/oauth/authorize",scopes:s,state:n,redirectURI:o,loginHint:r,additionalParams:{owner:"user"}})},validateAuthorizationCode:async({code:n,redirectURI:i})=>Rt({code:n,redirectURI:i,options:e,tokenEndpoint:t,authentication:"basic"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async n=>$t({refreshToken:n,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:t}),async getUserInfo(n){if(e.getUserInfo)return e.getUserInfo(n);const{data:i,error:r}=await rt("https://api.notion.com/v1/users/me",{headers:{Authorization:`Bearer ${n.accessToken}`,"Notion-Version":"2022-06-28"}});if(r||!i)return null;const o=i.bot?.owner?.user;if(!o)return null;const s=await e.mapProfileToUser?.(o);return{user:{id:o.id,name:o.name||"Notion User",email:o.person?.email||null,image:o.avatar_url,emailVerified:!1,...s},data:o}},options:e}},lK=e=>{const t=e.issuer||"https://idp.paybin.io",n=`${t}/oauth2/authorize`,i=`${t}/oauth2/token`;return{id:"paybin",name:"Paybin",async createAuthorizationURL({state:r,scopes:o,codeVerifier:s,redirectURI:a,loginHint:c}){if(!e.clientId||!e.clientSecret)throw Qe.error("Client Id and Client Secret is required for Paybin. Make sure to provide them in the options."),new Fe("CLIENT_ID_AND_SECRET_REQUIRED");if(!s)throw new Fe("codeVerifier is required for Paybin");const l=e.disableDefaultScope?[]:["openid","email","profile"];return e.scope&&l.push(...e.scope),o&&l.push(...o),await Jt({id:"paybin",options:e,authorizationEndpoint:n,scopes:l,state:r,codeVerifier:s,redirectURI:a,prompt:e.prompt,loginHint:c})},validateAuthorizationCode:async({code:r,codeVerifier:o,redirectURI:s})=>Rt({code:r,codeVerifier:o,redirectURI:s,options:e,tokenEndpoint:i}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async r=>$t({refreshToken:r,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:i}),async getUserInfo(r){if(e.getUserInfo)return e.getUserInfo(r);if(!r.idToken)return null;const o=Ao(r.idToken),s=await e.mapProfileToUser?.(o);return{user:{id:o.sub,name:o.name||o.preferred_username||(o.email?o.email.split("@")[0]:"User")||"User",email:o.email,image:o.picture,emailVerified:o.email_verified||!1,...s},data:o}},options:e}},uK=e=>{const t=(e.environment||"sandbox")==="sandbox",n=t?"https://www.sandbox.paypal.com/signin/authorize":"https://www.paypal.com/signin/authorize",i=t?"https://api-m.sandbox.paypal.com/v1/oauth2/token":"https://api-m.paypal.com/v1/oauth2/token",r=t?"https://api-m.sandbox.paypal.com/v1/identity/oauth2/userinfo":"https://api-m.paypal.com/v1/identity/oauth2/userinfo";return{id:"paypal",name:"PayPal",async createAuthorizationURL({state:o,codeVerifier:s,redirectURI:a}){if(!e.clientId||!e.clientSecret)throw Qe.error("Client Id and Client Secret is required for PayPal. Make sure to provide them in the options."),new Fe("CLIENT_ID_AND_SECRET_REQUIRED");return await Jt({id:"paypal",options:e,authorizationEndpoint:n,scopes:[],state:o,codeVerifier:s,redirectURI:a,prompt:e.prompt})},validateAuthorizationCode:async({code:o,redirectURI:s})=>{const a=bo.encode(`${e.clientId}:${e.clientSecret}`);try{const c=await rt(i,{method:"POST",headers:{Authorization:`Basic ${a}`,Accept:"application/json","Accept-Language":"en_US","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"authorization_code",code:o,redirect_uri:s}).toString()});if(!c.data)throw new Fe("FAILED_TO_GET_ACCESS_TOKEN");const l=c.data;return{accessToken:l.access_token,refreshToken:l.refresh_token,accessTokenExpiresAt:l.expires_in?new Date(Date.now()+l.expires_in*1e3):void 0,idToken:l.id_token}}catch(c){throw Qe.error("PayPal token exchange failed:",c),new Fe("FAILED_TO_GET_ACCESS_TOKEN")}},refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async o=>{const s=bo.encode(`${e.clientId}:${e.clientSecret}`);try{const a=await rt(i,{method:"POST",headers:{Authorization:`Basic ${s}`,Accept:"application/json","Accept-Language":"en_US","Content-Type":"application/x-www-form-urlencoded"},body:new URLSearchParams({grant_type:"refresh_token",refresh_token:o}).toString()});if(!a.data)throw new Fe("FAILED_TO_REFRESH_ACCESS_TOKEN");const c=a.data;return{accessToken:c.access_token,refreshToken:c.refresh_token,accessTokenExpiresAt:c.expires_in?new Date(Date.now()+c.expires_in*1e3):void 0}}catch(a){throw Qe.error("PayPal token refresh failed:",a),new Fe("FAILED_TO_REFRESH_ACCESS_TOKEN")}},async verifyIdToken(o,s){if(e.disableIdTokenSignIn)return!1;if(e.verifyIdToken)return e.verifyIdToken(o,s);try{return!!Ao(o).sub}catch(a){return Qe.error("Failed to verify PayPal ID token:",a),!1}},async getUserInfo(o){if(e.getUserInfo)return e.getUserInfo(o);if(!o.accessToken)return Qe.error("Access token is required to fetch PayPal user info"),null;try{const s=await rt(`${r}?schema=paypalv1.1`,{headers:{Authorization:`Bearer ${o.accessToken}`,Accept:"application/json"}});if(!s.data)return Qe.error("Failed to fetch user info from PayPal"),null;const a=s.data,c=await e.mapProfileToUser?.(a);return{user:{id:a.user_id,name:a.name,email:a.email,image:a.picture,emailVerified:a.email_verified,...c},data:a}}catch(s){return Qe.error("Failed to fetch user info from PayPal:",s),null}},options:e}},dK=e=>({id:"polar",name:"Polar",createAuthorizationURL({state:t,scopes:n,codeVerifier:i,redirectURI:r}){const o=e.disableDefaultScope?[]:["openid","profile","email"];return e.scope&&o.push(...e.scope),n&&o.push(...n),Jt({id:"polar",options:e,authorizationEndpoint:"https://polar.sh/oauth2/authorize",scopes:o,state:t,codeVerifier:i,redirectURI:r,prompt:e.prompt})},validateAuthorizationCode:async({code:t,codeVerifier:n,redirectURI:i})=>Rt({code:t,codeVerifier:n,redirectURI:i,options:e,tokenEndpoint:"https://api.polar.sh/v1/oauth2/token"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>$t({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://api.polar.sh/v1/oauth2/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:n,error:i}=await rt("https://api.polar.sh/v1/oauth2/userinfo",{headers:{Authorization:`Bearer ${t.accessToken}`}});if(i)return null;const r=await e.mapProfileToUser?.(n);return{user:{id:n.id,name:n.public_name||n.username,email:n.email,image:n.avatar_url,emailVerified:n.email_verified??!1,...r},data:n}},options:e}),fK=e=>({id:"reddit",name:"Reddit",createAuthorizationURL({state:t,scopes:n,redirectURI:i}){const r=e.disableDefaultScope?[]:["identity"];return e.scope&&r.push(...e.scope),n&&r.push(...n),Jt({id:"reddit",options:e,authorizationEndpoint:"https://www.reddit.com/api/v1/authorize",scopes:r,state:t,redirectURI:i,duration:e.duration})},validateAuthorizationCode:async({code:t,redirectURI:n})=>{const i=new URLSearchParams({grant_type:"authorization_code",code:t,redirect_uri:e.redirectURI||n}),{data:r,error:o}=await rt("https://www.reddit.com/api/v1/access_token",{method:"POST",headers:{"content-type":"application/x-www-form-urlencoded",accept:"text/plain","user-agent":"better-auth",Authorization:`Basic ${bo.encode(`${e.clientId}:${e.clientSecret}`)}`},body:i.toString()});if(o)throw o;return r0(r)},refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>$t({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},authentication:"basic",tokenEndpoint:"https://www.reddit.com/api/v1/access_token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:n,error:i}=await rt("https://oauth.reddit.com/api/v1/me",{headers:{Authorization:`Bearer ${t.accessToken}`,"User-Agent":"better-auth"}});if(i)return null;const r=await e.mapProfileToUser?.(n);return{user:{id:n.id,name:n.name,email:n.oauth_client_id,emailVerified:n.has_verified_email,image:n.icon_img?.split("?")[0],...r},data:n}},options:e}),pK=e=>({id:"roblox",name:"Roblox",createAuthorizationURL({state:t,scopes:n,redirectURI:i}){const r=e.disableDefaultScope?[]:["openid","profile"];return e.scope&&r.push(...e.scope),n&&r.push(...n),new URL(`https://apis.roblox.com/oauth/v1/authorize?scope=${r.join("+")}&response_type=code&client_id=${e.clientId}&redirect_uri=${encodeURIComponent(e.redirectURI||i)}&state=${t}&prompt=${e.prompt||"select_account consent"}`)},validateAuthorizationCode:async({code:t,redirectURI:n})=>Rt({code:t,redirectURI:e.redirectURI||n,options:e,tokenEndpoint:"https://apis.roblox.com/oauth/v1/token",authentication:"post"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>$t({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://apis.roblox.com/oauth/v1/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:n,error:i}=await rt("https://apis.roblox.com/oauth/v1/userinfo",{headers:{authorization:`Bearer ${t.accessToken}`}});if(i)return null;const r=await e.mapProfileToUser?.(n);return{user:{id:n.sub,name:n.nickname||n.preferred_username||"",image:n.picture,email:n.preferred_username||null,emailVerified:!1,...r},data:{...n}}},options:e}),hK=e=>{const t=(e.environment??"production")==="sandbox",n=e.loginUrl?`https://${e.loginUrl}/services/oauth2/authorize`:t?"https://test.salesforce.com/services/oauth2/authorize":"https://login.salesforce.com/services/oauth2/authorize",i=e.loginUrl?`https://${e.loginUrl}/services/oauth2/token`:t?"https://test.salesforce.com/services/oauth2/token":"https://login.salesforce.com/services/oauth2/token",r=e.loginUrl?`https://${e.loginUrl}/services/oauth2/userinfo`:t?"https://test.salesforce.com/services/oauth2/userinfo":"https://login.salesforce.com/services/oauth2/userinfo";return{id:"salesforce",name:"Salesforce",async createAuthorizationURL({state:o,scopes:s,codeVerifier:a,redirectURI:c}){if(!e.clientId||!e.clientSecret)throw Qe.error("Client Id and Client Secret are required for Salesforce. Make sure to provide them in the options."),new Fe("CLIENT_ID_AND_SECRET_REQUIRED");if(!a)throw new Fe("codeVerifier is required for Salesforce");const l=e.disableDefaultScope?[]:["openid","email","profile"];return e.scope&&l.push(...e.scope),s&&l.push(...s),Jt({id:"salesforce",options:e,authorizationEndpoint:n,scopes:l,state:o,codeVerifier:a,redirectURI:e.redirectURI||c})},validateAuthorizationCode:async({code:o,codeVerifier:s,redirectURI:a})=>Rt({code:o,codeVerifier:s,redirectURI:e.redirectURI||a,options:e,tokenEndpoint:i}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async o=>$t({refreshToken:o,options:{clientId:e.clientId,clientSecret:e.clientSecret},tokenEndpoint:i}),async getUserInfo(o){if(e.getUserInfo)return e.getUserInfo(o);try{const{data:s}=await rt(r,{headers:{Authorization:`Bearer ${o.accessToken}`}});if(!s)return Qe.error("Failed to fetch user info from Salesforce"),null;const a=await e.mapProfileToUser?.(s);return{user:{id:s.user_id,name:s.name,email:s.email,image:s.photos?.picture||s.photos?.thumbnail,emailVerified:s.email_verified??!1,...a},data:s}}catch(s){return Qe.error("Failed to fetch user info from Salesforce:",s),null}},options:e}},mK=e=>({id:"slack",name:"Slack",createAuthorizationURL({state:t,scopes:n,redirectURI:i}){const r=e.disableDefaultScope?[]:["openid","profile","email"];n&&r.push(...n),e.scope&&r.push(...e.scope);const o=new URL("https://slack.com/openid/connect/authorize");return o.searchParams.set("scope",r.join(" ")),o.searchParams.set("response_type","code"),o.searchParams.set("client_id",e.clientId),o.searchParams.set("redirect_uri",e.redirectURI||i),o.searchParams.set("state",t),o},validateAuthorizationCode:async({code:t,redirectURI:n})=>Rt({code:t,redirectURI:n,options:e,tokenEndpoint:"https://slack.com/api/openid.connect.token"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>$t({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://slack.com/api/openid.connect.token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:n,error:i}=await rt("https://slack.com/api/openid.connect.userInfo",{headers:{authorization:`Bearer ${t.accessToken}`}});if(i)return null;const r=await e.mapProfileToUser?.(n);return{user:{id:n["https://slack.com/user_id"],name:n.name||"",email:n.email,emailVerified:n.email_verified,image:n.picture||n["https://slack.com/user_image_512"],...r},data:n}},options:e}),gK=e=>({id:"spotify",name:"Spotify",createAuthorizationURL({state:t,scopes:n,codeVerifier:i,redirectURI:r}){const o=e.disableDefaultScope?[]:["user-read-email"];return e.scope&&o.push(...e.scope),n&&o.push(...n),Jt({id:"spotify",options:e,authorizationEndpoint:"https://accounts.spotify.com/authorize",scopes:o,state:t,codeVerifier:i,redirectURI:r})},validateAuthorizationCode:async({code:t,codeVerifier:n,redirectURI:i})=>Rt({code:t,codeVerifier:n,redirectURI:i,options:e,tokenEndpoint:"https://accounts.spotify.com/api/token"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>$t({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://accounts.spotify.com/api/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:n,error:i}=await rt("https://api.spotify.com/v1/me",{method:"GET",headers:{Authorization:`Bearer ${t.accessToken}`}});if(i)return null;const r=await e.mapProfileToUser?.(n);return{user:{id:n.id,name:n.display_name,email:n.email,image:n.images[0]?.url,emailVerified:!1,...r},data:n}},options:e}),yK=e=>({id:"tiktok",name:"TikTok",createAuthorizationURL({state:t,scopes:n,redirectURI:i}){const r=e.disableDefaultScope?[]:["user.info.profile"];return e.scope&&r.push(...e.scope),n&&r.push(...n),new URL(`https://www.tiktok.com/v2/auth/authorize?scope=${r.join(",")}&response_type=code&client_key=${e.clientKey}&redirect_uri=${encodeURIComponent(e.redirectURI||i)}&state=${t}`)},validateAuthorizationCode:async({code:t,redirectURI:n})=>Rt({code:t,redirectURI:e.redirectURI||n,options:{clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://open.tiktokapis.com/v2/oauth/token/"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>$t({refreshToken:t,options:{clientSecret:e.clientSecret},tokenEndpoint:"https://open.tiktokapis.com/v2/oauth/token/",authentication:"post",extraParams:{client_key:e.clientKey}}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:n,error:i}=await rt(`https://open.tiktokapis.com/v2/user/info/?fields=${["open_id","avatar_large_url","display_name","username"].join(",")}`,{headers:{authorization:`Bearer ${t.accessToken}`}});return i?null:{user:{email:n.data.user.email||n.data.user.username,id:n.data.user.open_id,name:n.data.user.display_name||n.data.user.username,image:n.data.user.avatar_large_url,emailVerified:!1},data:n}},options:e}),wK=e=>({id:"twitch",name:"Twitch",createAuthorizationURL({state:t,scopes:n,redirectURI:i}){const r=e.disableDefaultScope?[]:["user:read:email","openid"];return e.scope&&r.push(...e.scope),n&&r.push(...n),Jt({id:"twitch",redirectURI:i,options:e,authorizationEndpoint:"https://id.twitch.tv/oauth2/authorize",scopes:r,state:t,claims:e.claims||["email","email_verified","preferred_username","picture"]})},validateAuthorizationCode:async({code:t,redirectURI:n})=>Rt({code:t,redirectURI:n,options:e,tokenEndpoint:"https://id.twitch.tv/oauth2/token"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>$t({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://id.twitch.tv/oauth2/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const n=t.idToken;if(!n)return Qe.error("No idToken found in token"),null;const i=Ao(n),r=await e.mapProfileToUser?.(i);return{user:{id:i.sub,name:i.preferred_username,email:i.email,image:i.picture,emailVerified:i.email_verified,...r},data:i}},options:e}),vK=e=>({id:"twitter",name:"Twitter",createAuthorizationURL(t){const n=e.disableDefaultScope?[]:["users.read","tweet.read","offline.access","users.email"];return e.scope&&n.push(...e.scope),t.scopes&&n.push(...t.scopes),Jt({id:"twitter",options:e,authorizationEndpoint:"https://x.com/i/oauth2/authorize",scopes:n,state:t.state,codeVerifier:t.codeVerifier,redirectURI:t.redirectURI})},validateAuthorizationCode:async({code:t,codeVerifier:n,redirectURI:i})=>Rt({code:t,codeVerifier:n,authentication:"basic",redirectURI:i,options:e,tokenEndpoint:"https://api.x.com/2/oauth2/token"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>$t({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},authentication:"basic",tokenEndpoint:"https://api.x.com/2/oauth2/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:n,error:i}=await rt("https://api.x.com/2/users/me?user.fields=profile_image_url",{method:"GET",headers:{Authorization:`Bearer ${t.accessToken}`}});if(i)return null;const{data:r,error:o}=await rt("https://api.x.com/2/users/me?user.fields=confirmed_email",{method:"GET",headers:{Authorization:`Bearer ${t.accessToken}`}});let s=!1;!o&&r?.data?.confirmed_email&&(n.data.email=r.data.confirmed_email,s=!0);const a=await e.mapProfileToUser?.(n);return{user:{id:n.data.id,name:n.data.name,email:n.data.email||n.data.username||null,image:n.data.profile_image_url,emailVerified:s,...a},data:n}},options:e}),bK=e=>({id:"vercel",name:"Vercel",createAuthorizationURL({state:t,scopes:n,codeVerifier:i,redirectURI:r}){if(!i)throw new Fe("codeVerifier is required for Vercel");let o;return(e.scope!==void 0||n!==void 0)&&(o=[],e.scope&&o.push(...e.scope),n&&o.push(...n)),Jt({id:"vercel",options:e,authorizationEndpoint:"https://vercel.com/oauth/authorize",scopes:o,state:t,codeVerifier:i,redirectURI:r})},validateAuthorizationCode:async({code:t,codeVerifier:n,redirectURI:i})=>Rt({code:t,codeVerifier:n,redirectURI:i,options:e,tokenEndpoint:"https://api.vercel.com/login/oauth/token"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);const{data:n,error:i}=await rt("https://api.vercel.com/login/oauth/userinfo",{headers:{Authorization:`Bearer ${t.accessToken}`}});if(i||!n)return null;const r=await e.mapProfileToUser?.(n);return{user:{id:n.sub,name:n.name??n.preferred_username,email:n.email,image:n.picture,emailVerified:n.email_verified??!1,...r},data:n}},options:e}),_K=e=>({id:"vk",name:"VK",async createAuthorizationURL({state:t,scopes:n,codeVerifier:i,redirectURI:r}){const o=e.disableDefaultScope?[]:["email","phone"];return e.scope&&o.push(...e.scope),n&&o.push(...n),Jt({id:"vk",options:e,authorizationEndpoint:"https://id.vk.com/authorize",scopes:o,state:t,redirectURI:r,codeVerifier:i})},validateAuthorizationCode:async({code:t,codeVerifier:n,redirectURI:i,deviceId:r})=>Rt({code:t,codeVerifier:n,redirectURI:e.redirectURI||i,options:e,deviceId:r,tokenEndpoint:"https://id.vk.com/oauth2/auth"}),refreshAccessToken:e.refreshAccessToken?e.refreshAccessToken:async t=>$t({refreshToken:t,options:{clientId:e.clientId,clientKey:e.clientKey,clientSecret:e.clientSecret},tokenEndpoint:"https://id.vk.com/oauth2/auth"}),async getUserInfo(t){if(e.getUserInfo)return e.getUserInfo(t);if(!t.accessToken)return null;const n=new URLSearchParams({access_token:t.accessToken,client_id:e.clientId}).toString(),{data:i,error:r}=await rt("https://id.vk.com/oauth2/user_info",{method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},body:n});if(r)return null;const o=await e.mapProfileToUser?.(i);return!i.user.email&&!o?.email?null:{user:{id:i.user.user_id,first_name:i.user.first_name,last_name:i.user.last_name,email:i.user.email,image:i.user.avatar,emailVerified:!1,birthday:i.user.birthday,sex:i.user.sex,name:`${i.user.first_name} ${i.user.last_name}`,...o},data:i}},options:e}),SK=e=>{const t={pkce:!0,...e};return{id:"zoom",name:"Zoom",createAuthorizationURL:async({state:n,redirectURI:i,codeVerifier:r})=>{const o=new URLSearchParams({response_type:"code",redirect_uri:t.redirectURI?t.redirectURI:i,client_id:t.clientId,state:n});if(t.pkce){const a=await LO(r);o.set("code_challenge_method","S256"),o.set("code_challenge",a)}const s=new URL("https://zoom.us/oauth/authorize");return s.search=o.toString(),s},validateAuthorizationCode:async({code:n,redirectURI:i,codeVerifier:r})=>Rt({code:n,redirectURI:t.redirectURI||i,codeVerifier:r,options:t,tokenEndpoint:"https://zoom.us/oauth/token",authentication:"post"}),refreshAccessToken:t.refreshAccessToken?t.refreshAccessToken:async n=>$t({refreshToken:n,options:{clientId:t.clientId,clientKey:t.clientKey,clientSecret:t.clientSecret},tokenEndpoint:"https://zoom.us/oauth/token"}),async getUserInfo(n){if(t.getUserInfo)return t.getUserInfo(n);const{data:i,error:r}=await rt("https://api.zoom.us/v2/users/me",{headers:{authorization:`Bearer ${n.accessToken}`}});if(r)return null;const o=await t.mapProfileToUser?.(i);return{user:{id:i.id,name:i.display_name,image:i.pic_url,email:i.email,emailVerified:!!i.verified,...o},data:{...i}}}}},BO={apple:zH,atlassian:FH,cognito:WH,discord:qH,facebook:KH,figma:JH,github:GH,microsoft:sK,google:YH,huggingface:eK,slack:mK,spotify:gK,twitch:wK,twitter:vK,dropbox:HH,kick:nK,linear:iK,linkedin:oK,gitlab:QH,tiktok:yK,reddit:fK,roblox:pK,salesforce:hK,vk:_K,zoom:SK,notion:cK,kakao:tK,naver:aK,line:rK,paybin:lK,paypal:uK,polar:dK,vercel:bK},xK=Object.keys(BO),FO=Eo(xK).or(W()),kK=Ot("/list-accounts",{method:"GET",use:[Ku],metadata:{openapi:{operationId:"listUserAccounts",description:"List all accounts linked to the user",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"array",items:{type:"object",properties:{id:{type:"string"},providerId:{type:"string"},createdAt:{type:"string",format:"date-time"},updatedAt:{type:"string",format:"date-time"},accountId:{type:"string"},userId:{type:"string"},scopes:{type:"array",items:{type:"string"}}},required:["id","providerId","createdAt","updatedAt","accountId","userId","scopes"]}}}}}}}}},async e=>{const t=e.context.session,n=await e.context.internalAdapter.findAccounts(t.user.id);return e.json(n.map(i=>{const{scope:r,...o}=hC(e.context.options,i);return{...o,scopes:r?.split(",")||[]}}))}),EK=Ot("/link-social",{method:"POST",requireHeaders:!0,body:ce({callbackURL:W().meta({description:"The URL to redirect to after the user has signed in"}).optional(),provider:FO,idToken:ce({token:W(),nonce:W().optional(),accessToken:W().optional(),refreshToken:W().optional(),scopes:yt(W()).optional()}).optional(),requestSignUp:nt().optional(),scopes:yt(W()).meta({description:"Additional scopes to request from the provider"}).optional(),errorCallbackURL:W().meta({description:"The URL to redirect to if there is an error during the link process"}).optional(),disableRedirect:nt().meta({description:"Disable automatic redirection to the provider. Useful for handling the redirection yourself"}).optional(),additionalData:rr(W(),Hn()).optional()}),use:[Ku],metadata:{openapi:{description:"Link a social account to the user",operationId:"linkSocialAccount",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{url:{type:"string",description:"The authorization URL to redirect the user to"},redirect:{type:"boolean",description:"Indicates if the user should be redirected to the authorization URL"},status:{type:"boolean"}},required:["redirect"]}}}}}}}},async e=>{const t=e.context.session,n=e.context.socialProviders.find(o=>o.id===e.body.provider);if(!n)throw e.context.logger.error("Provider not found. Make sure to add the provider in your auth config",{provider:e.body.provider}),new le("NOT_FOUND",{message:Re.PROVIDER_NOT_FOUND});if(e.body.idToken){if(!n.verifyIdToken)throw e.context.logger.error("Provider does not support id token verification",{provider:e.body.provider}),new le("NOT_FOUND",{message:Re.ID_TOKEN_NOT_SUPPORTED});const{token:o,nonce:s}=e.body.idToken;if(!await n.verifyIdToken(o,s))throw e.context.logger.error("Invalid id token",{provider:e.body.provider}),new le("UNAUTHORIZED",{message:Re.INVALID_TOKEN});const a=await n.getUserInfo({idToken:o,accessToken:e.body.idToken.accessToken,refreshToken:e.body.idToken.refreshToken});if(!a||!a?.user)throw e.context.logger.error("Failed to get user info",{provider:e.body.provider}),new le("UNAUTHORIZED",{message:Re.FAILED_TO_GET_USER_INFO});const c=String(a.user.id);if(!a.user.email)throw e.context.logger.error("User email not found",{provider:e.body.provider}),new le("UNAUTHORIZED",{message:Re.USER_EMAIL_NOT_FOUND});if((await e.context.internalAdapter.findAccounts(t.user.id)).find(l=>l.providerId===n.id&&l.accountId===c))return e.json({url:"",status:!0,redirect:!1});if(!e.context.options.account?.accountLinking?.trustedProviders?.includes(n.id)&&!a.user.emailVerified||e.context.options.account?.accountLinking?.enabled===!1)throw new le("UNAUTHORIZED",{message:"Account not linked - linking not allowed"});if(a.user.email!==t.user.email&&e.context.options.account?.accountLinking?.allowDifferentEmails!==!0)throw new le("UNAUTHORIZED",{message:"Account not linked - different emails not allowed"});try{await e.context.internalAdapter.createAccount({userId:t.user.id,providerId:n.id,accountId:c,accessToken:e.body.idToken.accessToken,idToken:o,refreshToken:e.body.idToken.refreshToken,scope:e.body.idToken.scopes?.join(",")})}catch{throw new le("EXPECTATION_FAILED",{message:"Account not linked - unable to create account"})}if(e.context.options.account?.accountLinking?.updateUserInfoOnLink===!0)try{await e.context.internalAdapter.updateUser(t.user.id,{name:a.user?.name,image:a.user?.image})}catch(l){console.warn("Could not update user - "+l.toString())}return e.json({url:"",status:!0,redirect:!1})}const i=await AC(e,{userId:t.user.id,email:t.user.email},e.body.additionalData),r=await n.createAuthorizationURL({state:i.state,codeVerifier:i.codeVerifier,redirectURI:`${e.context.baseURL}/callback/${n.id}`,scopes:e.body.scopes});return e.body.disableRedirect||e.setHeader("Location",r.toString()),e.json({url:r.toString(),redirect:!e.body.disableRedirect})}),AK=Ot("/unlink-account",{method:"POST",body:ce({providerId:W(),accountId:W().optional()}),use:[fH],metadata:{openapi:{description:"Unlink an account",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean"}}}}}}}}}},async e=>{const{providerId:t,accountId:n}=e.body,i=await e.context.internalAdapter.findAccounts(e.context.session.user.id);if(i.length===1&&!e.context.options.account?.accountLinking?.allowUnlinkingAll)throw new le("BAD_REQUEST",{message:Re.FAILED_TO_UNLINK_LAST_ACCOUNT});const r=i.find(o=>n?o.accountId===n&&o.providerId===t:o.providerId===t);if(!r)throw new le("BAD_REQUEST",{message:Re.ACCOUNT_NOT_FOUND});return await e.context.internalAdapter.deleteAccount(r.id),e.json({status:!0})}),WO=Ot("/get-access-token",{method:"POST",body:ce({providerId:W().meta({description:"The provider ID for the OAuth provider"}),accountId:W().meta({description:"The account ID associated with the refresh token"}).optional(),userId:W().meta({description:"The user ID associated with the account"}).optional()}),metadata:{openapi:{description:"Get a valid access token, doing a refresh if needed",responses:{200:{description:"A Valid access token",content:{"application/json":{schema:{type:"object",properties:{tokenType:{type:"string"},idToken:{type:"string"},accessToken:{type:"string"},accessTokenExpiresAt:{type:"string",format:"date-time"}}}}}},400:{description:"Invalid refresh token or provider configuration"}}}}},async e=>{const{providerId:t,accountId:n,userId:i}=e.body||{},r=e.request,o=await ji(e);if(r&&!o)throw e.error("UNAUTHORIZED");const s=o?.user?.id||i;if(!s)throw e.error("UNAUTHORIZED");if(!e.context.socialProviders.find(u=>u.id===t))throw new le("BAD_REQUEST",{message:`Provider ${t} is not supported.`});const a=await Ch(e);let c;if(a&&t===a.providerId&&(!n||a.id===n)?c=a:c=(await e.context.internalAdapter.findAccounts(s)).find(u=>n?u.id===n&&u.providerId===t:u.providerId===t),!c)throw new le("BAD_REQUEST",{message:"Account not found"});const l=e.context.socialProviders.find(u=>u.id===t);if(!l)throw new le("BAD_REQUEST",{message:`Provider ${t} not found.`});try{let u=null;const p=c.accessTokenExpiresAt&&new Date(c.accessTokenExpiresAt).getTime()-Date.now()<5e3;if(c.refreshToken&&p&&l.refreshAccessToken){const h=await _y(c.refreshToken,e.context);u=await l.refreshAccessToken(h);const d={accessToken:await nr(u.accessToken,e.context),accessTokenExpiresAt:u.accessTokenExpiresAt,refreshToken:await nr(u.refreshToken,e.context),refreshTokenExpiresAt:u.refreshTokenExpiresAt};let y=null;c.id&&(y=await e.context.internalAdapter.updateAccount(c.id,d)),e.context.options.account?.storeAccountCookie&&await Nl(e,{...c,...y??d})}const f=(()=>{if(u?.accessTokenExpiresAt)return typeof u.accessTokenExpiresAt=="string"?new Date(u.accessTokenExpiresAt):u.accessTokenExpiresAt;if(c.accessTokenExpiresAt)return typeof c.accessTokenExpiresAt=="string"?new Date(c.accessTokenExpiresAt):c.accessTokenExpiresAt})(),g={accessToken:u?.accessToken??await _y(c.accessToken??"",e.context),accessTokenExpiresAt:f,scopes:c.scope?.split(",")??[],idToken:u?.idToken??c.idToken??void 0};return e.json(g)}catch(u){throw new le("BAD_REQUEST",{message:"Failed to get a valid access token",cause:u})}}),TK=Ot("/refresh-token",{method:"POST",body:ce({providerId:W().meta({description:"The provider ID for the OAuth provider"}),accountId:W().meta({description:"The account ID associated with the refresh token"}).optional(),userId:W().meta({description:"The user ID associated with the account"}).optional()}),metadata:{openapi:{description:"Refresh the access token using a refresh token",responses:{200:{description:"Access token refreshed successfully",content:{"application/json":{schema:{type:"object",properties:{tokenType:{type:"string"},idToken:{type:"string"},accessToken:{type:"string"},refreshToken:{type:"string"},accessTokenExpiresAt:{type:"string",format:"date-time"},refreshTokenExpiresAt:{type:"string",format:"date-time"}}}}}},400:{description:"Invalid refresh token or provider configuration"}}}}},async e=>{const{providerId:t,accountId:n,userId:i}=e.body,r=e.request,o=await ji(e);if(r&&!o)throw e.error("UNAUTHORIZED");const s=o?.user?.id||i;if(!s)throw new le("BAD_REQUEST",{message:"Either userId or session is required"});const a=e.context.socialProviders.find(p=>p.id===t);if(!a)throw new le("BAD_REQUEST",{message:`Provider ${t} not found.`});if(!a.refreshAccessToken)throw new le("BAD_REQUEST",{message:`Provider ${t} does not support token refreshing.`});let c;const l=await Ch(e);if(l&&(!t||t===l?.providerId)?c=l:c=(await e.context.internalAdapter.findAccounts(s)).find(p=>n?p.id===n&&p.providerId===t:p.providerId===t),!c)throw new le("BAD_REQUEST",{message:"Account not found"});let u;if(l&&t===l.providerId?u=l.refreshToken??void 0:u=c.refreshToken??void 0,!u)throw new le("BAD_REQUEST",{message:"Refresh token not found"});try{const p=await _y(u,e.context),f=await a.refreshAccessToken(p);if(c.id){const g={...c||{},accessToken:await nr(f.accessToken,e.context),refreshToken:await nr(f.refreshToken,e.context),accessTokenExpiresAt:f.accessTokenExpiresAt,refreshTokenExpiresAt:f.refreshTokenExpiresAt,scope:f.scopes?.join(",")||c.scope,idToken:f.idToken||c.idToken};await e.context.internalAdapter.updateAccount(c.id,g)}return l&&t===l.providerId&&e.context.options.account?.storeAccountCookie&&await Nl(e,{...l,accessToken:await nr(f.accessToken,e.context),refreshToken:await nr(f.refreshToken,e.context),accessTokenExpiresAt:f.accessTokenExpiresAt,refreshTokenExpiresAt:f.refreshTokenExpiresAt,scope:f.scopes?.join(",")||l.scope,idToken:f.idToken||l.idToken}),e.json({accessToken:f.accessToken,refreshToken:f.refreshToken,accessTokenExpiresAt:f.accessTokenExpiresAt,refreshTokenExpiresAt:f.refreshTokenExpiresAt,scope:f.scopes?.join(",")||c.scope,idToken:f.idToken||c.idToken,providerId:c.providerId,accountId:c.accountId})}catch(p){throw new le("BAD_REQUEST",{message:"Failed to refresh access token",cause:p})}}),IK=wo(ce({accountId:W().meta({description:"The provider given account id for which to get the account info"}).optional()})),NK=Ot("/account-info",{method:"GET",use:[Ku],metadata:{openapi:{description:"Get the account info provided by the provider",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{user:{type:"object",properties:{id:{type:"string"},name:{type:"string"},email:{type:"string"},image:{type:"string"},emailVerified:{type:"boolean"}},required:["id","emailVerified"]},data:{type:"object",properties:{},additionalProperties:!0}},required:["user","data"],additionalProperties:!1}}}}}}},query:IK},async e=>{const t=e.query?.accountId;let n;if(t){const s=await e.context.internalAdapter.findAccount(t);s&&(n=s)}else if(e.context.options.account?.storeAccountCookie){const s=await Ch(e);s&&(n=s)}if(!n||n.userId!==e.context.session.user.id)throw new le("BAD_REQUEST",{message:"Account not found"});const i=e.context.socialProviders.find(s=>s.id===n.providerId);if(!i)throw new le("INTERNAL_SERVER_ERROR",{message:`Provider account provider is ${n.providerId} but it is not configured`});const r=await WO({...e,method:"POST",body:{accountId:n.id,providerId:n.providerId},returnHeaders:!1,returnStatus:!1});if(!r.accessToken)throw new le("BAD_REQUEST",{message:"Access token not found"});const o=await i.getUserInfo({...r,accessToken:r.accessToken});return e.json(o)});async function Di(e,t,n,i=3600,r){return await z$({email:t.toLowerCase(),updateTo:n,...r},e,i)}async function Lx(e,t){if(!e.context.options.emailVerification?.sendVerificationEmail)throw e.context.logger.error("Verification email isn't enabled."),new le("BAD_REQUEST",{message:"Verification email isn't enabled"});const n=await Di(e.context.secret,t.email,void 0,e.context.options.emailVerification?.expiresIn),i=e.body.callbackURL?encodeURIComponent(e.body.callbackURL):encodeURIComponent("/"),r=`${e.context.baseURL}/verify-email?token=${n}&callbackURL=${i}`;await e.context.runInBackgroundOrAwait(e.context.options.emailVerification.sendVerificationEmail({user:t,url:r,token:n},e.request))}const $K=Ot("/send-verification-email",{method:"POST",operationId:"sendVerificationEmail",body:ce({email:Wi().meta({description:"The email to send the verification email to"}),callbackURL:W().meta({description:"The URL to use for email verification callback"}).optional()}),metadata:{openapi:{operationId:"sendVerificationEmail",description:"Send a verification email to the user",requestBody:{content:{"application/json":{schema:{type:"object",properties:{email:{type:"string",description:"The email to send the verification email to",example:"user@example.com"},callbackURL:{type:"string",description:"The URL to use for email verification callback",example:"https://example.com/callback",nullable:!0}},required:["email"]}}}},responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean",description:"Indicates if the email was sent successfully",example:!0}}}}}},400:{description:"Bad Request",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string",description:"Error message",example:"Verification email isn't enabled"}}}}}}}}}},async e=>{if(!e.context.options.emailVerification?.sendVerificationEmail)throw e.context.logger.error("Verification email isn't enabled."),new le("BAD_REQUEST",{message:"Verification email isn't enabled"});const{email:t}=e.body,n=await ji(e);if(!n){const i=await e.context.internalAdapter.findUserByEmail(t);return i?(await Lx(e,i.user),e.json({status:!0})):(await Di(e.context.secret,t,void 0,e.context.options.emailVerification?.expiresIn),e.json({status:!0}))}if(n?.user.email!==t)throw new le("BAD_REQUEST",{message:Re.EMAIL_MISMATCH});if(n?.user.emailVerified)throw new le("BAD_REQUEST",{message:Re.EMAIL_ALREADY_VERIFIED});return await Lx(e,n.user),e.json({status:!0})}),CK=Ot("/verify-email",{method:"GET",operationId:"verifyEmail",query:ce({token:W().meta({description:"The token to verify the email"}),callbackURL:W().meta({description:"The URL to redirect to after email verification"}).optional()}),use:[Mb(e=>e.query.callbackURL)],metadata:{openapi:{description:"Verify the email of the user",parameters:[{name:"token",in:"query",description:"The token to verify the email",required:!0,schema:{type:"string"}},{name:"callbackURL",in:"query",description:"The URL to redirect to after email verification",required:!1,schema:{type:"string"}}],responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{user:{type:"object",$ref:"#/components/schemas/User"},status:{type:"boolean",description:"Indicates if the email was verified successfully"}},required:["user","status"]}}}}}}}},async e=>{function t(a){throw e.query.callbackURL?e.query.callbackURL.includes("?")?e.redirect(`${e.query.callbackURL}&error=${a}`):e.redirect(`${e.query.callbackURL}?error=${a}`):new le("UNAUTHORIZED",{message:a})}const{token:n}=e.query;let i;try{i=await vc(n,new TextEncoder().encode(e.context.secret),{algorithms:["HS256"]})}catch(a){return a instanceof Jg?t("token_expired"):t("invalid_token")}const r=ce({email:Wi(),updateTo:W().optional(),requestType:W().optional()}).parse(i.payload),o=await e.context.internalAdapter.findUserByEmail(r.email);if(!o)return t("user_not_found");if(r.updateTo){const a=await ji(e);if(a&&a.user.email!==r.email)return t("unauthorized");switch(r.requestType){case"change-email-confirmation":{const c=await Di(e.context.secret,r.email,r.updateTo,e.context.options.emailVerification?.expiresIn,{requestType:"change-email-verification"}),l=e.query.callbackURL?encodeURIComponent(e.query.callbackURL):encodeURIComponent("/"),u=`${e.context.baseURL}/verify-email?token=${c}&callbackURL=${l}`;if(e.context.options.emailVerification?.sendVerificationEmail&&await e.context.runInBackgroundOrAwait(e.context.options.emailVerification.sendVerificationEmail({user:{...o.user,email:r.updateTo},url:u,token:c},e.request)),e.query.callbackURL)throw e.redirect(e.query.callbackURL);return e.json({status:!0})}case"change-email-verification":{let c=a;if(!c){const u=await e.context.internalAdapter.createSession(o.user.id);if(!u)throw new le("INTERNAL_SERVER_ERROR",{message:Re.FAILED_TO_CREATE_SESSION});c={session:u,user:o.user}}e.context.options.emailVerification?.onEmailVerification&&await e.context.options.emailVerification.onEmailVerification(o.user,e.request);const l=await e.context.internalAdapter.updateUserByEmail(r.email,{email:r.updateTo,emailVerified:!0});if(e.context.options.emailVerification?.afterEmailVerification&&await e.context.options.emailVerification.afterEmailVerification(l,e.request),await ii(e,{session:c.session,user:{...c.user,email:r.updateTo,emailVerified:!0}}),e.query.callbackURL)throw e.redirect(e.query.callbackURL);return e.json({status:!0,user:Vn(e.context.options,l)})}default:{let c=a;if(!c){const f=await e.context.internalAdapter.createSession(o.user.id);if(!f)throw new le("INTERNAL_SERVER_ERROR",{message:Re.FAILED_TO_CREATE_SESSION});c={session:f,user:o.user}}const l=await e.context.internalAdapter.updateUserByEmail(r.email,{email:r.updateTo,emailVerified:!1}),u=await Di(e.context.secret,r.updateTo),p=e.query.callbackURL?encodeURIComponent(e.query.callbackURL):encodeURIComponent("/");if(e.context.options.emailVerification?.sendVerificationEmail&&await e.context.runInBackgroundOrAwait(e.context.options.emailVerification.sendVerificationEmail({user:l,url:`${e.context.baseURL}/verify-email?token=${u}&callbackURL=${p}`,token:u},e.request)),await ii(e,{session:c.session,user:{...c.user,email:r.updateTo,emailVerified:!1}}),e.query.callbackURL)throw e.redirect(e.query.callbackURL);return e.json({status:!0,user:Vn(e.context.options,l)})}}}if(o.user.emailVerified){if(e.query.callbackURL)throw e.redirect(e.query.callbackURL);return e.json({status:!0,user:null})}e.context.options.emailVerification?.beforeEmailVerification&&await e.context.options.emailVerification.beforeEmailVerification(o.user,e.request),e.context.options.emailVerification?.onEmailVerification&&await e.context.options.emailVerification.onEmailVerification(o.user,e.request);const s=await e.context.internalAdapter.updateUserByEmail(r.email,{emailVerified:!0});if(e.context.options.emailVerification?.afterEmailVerification&&await e.context.options.emailVerification.afterEmailVerification(s,e.request),e.context.options.emailVerification?.autoSignInAfterVerification){const a=await ji(e);if(!a||a.user.email!==r.email){const c=await e.context.internalAdapter.createSession(o.user.id);if(!c)throw new le("INTERNAL_SERVER_ERROR",{message:"Failed to create session"});await ii(e,{session:c,user:{...o.user,emailVerified:!0}})}else await ii(e,{session:a.session,user:{...a.user,emailVerified:!0}})}if(e.query.callbackURL)throw e.redirect(e.query.callbackURL);return e.json({status:!0,user:null})});async function VO(e,t){const{userInfo:n,account:i,callbackURL:r,disableSignUp:o,overrideUserInfo:s}=t,a=await e.context.internalAdapter.findOAuthUser(n.email.toLowerCase(),i.accountId,i.providerId).catch(p=>{Qe.error(`Better auth was unable to query your database.
Error: `,p);const f=e.context.options.onAPIError?.errorURL||`${e.context.baseURL}/error`;throw e.redirect(`${f}?error=internal_server_error`)});let c=a?.user;const l=!c;if(a){const p=a.linkedAccount??a.accounts.find(f=>f.providerId===i.providerId&&f.accountId===i.accountId);if(p){const f=e.context.options.account?.updateAccountOnSignIn!==!1?Object.fromEntries(Object.entries({idToken:i.idToken,accessToken:await nr(i.accessToken,e.context),refreshToken:await nr(i.refreshToken,e.context),accessTokenExpiresAt:i.accessTokenExpiresAt,refreshTokenExpiresAt:i.refreshTokenExpiresAt,scope:i.scope}).filter(([g,h])=>h!==void 0)):{};e.context.options.account?.storeAccountCookie&&await Nl(e,{...p,...f}),Object.keys(f).length>0&&await e.context.internalAdapter.updateAccount(p.id,f),n.emailVerified&&!a.user.emailVerified&&n.email.toLowerCase()===a.user.email&&await e.context.internalAdapter.updateUser(a.user.id,{emailVerified:!0})}else{const f=e.context.options.account?.accountLinking,g=e.context.options.account?.accountLinking?.trustedProviders;if(!(t.isTrustedProvider||g?.includes(i.providerId))&&!n.emailVerified||f?.enabled===!1||f?.disableImplicitLinking===!0)return kb()&&Qe.warn(`User already exist but account isn't linked to ${i.providerId}. To read more about how account linking works in Better Auth see https://www.better-auth.com/docs/concepts/users-accounts#account-linking.`),{error:"account not linked",data:null};try{await e.context.internalAdapter.linkAccount({providerId:i.providerId,accountId:n.id.toString(),userId:a.user.id,accessToken:await nr(i.accessToken,e.context),refreshToken:await nr(i.refreshToken,e.context),idToken:i.idToken,accessTokenExpiresAt:i.accessTokenExpiresAt,refreshTokenExpiresAt:i.refreshTokenExpiresAt,scope:i.scope})}catch(h){return Qe.error("Unable to link account",h),{error:"unable to link account",data:null}}n.emailVerified&&!a.user.emailVerified&&n.email.toLowerCase()===a.user.email&&await e.context.internalAdapter.updateUser(a.user.id,{emailVerified:!0})}if(s){const{id:f,...g}=n;c=await e.context.internalAdapter.updateUser(a.user.id,{...g,email:n.email.toLowerCase(),emailVerified:n.email.toLowerCase()===a.user.email&&a.user.emailVerified||n.emailVerified})}}else{if(o)return{error:"signup disabled",data:null,isRegister:!1};try{const{id:p,...f}=n,g={accessToken:await nr(i.accessToken,e.context),refreshToken:await nr(i.refreshToken,e.context),idToken:i.idToken,accessTokenExpiresAt:i.accessTokenExpiresAt,refreshTokenExpiresAt:i.refreshTokenExpiresAt,scope:i.scope,providerId:i.providerId,accountId:n.id.toString()},{user:h,account:d}=await e.context.internalAdapter.createOAuthUser({...f,email:n.email.toLowerCase()},g);if(c=h,e.context.options.account?.storeAccountCookie&&await Nl(e,d),!n.emailVerified&&c&&e.context.options.emailVerification?.sendOnSignUp&&e.context.options.emailVerification?.sendVerificationEmail){const y=await Di(e.context.secret,c.email,void 0,e.context.options.emailVerification?.expiresIn),v=`${e.context.baseURL}/verify-email?token=${y}&callbackURL=${r}`;await e.context.runInBackgroundOrAwait(e.context.options.emailVerification.sendVerificationEmail({user:c,url:v,token:y},e.request))}}catch(p){return Qe.error(p),p instanceof le?{error:p.message,data:null,isRegister:!1}:{error:"unable to create user",data:null,isRegister:!1}}}if(!c)return{error:"unable to create user",data:null,isRegister:!1};const u=await e.context.internalAdapter.createSession(c.id);return u?{data:{session:u,user:c},error:null,isRegister:l}:{error:"unable to create session",data:null,isRegister:!1}}const ms=ce({code:W().optional(),error:W().optional(),device_id:W().optional(),error_description:W().optional(),state:W().optional(),user:W().optional()}),OK=Ot("/callback/:id",{method:["GET","POST"],operationId:"handleOAuthCallback",body:ms.optional(),query:ms.optional(),metadata:{...Ub,allowedMediaTypes:["application/x-www-form-urlencoded","application/json"]}},async e=>{let t;const n=e.context.options.onAPIError?.errorURL||`${e.context.baseURL}/error`;if(e.method==="POST"){const k=e.body?ms.parse(e.body):{},D=e.query?ms.parse(e.query):{},B=ms.parse({...k,...D}),J=new URLSearchParams;for(const[T,z]of Object.entries(B))z!=null&&J.set(T,String(z));const S=`${e.context.baseURL}/callback/${e.params.id}?${J.toString()}`;throw e.redirect(S)}try{if(e.method==="GET")t=ms.parse(e.query);else if(e.method==="POST")t=ms.parse(e.body);else throw new Error("Unsupported method")}catch(k){throw e.context.logger.error("INVALID_CALLBACK_REQUEST",k),e.redirect(`${n}?error=invalid_callback_request`)}const{code:i,error:r,state:o,error_description:s,device_id:a,user:c}=t;if(!o){e.context.logger.error("State not found",r);const k=`${n}${n.includes("?")?"&":"?"}state=state_not_found`;throw e.redirect(k)}const{codeVerifier:l,callbackURL:u,link:p,errorURL:f,newUserURL:g,requestSignUp:h}=await hV(e);function d(k,D){const B=f??n,J=new URLSearchParams({error:k});D&&J.set("error_description",D);const S=`${B}${B.includes("?")?"&":"?"}${J.toString()}`;throw e.redirect(S)}if(r&&d(r,s),!i)throw e.context.logger.error("Code not found"),d("no_code");const y=e.context.socialProviders.find(k=>k.id===e.params.id);if(!y)throw e.context.logger.error("Oauth provider with id",e.params.id,"not found"),d("oauth_provider_not_found");let v;try{v=await y.validateAuthorizationCode({code:i,codeVerifier:l,deviceId:a,redirectURI:`${e.context.baseURL}/callback/${y.id}`})}catch(k){throw e.context.logger.error("",k),d("invalid_code")}if(!v)throw d("invalid_code");const x=c?tr(c):null,E=await y.getUserInfo({...v,user:x??void 0}).then(k=>k?.user);if(!E)return e.context.logger.error("Unable to get user info"),d("unable_to_get_user_info");if(!u)throw e.context.logger.error("No callback URL found"),d("no_callback_url");if(p){if(!e.context.options.account?.accountLinking?.trustedProviders?.includes(y.id)&&!E.emailVerified||e.context.options.account?.accountLinking?.enabled===!1)return e.context.logger.error("Unable to link account - untrusted provider"),d("unable_to_link_account");if(E.email!==p.email&&e.context.options.account?.accountLinking?.allowDifferentEmails!==!0)return d("email_doesn't_match");const k=await e.context.internalAdapter.findAccount(String(E.id));if(k){if(k.userId.toString()!==p.userId.toString())return d("account_already_linked_to_different_user");const B=Object.fromEntries(Object.entries({accessToken:await nr(v.accessToken,e.context),refreshToken:await nr(v.refreshToken,e.context),idToken:v.idToken,accessTokenExpiresAt:v.accessTokenExpiresAt,refreshTokenExpiresAt:v.refreshTokenExpiresAt,scope:v.scopes?.join(",")}).filter(([J,S])=>S!==void 0));await e.context.internalAdapter.updateAccount(k.id,B)}else if(!await e.context.internalAdapter.createAccount({userId:p.userId,providerId:y.id,accountId:String(E.id),...v,accessToken:await nr(v.accessToken,e.context),refreshToken:await nr(v.refreshToken,e.context),scope:v.scopes?.join(",")}))return d("unable_to_link_account");let D;try{D=u.toString()}catch{D=u}throw e.redirect(D)}if(!E.email)return e.context.logger.error("Provider did not return email. This could be due to misconfiguration in the provider settings."),d("email_not_found");const N={providerId:y.id,accountId:String(E.id),...v,scope:v.scopes?.join(",")},C=await VO(e,{userInfo:{...E,id:String(E.id),email:E.email,name:E.name||E.email},account:N,callbackURL:u,disableSignUp:y.disableImplicitSignUp&&!h||y.options?.disableSignUp,overrideUserInfo:y.options?.overrideUserInfoOnSignIn});if(C.error)return e.context.logger.error(C.error.split(" ").join("_")),d(C.error.split(" ").join("_"));const{session:b,user:P}=C.data;await ii(e,{session:b,user:P});let $;try{$=(C.isRegister&&g||u).toString()}catch{$=C.isRegister&&g||u}throw e.redirect($)});function qO(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/&(?!amp;|lt;|gt;|quot;|#39;|#x[0-9a-fA-F]+;|#[0-9]+;)/g,"&amp;")}const RK=(e,t="Unknown",n=null)=>{const i=e.onAPIError?.customizeDefaultErrorPage;return`<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Error</title>
    <style>
      * {
        box-sizing: border-box;
      }
      body {
        font-family: ${i?.font?.defaultFamily||"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif"};
        background: ${i?.colors?.background||"var(--background)"};
        color: var(--foreground);
        margin: 0;
      }
      :root,
      :host {
        --spacing: 0.25rem;
        --container-md: 28rem;
        --text-sm: ${i?.size?.textSm||"0.875rem"};
        --text-sm--line-height: calc(1.25 / 0.875);
        --text-2xl: ${i?.size?.text2xl||"1.5rem"};
        --text-2xl--line-height: calc(2 / 1.5);
        --text-4xl: ${i?.size?.text4xl||"2.25rem"};
        --text-4xl--line-height: calc(2.5 / 2.25);
        --text-6xl: ${i?.size?.text6xl||"3rem"};
        --text-6xl--line-height: 1;
        --font-weight-medium: 500;
        --font-weight-semibold: 600;
        --font-weight-bold: 700;
        --default-transition-duration: 150ms;
        --default-transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
        --radius: ${i?.size?.radiusSm||"0.625rem"};
        --default-mono-font-family: ${i?.font?.monoFamily||"var(--font-geist-mono)"};
        --primary: ${i?.colors?.primary||"black"};
        --primary-foreground: ${i?.colors?.primaryForeground||"white"};
        --background: ${i?.colors?.background||"white"};
        --foreground: ${i?.colors?.foreground||"oklch(0.271 0 0)"};
        --border: ${i?.colors?.border||"oklch(0.89 0 0)"};
        --destructive: ${i?.colors?.destructive||"oklch(0.55 0.15 25.723)"};
        --muted-foreground: ${i?.colors?.mutedForeground||"oklch(0.545 0 0)"};
        --corner-border: ${i?.colors?.cornerBorder||"#404040"};
      }

      button, .btn {
        cursor: pointer;
        background: none;
        border: none;
        color: inherit;
        font: inherit;
        transition: all var(--default-transition-duration)
          var(--default-transition-timing-function);
      }
      button:hover, .btn:hover {
        opacity: 0.8;
      }

      @media (prefers-color-scheme: dark) {
        :root,
        :host {
          --primary: ${i?.colors?.primary||"white"};
          --primary-foreground: ${i?.colors?.primaryForeground||"black"};
          --background: ${i?.colors?.background||"oklch(0.15 0 0)"};
          --foreground: ${i?.colors?.foreground||"oklch(0.98 0 0)"};
          --border: ${i?.colors?.border||"oklch(0.27 0 0)"};
          --destructive: ${i?.colors?.destructive||"oklch(0.65 0.15 25.723)"};
          --muted-foreground: ${i?.colors?.mutedForeground||"oklch(0.65 0 0)"};
          --corner-border: ${i?.colors?.cornerBorder||"#a0a0a0"};
        }
      }
      @media (max-width: 640px) {
        :root, :host {
          --text-6xl: 2.5rem;
          --text-2xl: 1.25rem;
          --text-sm: 0.8125rem;
        }
      }
      @media (max-width: 480px) {
        :root, :host {
          --text-6xl: 2rem;
          --text-2xl: 1.125rem;
        }
      }
    </style>
  </head>
  <body style="width: 100vw; min-height: 100vh; overflow-x: hidden; overflow-y: auto;">
    <div
        style="
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 1.5rem;
            position: relative;
            width: 100%;
            min-height: 100vh;
            padding: 1rem;
        "
        >
${i?.disableBackgroundGrid?"":`
      <div
        style="
          position: absolute;
          inset: 0;
          background-image: linear-gradient(to right, ${i?.colors?.gridColor||"var(--border)"} 1px, transparent 1px),
            linear-gradient(to bottom, ${i?.colors?.gridColor||"var(--border)"} 1px, transparent 1px);
          background-size: 40px 40px;
          opacity: 0.6;
          pointer-events: none;
          width: 100vw;
          height: 100vh;
        "
      ></div>
      <div
        style="
          position: absolute;
          inset: 0;
          display: flex;
          align-items: center;
          justify-content: center;
          background: ${i?.colors?.background||"var(--background)"};
          mask-image: radial-gradient(ellipse at center, transparent 20%, black);
          -webkit-mask-image: radial-gradient(ellipse at center, transparent 20%, black);
          pointer-events: none;
        "
      ></div>
`}

<div
  style="
    position: relative;
    z-index: 10;
    border: 2px solid var(--border);
    background: ${i?.colors?.cardBackground||"var(--background)"};
    padding: 1.5rem;
    max-width: 42rem;
    width: 100%;
  "
>
    ${i?.disableCornerDecorations?"":`
        <!-- Corner decorations -->
        <div
          style="
            position: absolute;
            top: -2px;
            left: -2px;
            width: 2rem;
            height: 2rem;
            border-top: 4px solid var(--corner-border);
            border-left: 4px solid var(--corner-border);
          "
        ></div>
        <div
          style="
            position: absolute;
            top: -2px;
            right: -2px;
            width: 2rem;
            height: 2rem;
            border-top: 4px solid var(--corner-border);
            border-right: 4px solid var(--corner-border);
          "
        ></div>
  
        <div
          style="
            position: absolute;
            bottom: -2px;
            left: -2px;
            width: 2rem;
            height: 2rem;
            border-bottom: 4px solid var(--corner-border);
            border-left: 4px solid var(--corner-border);
          "
        ></div>
        <div
          style="
            position: absolute;
            bottom: -2px;
            right: -2px;
            width: 2rem;
            height: 2rem;
            border-bottom: 4px solid var(--corner-border);
            border-right: 4px solid var(--corner-border);
          "
        ></div>`}

        <div style="text-align: center; margin-bottom: 1.5rem;">
          <div style="margin-bottom: 1.5rem;">
            <div
              style="
                display: inline-block;
                border: 2px solid ${i?.disableTitleBorder?"transparent":i?.colors?.titleBorder||"var(--destructive)"};
                padding: 0.375rem 1rem;
              "
            >
              <h1
                style="
                  font-size: var(--text-6xl);
                  font-weight: var(--font-weight-semibold);
                  color: ${i?.colors?.titleColor||"var(--foreground)"};
                  letter-spacing: -0.02em;
                  margin: 0;
                "
              >
                ERROR
              </h1>
            </div>
            <div
              style="
                height: 2px;
                background-color: var(--border);
                width: calc(100% + 3rem);
                margin-left: -1.5rem;
                margin-top: 1.5rem;
              "
            ></div>
          </div>

          <h2
            style="
              font-size: var(--text-2xl);
              font-weight: var(--font-weight-semibold);
              color: var(--foreground);
              margin: 0 0 1rem;
            "
          >
            Something went wrong
          </h2>

          <div
            style="
                display: inline-flex;
                align-items: center;
                gap: 0.5rem;
                border: 2px solid var(--border);
                background-color: var(--muted);
                padding: 0.375rem 0.75rem;
                margin: 0 0 1rem;
                flex-wrap: wrap;
                justify-content: center;
            "
            >
            <span
                style="
                font-size: 0.75rem;
                color: var(--muted-foreground);
                font-weight: var(--font-weight-semibold);
                "
            >
                CODE:
            </span>
            <span
                style="
                font-size: var(--text-sm);
                font-family: var(--default-mono-font-family, monospace);
                color: var(--foreground);
                word-break: break-all;
                "
            >
                ${qO(t)}
            </span>
            </div>

          <p
            style="
              color: var(--muted-foreground);
              max-width: 28rem;
              margin: 0 auto;
              font-size: var(--text-sm);
              line-height: 1.5;
              text-wrap: pretty;
            "
          >
            ${n||`We encountered an unexpected error. Please try again or return to the home page. If you're a developer, you can find more information about the error <a href='https://better-auth.com/docs/reference/errors/${encodeURIComponent(t)}' target='_blank' rel="noopener noreferrer" style='color: var(--foreground); text-decoration: underline;'>here</a>.`}
          </p>
        </div>

        <div
          style="
            display: flex;
            gap: 0.75rem;
            margin-top: 1.5rem;
            justify-content: center;
            flex-wrap: wrap;
          "
        >
          <a
            href="/"
            style="
              text-decoration: none;
            "
          >
            <div
              style="
                border: 2px solid var(--border);
                background: var(--primary);
                color: var(--primary-foreground);
                padding: 0.5rem 1rem;
                border-radius: 0;
                white-space: nowrap;
              "
              class="btn"
            >
              Go Home
            </div>
          </a>
          <a
            href="https://better-auth.com/docs/reference/errors/${encodeURIComponent(t)}?askai=${encodeURIComponent(`What does the error code ${t} mean?`)}"
            target="_blank"
            rel="noopener noreferrer"
            style="
              text-decoration: none;
            "
          >
            <div
              style="
                border: 2px solid var(--border);
                background: transparent;
                color: var(--foreground);
                padding: 0.5rem 1rem;
                border-radius: 0;
                white-space: nowrap;
              "
              class="btn"
            >
              Ask AI
            </div>
          </a>
        </div>
      </div>
    </div>
  </body>
</html>`},PK=Ot("/error",{method:"GET",metadata:{...Ub,openapi:{description:"Displays an error page",responses:{200:{description:"Success",content:{"text/html":{schema:{type:"string",description:"The HTML content of the error page"}}}}}}}},async e=>{const t=new URL(e.request?.url||""),n=t.searchParams.get("error")||"UNKNOWN",i=t.searchParams.get("error_description")||null,r=/^[\'A-Za-z0-9_-]+$/.test(n)?n:"UNKNOWN",o=i?qO(i):null,s=new URLSearchParams;s.set("error",r),i&&s.set("error_description",i);const a=e.context.options,c=a.onAPIError?.errorURL;return c?new Response(null,{status:302,headers:{Location:`${c}${c.includes("?")?"&":"?"}${s.toString()}`}}):Ih&&!a.onAPIError?.customizeDefaultErrorPage?new Response(null,{status:302,headers:{Location:`/?${s.toString()}`}}):new Response(RK(e.context.options,r,o),{headers:{"Content-Type":"text/html"}})}),DK=Ot("/ok",{method:"GET",metadata:{...Ub,openapi:{description:"Check if the API is working",responses:{200:{description:"API is working",content:{"application/json":{schema:{type:"object",properties:{ok:{type:"boolean",description:"Indicates if the API is working"}},required:["ok"]}}}}}}}},async e=>e.json({ok:!0}));async function UK(e,t){const n=(await e.context.internalAdapter.findAccounts(t.userId))?.find(r=>r.providerId==="credential"),i=n?.password;return!n||!i?!1:await e.context.password.verify({hash:i,password:t.password})}async function LK(e,t){const n=(await t.context.internalAdapter.findAccounts(e))?.find(r=>r.providerId==="credential"),i=n?.password;if(!n||!i||!t.body.password)throw new le("BAD_REQUEST",{message:"No password credential found"});if(!await t.context.password.verify({hash:i,password:t.body.password}))throw new le("BAD_REQUEST",{message:"Invalid password"});return!0}function Mx(e,t,n){const i=t?new URL(t,e.baseURL):new URL(`${e.baseURL}/error`);return n&&Object.entries(n).forEach(([r,o])=>i.searchParams.set(r,o)),i.href}function MK(e,t,n){const i=new URL(t,e.baseURL);return n&&Object.entries(n).forEach(([r,o])=>i.searchParams.set(r,o)),i.href}const jK=Ot("/request-password-reset",{method:"POST",body:ce({email:Wi().meta({description:"The email address of the user to send a password reset email to"}),redirectTo:W().meta({description:"The URL to redirect the user to reset their password. If the token isn't valid or expired, it'll be redirected with a query parameter `?error=INVALID_TOKEN`. If the token is valid, it'll be redirected with a query parameter `?token=VALID_TOKEN"}).optional()}),metadata:{openapi:{operationId:"requestPasswordReset",description:"Send a password reset email to the user",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean"},message:{type:"string"}}}}}}}}}},async e=>{if(!e.context.options.emailAndPassword?.sendResetPassword)throw e.context.logger.error("Reset password isn't enabled.Please pass an emailAndPassword.sendResetPassword function in your auth config!"),new le("BAD_REQUEST",{message:"Reset password isn't enabled"});const{email:t,redirectTo:n}=e.body,i=await e.context.internalAdapter.findUserByEmail(t,{includeAccounts:!0});if(!i)return Al(24),await e.context.internalAdapter.findVerificationValue("dummy-verification-token"),e.context.logger.error("Reset Password: User not found",{email:t}),e.json({status:!0,message:"If this email exists in our system, check your email for the reset link"});const r=Ga(e.context.options.emailAndPassword.resetPasswordTokenExpiresIn||3600*1,"sec"),o=Al(24);await e.context.internalAdapter.createVerificationValue({value:i.user.id,identifier:`reset-password:${o}`,expiresAt:r});const s=n?encodeURIComponent(n):"",a=`${e.context.baseURL}/reset-password/${o}?callbackURL=${s}`;return await e.context.runInBackgroundOrAwait(e.context.options.emailAndPassword.sendResetPassword({user:i.user,url:a,token:o},e.request)),e.json({status:!0,message:"If this email exists in our system, check your email for the reset link"})}),zK=Ot("/reset-password/:token",{method:"GET",operationId:"forgetPasswordCallback",query:ce({callbackURL:W().meta({description:"The URL to redirect the user to reset their password"})}),use:[Mb(e=>e.query.callbackURL)],metadata:{openapi:{operationId:"resetPasswordCallback",description:"Redirects the user to the callback URL with the token",parameters:[{name:"token",in:"path",required:!0,description:"The token to reset the password",schema:{type:"string"}},{name:"callbackURL",in:"query",required:!0,description:"The URL to redirect the user to reset their password",schema:{type:"string"}}],responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{token:{type:"string"}}}}}}}}}},async e=>{const{token:t}=e.params,{callbackURL:n}=e.query;if(!t||!n)throw e.redirect(Mx(e.context,n,{error:"INVALID_TOKEN"}));const i=await e.context.internalAdapter.findVerificationValue(`reset-password:${t}`);throw!i||i.expiresAt<new Date?e.redirect(Mx(e.context,n,{error:"INVALID_TOKEN"})):e.redirect(MK(e.context,n,{token:t}))}),BK=Ot("/reset-password",{method:"POST",operationId:"resetPassword",query:ce({token:W().optional()}).optional(),body:ce({newPassword:W().meta({description:"The new password to set"}),token:W().meta({description:"The token to reset the password"}).optional()}),metadata:{openapi:{operationId:"resetPassword",description:"Reset the password for a user",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean"}}}}}}}}}},async e=>{const t=e.body.token||e.query?.token;if(!t)throw new le("BAD_REQUEST",{message:Re.INVALID_TOKEN});const{newPassword:n}=e.body,i=e.context.password?.config.minPasswordLength,r=e.context.password?.config.maxPasswordLength;if(n.length<i)throw new le("BAD_REQUEST",{message:Re.PASSWORD_TOO_SHORT});if(n.length>r)throw new le("BAD_REQUEST",{message:Re.PASSWORD_TOO_LONG});const o=`reset-password:${t}`,s=await e.context.internalAdapter.findVerificationValue(o);if(!s||s.expiresAt<new Date)throw new le("BAD_REQUEST",{message:Re.INVALID_TOKEN});const a=s.value,c=await e.context.password.hash(n);if((await e.context.internalAdapter.findAccounts(a)).find(l=>l.providerId==="credential")?await e.context.internalAdapter.updatePassword(a,c):await e.context.internalAdapter.createAccount({userId:a,providerId:"credential",password:c,accountId:a}),await e.context.internalAdapter.deleteVerificationValue(s.id),e.context.options.emailAndPassword?.onPasswordReset){const l=await e.context.internalAdapter.findUserById(a);l&&await e.context.options.emailAndPassword.onPasswordReset({user:l},e.request)}return e.context.options.emailAndPassword?.revokeSessionsOnPasswordReset&&await e.context.internalAdapter.deleteSessions(a),e.json({status:!0})}),FK=Ot("/verify-password",{method:"POST",body:ce({password:W().meta({description:"The password to verify"})}),metadata:{scope:"server",openapi:{operationId:"verifyPassword",description:"Verify the current user's password",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{status:{type:"boolean"}}}}}}}}},use:[cs]},async e=>{const{password:t}=e.body,n=e.context.session;if(!await UK(e,{password:t,userId:n.user.id}))throw new le("BAD_REQUEST",{message:Re.INVALID_PASSWORD});return e.json({status:!0})}),WK=ce({callbackURL:W().meta({description:"Callback URL to redirect to after the user has signed in"}).optional(),newUserCallbackURL:W().optional(),errorCallbackURL:W().meta({description:"Callback URL to redirect to if an error happens"}).optional(),provider:FO,disableRedirect:nt().meta({description:"Disable automatic redirection to the provider. Useful for handling the redirection yourself"}).optional(),idToken:wo(ce({token:W().meta({description:"ID token from the provider"}),nonce:W().meta({description:"Nonce used to generate the token"}).optional(),accessToken:W().meta({description:"Access token from the provider"}).optional(),refreshToken:W().meta({description:"Refresh token from the provider"}).optional(),expiresAt:Lt().meta({description:"Expiry date of the token"}).optional()})),scopes:yt(W()).meta({description:"Array of scopes to request from the provider. This will override the default scopes passed."}).optional(),requestSignUp:nt().meta({description:"Explicitly request sign-up. Useful when disableImplicitSignUp is true for this provider"}).optional(),loginHint:W().meta({description:"The login hint to use for the authorization code request"}).optional(),additionalData:rr(W(),Hn()).optional().meta({description:"Additional data to be passed through the OAuth flow"})}),VK=()=>Ot("/sign-in/social",{method:"POST",operationId:"socialSignIn",body:WK,metadata:{$Infer:{body:{},returned:{}},openapi:{description:"Sign in with a social provider",operationId:"socialSignIn",responses:{200:{description:"Success - Returns either session details or redirect URL",content:{"application/json":{schema:{type:"object",description:"Session response when idToken is provided",properties:{token:{type:"string"},user:{type:"object",$ref:"#/components/schemas/User"},url:{type:"string"},redirect:{type:"boolean",enum:[!1]}},required:["redirect","token","user"]}}}}}}}},async e=>{const t=e.context.socialProviders.find(o=>o.id===e.body.provider);if(!t)throw e.context.logger.error("Provider not found. Make sure to add the provider in your auth config",{provider:e.body.provider}),new le("NOT_FOUND",{message:Re.PROVIDER_NOT_FOUND});if(e.body.idToken){if(!t.verifyIdToken)throw e.context.logger.error("Provider does not support id token verification",{provider:e.body.provider}),new le("NOT_FOUND",{message:Re.ID_TOKEN_NOT_SUPPORTED});const{token:o,nonce:s}=e.body.idToken;if(!await t.verifyIdToken(o,s))throw e.context.logger.error("Invalid id token",{provider:e.body.provider}),new le("UNAUTHORIZED",{message:Re.INVALID_TOKEN});const a=await t.getUserInfo({idToken:o,accessToken:e.body.idToken.accessToken,refreshToken:e.body.idToken.refreshToken});if(!a||!a?.user)throw e.context.logger.error("Failed to get user info",{provider:e.body.provider}),new le("UNAUTHORIZED",{message:Re.FAILED_TO_GET_USER_INFO});if(!a.user.email)throw e.context.logger.error("User email not found",{provider:e.body.provider}),new le("UNAUTHORIZED",{message:Re.USER_EMAIL_NOT_FOUND});const c=await VO(e,{userInfo:{...a.user,email:a.user.email,id:String(a.user.id),name:a.user.name||"",image:a.user.image,emailVerified:a.user.emailVerified||!1},account:{providerId:t.id,accountId:String(a.user.id),accessToken:e.body.idToken.accessToken},callbackURL:e.body.callbackURL,disableSignUp:t.disableImplicitSignUp&&!e.body.requestSignUp||t.disableSignUp});if(c.error)throw new le("UNAUTHORIZED",{message:c.error});return await ii(e,c.data),e.json({redirect:!1,token:c.data.session.token,url:void 0,user:Vn(e.context.options,c.data.user)})}const{codeVerifier:n,state:i}=await AC(e,void 0,e.body.additionalData),r=await t.createAuthorizationURL({state:i,codeVerifier:n,redirectURI:`${e.context.baseURL}/callback/${t.id}`,scopes:e.body.scopes,loginHint:e.body.loginHint});return e.body.disableRedirect||e.setHeader("Location",r.toString()),e.json({url:r.toString(),redirect:!e.body.disableRedirect})}),qK=()=>Ot("/sign-in/email",{method:"POST",operationId:"signInEmail",use:[OC],body:ce({email:W().meta({description:"Email of the user"}),password:W().meta({description:"Password of the user"}),callbackURL:W().meta({description:"Callback URL to use as a redirect for email verification"}).optional(),rememberMe:nt().meta({description:"If this is false, the session will not be remembered. Default is `true`."}).default(!0).optional()}),metadata:{allowedMediaTypes:["application/x-www-form-urlencoded","application/json"],$Infer:{body:{},returned:{}},openapi:{operationId:"signInEmail",description:"Sign in with email and password",responses:{200:{description:"Success - Returns either session details or redirect URL",content:{"application/json":{schema:{type:"object",description:"Session response when idToken is provided",properties:{redirect:{type:"boolean",enum:[!1]},token:{type:"string",description:"Session token"},url:{type:"string",nullable:!0},user:{type:"object",$ref:"#/components/schemas/User"}},required:["redirect","token","user"]}}}}}}}},async e=>{if(!e.context.options?.emailAndPassword?.enabled)throw e.context.logger.error("Email and password is not enabled. Make sure to enable it in the options on you `auth.ts` file. Check `https://better-auth.com/docs/authentication/email-password` for more!"),new le("BAD_REQUEST",{message:"Email and password is not enabled"});const{email:t,password:n}=e.body;if(!Wi().safeParse(t).success)throw new le("BAD_REQUEST",{message:Re.INVALID_EMAIL});const i=await e.context.internalAdapter.findUserByEmail(t,{includeAccounts:!0});if(!i)throw await e.context.password.hash(n),e.context.logger.error("User not found",{email:t}),new le("UNAUTHORIZED",{message:Re.INVALID_EMAIL_OR_PASSWORD});const r=i.accounts.find(a=>a.providerId==="credential");if(!r)throw await e.context.password.hash(n),e.context.logger.error("Credential account not found",{email:t}),new le("UNAUTHORIZED",{message:Re.INVALID_EMAIL_OR_PASSWORD});const o=r?.password;if(!o)throw await e.context.password.hash(n),e.context.logger.error("Password not found",{email:t}),new le("UNAUTHORIZED",{message:Re.INVALID_EMAIL_OR_PASSWORD});if(!await e.context.password.verify({hash:o,password:n}))throw e.context.logger.error("Invalid password"),new le("UNAUTHORIZED",{message:Re.INVALID_EMAIL_OR_PASSWORD});if(e.context.options?.emailAndPassword?.requireEmailVerification&&!i.user.emailVerified){if(!e.context.options?.emailVerification?.sendVerificationEmail)throw new le("FORBIDDEN",{message:Re.EMAIL_NOT_VERIFIED});if(e.context.options?.emailVerification?.sendOnSignIn){const a=await Di(e.context.secret,i.user.email,void 0,e.context.options.emailVerification?.expiresIn),c=e.body.callbackURL?encodeURIComponent(e.body.callbackURL):encodeURIComponent("/"),l=`${e.context.baseURL}/verify-email?token=${a}&callbackURL=${c}`;await e.context.runInBackgroundOrAwait(e.context.options.emailVerification.sendVerificationEmail({user:i.user,url:l,token:a},e.request))}throw new le("FORBIDDEN",{message:Re.EMAIL_NOT_VERIFIED})}const s=await e.context.internalAdapter.createSession(i.user.id,e.body.rememberMe===!1);if(!s)throw e.context.logger.error("Failed to create session"),new le("UNAUTHORIZED",{message:Re.FAILED_TO_CREATE_SESSION});return await ii(e,{session:s,user:i.user},e.body.rememberMe===!1),e.body.callbackURL&&e.setHeader("Location",e.body.callbackURL),e.json({redirect:!!e.body.callbackURL,token:s.token,url:e.body.callbackURL,user:Vn(e.context.options,i.user)})}),HK=Ot("/sign-out",{method:"POST",operationId:"signOut",requireHeaders:!0,metadata:{openapi:{operationId:"signOut",description:"Sign out the current user",responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean"}}}}}}}}}},async e=>{const t=await e.getSignedCookie(e.context.authCookies.sessionToken.name,e.context.secret);if(t)try{await e.context.internalAdapter.deleteSession(t)}catch(n){e.context.logger.error("Failed to delete session from database",n)}return $l(e),e.json({success:!0})}),KK=ce({name:W(),email:Wi(),password:W().nonempty(),image:W().optional(),callbackURL:W().optional(),rememberMe:nt().optional()}).and(rr(W(),Hn())),JK=()=>Ot("/sign-up/email",{method:"POST",operationId:"signUpWithEmailAndPassword",use:[OC],body:KK,metadata:{allowedMediaTypes:["application/x-www-form-urlencoded","application/json"],$Infer:{body:{},returned:{}},openapi:{operationId:"signUpWithEmailAndPassword",description:"Sign up a user using email and password",requestBody:{content:{"application/json":{schema:{type:"object",properties:{name:{type:"string",description:"The name of the user"},email:{type:"string",description:"The email of the user"},password:{type:"string",description:"The password of the user"},image:{type:"string",description:"The profile image URL of the user"},callbackURL:{type:"string",description:"The URL to use for email verification callback"},rememberMe:{type:"boolean",description:"If this is false, the session will not be remembered. Default is `true`."}},required:["name","email","password"]}}}},responses:{200:{description:"Successfully created user",content:{"application/json":{schema:{type:"object",properties:{token:{type:"string",nullable:!0,description:"Authentication token for the session"},user:{type:"object",properties:{id:{type:"string",description:"The unique identifier of the user"},email:{type:"string",format:"email",description:"The email address of the user"},name:{type:"string",description:"The name of the user"},image:{type:"string",format:"uri",nullable:!0,description:"The profile image URL of the user"},emailVerified:{type:"boolean",description:"Whether the email has been verified"},createdAt:{type:"string",format:"date-time",description:"When the user was created"},updatedAt:{type:"string",format:"date-time",description:"When the user was last updated"}},required:["id","email","name","emailVerified","createdAt","updatedAt"]}},required:["user"]}}}},422:{description:"Unprocessable Entity. User already exists or failed to create user.",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string"}}}}}}}}}},async e=>kC(e.context.adapter,async()=>{if(!e.context.options.emailAndPassword?.enabled||e.context.options.emailAndPassword?.disableSignUp)throw new le("BAD_REQUEST",{message:"Email and password sign up is not enabled"});const t=e.body,{name:n,email:i,password:r,image:o,callbackURL:s,rememberMe:a,...c}=t;if(!Wi().safeParse(i).success)throw new le("BAD_REQUEST",{message:Re.INVALID_EMAIL});if(!r||typeof r!="string")throw new le("BAD_REQUEST",{message:Re.INVALID_PASSWORD});const l=e.context.password.config.minPasswordLength;if(r.length<l)throw e.context.logger.error("Password is too short"),new le("BAD_REQUEST",{message:Re.PASSWORD_TOO_SHORT});const u=e.context.password.config.maxPasswordLength;if(r.length>u)throw e.context.logger.error("Password is too long"),new le("BAD_REQUEST",{message:Re.PASSWORD_TOO_LONG});if((await e.context.internalAdapter.findUserByEmail(i))?.user)throw e.context.logger.info(`Sign-up attempt for existing email: ${i}`),new le("UNPROCESSABLE_ENTITY",{message:Re.USER_ALREADY_EXISTS_USE_ANOTHER_EMAIL});const p=await e.context.password.hash(r);let f;try{const h=$b(e.context.options,c,"create");if(f=await e.context.internalAdapter.createUser({email:i.toLowerCase(),name:n,image:o,...h,emailVerified:!1}),!f)throw new le("BAD_REQUEST",{message:Re.FAILED_TO_CREATE_USER})}catch(h){throw kb()&&e.context.logger.error("Failed to create user",h),h instanceof le?h:(e.context.logger?.error("Failed to create user",h),new le("UNPROCESSABLE_ENTITY",{message:Re.FAILED_TO_CREATE_USER}))}if(!f)throw new le("UNPROCESSABLE_ENTITY",{message:Re.FAILED_TO_CREATE_USER});if(await e.context.internalAdapter.linkAccount({userId:f.id,providerId:"credential",accountId:f.id,password:p}),e.context.options.emailVerification?.sendOnSignUp??e.context.options.emailAndPassword.requireEmailVerification){const h=await Di(e.context.secret,f.email,void 0,e.context.options.emailVerification?.expiresIn),d=t.callbackURL?encodeURIComponent(t.callbackURL):encodeURIComponent("/"),y=`${e.context.baseURL}/verify-email?token=${h}&callbackURL=${d}`;e.context.options.emailVerification?.sendVerificationEmail&&await e.context.runInBackgroundOrAwait(e.context.options.emailVerification.sendVerificationEmail({user:f,url:y,token:h},e.request))}if(e.context.options.emailAndPassword.autoSignIn===!1||e.context.options.emailAndPassword.requireEmailVerification)return e.json({token:null,user:Vn(e.context.options,f)});const g=await e.context.internalAdapter.createSession(f.id,a===!1);if(!g)throw new le("BAD_REQUEST",{message:Re.FAILED_TO_CREATE_SESSION});return await ii(e,{session:g,user:f},a===!1),e.json({token:g.token,user:Vn(e.context.options,f)})})),GK=rr(W().meta({description:"Field name must be a string"}),Hn()),ZK=()=>Ot("/update-user",{method:"POST",operationId:"updateUser",body:GK,use:[Ku],metadata:{$Infer:{body:{}},openapi:{operationId:"updateUser",description:"Update the current user",requestBody:{content:{"application/json":{schema:{type:"object",properties:{name:{type:"string",description:"The name of the user"},image:{type:"string",description:"The image of the user",nullable:!0}}}}}},responses:{200:{description:"Success",content:{"application/json":{schema:{type:"object",properties:{user:{type:"object",$ref:"#/components/schemas/User"}}}}}}}}}},async e=>{const t=e.body;if(typeof t!="object"||Array.isArray(t))throw new le("BAD_REQUEST",{message:"Body must be an object"});if(t.email)throw new le("BAD_REQUEST",{message:Re.EMAIL_CAN_NOT_BE_UPDATED});const{name:n,image:i,...r}=t,o=e.context.session,s=$b(e.context.options,r,"update");if(i===void 0&&n===void 0&&Object.keys(s).length===0)throw new le("BAD_REQUEST",{message:"No fields to update"});const a=await e.context.internalAdapter.updateUser(o.user.id,{name:n,image:i,...s})??{...o.user,...n!==void 0&&{name:n},...i!==void 0&&{image:i},...s};return await ii(e,{session:o.session,user:a}),e.json({status:!0})}),QK=Ot("/change-password",{method:"POST",operationId:"changePassword",body:ce({newPassword:W().meta({description:"The new password to set"}),currentPassword:W().meta({description:"The current password is required"}),revokeOtherSessions:nt().meta({description:"Must be a boolean value"}).optional()}),use:[cs],metadata:{openapi:{operationId:"changePassword",description:"Change the password of the user",responses:{200:{description:"Password successfully changed",content:{"application/json":{schema:{type:"object",properties:{token:{type:"string",nullable:!0,description:"New session token if other sessions were revoked"},user:{type:"object",properties:{id:{type:"string",description:"The unique identifier of the user"},email:{type:"string",format:"email",description:"The email address of the user"},name:{type:"string",description:"The name of the user"},image:{type:"string",format:"uri",nullable:!0,description:"The profile image URL of the user"},emailVerified:{type:"boolean",description:"Whether the email has been verified"},createdAt:{type:"string",format:"date-time",description:"When the user was created"},updatedAt:{type:"string",format:"date-time",description:"When the user was last updated"}},required:["id","email","name","emailVerified","createdAt","updatedAt"]}},required:["user"]}}}}}}}},async e=>{const{newPassword:t,currentPassword:n,revokeOtherSessions:i}=e.body,r=e.context.session,o=e.context.password.config.minPasswordLength;if(t.length<o)throw e.context.logger.error("Password is too short"),new le("BAD_REQUEST",{message:Re.PASSWORD_TOO_SHORT});const s=e.context.password.config.maxPasswordLength;if(t.length>s)throw e.context.logger.error("Password is too long"),new le("BAD_REQUEST",{message:Re.PASSWORD_TOO_LONG});const a=(await e.context.internalAdapter.findAccounts(r.user.id)).find(u=>u.providerId==="credential"&&u.password);if(!a||!a.password)throw new le("BAD_REQUEST",{message:Re.CREDENTIAL_ACCOUNT_NOT_FOUND});const c=await e.context.password.hash(t);if(!await e.context.password.verify({hash:a.password,password:n}))throw new le("BAD_REQUEST",{message:Re.INVALID_PASSWORD});await e.context.internalAdapter.updateAccount(a.id,{password:c});let l=null;if(i){await e.context.internalAdapter.deleteSessions(r.user.id);const u=await e.context.internalAdapter.createSession(r.user.id);if(!u)throw new le("INTERNAL_SERVER_ERROR",{message:Re.FAILED_TO_GET_SESSION});await ii(e,{session:u,user:r.user}),l=u.token}return e.json({token:l,user:Vn(e.context.options,r.user)})}),YK=Ot({method:"POST",body:ce({newPassword:W().meta({description:"The new password to set is required"})}),use:[cs]},async e=>{const{newPassword:t}=e.body,n=e.context.session,i=e.context.password.config.minPasswordLength;if(t.length<i)throw e.context.logger.error("Password is too short"),new le("BAD_REQUEST",{message:Re.PASSWORD_TOO_SHORT});const r=e.context.password.config.maxPasswordLength;if(t.length>r)throw e.context.logger.error("Password is too long"),new le("BAD_REQUEST",{message:Re.PASSWORD_TOO_LONG});const o=(await e.context.internalAdapter.findAccounts(n.user.id)).find(a=>a.providerId==="credential"&&a.password),s=await e.context.password.hash(t);if(!o)return await e.context.internalAdapter.linkAccount({userId:n.user.id,providerId:"credential",accountId:n.user.id,password:s}),e.json({status:!0});throw new le("BAD_REQUEST",{message:"user already has a password"})}),XK=Ot("/delete-user",{method:"POST",use:[cs],body:ce({callbackURL:W().meta({description:"The callback URL to redirect to after the user is deleted"}).optional(),password:W().meta({description:"The password of the user is required to delete the user"}).optional(),token:W().meta({description:"The token to delete the user is required"}).optional()}),metadata:{openapi:{operationId:"deleteUser",description:"Delete the user",requestBody:{content:{"application/json":{schema:{type:"object",properties:{callbackURL:{type:"string",description:"The callback URL to redirect to after the user is deleted"},password:{type:"string",description:"The user's password. Required if session is not fresh"},token:{type:"string",description:"The deletion verification token"}}}}}},responses:{200:{description:"User deletion processed successfully",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",description:"Indicates if the operation was successful"},message:{type:"string",enum:["User deleted","Verification email sent"],description:"Status message of the deletion process"}},required:["success","message"]}}}}}}}},async e=>{if(!e.context.options.user?.deleteUser?.enabled)throw e.context.logger.error("Delete user is disabled. Enable it in the options"),new le("NOT_FOUND");const t=e.context.session;if(e.body.password){const r=(await e.context.internalAdapter.findAccounts(t.user.id)).find(o=>o.providerId==="credential"&&o.password);if(!r||!r.password)throw new le("BAD_REQUEST",{message:Re.CREDENTIAL_ACCOUNT_NOT_FOUND});if(!await e.context.password.verify({hash:r.password,password:e.body.password}))throw new le("BAD_REQUEST",{message:Re.INVALID_PASSWORD})}if(e.body.token)return await HO({...e,query:{token:e.body.token}}),e.json({success:!0,message:"User deleted"});if(e.context.options.user.deleteUser?.sendDeleteAccountVerification){const r=yb(32,"0-9","a-z");await e.context.internalAdapter.createVerificationValue({value:t.user.id,identifier:`delete-account-${r}`,expiresAt:new Date(Date.now()+(e.context.options.user.deleteUser?.deleteTokenExpiresIn||3600*24)*1e3)});const o=`${e.context.baseURL}/delete-user/callback?token=${r}&callbackURL=${e.body.callbackURL||"/"}`;return await e.context.runInBackgroundOrAwait(e.context.options.user.deleteUser.sendDeleteAccountVerification({user:t.user,url:o,token:r},e.request)),e.json({success:!0,message:"Verification email sent"})}if(!e.body.password&&e.context.sessionConfig.freshAge!==0){const r=new Date(t.session.createdAt).getTime(),o=e.context.sessionConfig.freshAge*1e3;if(Date.now()-r>o*1e3)throw new le("BAD_REQUEST",{message:Re.SESSION_EXPIRED})}const n=e.context.options.user.deleteUser?.beforeDelete;n&&await n(t.user,e.request),await e.context.internalAdapter.deleteUser(t.user.id),await e.context.internalAdapter.deleteSessions(t.user.id),$l(e);const i=e.context.options.user.deleteUser?.afterDelete;return i&&await i(t.user,e.request),e.json({success:!0,message:"User deleted"})}),HO=Ot("/delete-user/callback",{method:"GET",query:ce({token:W().meta({description:"The token to verify the deletion request"}),callbackURL:W().meta({description:"The URL to redirect to after deletion"}).optional()}),use:[Mb(e=>e.query.callbackURL)],metadata:{openapi:{description:"Callback to complete user deletion with verification token",responses:{200:{description:"User successfully deleted",content:{"application/json":{schema:{type:"object",properties:{success:{type:"boolean",description:"Indicates if the deletion was successful"},message:{type:"string",enum:["User deleted"],description:"Confirmation message"}},required:["success","message"]}}}}}}}},async e=>{if(!e.context.options.user?.deleteUser?.enabled)throw e.context.logger.error("Delete user is disabled. Enable it in the options"),new le("NOT_FOUND");const t=await ji(e);if(!t)throw new le("NOT_FOUND",{message:Re.FAILED_TO_GET_USER_INFO});const n=await e.context.internalAdapter.findVerificationValue(`delete-account-${e.query.token}`);if(!n||n.expiresAt<new Date)throw new le("NOT_FOUND",{message:Re.INVALID_TOKEN});if(n.value!==t.user.id)throw new le("NOT_FOUND",{message:Re.INVALID_TOKEN});const i=e.context.options.user.deleteUser?.beforeDelete;i&&await i(t.user,e.request),await e.context.internalAdapter.deleteUser(t.user.id),await e.context.internalAdapter.deleteSessions(t.user.id),await e.context.internalAdapter.deleteAccounts(t.user.id),await e.context.internalAdapter.deleteVerificationValue(n.id),$l(e);const r=e.context.options.user.deleteUser?.afterDelete;if(r&&await r(t.user,e.request),e.query.callbackURL)throw e.redirect(e.query.callbackURL||"/");return e.json({success:!0,message:"User deleted"})}),eJ=Ot("/change-email",{method:"POST",body:ce({newEmail:Wi().meta({description:"The new email address to set must be a valid email address"}),callbackURL:W().meta({description:"The URL to redirect to after email verification"}).optional()}),use:[cs],metadata:{openapi:{operationId:"changeEmail",responses:{200:{description:"Email change request processed successfully",content:{"application/json":{schema:{type:"object",properties:{user:{type:"object",$ref:"#/components/schemas/User"},status:{type:"boolean",description:"Indicates if the request was successful"},message:{type:"string",enum:["Email updated","Verification email sent"],description:"Status message of the email change process",nullable:!0}},required:["status"]}}}},422:{description:"Unprocessable Entity. Email already exists",content:{"application/json":{schema:{type:"object",properties:{message:{type:"string"}}}}}}}}}},async e=>{if(!e.context.options.user?.changeEmail?.enabled)throw e.context.logger.error("Change email is disabled."),new le("BAD_REQUEST",{message:"Change email is disabled"});const t=e.body.newEmail.toLowerCase();if(t===e.context.session.user.email)throw e.context.logger.error("Email is the same"),new le("BAD_REQUEST",{message:"Email is the same"});if(await e.context.internalAdapter.findUserByEmail(t))throw e.context.logger.error("Email already exists"),new le("UNPROCESSABLE_ENTITY",{message:Re.USER_ALREADY_EXISTS_USE_ANOTHER_EMAIL});if(e.context.session.user.emailVerified!==!0&&e.context.options.user.changeEmail.updateEmailWithoutVerification){if(await e.context.internalAdapter.updateUserByEmail(e.context.session.user.email,{email:t}),await ii(e,{session:e.context.session.session,user:{...e.context.session.user,email:t}}),e.context.options.emailVerification?.sendVerificationEmail){const r=await Di(e.context.secret,t,void 0,e.context.options.emailVerification?.expiresIn),o=`${e.context.baseURL}/verify-email?token=${r}&callbackURL=${e.body.callbackURL||"/"}`;await e.context.runInBackgroundOrAwait(e.context.options.emailVerification.sendVerificationEmail({user:{...e.context.session.user,email:t},url:o,token:r},e.request))}return e.json({status:!0})}if(e.context.session.user.emailVerified&&(e.context.options.user.changeEmail.sendChangeEmailConfirmation||e.context.options.user.changeEmail.sendChangeEmailVerification)){const r=await Di(e.context.secret,e.context.session.user.email,t,e.context.options.emailVerification?.expiresIn,{requestType:"change-email-confirmation"}),o=`${e.context.baseURL}/verify-email?token=${r}&callbackURL=${e.body.callbackURL||"/"}`,s=e.context.options.user.changeEmail.sendChangeEmailConfirmation||e.context.options.user.changeEmail.sendChangeEmailVerification;return s&&await e.context.runInBackgroundOrAwait(s({user:e.context.session.user,newEmail:t,url:o,token:r},e.request)),e.json({status:!0})}if(!e.context.options.emailVerification?.sendVerificationEmail)throw e.context.logger.error("Verification email isn't enabled."),new le("BAD_REQUEST",{message:"Verification email isn't enabled"});const n=await Di(e.context.secret,e.context.session.user.email,t,e.context.options.emailVerification?.expiresIn,{requestType:"change-email-verification"}),i=`${e.context.baseURL}/verify-email?token=${n}&callbackURL=${e.body.callbackURL||"/"}`;return await e.context.runInBackgroundOrAwait(e.context.options.emailVerification.sendVerificationEmail({user:{...e.context.session.user,email:t},url:i,token:n},e.request)),e.json({status:!0})});function pg(e){if(e===null||typeof e!="object")return!1;const t=Object.getPrototypeOf(e);return t!==null&&t!==Object.prototype&&Object.getPrototypeOf(t)!==null||Symbol.iterator in e?!1:Symbol.toStringTag in e?Object.prototype.toString.call(e)==="[object Module]":!0}function xy(e,t,n=".",i){if(!pg(t))return xy(e,{},n,i);const r=Object.assign({},t);for(const o in e){if(o==="__proto__"||o==="constructor")continue;const s=e[o];s!=null&&(i&&i(r,o,s,n)||(Array.isArray(s)&&Array.isArray(r[o])?r[o]=[...s,...r[o]]:pg(s)&&pg(r[o])?r[o]=xy(s,r[o],(n?`${n}.`:"")+o.toString(),i):r[o]=s))}return r}function KO(e){return(...t)=>t.reduce((n,i)=>xy(n,i,"",e),{})}const JO=KO(),GO=KO((e,t,n)=>{if(Array.isArray(e[t])&&Array.isArray(n))return e[t]=n,!0}),ky=new WeakMap;function tJ(e,t){const n={};for(const[i,r]of Object.entries(e))n[i]=async o=>{const s=async()=>{const a=await t;let c={...o,context:{...a,returned:void 0,responseHeaders:void 0,session:null},path:r.path,headers:o?.headers?new Headers(o?.headers):void 0};return Cf(c,async()=>{const{beforeHooks:l,afterHooks:u}=iJ(a),p=await nJ(c,l);if("context"in p&&p.context&&typeof p.context=="object"){const{headers:h,...d}=p.context;h&&h.forEach((y,v)=>{c.headers.set(v,y)}),c=GO(d,c)}else if(p)return o?.asResponse?Cs(p,{headers:o?.headers}):o?.returnHeaders?{headers:o?.headers,response:p}:p;c.asResponse=!1,c.returnHeaders=!0,c.returnStatus=!0;const f=await Cf(c,()=>r(c)).catch(h=>{if(h instanceof le)return{response:h,status:h.statusCode,headers:h.headers?new Headers(h.headers):null};throw h});if(f&&f instanceof Response)return f;c.context.returned=f.response,c.context.responseHeaders=f.headers;const g=await rJ(c,u);if(g.response&&(f.response=g.response),f.response instanceof le&&Nh(a.logger.level,"debug")&&(f.response.stack=f.response.errorStack),f.response instanceof le&&!o?.asResponse)throw f.response;return o?.asResponse?Cs(f.response,{headers:f.headers,status:f.status}):o?.returnHeaders?o?.returnStatus?{headers:f.headers,response:f.response,status:f.status}:{headers:f.headers,response:f.response}:o?.returnStatus?{response:f.response,status:f.status}:f.response})};return await uV()?s():dV(new WeakMap,s)},n[i].path=r.path,n[i].options=r.options;return n}async function nJ(e,t){let n={};for(const i of t){let r=!1;try{r=i.matcher(e)}catch(o){const s=ky.get(i.handler)??"unknown";throw e.context.logger.error(`An error occurred during ${s} hook matcher execution:`,o),new le("INTERNAL_SERVER_ERROR",{message:"An error occurred during hook matcher execution. Check the logs for more details."})}if(r){const o=await i.handler({...e,returnHeaders:!1}).catch(s=>{throw s instanceof le&&Nh(e.context.logger.level,"debug")&&(s.stack=s.errorStack),s});if(o&&typeof o=="object"){if("context"in o&&typeof o.context=="object"){const{headers:s,...a}=o.context;s instanceof Headers&&(n.headers?s.forEach((c,l)=>{n.headers?.set(l,c)}):n.headers=s),n=GO(a,n);continue}return o}}}return{context:n}}async function rJ(e,t){for(const n of t)if(n.matcher(e)){const i=await n.handler(e).catch(r=>{if(r instanceof le)return Nh(e.context.logger.level,"debug")&&(r.stack=r.errorStack),{response:r,headers:r.headers?new Headers(r.headers):null};throw r});i.headers&&i.headers.forEach((r,o)=>{e.context.responseHeaders?o.toLowerCase()==="set-cookie"?e.context.responseHeaders.append(o,r):e.context.responseHeaders.set(o,r):e.context.responseHeaders=new Headers({[o]:r})}),i.response&&(e.context.returned=i.response)}return{response:e.context.returned,headers:e.context.responseHeaders}}function iJ(e){const t=e.options.plugins||[],n=[],i=[],r=e.options.hooks?.before;r&&(ky.set(r,"user"),n.push({matcher:()=>!0,handler:r}));const o=e.options.hooks?.after;o&&(ky.set(o,"user"),i.push({matcher:()=>!0,handler:o}));const s=t.filter(c=>c.hooks?.before).map(c=>c.hooks?.before).flat(),a=t.filter(c=>c.hooks?.after).map(c=>c.hooks?.after).flat();return s.length&&n.push(...s),a.length&&i.push(...a),{beforeHooks:n,afterHooks:i}}function oJ(e,t){const n=new Map;e.plugins?.forEach(r=>{if(r.endpoints){for(const[o,s]of Object.entries(r.endpoints))if(s&&"path"in s&&typeof s.path=="string"){const a=s.path;let c=[];s.options&&"method"in s.options&&(Array.isArray(s.options.method)?c=s.options.method:typeof s.options.method=="string"&&(c=[s.options.method])),c.length===0&&(c=["*"]),n.has(a)||n.set(a,[]),n.get(a).push({pluginId:r.id,endpointKey:o,methods:c})}}});const i=[];for(const[r,o]of n.entries())if(o.length>1){const s=new Map;let a=!1;for(const c of o)for(const l of c.methods)s.has(l)||s.set(l,[]),s.get(l).push(c.pluginId),s.get(l).length>1&&(a=!0),(l==="*"&&o.length>1||l!=="*"&&s.has("*"))&&(a=!0);if(a){const c=[...new Set(o.map(u=>u.pluginId))],l=[];for(const[u,p]of s.entries())(p.length>1||u==="*"&&o.length>1||u!=="*"&&s.has("*"))&&l.push(u);i.push({path:r,plugins:c,conflictingMethods:l})}}if(i.length>0){const r=i.map(o=>`  - "${o.path}" [${o.conflictingMethods.join(", ")}] used by plugins: ${o.plugins.join(", ")}`).join(`
`);t.error(`Endpoint path conflicts detected! Multiple plugins are trying to use the same endpoint paths with conflicting HTTP methods:
${r}

To resolve this, you can:
	1. Use only one of the conflicting plugins
	2. Configure the plugins to use different paths (if supported)
	3. Ensure plugins use different HTTP methods for the same path
`)}}function ZO(e,t){const n=t.plugins?.reduce((r,o)=>({...r,...o.endpoints}),{})??{},i=t.plugins?.map(r=>r.middlewares?.map(o=>{const s=(async a=>{const c=await e;return o.middleware({...a,context:{...c,...a.context}})});return s.options=o.middleware.options,{path:o.path,middleware:s}})).filter(r=>r!==void 0).flat()||[];return{api:tJ({signInSocial:VK(),callbackOAuth:OK,getSession:UO(),signOut:HK,signUpEmail:JK(),signInEmail:qK(),resetPassword:BK,verifyPassword:FK,verifyEmail:CK,sendVerificationEmail:$K,changeEmail:eJ,changePassword:QK,setPassword:YK,updateUser:ZK(),deleteUser:XK,requestPasswordReset:jK,requestPasswordResetCallback:zK,listSessions:pH(),revokeSession:hH,revokeSessions:mH,revokeOtherSessions:gH,linkSocialAccount:EK,listUserAccounts:kK,deleteUserCallback:HO,unlinkAccount:AK,refreshToken:TK,getAccessToken:WO,accountInfo:NK,...n,ok:DK,error:PK},e),middlewares:i}}const sJ=(e,t)=>{const{api:n,middlewares:i}=ZO(e,t),r=new URL(e.baseURL).pathname;return zW(n,{routerContext:e,openapi:{disabled:!0},basePath:r,routerMiddleware:[{path:"/**",middleware:xV},...i],allowedMediaTypes:["application/json"],skipTrailingSlashes:t.advanced?.skipTrailingSlashes??!1,async onRequest(o){const s=e.options.disabledPaths||[],a=Eb(o.url,r);if(s.includes(a))return new Response("Not Found",{status:404});let c=o;for(const u of e.options.plugins||[])if(u.onRequest){const p=await u.onRequest(c,e);if(p&&"response"in p)return p.response;p&&"request"in p&&(c=p.request)}const l=await $V(c,e);return l||c},async onResponse(o){for(const s of e.options.plugins||[])if(s.onResponse){const a=await s.onResponse(o,e);if(a)return a.response}return o},onError(o){if(o instanceof le&&o.status==="FOUND")return;if(t.onAPIError?.throw)throw o;if(t.onAPIError?.onError){t.onAPIError.onError(o,e);return}const s=t.logger?.level,a=s==="error"||s==="warn"||s==="debug"?Qe:void 0;if(t.logger?.disabled!==!0){if(o&&typeof o=="object"&&"message"in o&&typeof o.message=="string"&&(o.message.includes("no column")||o.message.includes("column")||o.message.includes("relation")||o.message.includes("table")||o.message.includes("does not exist"))){e.logger?.error(o.message);return}o instanceof le?(o.status==="INTERNAL_SERVER_ERROR"&&e.logger.error(o.status,o),a?.error(o.message)):e.logger?.error(o&&typeof o=="object"&&"name"in o?o.name:"",o)}}})},QO="better-auth-secret-12345678901234567890";async function aJ(e){let t=e.options;const n=t.plugins||[];let i=e;const r=[];for(const o of n)if(o.init){const s=o.init(i);let a;if(Ob(s)?a=await s:a=s,typeof a=="object"){if(a.options){const{databaseHooks:c,...l}=a.options;c&&r.push(c),t=JO(t,l)}a.context&&(i={...i,...a.context})}}return r.push(t.databaseHooks),i.internalAdapter=jb(i.adapter,{options:t,logger:i.logger,hooks:r.filter(o=>o!==void 0),generateId:i.generateId}),i.options=t,{context:i}}function cJ(e){const t=[];return e.advanced?.crossSubDomainCookies?.enabled,t}async function YO(e,t){const n=Lb(e.baseURL,e.basePath,t),i=n?[new URL(n).origin]:[];if(e.trustedOrigins&&(Array.isArray(e.trustedOrigins)&&i.push(...e.trustedOrigins),typeof e.trustedOrigins=="function")){const o=await e.trustedOrigins(t);i.push(...o)}const r=qt.BETTER_AUTH_TRUSTED_ORIGINS;return r&&i.push(...r.split(",")),i.filter(o=>!!o)}function lJ(e,t){return{database:t?.database,adapter:t?.adapter,emailVerification:{sendVerificationEmail:!!e.emailVerification?.sendVerificationEmail,sendOnSignUp:!!e.emailVerification?.sendOnSignUp,sendOnSignIn:!!e.emailVerification?.sendOnSignIn,autoSignInAfterVerification:!!e.emailVerification?.autoSignInAfterVerification,expiresIn:e.emailVerification?.expiresIn,onEmailVerification:!!e.emailVerification?.onEmailVerification,afterEmailVerification:!!e.emailVerification?.afterEmailVerification},emailAndPassword:{enabled:!!e.emailAndPassword?.enabled,disableSignUp:!!e.emailAndPassword?.disableSignUp,requireEmailVerification:!!e.emailAndPassword?.requireEmailVerification,maxPasswordLength:e.emailAndPassword?.maxPasswordLength,minPasswordLength:e.emailAndPassword?.minPasswordLength,sendResetPassword:!!e.emailAndPassword?.sendResetPassword,resetPasswordTokenExpiresIn:e.emailAndPassword?.resetPasswordTokenExpiresIn,onPasswordReset:!!e.emailAndPassword?.onPasswordReset,password:{hash:!!e.emailAndPassword?.password?.hash,verify:!!e.emailAndPassword?.password?.verify},autoSignIn:!!e.emailAndPassword?.autoSignIn,revokeSessionsOnPasswordReset:!!e.emailAndPassword?.revokeSessionsOnPasswordReset},socialProviders:Object.keys(e.socialProviders||{}).map(n=>{const i=e.socialProviders?.[n];return i?{id:n,mapProfileToUser:!!i.mapProfileToUser,disableDefaultScope:!!i.disableDefaultScope,disableIdTokenSignIn:!!i.disableIdTokenSignIn,disableImplicitSignUp:i.disableImplicitSignUp,disableSignUp:i.disableSignUp,getUserInfo:!!i.getUserInfo,overrideUserInfoOnSignIn:!!i.overrideUserInfoOnSignIn,prompt:i.prompt,verifyIdToken:!!i.verifyIdToken,scope:i.scope,refreshAccessToken:!!i.refreshAccessToken}:{}}),plugins:e.plugins?.map(n=>n.id.toString()),user:{modelName:e.user?.modelName,fields:e.user?.fields,additionalFields:e.user?.additionalFields,changeEmail:{enabled:e.user?.changeEmail?.enabled,sendChangeEmailVerification:!!e.user?.changeEmail?.sendChangeEmailVerification}},verification:{modelName:e.verification?.modelName,disableCleanup:e.verification?.disableCleanup,fields:e.verification?.fields},session:{modelName:e.session?.modelName,additionalFields:e.session?.additionalFields,cookieCache:{enabled:e.session?.cookieCache?.enabled,maxAge:e.session?.cookieCache?.maxAge,strategy:e.session?.cookieCache?.strategy},disableSessionRefresh:e.session?.disableSessionRefresh,expiresIn:e.session?.expiresIn,fields:e.session?.fields,freshAge:e.session?.freshAge,preserveSessionInDatabase:e.session?.preserveSessionInDatabase,storeSessionInDatabase:e.session?.storeSessionInDatabase,updateAge:e.session?.updateAge},account:{modelName:e.account?.modelName,fields:e.account?.fields,encryptOAuthTokens:e.account?.encryptOAuthTokens,updateAccountOnSignIn:e.account?.updateAccountOnSignIn,accountLinking:{enabled:e.account?.accountLinking?.enabled,trustedProviders:e.account?.accountLinking?.trustedProviders,updateUserInfoOnLink:e.account?.accountLinking?.updateUserInfoOnLink,allowUnlinkingAll:e.account?.accountLinking?.allowUnlinkingAll}},hooks:{after:!!e.hooks?.after,before:!!e.hooks?.before},secondaryStorage:!!e.secondaryStorage,advanced:{cookiePrefix:!!e.advanced?.cookiePrefix,cookies:!!e.advanced?.cookies,crossSubDomainCookies:{domain:!!e.advanced?.crossSubDomainCookies?.domain,enabled:e.advanced?.crossSubDomainCookies?.enabled,additionalCookies:e.advanced?.crossSubDomainCookies?.additionalCookies},database:{useNumberId:!!e.advanced?.database?.useNumberId||e.advanced?.database?.generateId==="serial",generateId:e.advanced?.database?.generateId,defaultFindManyLimit:e.advanced?.database?.defaultFindManyLimit},useSecureCookies:e.advanced?.useSecureCookies,ipAddress:{disableIpTracking:e.advanced?.ipAddress?.disableIpTracking,ipAddressHeaders:e.advanced?.ipAddress?.ipAddressHeaders},disableCSRFCheck:e.advanced?.disableCSRFCheck,cookieAttributes:{expires:e.advanced?.defaultCookieAttributes?.expires,secure:e.advanced?.defaultCookieAttributes?.secure,sameSite:e.advanced?.defaultCookieAttributes?.sameSite,domain:!!e.advanced?.defaultCookieAttributes?.domain,path:e.advanced?.defaultCookieAttributes?.path,httpOnly:e.advanced?.defaultCookieAttributes?.httpOnly}},trustedOrigins:e.trustedOrigins?.length,rateLimit:{storage:e.rateLimit?.storage,modelName:e.rateLimit?.modelName,window:e.rateLimit?.window,customStorage:!!e.rateLimit?.customStorage,enabled:e.rateLimit?.enabled,max:e.rateLimit?.max},onAPIError:{errorURL:e.onAPIError?.errorURL,onError:!!e.onAPIError?.onError,throw:e.onAPIError?.throw},logger:{disabled:e.logger?.disabled,level:e.logger?.level,log:!!e.logger?.log},databaseHooks:{user:{create:{after:!!e.databaseHooks?.user?.create?.after,before:!!e.databaseHooks?.user?.create?.before},update:{after:!!e.databaseHooks?.user?.update?.after,before:!!e.databaseHooks?.user?.update?.before}},session:{create:{after:!!e.databaseHooks?.session?.create?.after,before:!!e.databaseHooks?.session?.create?.before},update:{after:!!e.databaseHooks?.session?.update?.after,before:!!e.databaseHooks?.session?.update?.before}},account:{create:{after:!!e.databaseHooks?.account?.create?.after,before:!!e.databaseHooks?.account?.create?.before},update:{after:!!e.databaseHooks?.account?.update?.after,before:!!e.databaseHooks?.account?.update?.before}},verification:{create:{after:!!e.databaseHooks?.verification?.create?.after,before:!!e.databaseHooks?.verification?.create?.before},update:{after:!!e.databaseHooks?.verification?.update?.after,before:!!e.databaseHooks?.verification?.update?.before}}}}}let Ko;async function XO(){if(Ko)return Ko;try{const e=typeof process<"u"&&typeof process.cwd=="function"?process.cwd():"";if(!e)return;const t=o=>Function("mm","return import(mm)")(o),[{default:n},{default:i}]=await Promise.all([t("fs/promises"),t("path")]),r=await n.readFile(i.join(e,"package.json"),"utf-8");return Ko=JSON.parse(r),Ko}catch{}}async function eR(e){if(Ko)return Ko.dependencies?.[e]||Ko.devDependencies?.[e]||Ko.peerDependencies?.[e];try{const t=typeof process<"u"&&typeof process.cwd=="function"?process.cwd():"";if(!t)throw new Error("no-cwd");const n=a=>Function("mm","return import(mm)")(a),[{default:i},{default:r}]=await Promise.all([n("fs/promises"),n("path")]),o=r.join(t,"node_modules",e,"package.json"),s=await i.readFile(o,"utf-8");return JSON.parse(s).version||await jx(e)||void 0}catch{}return await jx(e)}async function jx(e){const t=await XO();if(t)return{...t.dependencies,...t.devDependencies,...t.peerDependencies}[e]}async function uJ(){return(await XO())?.name}const dJ={pg:"postgresql",mysql:"mysql",mariadb:"mariadb",sqlite3:"sqlite","better-sqlite3":"sqlite","@prisma/client":"prisma",mongoose:"mongodb",mongodb:"mongodb","drizzle-orm":"drizzle"};async function fJ(){for(const[e,t]of Object.entries(dJ)){const n=await eR(e);if(n)return{name:t,version:n}}}const pJ={next:"next",nuxt:"nuxt","@remix-run/server-runtime":"remix",astro:"astro","@sveltejs/kit":"sveltekit","solid-start":"solid-start","tanstack-start":"tanstack-start",hono:"hono",express:"express",elysia:"elysia",expo:"expo"};async function hJ(){for(const[e,t]of Object.entries(pJ)){const n=await eR(e);if(n)return{name:t,version:n}}}function mJ(){const e=qt.npm_config_user_agent;if(!e)return;const t=e.split(" ")[0],n=t.lastIndexOf("/"),i=t.substring(0,n);return{name:i==="npminstall"?"cnpm":i,version:t.substring(n+1)}}const Xa=e=>Function("mm","return import(mm)")(e);function Vs(){const e=(...t)=>t.some(n=>!!qt[n]);return e("CF_PAGES","CF_PAGES_URL","CF_ACCOUNT_ID")||typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"?"cloudflare":e("VERCEL","VERCEL_URL","VERCEL_ENV")?"vercel":e("NETLIFY","NETLIFY_URL")?"netlify":e("RENDER","RENDER_URL","RENDER_INTERNAL_HOSTNAME","RENDER_SERVICE_ID")?"render":e("AWS_LAMBDA_FUNCTION_NAME","AWS_EXECUTION_ENV","LAMBDA_TASK_ROOT")?"aws":e("GOOGLE_CLOUD_FUNCTION_NAME","GOOGLE_CLOUD_PROJECT","GCP_PROJECT","K_SERVICE")?"gcp":e("AZURE_FUNCTION_NAME","FUNCTIONS_WORKER_RUNTIME","WEBSITE_INSTANCE_ID","WEBSITE_SITE_NAME")?"azure":e("DENO_DEPLOYMENT_ID","DENO_REGION")?"deno-deploy":e("FLY_APP_NAME","FLY_REGION","FLY_ALLOC_ID")?"fly-io":e("RAILWAY_STATIC_URL","RAILWAY_ENVIRONMENT_NAME")?"railway":e("DYNO","HEROKU_APP_NAME")?"heroku":e("DO_DEPLOYMENT_ID","DO_APP_NAME","DIGITALOCEAN")?"digitalocean":e("KOYEB","KOYEB_DEPLOYMENT_ID","KOYEB_APP_NAME")?"koyeb":null}async function gJ(){try{if(Vs()==="cloudflare")return"cloudflare";const e=await Xa("os"),t=e.cpus();return{deploymentVendor:Vs(),systemPlatform:e.platform(),systemRelease:e.release(),systemArchitecture:e.arch(),cpuCount:t.length,cpuModel:t.length?t[0].model:null,cpuSpeed:t.length?t[0].speed:null,memory:e.totalmem(),isWSL:await vJ(),isDocker:await tR(),isTTY:typeof process<"u"&&process.stdout?process.stdout.isTTY:null}}catch{return{systemPlatform:null,systemRelease:null,systemArchitecture:null,cpuCount:null,cpuModel:null,cpuSpeed:null,memory:null,isWSL:null,isDocker:null,isTTY:null}}}let hg;async function yJ(){if(Vs()==="cloudflare")return!1;try{return(await Xa("fs")).statSync("/.dockerenv"),!0}catch{return!1}}async function wJ(){if(Vs()==="cloudflare")return!1;try{return(await Xa("fs")).readFileSync("/proc/self/cgroup","utf8").includes("docker")}catch{return!1}}async function tR(){return Vs()==="cloudflare"?!1:(hg===void 0&&(hg=await yJ()||await wJ()),hg)}async function vJ(){try{if(Vs()==="cloudflare"||typeof process>"u"||process?.platform!=="linux")return!1;const e=await Xa("fs");return(await Xa("os")).release().toLowerCase().includes("microsoft")?!await zx():e.readFileSync("/proc/version","utf8").toLowerCase().includes("microsoft")?!await zx():!1}catch{return!1}}let mg;const bJ=async()=>{if(Vs()==="cloudflare")return!1;try{return(await Xa("fs")).statSync("/run/.containerenv"),!0}catch{return!1}};async function zx(){return mg===void 0&&(mg=await bJ()||await tR()),mg}function _J(){return qt.CI!=="false"&&("BUILD_ID"in qt||"BUILD_NUMBER"in qt||"CI"in qt||"CI_APP_ID"in qt||"CI_BUILD_ID"in qt||"CI_BUILD_NUMBER"in qt||"CI_NAME"in qt||"CONTINUOUS_INTEGRATION"in qt||"RUN_ID"in qt)}function SJ(){return typeof Deno<"u"?{name:"deno",version:Deno?.version?.deno??null}:typeof Bun<"u"?{name:"bun",version:Bun?.version??null}:typeof process<"u"&&process?.versions?.node?{name:"node",version:process.versions.node??null}:{name:"edge",version:null}}function xJ(){return Pt("NODE_ENV")==="production"?"production":_J()?"ci":zu()?"test":"development"}async function Bx(e){const t=await Ab("SHA-256").digest(e);return bo.encode(t)}const kJ=e=>gb("a-z","A-Z","0-9")(e);let Do=null;async function Fx(e){if(Do)return Do;const t=await uJ();return t?(Do=await Bx(e?e+t:t),Do):e?(Do=await Bx(e),Do):(Do=kJ(32),Do)}const EJ=async function(){};async function AJ(e,t){const n=e.telemetry?.debug||zS("BETTER_AUTH_TELEMETRY_DEBUG",!1),i=bF.BETTER_AUTH_TELEMETRY_ENDPOINT;if(!i&&!t?.customTrack)return{publish:EJ};const r=async c=>{t?.customTrack?await t.customTrack(c).catch(Qe.error):i&&(n?Qe.info("telemetry event",JSON.stringify(c,null,2)):await rt(i,{method:"POST",body:c}).catch(Qe.error))},s=await(async()=>{const c=e.telemetry?.enabled!==void 0?e.telemetry.enabled:!1;return(zS("BETTER_AUTH_TELEMETRY",!1)||c)&&(t?.skipTestCheck||!zu())})();let a;return s&&(a=await Fx(e.baseURL),r({type:"init",payload:{config:lJ(e,t),runtime:SJ(),database:await fJ(),framework:await hJ(),environment:xJ(),systemInfo:await gJ(),packageManager:mJ()},anonymousId:a})),{publish:async c=>{s&&(a||(a=await Fx(e.baseURL)),await r({type:c.type,payload:c.payload,anonymousId:a}))}}}function TJ(e){const t=new Set(e).size;return t===0?0:Math.log2(Math.pow(t,e.length))}function IJ(e,t){const n=e===QO;if(!zu()){if(n&&Ih)throw new Fe("You are using the default secret. Please set `BETTER_AUTH_SECRET` in your environment variables or pass `secret` in your auth config.");e.length<32&&t.warn("[better-auth] Warning: your BETTER_AUTH_SECRET should be at least 32 characters long for adequate security. Generate one with `npx @better-auth/cli secret` or `openssl rand -base64 32`."),TJ(e)<120&&t.warn("[better-auth] Warning: your BETTER_AUTH_SECRET appears low-entropy. Use a randomly generated secret for production.")}}async function NJ(e,t,n){t.database||(t=JO(t,{session:{cookieCache:{enabled:!0,strategy:"jwe",refreshCache:!0}},account:{storeStateStrategy:"cookie",storeAccountCookie:!0}}));const i=t.plugins||[],r=cJ(t),o=Tl(t.logger),s=Lb(t.baseURL,t.basePath);s||o.warn("[better-auth] Base URL could not be determined. Please set a valid base URL using the baseURL config option or the BETTER_AUTH_BASE_URL environment variable. Without this, callbacks and redirects may not work correctly."),e.id==="memory"&&t.advanced?.database?.generateId===!1&&o.error(`[better-auth] Misconfiguration detected.
You are using the memory DB with generateId: false.
This will cause no id to be generated for any model.
Most of the features of Better Auth will not work correctly.`);const a=t.secret||qt.BETTER_AUTH_SECRET||qt.AUTH_SECRET||QO;IJ(a,o),t={...t,secret:a,baseURL:s?new URL(s).origin:"",basePath:t.basePath||"/api/auth",plugins:i.concat(r)},oJ(t,o);const c=iV(t),l=ts(t),u=Object.entries(t.socialProviders||{}).map(([y,v])=>{if(v==null||v.enabled===!1)return null;v.clientId||o.warn(`Social provider ${y} is missing clientId or clientSecret`);const x=BO[y](v);return x.disableImplicitSignUp=v.disableImplicitSignUp,x}).filter(y=>y!==null),p=({model:y,size:v})=>{if(typeof t.advanced?.generateId=="function")return t.advanced.generateId({model:y,size:v});const x=t?.advanced?.database?.generateId;return typeof x=="function"?x({model:y,size:v}):x==="uuid"?crypto.randomUUID():x==="serial"||x===!1?!1:Al(v)},{publish:f}=await AJ(t,{adapter:e.id,database:typeof t.database=="function"?"adapter":n(t.database)}),g=await YO(t),h=aJ({appName:t.appName||"Better Auth",baseURL:s||"",version:cV(),socialProviders:u,options:t,oauthConfig:{storeStateStrategy:t.account?.storeStateStrategy||(t.database?"database":"cookie"),skipStateCookieCheck:!!t.account?.skipStateCookieCheck},tables:l,trustedOrigins:g,isTrustedOrigin(y,v){return this.trustedOrigins.some(x=>NC(y,x,v))},sessionConfig:{updateAge:t.session?.updateAge!==void 0?t.session.updateAge:1440*60,expiresIn:t.session?.expiresIn||3600*24*7,freshAge:t.session?.freshAge===void 0?3600*24:t.session.freshAge,cookieRefreshCache:(()=>{const y=t.session?.cookieCache?.refreshCache,v=t.session?.cookieCache?.maxAge||300;return(t.database||t.secondaryStorage)&&y?(o.warn("[better-auth] `session.cookieCache.refreshCache` is enabled while `database` or `secondaryStorage` is configured. `refreshCache` is meant for stateless (DB-less) setups. Disabling `refreshCache`  remove it from your config to silence this warning."),!1):y===!1||y===void 0?!1:y===!0?{enabled:!0,updateAge:Math.floor(v*.2)}:{enabled:!0,updateAge:y.updateAge!==void 0?y.updateAge:Math.floor(v*.2)}})()},secret:a,rateLimit:{...t.rateLimit,enabled:t.rateLimit?.enabled??Ih,window:t.rateLimit?.window||10,max:t.rateLimit?.max||100,storage:t.rateLimit?.storage||(t.secondaryStorage?"secondary-storage":"memory")},authCookies:c,logger:o,generateId:p,session:null,secondaryStorage:t.secondaryStorage,password:{hash:t.emailAndPassword?.password?.hash||CF,verify:t.emailAndPassword?.password?.verify||OF,config:{minPasswordLength:t.emailAndPassword?.minPasswordLength||8,maxPasswordLength:t.emailAndPassword?.maxPasswordLength||128},checkPassword:LK},setNewSession(y){this.newSession=y},newSession:null,adapter:e,internalAdapter:jb(e,{options:t,logger:o,hooks:t.databaseHooks?[t.databaseHooks]:[],generateId:p}),createAuthCookie:SC(t),async runMigrations(){throw new Fe("runMigrations will be set by the specific init implementation")},publishTelemetry:f,skipCSRFCheck:!!t.advanced?.disableCSRFCheck,skipOriginCheck:t.advanced?.disableOriginCheck!==void 0?t.advanced.disableOriginCheck:!!zu(),runInBackground:t.advanced?.backgroundTasks?.handler??(y=>{y.catch(()=>{})}),async runInBackgroundOrAwait(y){try{t.advanced?.backgroundTasks?.handler?y instanceof Promise&&t.advanced.backgroundTasks.handler(y.catch(v=>{o.error("Failed to run background task:",v)})):await y}catch(v){o.error("Failed to run background task:",v)}},getPlugin:y=>t.plugins.find(v=>v.id===y)??null});let d;return Ob(h)?{context:d}=await h:{context:d}=h,typeof d.options.emailVerification?.onEmailVerification=="function"&&(d.options.emailVerification.onEmailVerification=H$(d.options.emailVerification.onEmailVerification,"Use `afterEmailVerification` instead. This will be removed in 1.5",d.logger)),d}const $J=async e=>{const t=await DC(e),i=await NJ(t,e,r=>t0(r)||"unknown");return i.runMigrations=async function(){if(!e.database||"updateMany"in e.database)throw new Fe("Database is not provided or it's an adapter. Migrations are only supported with a database instance.");const{runMigrations:r}=await PO(e);await r()},i},CJ=(e,t)=>{const n=t(e),{api:i}=ZO(n,e);return{handler:async r=>{const o=await n,s=o.options.basePath||"/api/auth";if(!o.options.baseURL){const c=Lb(void 0,s,r,void 0,o.options.advanced?.trustedProxyHeaders);if(c)o.baseURL=c,o.options.baseURL=Of(o.baseURL)||void 0;else throw new Fe("Could not get base URL from request. Please provide a valid base URL.")}o.trustedOrigins=await YO(o.options,r);const{handler:a}=sJ(o,e);return pV(o.adapter,()=>a(r))},api:i,options:e,$context:n,$ERROR_CODES:{...e.plugins?.reduce((r,o)=>o.$ERROR_CODES?{...r,...o.$ERROR_CODES}:r,{}),...Re}}},OJ=e=>CJ(e,$J),ie=Symbol.for("drizzle:entityKind");function me(e,t){if(!e||typeof e!="object")return!1;if(e instanceof t)return!0;if(!Object.prototype.hasOwnProperty.call(t,ie))throw new Error(`Class "${t.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let n=e.constructor;if(n)for(;n;){if(ie in n&&n[ie]===t[ie])return!0;n=Object.getPrototypeOf(n)}return!1}class qn{constructor(t,n){this.table=t,this.config=n,this.name=n.name,this.keyAsName=n.keyAsName,this.notNull=n.notNull,this.default=n.default,this.defaultFn=n.defaultFn,this.onUpdateFn=n.onUpdateFn,this.hasDefault=n.hasDefault,this.primary=n.primaryKey,this.isUnique=n.isUnique,this.uniqueName=n.uniqueName,this.uniqueType=n.uniqueType,this.dataType=n.dataType,this.columnType=n.columnType,this.generated=n.generated,this.generatedIdentity=n.generatedIdentity}static[ie]="Column";name;keyAsName;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;config;mapFromDriverValue(t){return t}mapToDriverValue(t){return t}shouldDisableInsert(){return this.config.generated!==void 0&&this.config.generated.type!=="byDefault"}}class RJ{static[ie]="ColumnBuilder";config;constructor(t,n,i){this.config={name:t,keyAsName:t==="",notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:n,columnType:i,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(t){return this.config.default=t,this.config.hasDefault=!0,this}$defaultFn(t){return this.config.defaultFn=t,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(t){return this.config.onUpdateFn=t,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(t){this.config.name===""&&(this.config.name=t)}}const Qo=Symbol.for("drizzle:Name");class nR{static[ie]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(t,n){this.reference=()=>{const{name:i,columns:r,foreignColumns:o}=t();return{name:i,columns:r,foreignTable:o[0].table,foreignColumns:o}},n&&(this._onUpdate=n.onUpdate,this._onDelete=n.onDelete)}onUpdate(t){return this._onUpdate=t===void 0?"no action":t,this}onDelete(t){return this._onDelete=t===void 0?"no action":t,this}build(t){return new PJ(t,this)}}class PJ{constructor(t,n){this.table=t,this.reference=n.reference,this.onUpdate=n._onUpdate,this.onDelete=n._onDelete}static[ie]="PgForeignKey";reference;onUpdate;onDelete;getName(){const{name:t,columns:n,foreignColumns:i}=this.reference(),r=n.map(a=>a.name),o=i.map(a=>a.name),s=[this.table[Qo],...r,i[0].table[Qo],...o];return t??`${s.join("_")}_fk`}}function DJ(e){function t(){const{name:n,columns:i,foreignColumns:r}=e;return{name:n,columns:i,foreignColumns:r}}return new nR(t)}function UJ(e,...t){return e(...t)}function LJ(e,t){return`${e[Qo]}_${t.join("_")}_unique`}function Wx(e,t,n){for(let i=t;i<e.length;i++){const r=e[i];if(r==="\\"){i++;continue}if(r==='"')return[e.slice(t,i).replace(/\\/g,""),i+1];if(!n&&(r===","||r==="}"))return[e.slice(t,i).replace(/\\/g,""),i]}return[e.slice(t).replace(/\\/g,""),e.length]}function rR(e,t=0){const n=[];let i=t,r=!1;for(;i<e.length;){const o=e[i];if(o===","){(r||i===t)&&n.push(""),r=!0,i++;continue}if(r=!1,o==="\\"){i+=2;continue}if(o==='"'){const[c,l]=Wx(e,i+1,!0);n.push(c),i=l;continue}if(o==="}")return[n,i+1];if(o==="{"){const[c,l]=rR(e,i+1);n.push(c),i=l;continue}const[s,a]=Wx(e,i,!1);n.push(s),i=a}return[n,i]}function MJ(e){const[t]=rR(e,1);return t}function iR(e){return`{${e.map(t=>Array.isArray(t)?iR(t):typeof t=="string"?`"${t.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${t}`).join(",")}}`}class xt extends RJ{foreignKeyConfigs=[];static[ie]="PgColumnBuilder";array(t){return new zJ(this.config.name,this,t)}references(t,n={}){return this.foreignKeyConfigs.push({ref:t,actions:n}),this}unique(t,n){return this.config.isUnique=!0,this.config.uniqueName=t,this.config.uniqueType=n?.nulls,this}generatedAlwaysAs(t){return this.config.generated={as:t,type:"always",mode:"stored"},this}buildForeignKeys(t,n){return this.foreignKeyConfigs.map(({ref:i,actions:r})=>UJ((o,s)=>{const a=new nR(()=>{const c=o();return{columns:[t],foreignColumns:[c]}});return s.onUpdate&&a.onUpdate(s.onUpdate),s.onDelete&&a.onDelete(s.onDelete),a.build(n)},i,r))}buildExtraConfigColumn(t){return new jJ(t,this.config)}}class Ye extends qn{constructor(t,n){n.uniqueName||(n.uniqueName=LJ(t,[n.name])),super(t,n),this.table=t}static[ie]="PgColumn"}class jJ extends Ye{static[ie]="ExtraConfigColumn";getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(t){return this.indexConfig.opClass=t,this}}class gg{static[ie]="IndexedColumn";constructor(t,n,i,r){this.name=t,this.keyAsName=n,this.type=i,this.indexConfig=r}name;keyAsName;type;indexConfig}class zJ extends xt{static[ie]="PgArrayBuilder";constructor(t,n,i){super(t,"array","PgArray"),this.config.baseBuilder=n,this.config.size=i}build(t){const n=this.config.baseBuilder.build(t);return new i0(t,this.config,n)}}class i0 extends Ye{constructor(t,n,i,r){super(t,n),this.baseColumn=i,this.range=r,this.size=n.size}size;static[ie]="PgArray";getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size=="number"?this.size:""}]`}mapFromDriverValue(t){return typeof t=="string"&&(t=MJ(t)),t.map(n=>this.baseColumn.mapFromDriverValue(n))}mapToDriverValue(t,n=!1){const i=t.map(r=>r===null?null:me(this.baseColumn,i0)?this.baseColumn.mapToDriverValue(r,!0):this.baseColumn.mapToDriverValue(r));return n?i:iR(i)}}const Vx=Symbol.for("drizzle:isPgEnum");function BJ(e){return!!e&&typeof e=="function"&&Vx in e&&e[Vx]===!0}class bi{static[ie]="Subquery";constructor(t,n,i,r=!1){this._={brand:"Subquery",sql:t,selectedFields:n,alias:i,isWith:r}}}class oR extends bi{static[ie]="WithSubquery"}const Wr={startActiveSpan(e,t){return t()}},Kn=Symbol.for("drizzle:ViewBaseConfig"),Zd=Symbol.for("drizzle:Schema"),qx=Symbol.for("drizzle:Columns"),Hx=Symbol.for("drizzle:ExtraConfigColumns"),yg=Symbol.for("drizzle:OriginalName"),wg=Symbol.for("drizzle:BaseName"),Kx=Symbol.for("drizzle:IsAlias"),Jx=Symbol.for("drizzle:ExtraConfigBuilder"),FJ=Symbol.for("drizzle:IsDrizzleTable");class De{static[ie]="Table";static Symbol={Name:Qo,Schema:Zd,OriginalName:yg,Columns:qx,ExtraConfigColumns:Hx,BaseName:wg,IsAlias:Kx,ExtraConfigBuilder:Jx};[Qo];[yg];[Zd];[qx];[Hx];[wg];[Kx]=!1;[FJ]=!0;[Jx]=void 0;constructor(t,n,i){this[Qo]=this[yg]=t,this[Zd]=n,this[wg]=i}}function Na(e){return e[Qo]}function Dl(e){return`${e[Zd]??"public"}.${e[Qo]}`}function sR(e){return e!=null&&typeof e.getSQL=="function"}function WJ(e){const t={sql:"",params:[]};for(const n of e)t.sql+=n.sql,t.params.push(...n.params),n.typings?.length&&(t.typings||(t.typings=[]),t.typings.push(...n.typings));return t}class Wn{static[ie]="StringChunk";value;constructor(t){this.value=Array.isArray(t)?t:[t]}getSQL(){return new je([this])}}class je{constructor(t){this.queryChunks=t}static[ie]="SQL";decoder=aR;shouldInlineParams=!1;append(t){return this.queryChunks.push(...t.queryChunks),this}toQuery(t){return Wr.startActiveSpan("drizzle.buildSQL",n=>{const i=this.buildQueryFromSourceParams(this.queryChunks,t);return n?.setAttributes({"drizzle.query.text":i.sql,"drizzle.query.params":JSON.stringify(i.params)}),i})}buildQueryFromSourceParams(t,n){const i=Object.assign({},n,{inlineParams:n.inlineParams||this.shouldInlineParams,paramStartIndex:n.paramStartIndex||{value:0}}),{casing:r,escapeName:o,escapeParam:s,prepareTyping:a,inlineParams:c,paramStartIndex:l}=i;return WJ(t.map(u=>{if(me(u,Wn))return{sql:u.value.join(""),params:[]};if(me(u,Ey))return{sql:o(u.value),params:[]};if(u===void 0)return{sql:"",params:[]};if(Array.isArray(u)){const p=[new Wn("(")];for(const[f,g]of u.entries())p.push(g),f<u.length-1&&p.push(new Wn(", "));return p.push(new Wn(")")),this.buildQueryFromSourceParams(p,i)}if(me(u,je))return this.buildQueryFromSourceParams(u.queryChunks,{...i,inlineParams:c||u.shouldInlineParams});if(me(u,De)){const p=u[De.Symbol.Schema],f=u[De.Symbol.Name];return{sql:p===void 0?o(f):o(p)+"."+o(f),params:[]}}if(me(u,qn)){const p=r.getColumnCasing(u);return n.invokeSource==="indexes"?{sql:o(p),params:[]}:{sql:o(u.table[De.Symbol.Name])+"."+o(p),params:[]}}if(me(u,na)){const p=u[Kn].schema,f=u[Kn].name;return{sql:p===void 0?o(f):o(p)+"."+o(f),params:[]}}if(me(u,is)){if(me(u.value,ec))return{sql:s(l.value++,u),params:[u],typings:["none"]};const p=u.value===null?null:u.encoder.mapToDriverValue(u.value);if(me(p,je))return this.buildQueryFromSourceParams([p],i);if(c)return{sql:this.mapInlineParam(p,i),params:[]};let f=["none"];return a&&(f=[a(u.encoder)]),{sql:s(l.value++,p),params:[p],typings:f}}return me(u,ec)?{sql:s(l.value++,u),params:[u],typings:["none"]}:me(u,je.Aliased)&&u.fieldAlias!==void 0?{sql:o(u.fieldAlias),params:[]}:me(u,bi)?u._.isWith?{sql:o(u._.alias),params:[]}:this.buildQueryFromSourceParams([new Wn("("),u._.sql,new Wn(") "),new Ey(u._.alias)],i):BJ(u)?u.schema?{sql:o(u.schema)+"."+o(u.enumName),params:[]}:{sql:o(u.enumName),params:[]}:sR(u)?u.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([u.getSQL()],i):this.buildQueryFromSourceParams([new Wn("("),u.getSQL(),new Wn(")")],i):c?{sql:this.mapInlineParam(u,i),params:[]}:{sql:s(l.value++,u),params:[u],typings:["none"]}}))}mapInlineParam(t,{escapeString:n}){if(t===null)return"null";if(typeof t=="number"||typeof t=="boolean")return t.toString();if(typeof t=="string")return n(t);if(typeof t=="object"){const i=t.toString();return n(i==="[object Object]"?JSON.stringify(t):i)}throw new Error("Unexpected param value: "+t)}getSQL(){return this}as(t){return t===void 0?this:new je.Aliased(this,t)}mapWith(t){return this.decoder=typeof t=="function"?{mapFromDriverValue:t}:t,this}inlineParams(){return this.shouldInlineParams=!0,this}if(t){return t?this:void 0}}class Ey{constructor(t){this.value=t}static[ie]="Name";brand;getSQL(){return new je([this])}}function VJ(e){return typeof e=="object"&&e!==null&&"mapToDriverValue"in e&&typeof e.mapToDriverValue=="function"}const aR={mapFromDriverValue:e=>e},cR={mapToDriverValue:e=>e};({...aR,...cR});class is{constructor(t,n=cR){this.value=t,this.encoder=n}static[ie]="Param";brand;getSQL(){return new je([this])}}function Z(e,...t){const n=[];(t.length>0||e.length>0&&e[0]!=="")&&n.push(new Wn(e[0]));for(const[i,r]of t.entries())n.push(r,new Wn(e[i+1]));return new je(n)}(e=>{function t(){return new je([])}e.empty=t;function n(c){return new je(c)}e.fromList=n;function i(c){return new je([new Wn(c)])}e.raw=i;function r(c,l){const u=[];for(const[p,f]of c.entries())p>0&&l!==void 0&&u.push(l),u.push(f);return new je(u)}e.join=r;function o(c){return new Ey(c)}e.identifier=o;function s(c){return new ec(c)}e.placeholder=s;function a(c,l){return new is(c,l)}e.param=a})(Z||(Z={}));(e=>{class t{constructor(i,r){this.sql=i,this.fieldAlias=r}static[ie]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new t(this.sql,this.fieldAlias)}}e.Aliased=t})(je||(je={}));class ec{constructor(t){this.name=t}static[ie]="Placeholder";getSQL(){return new je([this])}}function vg(e,t){return e.map(n=>{if(me(n,ec)){if(!(n.name in t))throw new Error(`No value for placeholder "${n.name}" was provided`);return t[n.name]}if(me(n,is)&&me(n.value,ec)){if(!(n.value.name in t))throw new Error(`No value for placeholder "${n.value.name}" was provided`);return n.encoder.mapToDriverValue(t[n.value.name])}return n})}class na{static[ie]="View";[Kn];constructor({name:t,schema:n,selectedFields:i,query:r}){this[Kn]={name:t,originalName:t,schema:n,selectedFields:i,query:r,isExisting:!r,isAlias:!1}}getSQL(){return new je([this])}}qn.prototype.getSQL=function(){return new je([this])};De.prototype.getSQL=function(){return new je([this])};bi.prototype.getSQL=function(){return new je([this])};class Hf{constructor(t){this.table=t}static[ie]="ColumnAliasProxyHandler";get(t,n){return n==="table"?this.table:t[n]}}class o0{constructor(t,n){this.alias=t,this.replaceOriginalName=n}static[ie]="TableAliasProxyHandler";get(t,n){if(n===De.Symbol.IsAlias)return!0;if(n===De.Symbol.Name)return this.alias;if(this.replaceOriginalName&&n===De.Symbol.OriginalName)return this.alias;if(n===Kn)return{...t[Kn],name:this.alias,isAlias:!0};if(n===De.Symbol.Columns){const r=t[De.Symbol.Columns];if(!r)return r;const o={};return Object.keys(r).map(s=>{o[s]=new Proxy(r[s],new Hf(new Proxy(t,this)))}),o}const i=t[n];return me(i,qn)?new Proxy(i,new Hf(new Proxy(t,this))):i}}function bg(e,t){return new Proxy(e,new o0(t,!1))}function to(e,t){return new Proxy(e,new Hf(new Proxy(e.table,new o0(t,!1))))}function lR(e,t){return new je.Aliased(Kf(e.sql,t),e.fieldAlias)}function Kf(e,t){return Z.join(e.queryChunks.map(n=>me(n,qn)?to(n,t):me(n,je)?Kf(n,t):me(n,je.Aliased)?lR(n,t):n))}class qJ extends Error{static[ie]="DrizzleError";constructor({message:t,cause:n}){super(t),this.name="DrizzleError",this.cause=n}}function Sr(e,t){return VJ(t)&&!sR(e)&&!me(e,is)&&!me(e,ec)&&!me(e,qn)&&!me(e,De)&&!me(e,na)?new is(e,t):e}const Pe=(e,t)=>Z`${e} = ${Sr(t,e)}`,Qd=(e,t)=>Z`${e} <> ${Sr(t,e)}`;function Jn(...e){const t=e.filter(n=>n!==void 0);if(t.length!==0)return t.length===1?new je(t):new je([new Wn("("),Z.join(t,new Wn(" and ")),new Wn(")")])}function Jf(...e){const t=e.filter(n=>n!==void 0);if(t.length!==0)return t.length===1?new je(t):new je([new Wn("("),Z.join(t,new Wn(" or ")),new Wn(")")])}function HJ(e){return Z`not ${e}`}const Yd=(e,t)=>Z`${e} > ${Sr(t,e)}`,Xd=(e,t)=>Z`${e} >= ${Sr(t,e)}`,ef=(e,t)=>Z`${e} < ${Sr(t,e)}`,tf=(e,t)=>Z`${e} <= ${Sr(t,e)}`;function Rs(e,t){return Array.isArray(t)?t.length===0?Z`false`:Z`${e} in ${t.map(n=>Sr(n,e))}`:Z`${e} in ${Sr(t,e)}`}function nf(e,t){return Array.isArray(t)?t.length===0?Z`true`:Z`${e} not in ${t.map(n=>Sr(n,e))}`:Z`${e} not in ${Sr(t,e)}`}function uR(e){return Z`${e} is null`}function KJ(e){return Z`${e} is not null`}function JJ(e){return Z`exists ${e}`}function GJ(e){return Z`not exists ${e}`}function ZJ(e,t,n){return Z`${e} between ${Sr(t,e)} and ${Sr(n,e)}`}function QJ(e,t,n){return Z`${e} not between ${Sr(t,e)} and ${Sr(n,e)}`}function Ti(e,t){return Z`${e} like ${t}`}function YJ(e,t){return Z`${e} not like ${t}`}function XJ(e,t){return Z`${e} ilike ${t}`}function eG(e,t){return Z`${e} not ilike ${t}`}function Ui(e){return Z`${e} asc`}function Ps(e){return Z`${e} desc`}class tG{static[ie]="ConsoleLogWriter";write(t){console.log(t)}}class nG{static[ie]="DefaultLogger";writer;constructor(t){this.writer=t?.writer??new tG}logQuery(t,n){const i=n.map(o=>{try{return JSON.stringify(o)}catch{return String(o)}}),r=i.length?` -- params: [${i.join(", ")}]`:"";this.writer.write(`Query: ${t}${r}`)}}class rG{static[ie]="NoopLogger";logQuery(){}}class ra{static[ie]="QueryPromise";[Symbol.toStringTag]="QueryPromise";catch(t){return this.then(void 0,t)}finally(t){return this.then(n=>(t?.(),n),n=>{throw t?.(),n})}then(t,n){return this.execute().then(t,n)}}function iG(e,t,n){const i={},r=e.reduce((o,{path:s,field:a},c)=>{let l;me(a,qn)?l=a:me(a,je)?l=a.decoder:l=a.sql.decoder;let u=o;for(const[p,f]of s.entries())if(p<s.length-1)f in u||(u[f]={}),u=u[f];else{const g=t[c],h=u[f]=g===null?null:l.mapFromDriverValue(g);if(n&&me(a,qn)&&s.length===2){const d=s[0];d in i?typeof i[d]=="string"&&i[d]!==Na(a.table)&&(i[d]=!1):i[d]=h===null?Na(a.table):!1}}return o},{});if(n&&Object.keys(i).length>0)for(const[o,s]of Object.entries(i))typeof s=="string"&&!n[s]&&(r[o]=null);return r}function qs(e,t){return Object.entries(e).reduce((n,[i,r])=>{if(typeof i!="string")return n;const o=t?[...t,i]:[i];return me(r,qn)||me(r,je)||me(r,je.Aliased)?n.push({path:o,field:r}):me(r,De)?n.push(...qs(r[De.Symbol.Columns],o)):n.push(...qs(r,o)),n},[])}function dR(e,t){const n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(const[r,o]of n.entries())if(o!==i[r])return!1;return!0}function fR(e,t){const n=Object.entries(t).filter(([,i])=>i!==void 0).map(([i,r])=>me(r,je)?[i,r]:[i,new is(r,e[De.Symbol.Columns][i])]);if(n.length===0)throw new Error("No values to set");return Object.fromEntries(n)}function oG(e,t){for(const n of t)for(const i of Object.getOwnPropertyNames(n.prototype))i!=="constructor"&&Object.defineProperty(e.prototype,i,Object.getOwnPropertyDescriptor(n.prototype,i)||Object.create(null))}function sG(e){return e[De.Symbol.Columns]}function Gx(e){return me(e,bi)?e._.alias:me(e,na)?e[Kn].name:me(e,je)?void 0:e[De.Symbol.IsAlias]?e[De.Symbol.Name]:e[De.Symbol.BaseName]}function jn(e,t){return{name:typeof e=="string"&&e.length>0?e:"",config:typeof e=="object"?e:t}}class Wh extends xt{static[ie]="PgIntColumnBaseBuilder";generatedAlwaysAsIdentity(t){if(t){const{name:n,...i}=t;this.config.generatedIdentity={type:"always",sequenceName:n,sequenceOptions:i}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(t){if(t){const{name:n,...i}=t;this.config.generatedIdentity={type:"byDefault",sequenceName:n,sequenceOptions:i}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}class aG extends Wh{static[ie]="PgBigInt53Builder";constructor(t){super(t,"number","PgBigInt53")}build(t){return new cG(t,this.config)}}class cG extends Ye{static[ie]="PgBigInt53";getSQLType(){return"bigint"}mapFromDriverValue(t){return typeof t=="number"?t:Number(t)}}class lG extends Wh{static[ie]="PgBigInt64Builder";constructor(t){super(t,"bigint","PgBigInt64")}build(t){return new uG(t,this.config)}}class uG extends Ye{static[ie]="PgBigInt64";getSQLType(){return"bigint"}mapFromDriverValue(t){return BigInt(t)}}function dG(e,t){const{name:n,config:i}=jn(e,t);return i.mode==="number"?new aG(n):new lG(n)}class fG extends xt{static[ie]="PgBigSerial53Builder";constructor(t){super(t,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(t){return new pG(t,this.config)}}class pG extends Ye{static[ie]="PgBigSerial53";getSQLType(){return"bigserial"}mapFromDriverValue(t){return typeof t=="number"?t:Number(t)}}class hG extends xt{static[ie]="PgBigSerial64Builder";constructor(t){super(t,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(t){return new mG(t,this.config)}}class mG extends Ye{static[ie]="PgBigSerial64";getSQLType(){return"bigserial"}mapFromDriverValue(t){return BigInt(t)}}function gG(e,t){const{name:n,config:i}=jn(e,t);return i.mode==="number"?new fG(n):new hG(n)}class yG extends xt{static[ie]="PgBooleanBuilder";constructor(t){super(t,"boolean","PgBoolean")}build(t){return new wG(t,this.config)}}class wG extends Ye{static[ie]="PgBoolean";getSQLType(){return"boolean"}}function ia(e){return new yG(e??"")}class vG extends xt{static[ie]="PgCharBuilder";constructor(t,n){super(t,"string","PgChar"),this.config.length=n.length,this.config.enumValues=n.enum}build(t){return new bG(t,this.config)}}class bG extends Ye{static[ie]="PgChar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"char":`char(${this.length})`}}function _G(e,t={}){const{name:n,config:i}=jn(e,t);return new vG(n,i)}class SG extends xt{static[ie]="PgCidrBuilder";constructor(t){super(t,"string","PgCidr")}build(t){return new xG(t,this.config)}}class xG extends Ye{static[ie]="PgCidr";getSQLType(){return"cidr"}}function kG(e){return new SG(e??"")}class EG extends xt{static[ie]="PgCustomColumnBuilder";constructor(t,n,i){super(t,"custom","PgCustomColumn"),this.config.fieldConfig=n,this.config.customTypeParams=i}build(t){return new AG(t,this.config)}}class AG extends Ye{static[ie]="PgCustomColumn";sqlName;mapTo;mapFrom;constructor(t,n){super(t,n),this.sqlName=n.customTypeParams.dataType(n.fieldConfig),this.mapTo=n.customTypeParams.toDriver,this.mapFrom=n.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(t){return typeof this.mapFrom=="function"?this.mapFrom(t):t}mapToDriverValue(t){return typeof this.mapTo=="function"?this.mapTo(t):t}}function s0(e){return(t,n)=>{const{name:i,config:r}=jn(t,n);return new EG(i,r,e)}}class Ju extends xt{static[ie]="PgDateColumnBaseBuilder";defaultNow(){return this.default(Z`now()`)}}class TG extends Ju{static[ie]="PgDateBuilder";constructor(t){super(t,"date","PgDate")}build(t){return new pR(t,this.config)}}class pR extends Ye{static[ie]="PgDate";getSQLType(){return"date"}mapFromDriverValue(t){return new Date(t)}mapToDriverValue(t){return t.toISOString()}}class IG extends Ju{static[ie]="PgDateStringBuilder";constructor(t){super(t,"string","PgDateString")}build(t){return new hR(t,this.config)}}class hR extends Ye{static[ie]="PgDateString";getSQLType(){return"date"}}function NG(e,t){const{name:n,config:i}=jn(e,t);return i?.mode==="date"?new TG(n):new IG(n)}class $G extends xt{static[ie]="PgDoublePrecisionBuilder";constructor(t){super(t,"number","PgDoublePrecision")}build(t){return new CG(t,this.config)}}class CG extends Ye{static[ie]="PgDoublePrecision";getSQLType(){return"double precision"}mapFromDriverValue(t){return typeof t=="string"?Number.parseFloat(t):t}}function OG(e){return new $G(e??"")}class RG extends xt{static[ie]="PgInetBuilder";constructor(t){super(t,"string","PgInet")}build(t){return new PG(t,this.config)}}class PG extends Ye{static[ie]="PgInet";getSQLType(){return"inet"}}function DG(e){return new RG(e??"")}class UG extends Wh{static[ie]="PgIntegerBuilder";constructor(t){super(t,"number","PgInteger")}build(t){return new LG(t,this.config)}}class LG extends Ye{static[ie]="PgInteger";getSQLType(){return"integer"}mapFromDriverValue(t){return typeof t=="string"?Number.parseInt(t):t}}function a0(e){return new UG(e??"")}class MG extends xt{static[ie]="PgIntervalBuilder";constructor(t,n){super(t,"string","PgInterval"),this.config.intervalConfig=n}build(t){return new jG(t,this.config)}}class jG extends Ye{static[ie]="PgInterval";fields=this.config.intervalConfig.fields;precision=this.config.intervalConfig.precision;getSQLType(){const t=this.fields?` ${this.fields}`:"",n=this.precision?`(${this.precision})`:"";return`interval${t}${n}`}}function zG(e,t={}){const{name:n,config:i}=jn(e,t);return new MG(n,i)}class BG extends xt{static[ie]="PgJsonBuilder";constructor(t){super(t,"json","PgJson")}build(t){return new mR(t,this.config)}}class mR extends Ye{static[ie]="PgJson";constructor(t,n){super(t,n)}getSQLType(){return"json"}mapToDriverValue(t){return JSON.stringify(t)}mapFromDriverValue(t){if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t}}function Jo(e){return new BG(e??"")}class FG extends xt{static[ie]="PgJsonbBuilder";constructor(t){super(t,"json","PgJsonb")}build(t){return new gR(t,this.config)}}class gR extends Ye{static[ie]="PgJsonb";constructor(t,n){super(t,n)}getSQLType(){return"jsonb"}mapToDriverValue(t){return JSON.stringify(t)}mapFromDriverValue(t){if(typeof t=="string")try{return JSON.parse(t)}catch{return t}return t}}function WG(e){return new FG(e??"")}class VG extends xt{static[ie]="PgLineBuilder";constructor(t){super(t,"array","PgLine")}build(t){return new qG(t,this.config)}}class qG extends Ye{static[ie]="PgLine";getSQLType(){return"line"}mapFromDriverValue(t){const[n,i,r]=t.slice(1,-1).split(",");return[Number.parseFloat(n),Number.parseFloat(i),Number.parseFloat(r)]}mapToDriverValue(t){return`{${t[0]},${t[1]},${t[2]}}`}}class HG extends xt{static[ie]="PgLineABCBuilder";constructor(t){super(t,"json","PgLineABC")}build(t){return new KG(t,this.config)}}class KG extends Ye{static[ie]="PgLineABC";getSQLType(){return"line"}mapFromDriverValue(t){const[n,i,r]=t.slice(1,-1).split(",");return{a:Number.parseFloat(n),b:Number.parseFloat(i),c:Number.parseFloat(r)}}mapToDriverValue(t){return`{${t.a},${t.b},${t.c}}`}}function JG(e,t){const{name:n,config:i}=jn(e,t);return!i?.mode||i.mode==="tuple"?new VG(n):new HG(n)}class GG extends xt{static[ie]="PgMacaddrBuilder";constructor(t){super(t,"string","PgMacaddr")}build(t){return new ZG(t,this.config)}}class ZG extends Ye{static[ie]="PgMacaddr";getSQLType(){return"macaddr"}}function QG(e){return new GG(e??"")}class YG extends xt{static[ie]="PgMacaddr8Builder";constructor(t){super(t,"string","PgMacaddr8")}build(t){return new XG(t,this.config)}}class XG extends Ye{static[ie]="PgMacaddr8";getSQLType(){return"macaddr8"}}function e9(e){return new YG(e??"")}class t9 extends xt{static[ie]="PgNumericBuilder";constructor(t,n,i){super(t,"string","PgNumeric"),this.config.precision=n,this.config.scale=i}build(t){return new yR(t,this.config)}}class yR extends Ye{static[ie]="PgNumeric";precision;scale;constructor(t,n){super(t,n),this.precision=n.precision,this.scale=n.scale}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}}function n9(e,t){const{name:n,config:i}=jn(e,t);return new t9(n,i?.precision,i?.scale)}class r9 extends xt{static[ie]="PgPointTupleBuilder";constructor(t){super(t,"array","PgPointTuple")}build(t){return new i9(t,this.config)}}class i9 extends Ye{static[ie]="PgPointTuple";getSQLType(){return"point"}mapFromDriverValue(t){if(typeof t=="string"){const[n,i]=t.slice(1,-1).split(",");return[Number.parseFloat(n),Number.parseFloat(i)]}return[t.x,t.y]}mapToDriverValue(t){return`(${t[0]},${t[1]})`}}class o9 extends xt{static[ie]="PgPointObjectBuilder";constructor(t){super(t,"json","PgPointObject")}build(t){return new s9(t,this.config)}}class s9 extends Ye{static[ie]="PgPointObject";getSQLType(){return"point"}mapFromDriverValue(t){if(typeof t=="string"){const[n,i]=t.slice(1,-1).split(",");return{x:Number.parseFloat(n),y:Number.parseFloat(i)}}return t}mapToDriverValue(t){return`(${t.x},${t.y})`}}function a9(e,t){const{name:n,config:i}=jn(e,t);return!i?.mode||i.mode==="tuple"?new r9(n):new o9(n)}function c9(e){const t=[];for(let n=0;n<e.length;n+=2)t.push(Number.parseInt(e.slice(n,n+2),16));return new Uint8Array(t)}function Zx(e,t){const n=new ArrayBuffer(8),i=new DataView(n);for(let r=0;r<8;r++)i.setUint8(r,e[t+r]);return i.getFloat64(0,!0)}function wR(e){const t=c9(e);let n=0;const i=t[n];n+=1;const r=new DataView(t.buffer),o=r.getUint32(n,i===1);if(n+=4,o&536870912&&(r.getUint32(n,i===1),n+=4),(o&65535)===1){const s=Zx(t,n);n+=8;const a=Zx(t,n);return n+=8,[s,a]}throw new Error("Unsupported geometry type")}class l9 extends xt{static[ie]="PgGeometryBuilder";constructor(t){super(t,"array","PgGeometry")}build(t){return new u9(t,this.config)}}class u9 extends Ye{static[ie]="PgGeometry";getSQLType(){return"geometry(point)"}mapFromDriverValue(t){return wR(t)}mapToDriverValue(t){return`point(${t[0]} ${t[1]})`}}class d9 extends xt{static[ie]="PgGeometryObjectBuilder";constructor(t){super(t,"json","PgGeometryObject")}build(t){return new f9(t,this.config)}}class f9 extends Ye{static[ie]="PgGeometryObject";getSQLType(){return"geometry(point)"}mapFromDriverValue(t){const n=wR(t);return{x:n[0],y:n[1]}}mapToDriverValue(t){return`point(${t.x} ${t.y})`}}function p9(e,t){const{name:n,config:i}=jn(e,t);return!i?.mode||i.mode==="tuple"?new l9(n):new d9(n)}class h9 extends xt{static[ie]="PgRealBuilder";constructor(t,n){super(t,"number","PgReal"),this.config.length=n}build(t){return new m9(t,this.config)}}class m9 extends Ye{static[ie]="PgReal";constructor(t,n){super(t,n)}getSQLType(){return"real"}mapFromDriverValue=t=>typeof t=="string"?Number.parseFloat(t):t}function g9(e){return new h9(e??"")}class y9 extends xt{static[ie]="PgSerialBuilder";constructor(t){super(t,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(t){return new w9(t,this.config)}}class w9 extends Ye{static[ie]="PgSerial";getSQLType(){return"serial"}}function v9(e){return new y9(e??"")}class b9 extends Wh{static[ie]="PgSmallIntBuilder";constructor(t){super(t,"number","PgSmallInt")}build(t){return new _9(t,this.config)}}class _9 extends Ye{static[ie]="PgSmallInt";getSQLType(){return"smallint"}mapFromDriverValue=t=>typeof t=="string"?Number(t):t}function S9(e){return new b9(e??"")}class x9 extends xt{static[ie]="PgSmallSerialBuilder";constructor(t){super(t,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(t){return new k9(t,this.config)}}class k9 extends Ye{static[ie]="PgSmallSerial";getSQLType(){return"smallserial"}}function E9(e){return new x9(e??"")}class A9 extends xt{static[ie]="PgTextBuilder";constructor(t,n){super(t,"string","PgText"),this.config.enumValues=n.enum}build(t){return new T9(t,this.config)}}class T9 extends Ye{static[ie]="PgText";enumValues=this.config.enumValues;getSQLType(){return"text"}}function ot(e,t={}){const{name:n,config:i}=jn(e,t);return new A9(n,i)}class I9 extends Ju{constructor(t,n,i){super(t,"string","PgTime"),this.withTimezone=n,this.precision=i,this.config.withTimezone=n,this.config.precision=i}static[ie]="PgTimeBuilder";build(t){return new vR(t,this.config)}}class vR extends Ye{static[ie]="PgTime";withTimezone;precision;constructor(t,n){super(t,n),this.withTimezone=n.withTimezone,this.precision=n.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}function N9(e,t={}){const{name:n,config:i}=jn(e,t);return new I9(n,i.withTimezone??!1,i.precision)}class $9 extends Ju{static[ie]="PgTimestampBuilder";constructor(t,n,i){super(t,"date","PgTimestamp"),this.config.withTimezone=n,this.config.precision=i}build(t){return new bR(t,this.config)}}class bR extends Ye{static[ie]="PgTimestamp";withTimezone;precision;constructor(t,n){super(t,n),this.withTimezone=n.withTimezone,this.precision=n.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=t=>new Date(this.withTimezone?t:t+"+0000");mapToDriverValue=t=>t.toISOString()}class C9 extends Ju{static[ie]="PgTimestampStringBuilder";constructor(t,n,i){super(t,"string","PgTimestampString"),this.config.withTimezone=n,this.config.precision=i}build(t){return new _R(t,this.config)}}class _R extends Ye{static[ie]="PgTimestampString";withTimezone;precision;constructor(t,n){super(t,n),this.withTimezone=n.withTimezone,this.precision=n.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}function Mt(e,t={}){const{name:n,config:i}=jn(e,t);return i?.mode==="string"?new C9(n,i.withTimezone??!1,i.precision):new $9(n,i?.withTimezone??!1,i?.precision)}class O9 extends xt{static[ie]="PgUUIDBuilder";constructor(t){super(t,"string","PgUUID")}defaultRandom(){return this.default(Z`gen_random_uuid()`)}build(t){return new SR(t,this.config)}}class SR extends Ye{static[ie]="PgUUID";getSQLType(){return"uuid"}}function Ln(e){return new O9(e??"")}class R9 extends xt{static[ie]="PgVarcharBuilder";constructor(t,n){super(t,"string","PgVarchar"),this.config.length=n.length,this.config.enumValues=n.enum}build(t){return new P9(t,this.config)}}class P9 extends Ye{static[ie]="PgVarchar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}}function Dt(e,t={}){const{name:n,config:i}=jn(e,t);return new R9(n,i)}class D9 extends xt{static[ie]="PgBinaryVectorBuilder";constructor(t,n){super(t,"string","PgBinaryVector"),this.config.dimensions=n.dimensions}build(t){return new U9(t,this.config)}}class U9 extends Ye{static[ie]="PgBinaryVector";dimensions=this.config.dimensions;getSQLType(){return`bit(${this.dimensions})`}}function L9(e,t){const{name:n,config:i}=jn(e,t);return new D9(n,i)}class M9 extends xt{static[ie]="PgHalfVectorBuilder";constructor(t,n){super(t,"array","PgHalfVector"),this.config.dimensions=n.dimensions}build(t){return new j9(t,this.config)}}class j9 extends Ye{static[ie]="PgHalfVector";dimensions=this.config.dimensions;getSQLType(){return`halfvec(${this.dimensions})`}mapToDriverValue(t){return JSON.stringify(t)}mapFromDriverValue(t){return t.slice(1,-1).split(",").map(n=>Number.parseFloat(n))}}function z9(e,t){const{name:n,config:i}=jn(e,t);return new M9(n,i)}class B9 extends xt{static[ie]="PgSparseVectorBuilder";constructor(t,n){super(t,"string","PgSparseVector"),this.config.dimensions=n.dimensions}build(t){return new F9(t,this.config)}}class F9 extends Ye{static[ie]="PgSparseVector";dimensions=this.config.dimensions;getSQLType(){return`sparsevec(${this.dimensions})`}}function W9(e,t){const{name:n,config:i}=jn(e,t);return new B9(n,i)}class V9 extends xt{static[ie]="PgVectorBuilder";constructor(t,n){super(t,"array","PgVector"),this.config.dimensions=n.dimensions}build(t){return new q9(t,this.config)}}class q9 extends Ye{static[ie]="PgVector";dimensions=this.config.dimensions;getSQLType(){return`vector(${this.dimensions})`}mapToDriverValue(t){return JSON.stringify(t)}mapFromDriverValue(t){return t.slice(1,-1).split(",").map(n=>Number.parseFloat(n))}}function H9(e,t){const{name:n,config:i}=jn(e,t);return new V9(n,i)}function K9(){return{bigint:dG,bigserial:gG,boolean:ia,char:_G,cidr:kG,customType:s0,date:NG,doublePrecision:OG,inet:DG,integer:a0,interval:zG,json:Jo,jsonb:WG,line:JG,macaddr:QG,macaddr8:e9,numeric:n9,point:a9,geometry:p9,real:g9,serial:v9,smallint:S9,smallserial:E9,text:ot,time:N9,timestamp:Mt,uuid:Ln,varchar:Dt,bit:L9,halfvec:z9,sparsevec:W9,vector:H9}}const Ay=Symbol.for("drizzle:PgInlineForeignKeys");class Ho extends De{static[ie]="PgTable";static Symbol=Object.assign({},De.Symbol,{InlineForeignKeys:Ay});[Ay]=[];[De.Symbol.ExtraConfigBuilder]=void 0}function J9(e,t,n,i,r=e){const o=new Ho(e,i,r),s=typeof t=="function"?t(K9()):t,a=Object.fromEntries(Object.entries(s).map(([u,p])=>{const f=p;f.setName(u);const g=f.build(o);return o[Ay].push(...f.buildForeignKeys(g,o)),[u,g]})),c=Object.fromEntries(Object.entries(s).map(([u,p])=>{const f=p;f.setName(u);const g=f.buildExtraConfigColumn(o);return[u,g]})),l=Object.assign(o,a);return l[De.Symbol.Columns]=a,l[De.Symbol.ExtraConfigColumns]=c,n&&(l[Ho.Symbol.ExtraConfigBuilder]=n),l}const mr=(e,t,n)=>J9(e,t,n,void 0);function Vh(...e){return e[0].columns?new Ty(e[0].columns,e[0].name):new Ty(e)}class Ty{static[ie]="PgPrimaryKeyBuilder";columns;name;constructor(t,n){this.columns=t,this.name=n}build(t){return new G9(t,this.columns,this.name)}}class G9{constructor(t,n,i){this.table=t,this.columns=n,this.name=i}static[ie]="PgPrimaryKey";columns;name;getName(){return this.name??`${this.table[Ho.Symbol.Name]}_${this.columns.map(t=>t.name).join("_")}_pk`}}class xR{constructor(t,n,i){this.sourceTable=t,this.referencedTable=n,this.relationName=i,this.referencedTableName=n[De.Symbol.Name]}static[ie]="Relation";referencedTableName;fieldName}class Z9{constructor(t,n){this.table=t,this.config=n}static[ie]="Relations"}class Hs extends xR{constructor(t,n,i,r){super(t,n,i?.relationName),this.config=i,this.isNullable=r}static[ie]="One";withFieldName(t){const n=new Hs(this.sourceTable,this.referencedTable,this.config,this.isNullable);return n.fieldName=t,n}}class qh extends xR{constructor(t,n,i){super(t,n,i?.relationName),this.config=i}static[ie]="Many";withFieldName(t){const n=new qh(this.sourceTable,this.referencedTable,this.config);return n.fieldName=t,n}}function Q9(){return{and:Jn,between:ZJ,eq:Pe,exists:JJ,gt:Yd,gte:Xd,ilike:XJ,inArray:Rs,isNull:uR,isNotNull:KJ,like:Ti,lt:ef,lte:tf,ne:Qd,not:HJ,notBetween:QJ,notExists:GJ,notLike:YJ,notIlike:eG,notInArray:nf,or:Jf,sql:Z}}function Y9(){return{sql:Z,asc:Ui,desc:Ps}}function X9(e,t){Object.keys(e).length===1&&"default"in e&&!me(e.default,De)&&(e=e.default);const n={},i={},r={};for(const[o,s]of Object.entries(e))if(me(s,De)){const a=Dl(s),c=i[a];n[a]=o,r[o]={tsName:o,dbName:s[De.Symbol.Name],schema:s[De.Symbol.Schema],columns:s[De.Symbol.Columns],relations:c?.relations??{},primaryKey:c?.primaryKey??[]};for(const u of Object.values(s[De.Symbol.Columns]))u.primary&&r[o].primaryKey.push(u);const l=s[De.Symbol.ExtraConfigBuilder]?.(s[De.Symbol.ExtraConfigColumns]);if(l)for(const u of Object.values(l))me(u,Ty)&&r[o].primaryKey.push(...u.columns)}else if(me(s,Z9)){const a=Dl(s.table),c=n[a],l=s.config(t(s.table));let u;for(const[p,f]of Object.entries(l))if(c){const g=r[c];g.relations[p]=f}else a in i||(i[a]={relations:{},primaryKey:u}),i[a].relations[p]=f}return{tables:r,tableNamesMap:n}}function eZ(e){return function(n,i){return new Hs(e,n,i,i?.fields.reduce((r,o)=>r&&o.notNull,!0)??!1)}}function tZ(e){return function(n,i){return new qh(e,n,i)}}function nZ(e,t,n){if(me(n,Hs)&&n.config)return{fields:n.config.fields,references:n.config.references};const i=t[Dl(n.referencedTable)];if(!i)throw new Error(`Table "${n.referencedTable[De.Symbol.Name]}" not found in schema`);const r=e[i];if(!r)throw new Error(`Table "${i}" not found in schema`);const o=n.sourceTable,s=t[Dl(o)];if(!s)throw new Error(`Table "${o[De.Symbol.Name]}" not found in schema`);const a=[];for(const c of Object.values(r.relations))(n.relationName&&n!==c&&c.relationName===n.relationName||!n.relationName&&c.referencedTable===n.sourceTable)&&a.push(c);if(a.length>1)throw n.relationName?new Error(`There are multiple relations with name "${n.relationName}" in table "${i}"`):new Error(`There are multiple relations between "${i}" and "${n.sourceTable[De.Symbol.Name]}". Please specify relation name`);if(a[0]&&me(a[0],Hs)&&a[0].config)return{fields:a[0].config.references,references:a[0].config.fields};throw new Error(`There is not enough information to infer relation "${s}.${n.fieldName}"`)}function rZ(e){return{one:eZ(e),many:tZ(e)}}function Iy(e,t,n,i,r=o=>o){const o={};for(const[s,a]of i.entries())if(a.isJson){const c=t.relations[a.tsKey],l=n[s],u=typeof l=="string"?JSON.parse(l):l;o[a.tsKey]=me(c,Hs)?u&&Iy(e,e[a.relationTableTsKey],u,a.selection,r):u.map(p=>Iy(e,e[a.relationTableTsKey],p,a.selection,r))}else{const c=r(n[s]),l=a.field;let u;me(l,qn)?u=l:me(l,je)?u=l.decoder:u=l.sql.decoder,o[a.tsKey]=c===null?null:u.mapFromDriverValue(c)}return o}function iZ(e){return Z`count(${Z.raw("*")})`.mapWith(Number)}const oZ=(e,t)=>{let n=null;const i=s=>({getFieldName:a,options:c})=>{function l(g){const h=t.schema||s._.fullSchema;if(!h)throw new Fe("Drizzle adapter failed to initialize. Schema not found. Please provide a schema object in the adapter options object.");const d=h[g];if(!d)throw new Fe(`[# Drizzle Adapter]: The model "${g}" was not found in the schema object. Please pass the schema directly to the adapter options.`);return d}const u=async(g,h,d,y)=>{if(t.provider!=="mysql")return(await h.returning())[0];await h.execute();const v=l(g),x=h.config?.values;if(y?.length){const E=p(y.map(N=>d[N.field]!==void 0?{...N,value:d[N.field]}:N),g);return(await s.select().from(v).where(...E))[0]}else if(x&&x[0]?.id?.value){let E=x[0]?.id?.value;return E||(E=(await s.select({id:Z`LAST_INSERT_ID()`}).from(v).orderBy(Ps(v.id)).limit(1))[0].id),(await s.select().from(v).where(Pe(v.id,E)).limit(1).execute())[0]}else{if(d.id)return(await s.select().from(v).where(Pe(v.id,d.id)).limit(1).execute())[0];if(!("id"in v))throw new Fe(`The model "${g}" does not have an "id" field. Please use the "id" field as your primary key.`);return(await s.select().from(v).orderBy(Ps(v.id)).limit(1).execute())[0]}};function p(g,h){const d=l(h);if(!g)return[];if(g.length===1){const C=g[0];if(!C)return[];const b=a({model:h,field:C.field});if(!d[b])throw new Fe(`The field "${C.field}" does not exist in the schema for the model "${h}". Please update your schema.`);if(C.operator==="in"){if(!Array.isArray(C.value))throw new Fe(`The value for the field "${C.field}" must be an array when using the "in" operator.`);return[Rs(d[b],C.value)]}if(C.operator==="not_in"){if(!Array.isArray(C.value))throw new Fe(`The value for the field "${C.field}" must be an array when using the "not_in" operator.`);return[nf(d[b],C.value)]}return C.operator==="contains"?[Ti(d[b],`%${C.value}%`)]:C.operator==="starts_with"?[Ti(d[b],`${C.value}%`)]:C.operator==="ends_with"?[Ti(d[b],`%${C.value}`)]:C.operator==="lt"?[ef(d[b],C.value)]:C.operator==="lte"?[tf(d[b],C.value)]:C.operator==="ne"?[Qd(d[b],C.value)]:C.operator==="gt"?[Yd(d[b],C.value)]:C.operator==="gte"?[Xd(d[b],C.value)]:[Pe(d[b],C.value)]}const y=g.filter(C=>C.connector==="AND"||!C.connector),v=g.filter(C=>C.connector==="OR"),x=Jn(...y.map(C=>{const b=a({model:h,field:C.field});if(C.operator==="in"){if(!Array.isArray(C.value))throw new Fe(`The value for the field "${C.field}" must be an array when using the "in" operator.`);return Rs(d[b],C.value)}if(C.operator==="not_in"){if(!Array.isArray(C.value))throw new Fe(`The value for the field "${C.field}" must be an array when using the "not_in" operator.`);return nf(d[b],C.value)}return C.operator==="contains"?Ti(d[b],`%${C.value}%`):C.operator==="starts_with"?Ti(d[b],`${C.value}%`):C.operator==="ends_with"?Ti(d[b],`%${C.value}`):C.operator==="lt"?ef(d[b],C.value):C.operator==="lte"?tf(d[b],C.value):C.operator==="gt"?Yd(d[b],C.value):C.operator==="gte"?Xd(d[b],C.value):C.operator==="ne"?Qd(d[b],C.value):Pe(d[b],C.value)})),E=Jf(...v.map(C=>{const b=a({model:h,field:C.field});if(C.operator==="in"){if(!Array.isArray(C.value))throw new Fe(`The value for the field "${C.field}" must be an array when using the "in" operator.`);return Rs(d[b],C.value)}if(C.operator==="not_in"){if(!Array.isArray(C.value))throw new Fe(`The value for the field "${C.field}" must be an array when using the "not_in" operator.`);return nf(d[b],C.value)}return C.operator==="contains"?Ti(d[b],`%${C.value}%`):C.operator==="starts_with"?Ti(d[b],`${C.value}%`):C.operator==="ends_with"?Ti(d[b],`%${C.value}`):C.operator==="lt"?ef(d[b],C.value):C.operator==="lte"?tf(d[b],C.value):C.operator==="gt"?Yd(d[b],C.value):C.operator==="gte"?Xd(d[b],C.value):C.operator==="ne"?Qd(d[b],C.value):Pe(d[b],C.value)})),N=[];return y.length&&N.push(x),v.length&&N.push(E),N}function f(g,h,d){if(!g)throw new Fe("Drizzle adapter failed to initialize. Drizzle Schema not found. Please provide a schema object in the adapter options object.");for(const y in d)if(!g[y])throw new Fe(`The field "${y}" does not exist in the "${h}" Drizzle schema. Please update your drizzle schema or re-generate using "npx @better-auth/cli@latest generate".`)}return{async create({model:g,data:h}){const d=l(g);return f(d,g,h),await u(g,s.insert(d).values(h),h)},async findOne({model:g,where:h,join:d}){const y=l(g),v=p(h,g);if(c.experimental?.joins)if(!s.query||!s.query[g])Qe.error(`[# Drizzle Adapter]: The model "${g}" was not found in the query object. Please update your Drizzle schema to include relations or re-generate using "npx @better-auth/cli@latest generate".`),Qe.info("Falling back to regular query");else{let E;const N=[];if(d){E={};const b=Object.entries(d);for(const[P,$]of b){const k=$.limit??c.advanced?.database?.defaultFindManyLimit??100,D=$.relation==="one-to-one",B=D||t.usePlural?"":"s";E[`${P}${B}`]=D?!0:{limit:k},D||N.push(`${P}${B}`)}}const C=await s.query[g].findFirst({where:v[0],with:E});if(C)for(const b of N){const P=t.usePlural?b:b.slice(0,-1);C[P]=C[b],b!==P&&delete C[b]}return C}const x=await s.select().from(y).where(...v);return x.length?x[0]:null},async findMany({model:g,where:h,sortBy:d,limit:y,offset:v,join:x}){const E=l(g),N=h?p(h,g):[],C=d?.direction==="desc"?Ps:Ui;if(c.experimental?.joins)if(!s.query[g])Qe.error(`[# Drizzle Adapter]: The model "${g}" was not found in the query object. Please update your Drizzle schema to include relations or re-generate using "npx @better-auth/cli@latest generate".`),Qe.info("Falling back to regular query");else{let k;const D=[];if(x){k={};const S=Object.entries(x);for(const[T,z]of S){const L=z.relation==="one-to-one",q=z.limit??c.advanced?.database?.defaultFindManyLimit??100,V=L||t.usePlural?"":"s";k[`${T}${V}`]=L?!0:{limit:q},L||D.push(`${T}${V}`)}}let B;d?.field&&(B=[C(E[a({model:g,field:d?.field})])]);const J=await s.query[g].findMany({where:N[0],with:k,limit:y??100,offset:v??0,orderBy:B});if(J)for(const S of J)for(const T of D){const z=t.usePlural?T:T.slice(0,-1);z!==T&&(S[z]=S[T],delete S[T])}return J}let b=s.select().from(E);const P=y,$=v;return typeof P<"u"&&(b=b.limit(P)),typeof $<"u"&&(b=b.offset($)),d?.field&&(b=b.orderBy(C(E[a({model:g,field:d?.field})]))),await b.where(...N)},async count({model:g,where:h}){const d=l(g),y=h?p(h,g):[];return(await s.select({count:iZ()}).from(d).where(...y))[0].count},async update({model:g,where:h,update:d}){const y=l(g),v=p(h,g);return await u(g,s.update(y).set(d).where(...v),d,h)},async updateMany({model:g,where:h,update:d}){const y=l(g),v=p(h,g);return await s.update(y).set(d).where(...v)},async delete({model:g,where:h}){const d=l(g),y=p(h,g);return await s.delete(d).where(...y)},async deleteMany({model:g,where:h}){const d=l(g),y=p(h,g),v=await s.delete(d).where(...y);let x=0;return v&&"rowCount"in v?x=v.rowCount:Array.isArray(v)?x=v.length:v&&("affectedRows"in v||"rowsAffected"in v||"changes"in v)&&(x=v.affectedRows??v.rowsAffected??v.changes),typeof x!="number"&&Qe.error("[Drizzle Adapter] The result of the deleteMany operation is not a number. This is likely a bug in the adapter. Please report this issue to the Better Auth team.",{res:v,model:g,where:h}),x},options:t}};let r=null;r={config:{adapterId:"drizzle",adapterName:"Drizzle Adapter",usePlural:t.usePlural??!1,debugLogs:t.debugLogs??!1,supportsUUIDs:t.provider==="pg",supportsJSON:t.provider==="pg",supportsArrays:t.provider==="pg",transaction:t.transaction??!1?s=>e.transaction(a=>s(Cx({config:r.config,adapter:i(a)})(n))):!1},adapter:i(e)};const o=Cx(r);return s=>(n=s,o(s))},sZ=ce({DATABASE_URL:W().min(1),AUTH_SECRET:W().min(1),BLOB_READ_WRITE_TOKEN:W().optional(),AUTH_GOOGLE_ID:W().optional(),AUTH_GOOGLE_SECRET:W().optional(),AUTH_GITHUB_ID:W().optional(),AUTH_GITHUB_SECRET:W().optional(),VERCEL_APP_CLIENT_ID:W().optional(),VERCEL_APP_CLIENT_SECRET:W().optional(),AI_GATEWAY_API_KEY:W().optional(),VERCEL_OIDC_TOKEN:W().optional(),CRON_SECRET:W().optional(),REDIS_URL:W().optional(),OPENAI_API_KEY:W().optional(),TAVILY_API_KEY:W().optional(),EXA_API_KEY:W().optional(),FIRECRAWL_API_KEY:W().optional(),MCP_ENCRYPTION_KEY:nn([W().length(44),_e("")]).optional(),VERCEL_TEAM_ID:W().optional(),VERCEL_PROJECT_ID:W().optional(),VERCEL_TOKEN:W().optional(),VERCEL_SANDBOX_RUNTIME:W().optional(),APP_URL:W().url().optional(),VERCEL_URL:W().optional()});process.env.CI==="1"||process.env.CI;const aZ={...tl,DATABASE_URL:tl.DATABASE_URL??process.env.DATABASE_URL??void 0,AUTH_SECRET:tl.AUTH_SECRET??process.env.AUTH_SECRET??void 0},cZ=sZ.parse(aZ),Pr=cZ;var lZ=Object.create,Ac=Object.defineProperty,uZ=Object.getOwnPropertyDescriptor,dZ=Object.getOwnPropertyNames,fZ=Object.getPrototypeOf,pZ=Object.prototype.hasOwnProperty,hZ=(e,t,n)=>t in e?Ac(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,M=(e,t)=>Ac(e,"name",{value:t,configurable:!0}),kr=(e,t)=>()=>(e&&(t=e(e=0)),t),ut=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),xi=(e,t)=>{for(var n in t)Ac(e,n,{get:t[n],enumerable:!0})},kR=(e,t,n,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of dZ(t))!pZ.call(e,r)&&r!==n&&Ac(e,r,{get:()=>t[r],enumerable:!(i=uZ(t,r))||i.enumerable});return e},oa=(e,t,n)=>(n=e!=null?lZ(fZ(e)):{},kR(t||!e||!e.__esModule?Ac(n,"default",{value:e,enumerable:!0}):n,e)),Mn=e=>kR(Ac({},"__esModule",{value:!0}),e),Je=(e,t,n)=>hZ(e,typeof t!="symbol"?t+"":t,n),mZ=ut(e=>{$e(),e.byteLength=c,e.toByteArray=u,e.fromByteArray=g;var t=[],n=[],i=typeof Uint8Array<"u"?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(o=0,s=r.length;o<s;++o)t[o]=r[o],n[r.charCodeAt(o)]=o;var o,s;n[45]=62,n[95]=63;function a(h){var d=h.length;if(d%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var y=h.indexOf("=");y===-1&&(y=d);var v=y===d?0:4-y%4;return[y,v]}M(a,"getLens");function c(h){var d=a(h),y=d[0],v=d[1];return(y+v)*3/4-v}M(c,"byteLength");function l(h,d,y){return(d+y)*3/4-y}M(l,"_byteLength");function u(h){var d,y=a(h),v=y[0],x=y[1],E=new i(l(h,v,x)),N=0,C=x>0?v-4:v,b;for(b=0;b<C;b+=4)d=n[h.charCodeAt(b)]<<18|n[h.charCodeAt(b+1)]<<12|n[h.charCodeAt(b+2)]<<6|n[h.charCodeAt(b+3)],E[N++]=d>>16&255,E[N++]=d>>8&255,E[N++]=d&255;return x===2&&(d=n[h.charCodeAt(b)]<<2|n[h.charCodeAt(b+1)]>>4,E[N++]=d&255),x===1&&(d=n[h.charCodeAt(b)]<<10|n[h.charCodeAt(b+1)]<<4|n[h.charCodeAt(b+2)]>>2,E[N++]=d>>8&255,E[N++]=d&255),E}M(u,"toByteArray");function p(h){return t[h>>18&63]+t[h>>12&63]+t[h>>6&63]+t[h&63]}M(p,"tripletToBase64");function f(h,d,y){for(var v,x=[],E=d;E<y;E+=3)v=(h[E]<<16&16711680)+(h[E+1]<<8&65280)+(h[E+2]&255),x.push(p(v));return x.join("")}M(f,"encodeChunk");function g(h){for(var d,y=h.length,v=y%3,x=[],E=16383,N=0,C=y-v;N<C;N+=E)x.push(f(h,N,N+E>C?C:N+E));return v===1?(d=h[y-1],x.push(t[d>>2]+t[d<<4&63]+"==")):v===2&&(d=(h[y-2]<<8)+h[y-1],x.push(t[d>>10]+t[d>>4&63]+t[d<<2&63]+"=")),x.join("")}M(g,"fromByteArray")}),gZ=ut(e=>{$e(),e.read=function(t,n,i,r,o){var s,a,c=o*8-r-1,l=(1<<c)-1,u=l>>1,p=-7,f=i?o-1:0,g=i?-1:1,h=t[n+f];for(f+=g,s=h&(1<<-p)-1,h>>=-p,p+=c;p>0;s=s*256+t[n+f],f+=g,p-=8);for(a=s&(1<<-p)-1,s>>=-p,p+=r;p>0;a=a*256+t[n+f],f+=g,p-=8);if(s===0)s=1-u;else{if(s===l)return a?NaN:(h?-1:1)*(1/0);a=a+Math.pow(2,r),s=s-u}return(h?-1:1)*a*Math.pow(2,s-r)},e.write=function(t,n,i,r,o,s){var a,c,l,u=s*8-o-1,p=(1<<u)-1,f=p>>1,g=o===23?Math.pow(2,-24)-Math.pow(2,-77):0,h=r?0:s-1,d=r?1:-1,y=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(c=isNaN(n)?1:0,a=p):(a=Math.floor(Math.log(n)/Math.LN2),n*(l=Math.pow(2,-a))<1&&(a--,l*=2),a+f>=1?n+=g/l:n+=g*Math.pow(2,1-f),n*l>=2&&(a++,l/=2),a+f>=p?(c=0,a=p):a+f>=1?(c=(n*l-1)*Math.pow(2,o),a=a+f):(c=n*Math.pow(2,f-1)*Math.pow(2,o),a=0));o>=8;t[i+h]=c&255,h+=d,c/=256,o-=8);for(a=a<<o|c,u+=o;u>0;t[i+h]=a&255,h+=d,a/=256,u-=8);t[i+h-d]|=y*128}}),yZ=ut(e=>{$e();var t=mZ(),n=gZ(),i=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=a,e.SlowBuffer=x,e.INSPECT_MAX_BYTES=50;var r=2147483647;e.kMaxLength=r,a.TYPED_ARRAY_SUPPORT=o(),!a.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function o(){try{let w=new Uint8Array(1),I={foo:M(function(){return 42},"foo")};return Object.setPrototypeOf(I,Uint8Array.prototype),Object.setPrototypeOf(w,I),w.foo()===42}catch{return!1}}M(o,"typedArraySupport"),Object.defineProperty(a.prototype,"parent",{enumerable:!0,get:M(function(){if(a.isBuffer(this))return this.buffer},"get")}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:M(function(){if(a.isBuffer(this))return this.byteOffset},"get")});function s(w){if(w>r)throw new RangeError('The value "'+w+'" is invalid for option "size"');let I=new Uint8Array(w);return Object.setPrototypeOf(I,a.prototype),I}M(s,"createBuffer");function a(w,I,U){if(typeof w=="number"){if(typeof I=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return p(w)}return c(w,I,U)}M(a,"Buffer"),a.poolSize=8192;function c(w,I,U){if(typeof w=="string")return f(w,I);if(ArrayBuffer.isView(w))return h(w);if(w==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof w);if(Be(w,ArrayBuffer)||w&&Be(w.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Be(w,SharedArrayBuffer)||w&&Be(w.buffer,SharedArrayBuffer)))return d(w,I,U);if(typeof w=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let G=w.valueOf&&w.valueOf();if(G!=null&&G!==w)return a.from(G,I,U);let Q=y(w);if(Q)return Q;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof w[Symbol.toPrimitive]=="function")return a.from(w[Symbol.toPrimitive]("string"),I,U);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof w)}M(c,"from"),a.from=function(w,I,U){return c(w,I,U)},Object.setPrototypeOf(a.prototype,Uint8Array.prototype),Object.setPrototypeOf(a,Uint8Array);function l(w){if(typeof w!="number")throw new TypeError('"size" argument must be of type number');if(w<0)throw new RangeError('The value "'+w+'" is invalid for option "size"')}M(l,"assertSize");function u(w,I,U){return l(w),w<=0?s(w):I!==void 0?typeof U=="string"?s(w).fill(I,U):s(w).fill(I):s(w)}M(u,"alloc"),a.alloc=function(w,I,U){return u(w,I,U)};function p(w){return l(w),s(w<0?0:v(w)|0)}M(p,"allocUnsafe"),a.allocUnsafe=function(w){return p(w)},a.allocUnsafeSlow=function(w){return p(w)};function f(w,I){if((typeof I!="string"||I==="")&&(I="utf8"),!a.isEncoding(I))throw new TypeError("Unknown encoding: "+I);let U=E(w,I)|0,G=s(U),Q=G.write(w,I);return Q!==U&&(G=G.slice(0,Q)),G}M(f,"fromString");function g(w){let I=w.length<0?0:v(w.length)|0,U=s(I);for(let G=0;G<I;G+=1)U[G]=w[G]&255;return U}M(g,"fromArrayLike");function h(w){if(Be(w,Uint8Array)){let I=new Uint8Array(w);return d(I.buffer,I.byteOffset,I.byteLength)}return g(w)}M(h,"fromArrayView");function d(w,I,U){if(I<0||w.byteLength<I)throw new RangeError('"offset" is outside of buffer bounds');if(w.byteLength<I+(U||0))throw new RangeError('"length" is outside of buffer bounds');let G;return I===void 0&&U===void 0?G=new Uint8Array(w):U===void 0?G=new Uint8Array(w,I):G=new Uint8Array(w,I,U),Object.setPrototypeOf(G,a.prototype),G}M(d,"fromArrayBuffer");function y(w){if(a.isBuffer(w)){let I=v(w.length)|0,U=s(I);return U.length===0||w.copy(U,0,0,I),U}if(w.length!==void 0)return typeof w.length!="number"||Oe(w.length)?s(0):g(w);if(w.type==="Buffer"&&Array.isArray(w.data))return g(w.data)}M(y,"fromObject");function v(w){if(w>=r)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+r.toString(16)+" bytes");return w|0}M(v,"checked");function x(w){return+w!=w&&(w=0),a.alloc(+w)}M(x,"SlowBuffer"),a.isBuffer=M(function(w){return w!=null&&w._isBuffer===!0&&w!==a.prototype},"isBuffer"),a.compare=M(function(w,I){if(Be(w,Uint8Array)&&(w=a.from(w,w.offset,w.byteLength)),Be(I,Uint8Array)&&(I=a.from(I,I.offset,I.byteLength)),!a.isBuffer(w)||!a.isBuffer(I))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(w===I)return 0;let U=w.length,G=I.length;for(let Q=0,ee=Math.min(U,G);Q<ee;++Q)if(w[Q]!==I[Q]){U=w[Q],G=I[Q];break}return U<G?-1:G<U?1:0},"compare"),a.isEncoding=M(function(w){switch(String(w).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},"isEncoding"),a.concat=M(function(w,I){if(!Array.isArray(w))throw new TypeError('"list" argument must be an Array of Buffers');if(w.length===0)return a.alloc(0);let U;if(I===void 0)for(I=0,U=0;U<w.length;++U)I+=w[U].length;let G=a.allocUnsafe(I),Q=0;for(U=0;U<w.length;++U){let ee=w[U];if(Be(ee,Uint8Array))Q+ee.length>G.length?(a.isBuffer(ee)||(ee=a.from(ee)),ee.copy(G,Q)):Uint8Array.prototype.set.call(G,ee,Q);else if(a.isBuffer(ee))ee.copy(G,Q);else throw new TypeError('"list" argument must be an Array of Buffers');Q+=ee.length}return G},"concat");function E(w,I){if(a.isBuffer(w))return w.length;if(ArrayBuffer.isView(w)||Be(w,ArrayBuffer))return w.byteLength;if(typeof w!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof w);let U=w.length,G=arguments.length>2&&arguments[2]===!0;if(!G&&U===0)return 0;let Q=!1;for(;;)switch(I){case"ascii":case"latin1":case"binary":return U;case"utf8":case"utf-8":return We(w).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return U*2;case"hex":return U>>>1;case"base64":return vt(w).length;default:if(Q)return G?-1:We(w).length;I=(""+I).toLowerCase(),Q=!0}}M(E,"byteLength"),a.byteLength=E;function N(w,I,U){let G=!1;if((I===void 0||I<0)&&(I=0),I>this.length||((U===void 0||U>this.length)&&(U=this.length),U<=0)||(U>>>=0,I>>>=0,U<=I))return"";for(w||(w="utf8");;)switch(w){case"hex":return K(this,I,U);case"utf8":case"utf-8":return T(this,I,U);case"ascii":return q(this,I,U);case"latin1":case"binary":return V(this,I,U);case"base64":return S(this,I,U);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return oe(this,I,U);default:if(G)throw new TypeError("Unknown encoding: "+w);w=(w+"").toLowerCase(),G=!0}}M(N,"slowToString"),a.prototype._isBuffer=!0;function C(w,I,U){let G=w[I];w[I]=w[U],w[U]=G}M(C,"swap"),a.prototype.swap16=M(function(){let w=this.length;if(w%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let I=0;I<w;I+=2)C(this,I,I+1);return this},"swap16"),a.prototype.swap32=M(function(){let w=this.length;if(w%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let I=0;I<w;I+=4)C(this,I,I+3),C(this,I+1,I+2);return this},"swap32"),a.prototype.swap64=M(function(){let w=this.length;if(w%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let I=0;I<w;I+=8)C(this,I,I+7),C(this,I+1,I+6),C(this,I+2,I+5),C(this,I+3,I+4);return this},"swap64"),a.prototype.toString=M(function(){let w=this.length;return w===0?"":arguments.length===0?T(this,0,w):N.apply(this,arguments)},"toString"),a.prototype.toLocaleString=a.prototype.toString,a.prototype.equals=M(function(w){if(!a.isBuffer(w))throw new TypeError("Argument must be a Buffer");return this===w?!0:a.compare(this,w)===0},"equals"),a.prototype.inspect=M(function(){let w="",I=e.INSPECT_MAX_BYTES;return w=this.toString("hex",0,I).replace(/(.{2})/g,"$1 ").trim(),this.length>I&&(w+=" ... "),"<Buffer "+w+">"},"inspect"),i&&(a.prototype[i]=a.prototype.inspect),a.prototype.compare=M(function(w,I,U,G,Q){if(Be(w,Uint8Array)&&(w=a.from(w,w.offset,w.byteLength)),!a.isBuffer(w))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof w);if(I===void 0&&(I=0),U===void 0&&(U=w?w.length:0),G===void 0&&(G=0),Q===void 0&&(Q=this.length),I<0||U>w.length||G<0||Q>this.length)throw new RangeError("out of range index");if(G>=Q&&I>=U)return 0;if(G>=Q)return-1;if(I>=U)return 1;if(I>>>=0,U>>>=0,G>>>=0,Q>>>=0,this===w)return 0;let ee=Q-G,de=U-I,wt=Math.min(ee,de),kt=this.slice(G,Q),Et=w.slice(I,U);for(let dt=0;dt<wt;++dt)if(kt[dt]!==Et[dt]){ee=kt[dt],de=Et[dt];break}return ee<de?-1:de<ee?1:0},"compare");function b(w,I,U,G,Q){if(w.length===0)return-1;if(typeof U=="string"?(G=U,U=0):U>2147483647?U=2147483647:U<-2147483648&&(U=-2147483648),U=+U,Oe(U)&&(U=Q?0:w.length-1),U<0&&(U=w.length+U),U>=w.length){if(Q)return-1;U=w.length-1}else if(U<0)if(Q)U=0;else return-1;if(typeof I=="string"&&(I=a.from(I,G)),a.isBuffer(I))return I.length===0?-1:P(w,I,U,G,Q);if(typeof I=="number")return I=I&255,typeof Uint8Array.prototype.indexOf=="function"?Q?Uint8Array.prototype.indexOf.call(w,I,U):Uint8Array.prototype.lastIndexOf.call(w,I,U):P(w,[I],U,G,Q);throw new TypeError("val must be string, number or Buffer")}M(b,"bidirectionalIndexOf");function P(w,I,U,G,Q){let ee=1,de=w.length,wt=I.length;if(G!==void 0&&(G=String(G).toLowerCase(),G==="ucs2"||G==="ucs-2"||G==="utf16le"||G==="utf-16le")){if(w.length<2||I.length<2)return-1;ee=2,de/=2,wt/=2,U/=2}function kt(dt,It){return ee===1?dt[It]:dt.readUInt16BE(It*ee)}M(kt,"read");let Et;if(Q){let dt=-1;for(Et=U;Et<de;Et++)if(kt(w,Et)===kt(I,dt===-1?0:Et-dt)){if(dt===-1&&(dt=Et),Et-dt+1===wt)return dt*ee}else dt!==-1&&(Et-=Et-dt),dt=-1}else for(U+wt>de&&(U=de-wt),Et=U;Et>=0;Et--){let dt=!0;for(let It=0;It<wt;It++)if(kt(w,Et+It)!==kt(I,It)){dt=!1;break}if(dt)return Et}return-1}M(P,"arrayIndexOf"),a.prototype.includes=M(function(w,I,U){return this.indexOf(w,I,U)!==-1},"includes"),a.prototype.indexOf=M(function(w,I,U){return b(this,w,I,U,!0)},"indexOf"),a.prototype.lastIndexOf=M(function(w,I,U){return b(this,w,I,U,!1)},"lastIndexOf");function $(w,I,U,G){U=Number(U)||0;let Q=w.length-U;G?(G=Number(G),G>Q&&(G=Q)):G=Q;let ee=I.length;G>ee/2&&(G=ee/2);let de;for(de=0;de<G;++de){let wt=parseInt(I.substr(de*2,2),16);if(Oe(wt))return de;w[U+de]=wt}return de}M($,"hexWrite");function k(w,I,U,G){return Le(We(I,w.length-U),w,U,G)}M(k,"utf8Write");function D(w,I,U,G){return Le(Ge(I),w,U,G)}M(D,"asciiWrite");function B(w,I,U,G){return Le(vt(I),w,U,G)}M(B,"base64Write");function J(w,I,U,G){return Le(_t(I,w.length-U),w,U,G)}M(J,"ucs2Write"),a.prototype.write=M(function(w,I,U,G){if(I===void 0)G="utf8",U=this.length,I=0;else if(U===void 0&&typeof I=="string")G=I,U=this.length,I=0;else if(isFinite(I))I=I>>>0,isFinite(U)?(U=U>>>0,G===void 0&&(G="utf8")):(G=U,U=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let Q=this.length-I;if((U===void 0||U>Q)&&(U=Q),w.length>0&&(U<0||I<0)||I>this.length)throw new RangeError("Attempt to write outside buffer bounds");G||(G="utf8");let ee=!1;for(;;)switch(G){case"hex":return $(this,w,I,U);case"utf8":case"utf-8":return k(this,w,I,U);case"ascii":case"latin1":case"binary":return D(this,w,I,U);case"base64":return B(this,w,I,U);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return J(this,w,I,U);default:if(ee)throw new TypeError("Unknown encoding: "+G);G=(""+G).toLowerCase(),ee=!0}},"write"),a.prototype.toJSON=M(function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},"toJSON");function S(w,I,U){return I===0&&U===w.length?t.fromByteArray(w):t.fromByteArray(w.slice(I,U))}M(S,"base64Slice");function T(w,I,U){U=Math.min(w.length,U);let G=[],Q=I;for(;Q<U;){let ee=w[Q],de=null,wt=ee>239?4:ee>223?3:ee>191?2:1;if(Q+wt<=U){let kt,Et,dt,It;switch(wt){case 1:ee<128&&(de=ee);break;case 2:kt=w[Q+1],(kt&192)===128&&(It=(ee&31)<<6|kt&63,It>127&&(de=It));break;case 3:kt=w[Q+1],Et=w[Q+2],(kt&192)===128&&(Et&192)===128&&(It=(ee&15)<<12|(kt&63)<<6|Et&63,It>2047&&(It<55296||It>57343)&&(de=It));break;case 4:kt=w[Q+1],Et=w[Q+2],dt=w[Q+3],(kt&192)===128&&(Et&192)===128&&(dt&192)===128&&(It=(ee&15)<<18|(kt&63)<<12|(Et&63)<<6|dt&63,It>65535&&It<1114112&&(de=It))}}de===null?(de=65533,wt=1):de>65535&&(de-=65536,G.push(de>>>10&1023|55296),de=56320|de&1023),G.push(de),Q+=wt}return L(G)}M(T,"utf8Slice");var z=4096;function L(w){let I=w.length;if(I<=z)return String.fromCharCode.apply(String,w);let U="",G=0;for(;G<I;)U+=String.fromCharCode.apply(String,w.slice(G,G+=z));return U}M(L,"decodeCodePointsArray");function q(w,I,U){let G="";U=Math.min(w.length,U);for(let Q=I;Q<U;++Q)G+=String.fromCharCode(w[Q]&127);return G}M(q,"asciiSlice");function V(w,I,U){let G="";U=Math.min(w.length,U);for(let Q=I;Q<U;++Q)G+=String.fromCharCode(w[Q]);return G}M(V,"latin1Slice");function K(w,I,U){let G=w.length;(!I||I<0)&&(I=0),(!U||U<0||U>G)&&(U=G);let Q="";for(let ee=I;ee<U;++ee)Q+=kn[w[ee]];return Q}M(K,"hexSlice");function oe(w,I,U){let G=w.slice(I,U),Q="";for(let ee=0;ee<G.length-1;ee+=2)Q+=String.fromCharCode(G[ee]+G[ee+1]*256);return Q}M(oe,"utf16leSlice"),a.prototype.slice=M(function(w,I){let U=this.length;w=~~w,I=I===void 0?U:~~I,w<0?(w+=U,w<0&&(w=0)):w>U&&(w=U),I<0?(I+=U,I<0&&(I=0)):I>U&&(I=U),I<w&&(I=w);let G=this.subarray(w,I);return Object.setPrototypeOf(G,a.prototype),G},"slice");function ne(w,I,U){if(w%1!==0||w<0)throw new RangeError("offset is not uint");if(w+I>U)throw new RangeError("Trying to access beyond buffer length")}M(ne,"checkOffset"),a.prototype.readUintLE=a.prototype.readUIntLE=M(function(w,I,U){w=w>>>0,I=I>>>0,U||ne(w,I,this.length);let G=this[w],Q=1,ee=0;for(;++ee<I&&(Q*=256);)G+=this[w+ee]*Q;return G},"readUIntLE"),a.prototype.readUintBE=a.prototype.readUIntBE=M(function(w,I,U){w=w>>>0,I=I>>>0,U||ne(w,I,this.length);let G=this[w+--I],Q=1;for(;I>0&&(Q*=256);)G+=this[w+--I]*Q;return G},"readUIntBE"),a.prototype.readUint8=a.prototype.readUInt8=M(function(w,I){return w=w>>>0,I||ne(w,1,this.length),this[w]},"readUInt8"),a.prototype.readUint16LE=a.prototype.readUInt16LE=M(function(w,I){return w=w>>>0,I||ne(w,2,this.length),this[w]|this[w+1]<<8},"readUInt16LE"),a.prototype.readUint16BE=a.prototype.readUInt16BE=M(function(w,I){return w=w>>>0,I||ne(w,2,this.length),this[w]<<8|this[w+1]},"readUInt16BE"),a.prototype.readUint32LE=a.prototype.readUInt32LE=M(function(w,I){return w=w>>>0,I||ne(w,4,this.length),(this[w]|this[w+1]<<8|this[w+2]<<16)+this[w+3]*16777216},"readUInt32LE"),a.prototype.readUint32BE=a.prototype.readUInt32BE=M(function(w,I){return w=w>>>0,I||ne(w,4,this.length),this[w]*16777216+(this[w+1]<<16|this[w+2]<<8|this[w+3])},"readUInt32BE"),a.prototype.readBigUInt64LE=En(M(function(w){w=w>>>0,we(w,"offset");let I=this[w],U=this[w+7];(I===void 0||U===void 0)&&Ue(w,this.length-8);let G=I+this[++w]*2**8+this[++w]*2**16+this[++w]*2**24,Q=this[++w]+this[++w]*2**8+this[++w]*2**16+U*2**24;return BigInt(G)+(BigInt(Q)<<BigInt(32))},"readBigUInt64LE")),a.prototype.readBigUInt64BE=En(M(function(w){w=w>>>0,we(w,"offset");let I=this[w],U=this[w+7];(I===void 0||U===void 0)&&Ue(w,this.length-8);let G=I*2**24+this[++w]*2**16+this[++w]*2**8+this[++w],Q=this[++w]*2**24+this[++w]*2**16+this[++w]*2**8+U;return(BigInt(G)<<BigInt(32))+BigInt(Q)},"readBigUInt64BE")),a.prototype.readIntLE=M(function(w,I,U){w=w>>>0,I=I>>>0,U||ne(w,I,this.length);let G=this[w],Q=1,ee=0;for(;++ee<I&&(Q*=256);)G+=this[w+ee]*Q;return Q*=128,G>=Q&&(G-=Math.pow(2,8*I)),G},"readIntLE"),a.prototype.readIntBE=M(function(w,I,U){w=w>>>0,I=I>>>0,U||ne(w,I,this.length);let G=I,Q=1,ee=this[w+--G];for(;G>0&&(Q*=256);)ee+=this[w+--G]*Q;return Q*=128,ee>=Q&&(ee-=Math.pow(2,8*I)),ee},"readIntBE"),a.prototype.readInt8=M(function(w,I){return w=w>>>0,I||ne(w,1,this.length),this[w]&128?(255-this[w]+1)*-1:this[w]},"readInt8"),a.prototype.readInt16LE=M(function(w,I){w=w>>>0,I||ne(w,2,this.length);let U=this[w]|this[w+1]<<8;return U&32768?U|4294901760:U},"readInt16LE"),a.prototype.readInt16BE=M(function(w,I){w=w>>>0,I||ne(w,2,this.length);let U=this[w+1]|this[w]<<8;return U&32768?U|4294901760:U},"readInt16BE"),a.prototype.readInt32LE=M(function(w,I){return w=w>>>0,I||ne(w,4,this.length),this[w]|this[w+1]<<8|this[w+2]<<16|this[w+3]<<24},"readInt32LE"),a.prototype.readInt32BE=M(function(w,I){return w=w>>>0,I||ne(w,4,this.length),this[w]<<24|this[w+1]<<16|this[w+2]<<8|this[w+3]},"readInt32BE"),a.prototype.readBigInt64LE=En(M(function(w){w=w>>>0,we(w,"offset");let I=this[w],U=this[w+7];(I===void 0||U===void 0)&&Ue(w,this.length-8);let G=this[w+4]+this[w+5]*2**8+this[w+6]*2**16+(U<<24);return(BigInt(G)<<BigInt(32))+BigInt(I+this[++w]*2**8+this[++w]*2**16+this[++w]*2**24)},"readBigInt64LE")),a.prototype.readBigInt64BE=En(M(function(w){w=w>>>0,we(w,"offset");let I=this[w],U=this[w+7];(I===void 0||U===void 0)&&Ue(w,this.length-8);let G=(I<<24)+this[++w]*2**16+this[++w]*2**8+this[++w];return(BigInt(G)<<BigInt(32))+BigInt(this[++w]*2**24+this[++w]*2**16+this[++w]*2**8+U)},"readBigInt64BE")),a.prototype.readFloatLE=M(function(w,I){return w=w>>>0,I||ne(w,4,this.length),n.read(this,w,!0,23,4)},"readFloatLE"),a.prototype.readFloatBE=M(function(w,I){return w=w>>>0,I||ne(w,4,this.length),n.read(this,w,!1,23,4)},"readFloatBE"),a.prototype.readDoubleLE=M(function(w,I){return w=w>>>0,I||ne(w,8,this.length),n.read(this,w,!0,52,8)},"readDoubleLE"),a.prototype.readDoubleBE=M(function(w,I){return w=w>>>0,I||ne(w,8,this.length),n.read(this,w,!1,52,8)},"readDoubleBE");function X(w,I,U,G,Q,ee){if(!a.isBuffer(w))throw new TypeError('"buffer" argument must be a Buffer instance');if(I>Q||I<ee)throw new RangeError('"value" argument is out of bounds');if(U+G>w.length)throw new RangeError("Index out of range")}M(X,"checkInt"),a.prototype.writeUintLE=a.prototype.writeUIntLE=M(function(w,I,U,G){if(w=+w,I=I>>>0,U=U>>>0,!G){let de=Math.pow(2,8*U)-1;X(this,w,I,U,de,0)}let Q=1,ee=0;for(this[I]=w&255;++ee<U&&(Q*=256);)this[I+ee]=w/Q&255;return I+U},"writeUIntLE"),a.prototype.writeUintBE=a.prototype.writeUIntBE=M(function(w,I,U,G){if(w=+w,I=I>>>0,U=U>>>0,!G){let de=Math.pow(2,8*U)-1;X(this,w,I,U,de,0)}let Q=U-1,ee=1;for(this[I+Q]=w&255;--Q>=0&&(ee*=256);)this[I+Q]=w/ee&255;return I+U},"writeUIntBE"),a.prototype.writeUint8=a.prototype.writeUInt8=M(function(w,I,U){return w=+w,I=I>>>0,U||X(this,w,I,1,255,0),this[I]=w&255,I+1},"writeUInt8"),a.prototype.writeUint16LE=a.prototype.writeUInt16LE=M(function(w,I,U){return w=+w,I=I>>>0,U||X(this,w,I,2,65535,0),this[I]=w&255,this[I+1]=w>>>8,I+2},"writeUInt16LE"),a.prototype.writeUint16BE=a.prototype.writeUInt16BE=M(function(w,I,U){return w=+w,I=I>>>0,U||X(this,w,I,2,65535,0),this[I]=w>>>8,this[I+1]=w&255,I+2},"writeUInt16BE"),a.prototype.writeUint32LE=a.prototype.writeUInt32LE=M(function(w,I,U){return w=+w,I=I>>>0,U||X(this,w,I,4,4294967295,0),this[I+3]=w>>>24,this[I+2]=w>>>16,this[I+1]=w>>>8,this[I]=w&255,I+4},"writeUInt32LE"),a.prototype.writeUint32BE=a.prototype.writeUInt32BE=M(function(w,I,U){return w=+w,I=I>>>0,U||X(this,w,I,4,4294967295,0),this[I]=w>>>24,this[I+1]=w>>>16,this[I+2]=w>>>8,this[I+3]=w&255,I+4},"writeUInt32BE");function ae(w,I,U,G,Q){Ke(I,G,Q,w,U,7);let ee=Number(I&BigInt(4294967295));w[U++]=ee,ee=ee>>8,w[U++]=ee,ee=ee>>8,w[U++]=ee,ee=ee>>8,w[U++]=ee;let de=Number(I>>BigInt(32)&BigInt(4294967295));return w[U++]=de,de=de>>8,w[U++]=de,de=de>>8,w[U++]=de,de=de>>8,w[U++]=de,U}M(ae,"wrtBigUInt64LE");function he(w,I,U,G,Q){Ke(I,G,Q,w,U,7);let ee=Number(I&BigInt(4294967295));w[U+7]=ee,ee=ee>>8,w[U+6]=ee,ee=ee>>8,w[U+5]=ee,ee=ee>>8,w[U+4]=ee;let de=Number(I>>BigInt(32)&BigInt(4294967295));return w[U+3]=de,de=de>>8,w[U+2]=de,de=de>>8,w[U+1]=de,de=de>>8,w[U]=de,U+8}M(he,"wrtBigUInt64BE"),a.prototype.writeBigUInt64LE=En(M(function(w,I=0){return ae(this,w,I,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64LE")),a.prototype.writeBigUInt64BE=En(M(function(w,I=0){return he(this,w,I,BigInt(0),BigInt("0xffffffffffffffff"))},"writeBigUInt64BE")),a.prototype.writeIntLE=M(function(w,I,U,G){if(w=+w,I=I>>>0,!G){let wt=Math.pow(2,8*U-1);X(this,w,I,U,wt-1,-wt)}let Q=0,ee=1,de=0;for(this[I]=w&255;++Q<U&&(ee*=256);)w<0&&de===0&&this[I+Q-1]!==0&&(de=1),this[I+Q]=(w/ee>>0)-de&255;return I+U},"writeIntLE"),a.prototype.writeIntBE=M(function(w,I,U,G){if(w=+w,I=I>>>0,!G){let wt=Math.pow(2,8*U-1);X(this,w,I,U,wt-1,-wt)}let Q=U-1,ee=1,de=0;for(this[I+Q]=w&255;--Q>=0&&(ee*=256);)w<0&&de===0&&this[I+Q+1]!==0&&(de=1),this[I+Q]=(w/ee>>0)-de&255;return I+U},"writeIntBE"),a.prototype.writeInt8=M(function(w,I,U){return w=+w,I=I>>>0,U||X(this,w,I,1,127,-128),w<0&&(w=255+w+1),this[I]=w&255,I+1},"writeInt8"),a.prototype.writeInt16LE=M(function(w,I,U){return w=+w,I=I>>>0,U||X(this,w,I,2,32767,-32768),this[I]=w&255,this[I+1]=w>>>8,I+2},"writeInt16LE"),a.prototype.writeInt16BE=M(function(w,I,U){return w=+w,I=I>>>0,U||X(this,w,I,2,32767,-32768),this[I]=w>>>8,this[I+1]=w&255,I+2},"writeInt16BE"),a.prototype.writeInt32LE=M(function(w,I,U){return w=+w,I=I>>>0,U||X(this,w,I,4,2147483647,-2147483648),this[I]=w&255,this[I+1]=w>>>8,this[I+2]=w>>>16,this[I+3]=w>>>24,I+4},"writeInt32LE"),a.prototype.writeInt32BE=M(function(w,I,U){return w=+w,I=I>>>0,U||X(this,w,I,4,2147483647,-2147483648),w<0&&(w=4294967295+w+1),this[I]=w>>>24,this[I+1]=w>>>16,this[I+2]=w>>>8,this[I+3]=w&255,I+4},"writeInt32BE"),a.prototype.writeBigInt64LE=En(M(function(w,I=0){return ae(this,w,I,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64LE")),a.prototype.writeBigInt64BE=En(M(function(w,I=0){return he(this,w,I,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))},"writeBigInt64BE"));function ge(w,I,U,G,Q,ee){if(U+G>w.length)throw new RangeError("Index out of range");if(U<0)throw new RangeError("Index out of range")}M(ge,"checkIEEE754");function pe(w,I,U,G,Q){return I=+I,U=U>>>0,Q||ge(w,I,U,4),n.write(w,I,U,G,23,4),U+4}M(pe,"writeFloat"),a.prototype.writeFloatLE=M(function(w,I,U){return pe(this,w,I,!0,U)},"writeFloatLE"),a.prototype.writeFloatBE=M(function(w,I,U){return pe(this,w,I,!1,U)},"writeFloatBE");function fe(w,I,U,G,Q){return I=+I,U=U>>>0,Q||ge(w,I,U,8),n.write(w,I,U,G,52,8),U+8}M(fe,"writeDouble"),a.prototype.writeDoubleLE=M(function(w,I,U){return fe(this,w,I,!0,U)},"writeDoubleLE"),a.prototype.writeDoubleBE=M(function(w,I,U){return fe(this,w,I,!1,U)},"writeDoubleBE"),a.prototype.copy=M(function(w,I,U,G){if(!a.isBuffer(w))throw new TypeError("argument should be a Buffer");if(U||(U=0),!G&&G!==0&&(G=this.length),I>=w.length&&(I=w.length),I||(I=0),G>0&&G<U&&(G=U),G===U||w.length===0||this.length===0)return 0;if(I<0)throw new RangeError("targetStart out of bounds");if(U<0||U>=this.length)throw new RangeError("Index out of range");if(G<0)throw new RangeError("sourceEnd out of bounds");G>this.length&&(G=this.length),w.length-I<G-U&&(G=w.length-I+U);let Q=G-U;return this===w&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(I,U,G):Uint8Array.prototype.set.call(w,this.subarray(U,G),I),Q},"copy"),a.prototype.fill=M(function(w,I,U,G){if(typeof w=="string"){if(typeof I=="string"?(G=I,I=0,U=this.length):typeof U=="string"&&(G=U,U=this.length),G!==void 0&&typeof G!="string")throw new TypeError("encoding must be a string");if(typeof G=="string"&&!a.isEncoding(G))throw new TypeError("Unknown encoding: "+G);if(w.length===1){let ee=w.charCodeAt(0);(G==="utf8"&&ee<128||G==="latin1")&&(w=ee)}}else typeof w=="number"?w=w&255:typeof w=="boolean"&&(w=Number(w));if(I<0||this.length<I||this.length<U)throw new RangeError("Out of range index");if(U<=I)return this;I=I>>>0,U=U===void 0?this.length:U>>>0,w||(w=0);let Q;if(typeof w=="number")for(Q=I;Q<U;++Q)this[Q]=w;else{let ee=a.isBuffer(w)?w:a.from(w,G),de=ee.length;if(de===0)throw new TypeError('The value "'+w+'" is invalid for argument "value"');for(Q=0;Q<U-I;++Q)this[Q+I]=ee[Q%de]}return this},"fill");var xe={};function Ce(w,I,U){var G;xe[w]=(G=class extends U{constructor(){super(),Object.defineProperty(this,"message",{value:I.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${w}]`,this.stack,delete this.name}get code(){return w}set code(Q){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:Q,writable:!0})}toString(){return`${this.name} [${w}]: ${this.message}`}},M(G,"NodeError"),G)}M(Ce,"E"),Ce("ERR_BUFFER_OUT_OF_BOUNDS",function(w){return w?`${w} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),Ce("ERR_INVALID_ARG_TYPE",function(w,I){return`The "${w}" argument must be of type number. Received type ${typeof I}`},TypeError),Ce("ERR_OUT_OF_RANGE",function(w,I,U){let G=`The value of "${w}" is out of range.`,Q=U;return Number.isInteger(U)&&Math.abs(U)>2**32?Q=Ze(String(U)):typeof U=="bigint"&&(Q=String(U),(U>BigInt(2)**BigInt(32)||U<-(BigInt(2)**BigInt(32)))&&(Q=Ze(Q)),Q+="n"),G+=` It must be ${I}. Received ${Q}`,G},RangeError);function Ze(w){let I="",U=w.length,G=w[0]==="-"?1:0;for(;U>=G+4;U-=3)I=`_${w.slice(U-3,U)}${I}`;return`${w.slice(0,U)}${I}`}M(Ze,"addNumericalSeparator");function st(w,I,U){we(I,"offset"),(w[I]===void 0||w[I+U]===void 0)&&Ue(I,w.length-(U+1))}M(st,"checkBounds");function Ke(w,I,U,G,Q,ee){if(w>U||w<I){let de=typeof I=="bigint"?"n":"",wt;throw ee>3?I===0||I===BigInt(0)?wt=`>= 0${de} and < 2${de} ** ${(ee+1)*8}${de}`:wt=`>= -(2${de} ** ${(ee+1)*8-1}${de}) and < 2 ** ${(ee+1)*8-1}${de}`:wt=`>= ${I}${de} and <= ${U}${de}`,new xe.ERR_OUT_OF_RANGE("value",wt,w)}st(G,Q,ee)}M(Ke,"checkIntBI");function we(w,I){if(typeof w!="number")throw new xe.ERR_INVALID_ARG_TYPE(I,"number",w)}M(we,"validateNumber");function Ue(w,I,U){throw Math.floor(w)!==w?(we(w,U),new xe.ERR_OUT_OF_RANGE(U||"offset","an integer",w)):I<0?new xe.ERR_BUFFER_OUT_OF_BOUNDS:new xe.ERR_OUT_OF_RANGE(U||"offset",`>= ${U?1:0} and <= ${I}`,w)}M(Ue,"boundsError");var Ct=/[^+/0-9A-Za-z-_]/g;function Ie(w){if(w=w.split("=")[0],w=w.trim().replace(Ct,""),w.length<2)return"";for(;w.length%4!==0;)w=w+"=";return w}M(Ie,"base64clean");function We(w,I){I=I||1/0;let U,G=w.length,Q=null,ee=[];for(let de=0;de<G;++de){if(U=w.charCodeAt(de),U>55295&&U<57344){if(!Q){if(U>56319){(I-=3)>-1&&ee.push(239,191,189);continue}else if(de+1===G){(I-=3)>-1&&ee.push(239,191,189);continue}Q=U;continue}if(U<56320){(I-=3)>-1&&ee.push(239,191,189),Q=U;continue}U=(Q-55296<<10|U-56320)+65536}else Q&&(I-=3)>-1&&ee.push(239,191,189);if(Q=null,U<128){if((I-=1)<0)break;ee.push(U)}else if(U<2048){if((I-=2)<0)break;ee.push(U>>6|192,U&63|128)}else if(U<65536){if((I-=3)<0)break;ee.push(U>>12|224,U>>6&63|128,U&63|128)}else if(U<1114112){if((I-=4)<0)break;ee.push(U>>18|240,U>>12&63|128,U>>6&63|128,U&63|128)}else throw new Error("Invalid code point")}return ee}M(We,"utf8ToBytes");function Ge(w){let I=[];for(let U=0;U<w.length;++U)I.push(w.charCodeAt(U)&255);return I}M(Ge,"asciiToBytes");function _t(w,I){let U,G,Q,ee=[];for(let de=0;de<w.length&&!((I-=2)<0);++de)U=w.charCodeAt(de),G=U>>8,Q=U%256,ee.push(Q),ee.push(G);return ee}M(_t,"utf16leToBytes");function vt(w){return t.toByteArray(Ie(w))}M(vt,"base64ToBytes");function Le(w,I,U,G){let Q;for(Q=0;Q<G&&!(Q+U>=I.length||Q>=w.length);++Q)I[Q+U]=w[Q];return Q}M(Le,"blitBuffer");function Be(w,I){return w instanceof I||w!=null&&w.constructor!=null&&w.constructor.name!=null&&w.constructor.name===I.name}M(Be,"isInstance");function Oe(w){return w!==w}M(Oe,"numberIsNaN");var kn=(function(){let w="0123456789abcdef",I=new Array(256);for(let U=0;U<16;++U){let G=U*16;for(let Q=0;Q<16;++Q)I[G+Q]=w[U]+w[Q]}return I})();function En(w){return typeof BigInt>"u"?Xt:w}M(En,"defineBigIntMethod");function Xt(){throw new Error("BigInt not supported")}M(Xt,"BufferBigIntNotDefined")}),Hh,c0,qe,ct,$e=kr(()=>{Hh=globalThis,c0=globalThis.setImmediate??(e=>setTimeout(e,0)),qe=typeof globalThis.Buffer=="function"&&typeof globalThis.Buffer.allocUnsafe=="function"?globalThis.Buffer:yZ().Buffer,ct=globalThis.process??{},ct.env??(ct.env={});try{ct.nextTick(()=>{})}catch{let e=Promise.resolve();ct.nextTick=e.then.bind(e)}}),sa=ut((e,t)=>{$e();var n=typeof Reflect=="object"?Reflect:null,i=n&&typeof n.apply=="function"?n.apply:M(function(b,P,$){return Function.prototype.apply.call(b,P,$)},"ReflectApply"),r;n&&typeof n.ownKeys=="function"?r=n.ownKeys:Object.getOwnPropertySymbols?r=M(function(b){return Object.getOwnPropertyNames(b).concat(Object.getOwnPropertySymbols(b))},"ReflectOwnKeys"):r=M(function(b){return Object.getOwnPropertyNames(b)},"ReflectOwnKeys");function o(b){console&&console.warn&&console.warn(b)}M(o,"ProcessEmitWarning");var s=Number.isNaN||M(function(b){return b!==b},"NumberIsNaN");function a(){a.init.call(this)}M(a,"EventEmitter"),t.exports=a,t.exports.once=E,a.EventEmitter=a,a.prototype._events=void 0,a.prototype._eventsCount=0,a.prototype._maxListeners=void 0;var c=10;function l(b){if(typeof b!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof b)}M(l,"checkListener"),Object.defineProperty(a,"defaultMaxListeners",{enumerable:!0,get:M(function(){return c},"get"),set:M(function(b){if(typeof b!="number"||b<0||s(b))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+b+".");c=b},"set")}),a.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},a.prototype.setMaxListeners=M(function(b){if(typeof b!="number"||b<0||s(b))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+b+".");return this._maxListeners=b,this},"setMaxListeners");function u(b){return b._maxListeners===void 0?a.defaultMaxListeners:b._maxListeners}M(u,"_getMaxListeners"),a.prototype.getMaxListeners=M(function(){return u(this)},"getMaxListeners"),a.prototype.emit=M(function(b){for(var P=[],$=1;$<arguments.length;$++)P.push(arguments[$]);var k=b==="error",D=this._events;if(D!==void 0)k=k&&D.error===void 0;else if(!k)return!1;if(k){var B;if(P.length>0&&(B=P[0]),B instanceof Error)throw B;var J=new Error("Unhandled error."+(B?" ("+B.message+")":""));throw J.context=B,J}var S=D[b];if(S===void 0)return!1;if(typeof S=="function")i(S,this,P);else for(var T=S.length,z=y(S,T),$=0;$<T;++$)i(z[$],this,P);return!0},"emit");function p(b,P,$,k){var D,B,J;if(l($),B=b._events,B===void 0?(B=b._events=Object.create(null),b._eventsCount=0):(B.newListener!==void 0&&(b.emit("newListener",P,$.listener?$.listener:$),B=b._events),J=B[P]),J===void 0)J=B[P]=$,++b._eventsCount;else if(typeof J=="function"?J=B[P]=k?[$,J]:[J,$]:k?J.unshift($):J.push($),D=u(b),D>0&&J.length>D&&!J.warned){J.warned=!0;var S=new Error("Possible EventEmitter memory leak detected. "+J.length+" "+String(P)+" listeners added. Use emitter.setMaxListeners() to increase limit");S.name="MaxListenersExceededWarning",S.emitter=b,S.type=P,S.count=J.length,o(S)}return b}M(p,"_addListener"),a.prototype.addListener=M(function(b,P){return p(this,b,P,!1)},"addListener"),a.prototype.on=a.prototype.addListener,a.prototype.prependListener=M(function(b,P){return p(this,b,P,!0)},"prependListener");function f(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}M(f,"onceWrapper");function g(b,P,$){var k={fired:!1,wrapFn:void 0,target:b,type:P,listener:$},D=f.bind(k);return D.listener=$,k.wrapFn=D,D}M(g,"_onceWrap"),a.prototype.once=M(function(b,P){return l(P),this.on(b,g(this,b,P)),this},"once"),a.prototype.prependOnceListener=M(function(b,P){return l(P),this.prependListener(b,g(this,b,P)),this},"prependOnceListener"),a.prototype.removeListener=M(function(b,P){var $,k,D,B,J;if(l(P),k=this._events,k===void 0)return this;if($=k[b],$===void 0)return this;if($===P||$.listener===P)--this._eventsCount===0?this._events=Object.create(null):(delete k[b],k.removeListener&&this.emit("removeListener",b,$.listener||P));else if(typeof $!="function"){for(D=-1,B=$.length-1;B>=0;B--)if($[B]===P||$[B].listener===P){J=$[B].listener,D=B;break}if(D<0)return this;D===0?$.shift():v($,D),$.length===1&&(k[b]=$[0]),k.removeListener!==void 0&&this.emit("removeListener",b,J||P)}return this},"removeListener"),a.prototype.off=a.prototype.removeListener,a.prototype.removeAllListeners=M(function(b){var P,$,k;if($=this._events,$===void 0)return this;if($.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):$[b]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete $[b]),this;if(arguments.length===0){var D=Object.keys($),B;for(k=0;k<D.length;++k)B=D[k],B!=="removeListener"&&this.removeAllListeners(B);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(P=$[b],typeof P=="function")this.removeListener(b,P);else if(P!==void 0)for(k=P.length-1;k>=0;k--)this.removeListener(b,P[k]);return this},"removeAllListeners");function h(b,P,$){var k=b._events;if(k===void 0)return[];var D=k[P];return D===void 0?[]:typeof D=="function"?$?[D.listener||D]:[D]:$?x(D):y(D,D.length)}M(h,"_listeners"),a.prototype.listeners=M(function(b){return h(this,b,!0)},"listeners"),a.prototype.rawListeners=M(function(b){return h(this,b,!1)},"rawListeners"),a.listenerCount=function(b,P){return typeof b.listenerCount=="function"?b.listenerCount(P):d.call(b,P)},a.prototype.listenerCount=d;function d(b){var P=this._events;if(P!==void 0){var $=P[b];if(typeof $=="function")return 1;if($!==void 0)return $.length}return 0}M(d,"listenerCount"),a.prototype.eventNames=M(function(){return this._eventsCount>0?r(this._events):[]},"eventNames");function y(b,P){for(var $=new Array(P),k=0;k<P;++k)$[k]=b[k];return $}M(y,"arrayClone");function v(b,P){for(;P+1<b.length;P++)b[P]=b[P+1];b.pop()}M(v,"spliceOne");function x(b){for(var P=new Array(b.length),$=0;$<P.length;++$)P[$]=b[$].listener||b[$];return P}M(x,"unwrapListeners");function E(b,P){return new Promise(function($,k){function D(J){b.removeListener(P,B),k(J)}M(D,"errorListener");function B(){typeof b.removeListener=="function"&&b.removeListener("error",D),$([].slice.call(arguments))}M(B,"resolver"),C(b,P,B,{once:!0}),P!=="error"&&N(b,D,{once:!0})})}M(E,"once");function N(b,P,$){typeof b.on=="function"&&C(b,"error",P,$)}M(N,"addErrorHandlerIfEventEmitter");function C(b,P,$,k){if(typeof b.on=="function")k.once?b.once(P,$):b.on(P,$);else if(typeof b.addEventListener=="function")b.addEventListener(P,M(function D(B){k.once&&b.removeEventListener(P,D),$(B)},"wrapListener"));else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof b)}M(C,"eventTargetAgnosticAddListener")}),ER={};xi(ER,{Socket:()=>Ul,isIP:()=>AR});function AR(e){return 0}var Qx,_g,Zc,Ul,Gu=kr(()=>{$e(),Qx=oa(sa(),1),M(AR,"isIP"),_g=/^[^.]+\./,Zc=class Me extends Qx.EventEmitter{constructor(){super(...arguments),Je(this,"opts",{}),Je(this,"connecting",!1),Je(this,"pending",!0),Je(this,"writable",!0),Je(this,"encrypted",!1),Je(this,"authorized",!1),Je(this,"destroyed",!1),Je(this,"ws",null),Je(this,"writeBuffer"),Je(this,"tlsState",0),Je(this,"tlsRead"),Je(this,"tlsWrite")}static get poolQueryViaFetch(){return Me.opts.poolQueryViaFetch??Me.defaults.poolQueryViaFetch}static set poolQueryViaFetch(t){Me.opts.poolQueryViaFetch=t}static get fetchEndpoint(){return Me.opts.fetchEndpoint??Me.defaults.fetchEndpoint}static set fetchEndpoint(t){Me.opts.fetchEndpoint=t}static get fetchConnectionCache(){return!0}static set fetchConnectionCache(t){console.warn("The `fetchConnectionCache` option is deprecated (now always `true`)")}static get fetchFunction(){return Me.opts.fetchFunction??Me.defaults.fetchFunction}static set fetchFunction(t){Me.opts.fetchFunction=t}static get webSocketConstructor(){return Me.opts.webSocketConstructor??Me.defaults.webSocketConstructor}static set webSocketConstructor(t){Me.opts.webSocketConstructor=t}get webSocketConstructor(){return this.opts.webSocketConstructor??Me.webSocketConstructor}set webSocketConstructor(t){this.opts.webSocketConstructor=t}static get wsProxy(){return Me.opts.wsProxy??Me.defaults.wsProxy}static set wsProxy(t){Me.opts.wsProxy=t}get wsProxy(){return this.opts.wsProxy??Me.wsProxy}set wsProxy(t){this.opts.wsProxy=t}static get coalesceWrites(){return Me.opts.coalesceWrites??Me.defaults.coalesceWrites}static set coalesceWrites(t){Me.opts.coalesceWrites=t}get coalesceWrites(){return this.opts.coalesceWrites??Me.coalesceWrites}set coalesceWrites(t){this.opts.coalesceWrites=t}static get useSecureWebSocket(){return Me.opts.useSecureWebSocket??Me.defaults.useSecureWebSocket}static set useSecureWebSocket(t){Me.opts.useSecureWebSocket=t}get useSecureWebSocket(){return this.opts.useSecureWebSocket??Me.useSecureWebSocket}set useSecureWebSocket(t){this.opts.useSecureWebSocket=t}static get forceDisablePgSSL(){return Me.opts.forceDisablePgSSL??Me.defaults.forceDisablePgSSL}static set forceDisablePgSSL(t){Me.opts.forceDisablePgSSL=t}get forceDisablePgSSL(){return this.opts.forceDisablePgSSL??Me.forceDisablePgSSL}set forceDisablePgSSL(t){this.opts.forceDisablePgSSL=t}static get disableSNI(){return Me.opts.disableSNI??Me.defaults.disableSNI}static set disableSNI(t){Me.opts.disableSNI=t}get disableSNI(){return this.opts.disableSNI??Me.disableSNI}set disableSNI(t){this.opts.disableSNI=t}static get disableWarningInBrowsers(){return Me.opts.disableWarningInBrowsers??Me.defaults.disableWarningInBrowsers}static set disableWarningInBrowsers(t){Me.opts.disableWarningInBrowsers=t}get disableWarningInBrowsers(){return this.opts.disableWarningInBrowsers??Me.disableWarningInBrowsers}set disableWarningInBrowsers(t){this.opts.disableWarningInBrowsers=t}static get pipelineConnect(){return Me.opts.pipelineConnect??Me.defaults.pipelineConnect}static set pipelineConnect(t){Me.opts.pipelineConnect=t}get pipelineConnect(){return this.opts.pipelineConnect??Me.pipelineConnect}set pipelineConnect(t){this.opts.pipelineConnect=t}static get subtls(){return Me.opts.subtls??Me.defaults.subtls}static set subtls(t){Me.opts.subtls=t}get subtls(){return this.opts.subtls??Me.subtls}set subtls(t){this.opts.subtls=t}static get pipelineTLS(){return Me.opts.pipelineTLS??Me.defaults.pipelineTLS}static set pipelineTLS(t){Me.opts.pipelineTLS=t}get pipelineTLS(){return this.opts.pipelineTLS??Me.pipelineTLS}set pipelineTLS(t){this.opts.pipelineTLS=t}static get rootCerts(){return Me.opts.rootCerts??Me.defaults.rootCerts}static set rootCerts(t){Me.opts.rootCerts=t}get rootCerts(){return this.opts.rootCerts??Me.rootCerts}set rootCerts(t){this.opts.rootCerts=t}wsProxyAddrForHost(t,n){let i=this.wsProxy;if(i===void 0)throw new Error("No WebSocket proxy is configured. Please see https://github.com/neondatabase/serverless/blob/main/CONFIG.md#wsproxy-string--host-string-port-number--string--string");return typeof i=="function"?i(t,n):`${i}?address=${t}:${n}`}setNoDelay(){return this}setKeepAlive(){return this}ref(){return this}unref(){return this}connect(t,n,i){this.connecting=!0,i&&this.once("connect",i);let r=M(()=>{this.connecting=!1,this.pending=!1,this.emit("connect"),this.emit("ready")},"handleWebSocketOpen"),o=M((a,c=!1)=>{a.binaryType="arraybuffer",a.addEventListener("error",l=>{this.emit("error",l),this.emit("close")}),a.addEventListener("message",l=>{if(this.tlsState===0){let u=qe.from(l.data);this.emit("data",u)}}),a.addEventListener("close",()=>{this.emit("close")}),c?r():a.addEventListener("open",r)},"configureWebSocket"),s;try{s=this.wsProxyAddrForHost(n,typeof t=="string"?parseInt(t,10):t)}catch(a){this.emit("error",a),this.emit("close");return}try{let a=(this.useSecureWebSocket?"wss:":"ws:")+"//"+s;if(this.webSocketConstructor!==void 0)this.ws=new this.webSocketConstructor(a),o(this.ws);else try{this.ws=new WebSocket(a),o(this.ws)}catch{this.ws=new __unstable_WebSocket(a),o(this.ws)}}catch(a){let c=(this.useSecureWebSocket?"https:":"http:")+"//"+s;fetch(c,{headers:{Upgrade:"websocket"}}).then(l=>{if(this.ws=l.webSocket,this.ws==null)throw a;this.ws.accept(),o(this.ws,!0)}).catch(l=>{this.emit("error",new Error(`All attempts to open a WebSocket to connect to the database failed. Please refer to https://github.com/neondatabase/serverless/blob/main/CONFIG.md#websocketconstructor-typeof-websocket--undefined. Details: ${l}`)),this.emit("close")})}}async startTls(t){if(this.subtls===void 0)throw new Error("For Postgres SSL connections, you must set `neonConfig.subtls` to the subtls library. See https://github.com/neondatabase/serverless/blob/main/CONFIG.md for more information.");this.tlsState=1;let n=await this.subtls.TrustedCert.databaseFromPEM(this.rootCerts),i=new this.subtls.WebSocketReadQueue(this.ws),r=i.read.bind(i),o=this.rawWrite.bind(this),{read:s,write:a}=await this.subtls.startTls(t,n,r,o,{useSNI:!this.disableSNI,expectPreData:this.pipelineTLS?new Uint8Array([83]):void 0});this.tlsRead=s,this.tlsWrite=a,this.tlsState=2,this.encrypted=!0,this.authorized=!0,this.emit("secureConnection",this),this.tlsReadLoop()}async tlsReadLoop(){for(;;){let t=await this.tlsRead();if(t===void 0)break;{let n=qe.from(t);this.emit("data",n)}}}rawWrite(t){if(!this.coalesceWrites){this.ws&&this.ws.send(t);return}if(this.writeBuffer===void 0)this.writeBuffer=t,setTimeout(()=>{this.ws&&this.ws.send(this.writeBuffer),this.writeBuffer=void 0},0);else{let n=new Uint8Array(this.writeBuffer.length+t.length);n.set(this.writeBuffer),n.set(t,this.writeBuffer.length),this.writeBuffer=n}}write(t,n="utf8",i=r=>{}){return t.length===0?(i(),!0):(typeof t=="string"&&(t=qe.from(t,n)),this.tlsState===0?(this.rawWrite(t),i()):this.tlsState===1?this.once("secureConnection",()=>{this.write(t,n,i)}):(this.tlsWrite(t),i()),!0)}end(t=qe.alloc(0),n="utf8",i=()=>{}){return this.write(t,n,()=>{this.ws.close(),i()}),this}destroy(){return this.destroyed=!0,this.end()}},M(Zc,"Socket"),Je(Zc,"defaults",{poolQueryViaFetch:!1,fetchEndpoint:M((e,t,n)=>{let i;return n?.jwtAuth?i=e.replace(_g,"apiauth."):i=e.replace(_g,"api."),"https://"+i+"/sql"},"fetchEndpoint"),fetchConnectionCache:!0,fetchFunction:void 0,webSocketConstructor:void 0,wsProxy:M(e=>e+"/v2","wsProxy"),useSecureWebSocket:!0,forceDisablePgSSL:!0,coalesceWrites:!0,pipelineConnect:"password",subtls:void 0,rootCerts:"",pipelineTLS:!1,disableSNI:!1,disableWarningInBrowsers:!1}),Je(Zc,"opts",{}),Ul=Zc}),TR={};xi(TR,{parse:()=>l0});function l0(e,t=!1){let{protocol:n}=new URL(e),i="http:"+e.substring(n.length),{username:r,password:o,host:s,hostname:a,port:c,pathname:l,search:u,searchParams:p,hash:f}=new URL(i);o=decodeURIComponent(o),r=decodeURIComponent(r),l=decodeURIComponent(l);let g=r+":"+o,h=t?Object.fromEntries(p.entries()):u;return{href:e,protocol:n,auth:g,username:r,password:o,host:s,hostname:a,port:c,pathname:l,search:u,query:h,hash:f}}var IR=kr(()=>{$e(),M(l0,"parse")}),NR=ut(e=>{$e(),e.parse=function(r,o){return new n(r,o).parse()};var t=class $R{constructor(o,s){this.source=o,this.transform=s||i,this.position=0,this.entries=[],this.recorded=[],this.dimension=0}isEof(){return this.position>=this.source.length}nextCharacter(){var o=this.source[this.position++];return o==="\\"?{value:this.source[this.position++],escaped:!0}:{value:o,escaped:!1}}record(o){this.recorded.push(o)}newEntry(o){var s;(this.recorded.length>0||o)&&(s=this.recorded.join(""),s==="NULL"&&!o&&(s=null),s!==null&&(s=this.transform(s)),this.entries.push(s),this.recorded=[])}consumeDimensions(){if(this.source[0]==="[")for(;!this.isEof();){var o=this.nextCharacter();if(o.value==="=")break}}parse(o){var s,a,c;for(this.consumeDimensions();!this.isEof();)if(s=this.nextCharacter(),s.value==="{"&&!c)this.dimension++,this.dimension>1&&(a=new $R(this.source.substr(this.position-1),this.transform),this.entries.push(a.parse(!0)),this.position+=a.position-2);else if(s.value==="}"&&!c){if(this.dimension--,!this.dimension&&(this.newEntry(),o))return this.entries}else s.value==='"'&&!s.escaped?(c&&this.newEntry(!0),c=!c):s.value===","&&!c?this.newEntry():this.record(s.value);if(this.dimension!==0)throw new Error("array dimension not balanced");return this.entries}};M(t,"ArrayParser");var n=t;function i(r){return r}M(i,"identity")}),CR=ut((e,t)=>{$e();var n=NR();t.exports={create:M(function(i,r){return{parse:M(function(){return n.parse(i,r)},"parse")}},"create")}}),wZ=ut((e,t)=>{$e();var n=/(\d{1,})-(\d{2})-(\d{2}) (\d{2}):(\d{2}):(\d{2})(\.\d{1,})?.*?( BC)?$/,i=/^(\d{1,})-(\d{2})-(\d{2})( BC)?$/,r=/([Z+-])(\d{2})?:?(\d{2})?:?(\d{2})?/,o=/^-?infinity$/;t.exports=M(function(u){if(o.test(u))return Number(u.replace("i","I"));var p=n.exec(u);if(!p)return s(u)||null;var f=!!p[8],g=parseInt(p[1],10);f&&(g=c(g));var h=parseInt(p[2],10)-1,d=p[3],y=parseInt(p[4],10),v=parseInt(p[5],10),x=parseInt(p[6],10),E=p[7];E=E?1e3*parseFloat(E):0;var N,C=a(u);return C!=null?(N=new Date(Date.UTC(g,h,d,y,v,x,E)),l(g)&&N.setUTCFullYear(g),C!==0&&N.setTime(N.getTime()-C)):(N=new Date(g,h,d,y,v,x,E),l(g)&&N.setFullYear(g)),N},"parseDate");function s(u){var p=i.exec(u);if(p){var f=parseInt(p[1],10),g=!!p[4];g&&(f=c(f));var h=parseInt(p[2],10)-1,d=p[3],y=new Date(f,h,d);return l(f)&&y.setFullYear(f),y}}M(s,"getDate");function a(u){if(u.endsWith("+00"))return 0;var p=r.exec(u.split(" ")[1]);if(p){var f=p[1];if(f==="Z")return 0;var g=f==="-"?-1:1,h=parseInt(p[2],10)*3600+parseInt(p[3]||0,10)*60+parseInt(p[4]||0,10);return h*g*1e3}}M(a,"timeZoneOffset");function c(u){return-(u-1)}M(c,"bcYearToNegativeYear");function l(u){return u>=0&&u<100}M(l,"is0To99")}),vZ=ut((e,t)=>{$e(),t.exports=i;var n=Object.prototype.hasOwnProperty;function i(r){for(var o=1;o<arguments.length;o++){var s=arguments[o];for(var a in s)n.call(s,a)&&(r[a]=s[a])}return r}M(i,"extend")}),bZ=ut((e,t)=>{$e();var n=vZ();t.exports=i;function i(x){if(!(this instanceof i))return new i(x);n(this,v(x))}M(i,"PostgresInterval");var r=["seconds","minutes","hours","days","months","years"];i.prototype.toPostgres=function(){var x=r.filter(this.hasOwnProperty,this);return this.milliseconds&&x.indexOf("seconds")<0&&x.push("seconds"),x.length===0?"0":x.map(function(E){var N=this[E]||0;return E==="seconds"&&this.milliseconds&&(N=(N+this.milliseconds/1e3).toFixed(6).replace(/\.?0+$/,"")),N+" "+E},this).join(" ")};var o={years:"Y",months:"M",days:"D",hours:"H",minutes:"M",seconds:"S"},s=["years","months","days"],a=["hours","minutes","seconds"];i.prototype.toISOString=i.prototype.toISO=function(){var x=s.map(N,this).join(""),E=a.map(N,this).join("");return"P"+x+"T"+E;function N(C){var b=this[C]||0;return C==="seconds"&&this.milliseconds&&(b=(b+this.milliseconds/1e3).toFixed(6).replace(/0+$/,"")),b+o[C]}};var c="([+-]?\\d+)",l=c+"\\s+years?",u=c+"\\s+mons?",p=c+"\\s+days?",f="([+-])?([\\d]*):(\\d\\d):(\\d\\d)\\.?(\\d{1,6})?",g=new RegExp([l,u,p,f].map(function(x){return"("+x+")?"}).join("\\s*")),h={years:2,months:4,days:6,hours:9,minutes:10,seconds:11,milliseconds:12},d=["hours","minutes","seconds","milliseconds"];function y(x){var E=x+"000000".slice(x.length);return parseInt(E,10)/1e3}M(y,"parseMilliseconds");function v(x){if(!x)return{};var E=g.exec(x),N=E[8]==="-";return Object.keys(h).reduce(function(C,b){var P=h[b],$=E[P];return!$||($=b==="milliseconds"?y($):parseInt($,10),!$)||(N&&~d.indexOf(b)&&($*=-1),C[b]=$),C},{})}M(v,"parse")}),_Z=ut((e,t)=>{$e(),t.exports=M(function(n){if(/^\\x/.test(n))return new qe(n.substr(2),"hex");for(var i="",r=0;r<n.length;)if(n[r]!=="\\")i+=n[r],++r;else if(/[0-7]{3}/.test(n.substr(r+1,3)))i+=String.fromCharCode(parseInt(n.substr(r+1,3),8)),r+=4;else{for(var o=1;r+o<n.length&&n[r+o]==="\\";)o++;for(var s=0;s<Math.floor(o/2);++s)i+="\\";r+=Math.floor(o/2)*2}return new qe(i,"binary")},"parseBytea")}),SZ=ut((e,t)=>{$e();var n=NR(),i=CR(),r=wZ(),o=bZ(),s=_Z();function a(k){return M(function(D){return D===null?D:k(D)},"nullAllowed")}M(a,"allowNull");function c(k){return k===null?k:k==="TRUE"||k==="t"||k==="true"||k==="y"||k==="yes"||k==="on"||k==="1"}M(c,"parseBool");function l(k){return k?n.parse(k,c):null}M(l,"parseBoolArray");function u(k){return parseInt(k,10)}M(u,"parseBaseTenInt");function p(k){return k?n.parse(k,a(u)):null}M(p,"parseIntegerArray");function f(k){return k?n.parse(k,a(function(D){return N(D).trim()})):null}M(f,"parseBigIntegerArray");var g=M(function(k){if(!k)return null;var D=i.create(k,function(B){return B!==null&&(B=b(B)),B});return D.parse()},"parsePointArray"),h=M(function(k){if(!k)return null;var D=i.create(k,function(B){return B!==null&&(B=parseFloat(B)),B});return D.parse()},"parseFloatArray"),d=M(function(k){if(!k)return null;var D=i.create(k);return D.parse()},"parseStringArray"),y=M(function(k){if(!k)return null;var D=i.create(k,function(B){return B!==null&&(B=r(B)),B});return D.parse()},"parseDateArray"),v=M(function(k){if(!k)return null;var D=i.create(k,function(B){return B!==null&&(B=o(B)),B});return D.parse()},"parseIntervalArray"),x=M(function(k){return k?n.parse(k,a(s)):null},"parseByteAArray"),E=M(function(k){return parseInt(k,10)},"parseInteger"),N=M(function(k){var D=String(k);return/^\d+$/.test(D)?D:k},"parseBigInteger"),C=M(function(k){return k?n.parse(k,a(JSON.parse)):null},"parseJsonArray"),b=M(function(k){return k[0]!=="("?null:(k=k.substring(1,k.length-1).split(","),{x:parseFloat(k[0]),y:parseFloat(k[1])})},"parsePoint"),P=M(function(k){if(k[0]!=="<"&&k[1]!=="(")return null;for(var D="(",B="",J=!1,S=2;S<k.length-1;S++){if(J||(D+=k[S]),k[S]===")"){J=!0;continue}else if(!J)continue;k[S]!==","&&(B+=k[S])}var T=b(D);return T.radius=parseFloat(B),T},"parseCircle"),$=M(function(k){k(20,N),k(21,E),k(23,E),k(26,E),k(700,parseFloat),k(701,parseFloat),k(16,c),k(1082,r),k(1114,r),k(1184,r),k(600,b),k(651,d),k(718,P),k(1e3,l),k(1001,x),k(1005,p),k(1007,p),k(1028,p),k(1016,f),k(1017,g),k(1021,h),k(1022,h),k(1231,h),k(1014,d),k(1015,d),k(1008,d),k(1009,d),k(1040,d),k(1041,d),k(1115,y),k(1182,y),k(1185,y),k(1186,o),k(1187,v),k(17,s),k(114,JSON.parse.bind(JSON)),k(3802,JSON.parse.bind(JSON)),k(199,C),k(3807,C),k(3907,d),k(2951,d),k(791,d),k(1183,d),k(1270,d)},"init");t.exports={init:$}}),xZ=ut((e,t)=>{$e();var n=1e6;function i(r){var o=r.readInt32BE(0),s=r.readUInt32BE(4),a="";o<0&&(o=~o+(s===0),s=~s+1>>>0,a="-");var c="",l,u,p,f,g,h;{if(l=o%n,o=o/n>>>0,u=4294967296*l+s,s=u/n>>>0,p=""+(u-n*s),s===0&&o===0)return a+p+c;for(f="",g=6-p.length,h=0;h<g;h++)f+="0";c=f+p+c}{if(l=o%n,o=o/n>>>0,u=4294967296*l+s,s=u/n>>>0,p=""+(u-n*s),s===0&&o===0)return a+p+c;for(f="",g=6-p.length,h=0;h<g;h++)f+="0";c=f+p+c}{if(l=o%n,o=o/n>>>0,u=4294967296*l+s,s=u/n>>>0,p=""+(u-n*s),s===0&&o===0)return a+p+c;for(f="",g=6-p.length,h=0;h<g;h++)f+="0";c=f+p+c}return l=o%n,u=4294967296*l+s,p=""+u%n,a+p+c}M(i,"readInt8"),t.exports=i}),kZ=ut((e,t)=>{$e();var n=xZ(),i=M(function(d,y,v,x,E){v=v||0,x=x||!1,E=E||function(J,S,T){return J*Math.pow(2,T)+S};var N=v>>3,C=M(function(J){return x?~J&255:J},"inv"),b=255,P=8-v%8;y<P&&(b=255<<8-y&255,P=y),v&&(b=b>>v%8);var $=0;v%8+y>=8&&($=E(0,C(d[N])&b,P));for(var k=y+v>>3,D=N+1;D<k;D++)$=E($,C(d[D]),8);var B=(y+v)%8;return B>0&&($=E($,C(d[k])>>8-B,B)),$},"parseBits"),r=M(function(d,y,v){var x=Math.pow(2,v-1)-1,E=i(d,1),N=i(d,v,1);if(N===0)return 0;var C=1,b=M(function($,k,D){$===0&&($=1);for(var B=1;B<=D;B++)C/=2,(k&1<<D-B)>0&&($+=C);return $},"parsePrecisionBits"),P=i(d,y,v+1,!1,b);return N==Math.pow(2,v+1)-1?P===0?E===0?1/0:-1/0:NaN:(E===0?1:-1)*Math.pow(2,N-x)*P},"parseFloatFromBits"),o=M(function(d){return i(d,1)==1?-1*(i(d,15,1,!0)+1):i(d,15,1)},"parseInt16"),s=M(function(d){return i(d,1)==1?-1*(i(d,31,1,!0)+1):i(d,31,1)},"parseInt32"),a=M(function(d){return r(d,23,8)},"parseFloat32"),c=M(function(d){return r(d,52,11)},"parseFloat64"),l=M(function(d){var y=i(d,16,32);if(y==49152)return NaN;for(var v=Math.pow(1e4,i(d,16,16)),x=0,E=[],N=i(d,16),C=0;C<N;C++)x+=i(d,16,64+16*C)*v,v/=1e4;var b=Math.pow(10,i(d,16,48));return(y===0?1:-1)*Math.round(x*b)/b},"parseNumeric"),u=M(function(d,y){var v=i(y,1),x=i(y,63,1),E=new Date((v===0?1:-1)*x/1e3+9466848e5);return d||E.setTime(E.getTime()+E.getTimezoneOffset()*6e4),E.usec=x%1e3,E.getMicroSeconds=function(){return this.usec},E.setMicroSeconds=function(N){this.usec=N},E.getUTCMicroSeconds=function(){return this.usec},E},"parseDate"),p=M(function(d){for(var y=i(d,32),v=i(d,32,32),x=i(d,32,64),E=96,N=[],C=0;C<y;C++)N[C]=i(d,32,E),E+=32,E+=32;var b=M(function($){var k=i(d,32,E);if(E+=32,k==4294967295)return null;var D;if($==23||$==20)return D=i(d,k*8,E),E+=k*8,D;if($==25)return D=d.toString(this.encoding,E>>3,(E+=k<<3)>>3),D;console.log("ERROR: ElementType not implemented: "+$)},"parseElement"),P=M(function($,k){var D=[],B;if($.length>1){var J=$.shift();for(B=0;B<J;B++)D[B]=P($,k);$.unshift(J)}else for(B=0;B<$[0];B++)D[B]=b(k);return D},"parse");return P(N,x)},"parseArray"),f=M(function(d){return d.toString("utf8")},"parseText"),g=M(function(d){return d===null?null:i(d,8)>0},"parseBool"),h=M(function(d){d(20,n),d(21,o),d(23,s),d(26,s),d(1700,l),d(700,a),d(701,c),d(16,g),d(1114,u.bind(null,!1)),d(1184,u.bind(null,!0)),d(1e3,p),d(1007,p),d(1016,p),d(1008,p),d(1009,p),d(25,f)},"init");t.exports={init:h}}),EZ=ut((e,t)=>{$e(),t.exports={BOOL:16,BYTEA:17,CHAR:18,INT8:20,INT2:21,INT4:23,REGPROC:24,TEXT:25,OID:26,TID:27,XID:28,CID:29,JSON:114,XML:142,PG_NODE_TREE:194,SMGR:210,PATH:602,POLYGON:604,CIDR:650,FLOAT4:700,FLOAT8:701,ABSTIME:702,RELTIME:703,TINTERVAL:704,CIRCLE:718,MACADDR8:774,MONEY:790,MACADDR:829,INET:869,ACLITEM:1033,BPCHAR:1042,VARCHAR:1043,DATE:1082,TIME:1083,TIMESTAMP:1114,TIMESTAMPTZ:1184,INTERVAL:1186,TIMETZ:1266,BIT:1560,VARBIT:1562,NUMERIC:1700,REFCURSOR:1790,REGPROCEDURE:2202,REGOPER:2203,REGOPERATOR:2204,REGCLASS:2205,REGTYPE:2206,UUID:2950,TXID_SNAPSHOT:2970,PG_LSN:3220,PG_NDISTINCT:3361,PG_DEPENDENCIES:3402,TSVECTOR:3614,TSQUERY:3615,GTSVECTOR:3642,REGCONFIG:3734,REGDICTIONARY:3769,JSONB:3802,REGNAMESPACE:4089,REGROLE:4096}}),Kh=ut(e=>{$e();var t=SZ(),n=kZ(),i=CR(),r=EZ();e.getTypeParser=a,e.setTypeParser=c,e.arrayParser=i,e.builtins=r;var o={text:{},binary:{}};function s(l){return String(l)}M(s,"noParse");function a(l,u){return u=u||"text",o[u]&&o[u][l]||s}M(a,"getTypeParser");function c(l,u,p){typeof u=="function"&&(p=u,u="text"),o[u][l]=p}M(c,"setTypeParser"),t.init(function(l,u){o.text[l]=u}),n.init(function(l,u){o.binary[l]=u})}),u0=ut((e,t)=>{$e();var n=Kh();function i(r){this._types=r||n,this.text={},this.binary={}}M(i,"TypeOverrides"),i.prototype.getOverrides=function(r){switch(r){case"text":return this.text;case"binary":return this.binary;default:return{}}},i.prototype.setTypeParser=function(r,o,s){typeof o=="function"&&(s=o,o="text"),this.getOverrides(o)[r]=s},i.prototype.getTypeParser=function(r,o){return o=o||"text",this.getOverrides(o)[r]||this._types.getTypeParser(r,o)},t.exports=i});function vl(e){let t=1779033703,n=3144134277,i=1013904242,r=2773480762,o=1359893119,s=2600822924,a=528734635,c=1541459225,l=0,u=0,p=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],f=M((x,E)=>x>>>E|x<<32-E,"rrot"),g=new Uint32Array(64),h=new Uint8Array(64),d=M(()=>{for(let D=0,B=0;D<16;D++,B+=4)g[D]=h[B]<<24|h[B+1]<<16|h[B+2]<<8|h[B+3];for(let D=16;D<64;D++){let B=f(g[D-15],7)^f(g[D-15],18)^g[D-15]>>>3,J=f(g[D-2],17)^f(g[D-2],19)^g[D-2]>>>10;g[D]=g[D-16]+B+g[D-7]+J|0}let x=t,E=n,N=i,C=r,b=o,P=s,$=a,k=c;for(let D=0;D<64;D++){let B=f(b,6)^f(b,11)^f(b,25),J=b&P^~b&$,S=k+B+J+p[D]+g[D]|0,T=f(x,2)^f(x,13)^f(x,22),z=x&E^x&N^E&N,L=T+z|0;k=$,$=P,P=b,b=C+S|0,C=N,N=E,E=x,x=S+L|0}t=t+x|0,n=n+E|0,i=i+N|0,r=r+C|0,o=o+b|0,s=s+P|0,a=a+$|0,c=c+k|0,u=0},"process"),y=M(x=>{typeof x=="string"&&(x=new TextEncoder().encode(x));for(let E=0;E<x.length;E++)h[u++]=x[E],u===64&&d();l+=x.length},"add"),v=M(()=>{if(h[u++]=128,u==64&&d(),u+8>64){for(;u<64;)h[u++]=0;d()}for(;u<58;)h[u++]=0;let x=l*8;h[u++]=x/1099511627776&255,h[u++]=x/4294967296&255,h[u++]=x>>>24,h[u++]=x>>>16&255,h[u++]=x>>>8&255,h[u++]=x&255,d();let E=new Uint8Array(32);return E[0]=t>>>24,E[1]=t>>>16&255,E[2]=t>>>8&255,E[3]=t&255,E[4]=n>>>24,E[5]=n>>>16&255,E[6]=n>>>8&255,E[7]=n&255,E[8]=i>>>24,E[9]=i>>>16&255,E[10]=i>>>8&255,E[11]=i&255,E[12]=r>>>24,E[13]=r>>>16&255,E[14]=r>>>8&255,E[15]=r&255,E[16]=o>>>24,E[17]=o>>>16&255,E[18]=o>>>8&255,E[19]=o&255,E[20]=s>>>24,E[21]=s>>>16&255,E[22]=s>>>8&255,E[23]=s&255,E[24]=a>>>24,E[25]=a>>>16&255,E[26]=a>>>8&255,E[27]=a&255,E[28]=c>>>24,E[29]=c>>>16&255,E[30]=c>>>8&255,E[31]=c&255,E},"digest");return e===void 0?{add:y,digest:v}:(y(e),v())}var AZ=kr(()=>{$e(),M(vl,"sha256")}),Xi,Ny,TZ=kr(()=>{$e(),Xi=class Yr{constructor(){Je(this,"_dataLength",0),Je(this,"_bufferLength",0),Je(this,"_state",new Int32Array(4)),Je(this,"_buffer",new ArrayBuffer(68)),Je(this,"_buffer8"),Je(this,"_buffer32"),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}static hashByteArray(t,n=!1){return this.onePassHasher.start().appendByteArray(t).end(n)}static hashStr(t,n=!1){return this.onePassHasher.start().appendStr(t).end(n)}static hashAsciiStr(t,n=!1){return this.onePassHasher.start().appendAsciiStr(t).end(n)}static _hex(t){let n=Yr.hexChars,i=Yr.hexOut,r,o,s,a;for(a=0;a<4;a+=1)for(o=a*8,r=t[a],s=0;s<8;s+=2)i[o+1+s]=n.charAt(r&15),r>>>=4,i[o+0+s]=n.charAt(r&15),r>>>=4;return i.join("")}static _md5cycle(t,n){let i=t[0],r=t[1],o=t[2],s=t[3];i+=(r&o|~r&s)+n[0]-680876936|0,i=(i<<7|i>>>25)+r|0,s+=(i&r|~i&o)+n[1]-389564586|0,s=(s<<12|s>>>20)+i|0,o+=(s&i|~s&r)+n[2]+606105819|0,o=(o<<17|o>>>15)+s|0,r+=(o&s|~o&i)+n[3]-1044525330|0,r=(r<<22|r>>>10)+o|0,i+=(r&o|~r&s)+n[4]-176418897|0,i=(i<<7|i>>>25)+r|0,s+=(i&r|~i&o)+n[5]+1200080426|0,s=(s<<12|s>>>20)+i|0,o+=(s&i|~s&r)+n[6]-1473231341|0,o=(o<<17|o>>>15)+s|0,r+=(o&s|~o&i)+n[7]-45705983|0,r=(r<<22|r>>>10)+o|0,i+=(r&o|~r&s)+n[8]+1770035416|0,i=(i<<7|i>>>25)+r|0,s+=(i&r|~i&o)+n[9]-1958414417|0,s=(s<<12|s>>>20)+i|0,o+=(s&i|~s&r)+n[10]-42063|0,o=(o<<17|o>>>15)+s|0,r+=(o&s|~o&i)+n[11]-1990404162|0,r=(r<<22|r>>>10)+o|0,i+=(r&o|~r&s)+n[12]+1804603682|0,i=(i<<7|i>>>25)+r|0,s+=(i&r|~i&o)+n[13]-40341101|0,s=(s<<12|s>>>20)+i|0,o+=(s&i|~s&r)+n[14]-1502002290|0,o=(o<<17|o>>>15)+s|0,r+=(o&s|~o&i)+n[15]+1236535329|0,r=(r<<22|r>>>10)+o|0,i+=(r&s|o&~s)+n[1]-165796510|0,i=(i<<5|i>>>27)+r|0,s+=(i&o|r&~o)+n[6]-1069501632|0,s=(s<<9|s>>>23)+i|0,o+=(s&r|i&~r)+n[11]+643717713|0,o=(o<<14|o>>>18)+s|0,r+=(o&i|s&~i)+n[0]-373897302|0,r=(r<<20|r>>>12)+o|0,i+=(r&s|o&~s)+n[5]-701558691|0,i=(i<<5|i>>>27)+r|0,s+=(i&o|r&~o)+n[10]+38016083|0,s=(s<<9|s>>>23)+i|0,o+=(s&r|i&~r)+n[15]-660478335|0,o=(o<<14|o>>>18)+s|0,r+=(o&i|s&~i)+n[4]-405537848|0,r=(r<<20|r>>>12)+o|0,i+=(r&s|o&~s)+n[9]+568446438|0,i=(i<<5|i>>>27)+r|0,s+=(i&o|r&~o)+n[14]-1019803690|0,s=(s<<9|s>>>23)+i|0,o+=(s&r|i&~r)+n[3]-187363961|0,o=(o<<14|o>>>18)+s|0,r+=(o&i|s&~i)+n[8]+1163531501|0,r=(r<<20|r>>>12)+o|0,i+=(r&s|o&~s)+n[13]-1444681467|0,i=(i<<5|i>>>27)+r|0,s+=(i&o|r&~o)+n[2]-51403784|0,s=(s<<9|s>>>23)+i|0,o+=(s&r|i&~r)+n[7]+1735328473|0,o=(o<<14|o>>>18)+s|0,r+=(o&i|s&~i)+n[12]-1926607734|0,r=(r<<20|r>>>12)+o|0,i+=(r^o^s)+n[5]-378558|0,i=(i<<4|i>>>28)+r|0,s+=(i^r^o)+n[8]-2022574463|0,s=(s<<11|s>>>21)+i|0,o+=(s^i^r)+n[11]+1839030562|0,o=(o<<16|o>>>16)+s|0,r+=(o^s^i)+n[14]-35309556|0,r=(r<<23|r>>>9)+o|0,i+=(r^o^s)+n[1]-1530992060|0,i=(i<<4|i>>>28)+r|0,s+=(i^r^o)+n[4]+1272893353|0,s=(s<<11|s>>>21)+i|0,o+=(s^i^r)+n[7]-155497632|0,o=(o<<16|o>>>16)+s|0,r+=(o^s^i)+n[10]-1094730640|0,r=(r<<23|r>>>9)+o|0,i+=(r^o^s)+n[13]+681279174|0,i=(i<<4|i>>>28)+r|0,s+=(i^r^o)+n[0]-358537222|0,s=(s<<11|s>>>21)+i|0,o+=(s^i^r)+n[3]-722521979|0,o=(o<<16|o>>>16)+s|0,r+=(o^s^i)+n[6]+76029189|0,r=(r<<23|r>>>9)+o|0,i+=(r^o^s)+n[9]-640364487|0,i=(i<<4|i>>>28)+r|0,s+=(i^r^o)+n[12]-421815835|0,s=(s<<11|s>>>21)+i|0,o+=(s^i^r)+n[15]+530742520|0,o=(o<<16|o>>>16)+s|0,r+=(o^s^i)+n[2]-995338651|0,r=(r<<23|r>>>9)+o|0,i+=(o^(r|~s))+n[0]-198630844|0,i=(i<<6|i>>>26)+r|0,s+=(r^(i|~o))+n[7]+1126891415|0,s=(s<<10|s>>>22)+i|0,o+=(i^(s|~r))+n[14]-1416354905|0,o=(o<<15|o>>>17)+s|0,r+=(s^(o|~i))+n[5]-57434055|0,r=(r<<21|r>>>11)+o|0,i+=(o^(r|~s))+n[12]+1700485571|0,i=(i<<6|i>>>26)+r|0,s+=(r^(i|~o))+n[3]-1894986606|0,s=(s<<10|s>>>22)+i|0,o+=(i^(s|~r))+n[10]-1051523|0,o=(o<<15|o>>>17)+s|0,r+=(s^(o|~i))+n[1]-2054922799|0,r=(r<<21|r>>>11)+o|0,i+=(o^(r|~s))+n[8]+1873313359|0,i=(i<<6|i>>>26)+r|0,s+=(r^(i|~o))+n[15]-30611744|0,s=(s<<10|s>>>22)+i|0,o+=(i^(s|~r))+n[6]-1560198380|0,o=(o<<15|o>>>17)+s|0,r+=(s^(o|~i))+n[13]+1309151649|0,r=(r<<21|r>>>11)+o|0,i+=(o^(r|~s))+n[4]-145523070|0,i=(i<<6|i>>>26)+r|0,s+=(r^(i|~o))+n[11]-1120210379|0,s=(s<<10|s>>>22)+i|0,o+=(i^(s|~r))+n[2]+718787259|0,o=(o<<15|o>>>17)+s|0,r+=(s^(o|~i))+n[9]-343485551|0,r=(r<<21|r>>>11)+o|0,t[0]=i+t[0]|0,t[1]=r+t[1]|0,t[2]=o+t[2]|0,t[3]=s+t[3]|0}start(){return this._dataLength=0,this._bufferLength=0,this._state.set(Yr.stateIdentity),this}appendStr(t){let n=this._buffer8,i=this._buffer32,r=this._bufferLength,o,s;for(s=0;s<t.length;s+=1){if(o=t.charCodeAt(s),o<128)n[r++]=o;else if(o<2048)n[r++]=(o>>>6)+192,n[r++]=o&63|128;else if(o<55296||o>56319)n[r++]=(o>>>12)+224,n[r++]=o>>>6&63|128,n[r++]=o&63|128;else{if(o=(o-55296)*1024+(t.charCodeAt(++s)-56320)+65536,o>1114111)throw new Error("Unicode standard supports code points up to U+10FFFF");n[r++]=(o>>>18)+240,n[r++]=o>>>12&63|128,n[r++]=o>>>6&63|128,n[r++]=o&63|128}r>=64&&(this._dataLength+=64,Yr._md5cycle(this._state,i),r-=64,i[0]=i[16])}return this._bufferLength=r,this}appendAsciiStr(t){let n=this._buffer8,i=this._buffer32,r=this._bufferLength,o,s=0;for(;;){for(o=Math.min(t.length-s,64-r);o--;)n[r++]=t.charCodeAt(s++);if(r<64)break;this._dataLength+=64,Yr._md5cycle(this._state,i),r=0}return this._bufferLength=r,this}appendByteArray(t){let n=this._buffer8,i=this._buffer32,r=this._bufferLength,o,s=0;for(;;){for(o=Math.min(t.length-s,64-r);o--;)n[r++]=t[s++];if(r<64)break;this._dataLength+=64,Yr._md5cycle(this._state,i),r=0}return this._bufferLength=r,this}getState(){let t=this._state;return{buffer:String.fromCharCode.apply(null,Array.from(this._buffer8)),buflen:this._bufferLength,length:this._dataLength,state:[t[0],t[1],t[2],t[3]]}}setState(t){let n=t.buffer,i=t.state,r=this._state,o;for(this._dataLength=t.length,this._bufferLength=t.buflen,r[0]=i[0],r[1]=i[1],r[2]=i[2],r[3]=i[3],o=0;o<n.length;o+=1)this._buffer8[o]=n.charCodeAt(o)}end(t=!1){let n=this._bufferLength,i=this._buffer8,r=this._buffer32,o=(n>>2)+1;this._dataLength+=n;let s=this._dataLength*8;if(i[n]=128,i[n+1]=i[n+2]=i[n+3]=0,r.set(Yr.buffer32Identity.subarray(o),o),n>55&&(Yr._md5cycle(this._state,r),r.set(Yr.buffer32Identity)),s<=4294967295)r[14]=s;else{let a=s.toString(16).match(/(.*?)(.{0,8})$/);if(a===null)return;let c=parseInt(a[2],16),l=parseInt(a[1],16)||0;r[14]=c,r[15]=l}return Yr._md5cycle(this._state,r),t?this._state:Yr._hex(this._state)}},M(Xi,"Md5"),Je(Xi,"stateIdentity",new Int32Array([1732584193,-271733879,-1732584194,271733878])),Je(Xi,"buffer32Identity",new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),Je(Xi,"hexChars","0123456789abcdef"),Je(Xi,"hexOut",[]),Je(Xi,"onePassHasher",new Xi),Ny=Xi}),d0={};xi(d0,{createHash:()=>RR,createHmac:()=>PR,randomBytes:()=>OR});function OR(e){return crypto.getRandomValues(qe.alloc(e))}function RR(e){if(e==="sha256")return{update:M(function(t){return{digest:M(function(){return qe.from(vl(t))},"digest")}},"update")};if(e==="md5")return{update:M(function(t){return{digest:M(function(){return typeof t=="string"?Ny.hashStr(t):Ny.hashByteArray(t)},"digest")}},"update")};throw new Error(`Hash type '${e}' not supported`)}function PR(e,t){if(e!=="sha256")throw new Error(`Only sha256 is supported (requested: '${e}')`);return{update:M(function(n){return{digest:M(function(){typeof t=="string"&&(t=new TextEncoder().encode(t)),typeof n=="string"&&(n=new TextEncoder().encode(n));let i=t.length;if(i>64)t=vl(t);else if(i<64){let c=new Uint8Array(64);c.set(t),t=c}let r=new Uint8Array(64),o=new Uint8Array(64);for(let c=0;c<64;c++)r[c]=54^t[c],o[c]=92^t[c];let s=new Uint8Array(n.length+64);s.set(r,0),s.set(n,64);let a=new Uint8Array(96);return a.set(o,0),a.set(vl(s),64),qe.from(vl(a))},"digest")}},"update")}}var DR=kr(()=>{$e(),AZ(),TZ(),M(OR,"randomBytes"),M(RR,"createHash"),M(PR,"createHmac")}),Jh=ut((e,t)=>{$e(),t.exports={host:"localhost",user:ct.platform==="win32"?ct.env.USERNAME:ct.env.USER,database:void 0,password:null,connectionString:void 0,port:5432,rows:0,binary:!1,max:10,idleTimeoutMillis:3e4,client_encoding:"",ssl:!1,application_name:void 0,fallback_application_name:void 0,options:void 0,parseInputDatesAsUTC:!1,statement_timeout:!1,lock_timeout:!1,idle_in_transaction_session_timeout:!1,query_timeout:!1,connect_timeout:0,keepalives:1,keepalives_idle:0};var n=Kh(),i=n.getTypeParser(20,"text"),r=n.getTypeParser(1016,"text");t.exports.__defineSetter__("parseInt8",function(o){n.setTypeParser(20,"text",o?n.getTypeParser(23,"text"):i),n.setTypeParser(1016,"text",o?n.getTypeParser(1007,"text"):r)})}),Gh=ut((e,t)=>{$e();var n=(DR(),Mn(d0)),i=Jh();function r(h){var d=h.replace(/\\/g,"\\\\").replace(/"/g,'\\"');return'"'+d+'"'}M(r,"escapeElement");function o(h){for(var d="{",y=0;y<h.length;y++)y>0&&(d=d+","),h[y]===null||typeof h[y]>"u"?d=d+"NULL":Array.isArray(h[y])?d=d+o(h[y]):h[y]instanceof qe?d+="\\\\x"+h[y].toString("hex"):d+=r(s(h[y]));return d=d+"}",d}M(o,"arrayString");var s=M(function(h,d){if(h==null)return null;if(h instanceof qe)return h;if(ArrayBuffer.isView(h)){var y=qe.from(h.buffer,h.byteOffset,h.byteLength);return y.length===h.byteLength?y:y.slice(h.byteOffset,h.byteOffset+h.byteLength)}return h instanceof Date?i.parseInputDatesAsUTC?u(h):l(h):Array.isArray(h)?o(h):typeof h=="object"?a(h,d):h.toString()},"prepareValue");function a(h,d){if(h&&typeof h.toPostgres=="function"){if(d=d||[],d.indexOf(h)!==-1)throw new Error('circular reference detected while preparing "'+h+'" for query');return d.push(h),s(h.toPostgres(s),d)}return JSON.stringify(h)}M(a,"prepareObject");function c(h,d){for(h=""+h;h.length<d;)h="0"+h;return h}M(c,"pad");function l(h){var d=-h.getTimezoneOffset(),y=h.getFullYear(),v=y<1;v&&(y=Math.abs(y)+1);var x=c(y,4)+"-"+c(h.getMonth()+1,2)+"-"+c(h.getDate(),2)+"T"+c(h.getHours(),2)+":"+c(h.getMinutes(),2)+":"+c(h.getSeconds(),2)+"."+c(h.getMilliseconds(),3);return d<0?(x+="-",d*=-1):x+="+",x+=c(Math.floor(d/60),2)+":"+c(d%60,2),v&&(x+=" BC"),x}M(l,"dateToString");function u(h){var d=h.getUTCFullYear(),y=d<1;y&&(d=Math.abs(d)+1);var v=c(d,4)+"-"+c(h.getUTCMonth()+1,2)+"-"+c(h.getUTCDate(),2)+"T"+c(h.getUTCHours(),2)+":"+c(h.getUTCMinutes(),2)+":"+c(h.getUTCSeconds(),2)+"."+c(h.getUTCMilliseconds(),3);return v+="+00:00",y&&(v+=" BC"),v}M(u,"dateToStringUTC");function p(h,d,y){return h=typeof h=="string"?{text:h}:h,d&&(typeof d=="function"?h.callback=d:h.values=d),y&&(h.callback=y),h}M(p,"normalizeQueryConfig");var f=M(function(h){return n.createHash("md5").update(h,"utf-8").digest("hex")},"md5"),g=M(function(h,d,y){var v=f(d+h),x=f(qe.concat([qe.from(v),y]));return"md5"+x},"postgresMd5PasswordHash");t.exports={prepareValue:M(function(h){return s(h)},"prepareValueWrapper"),normalizeQueryConfig:p,postgresMd5PasswordHash:g,md5:f}}),Zu={};xi(Zu,{default:()=>UR});var UR,Zh=kr(()=>{$e(),UR={}}),IZ=ut((e,t)=>{$e();var n=(DR(),Mn(d0));function i(d){if(d.indexOf("SCRAM-SHA-256")===-1)throw new Error("SASL: Only mechanism SCRAM-SHA-256 is currently supported");let y=n.randomBytes(18).toString("base64");return{mechanism:"SCRAM-SHA-256",clientNonce:y,response:"n,,n=*,r="+y,message:"SASLInitialResponse"}}M(i,"startSession");function r(d,y,v){if(d.message!=="SASLInitialResponse")throw new Error("SASL: Last message was not SASLInitialResponse");if(typeof y!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: client password must be a string");if(typeof v!="string")throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: serverData must be a string");let x=l(v);if(x.nonce.startsWith(d.clientNonce)){if(x.nonce.length===d.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");var E=qe.from(x.salt,"base64"),N=h(y,E,x.iteration),C=g(N,"Client Key"),b=f(C),P="n=*,r="+d.clientNonce,$="r="+x.nonce+",s="+x.salt+",i="+x.iteration,k="c=biws,r="+x.nonce,D=P+","+$+","+k,B=g(b,D),J=p(C,B),S=J.toString("base64"),T=g(N,"Server Key"),z=g(T,D);d.message="SASLResponse",d.serverSignature=z.toString("base64"),d.response=k+",p="+S}M(r,"continueSession");function o(d,y){if(d.message!=="SASLResponse")throw new Error("SASL: Last message was not SASLResponse");if(typeof y!="string")throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: serverData must be a string");let{serverSignature:v}=u(y);if(v!==d.serverSignature)throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature does not match")}M(o,"finalizeSession");function s(d){if(typeof d!="string")throw new TypeError("SASL: text must be a string");return d.split("").map((y,v)=>d.charCodeAt(v)).every(y=>y>=33&&y<=43||y>=45&&y<=126)}M(s,"isPrintableChars");function a(d){return/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(d)}M(a,"isBase64");function c(d){if(typeof d!="string")throw new TypeError("SASL: attribute pairs text must be a string");return new Map(d.split(",").map(y=>{if(!/^.=/.test(y))throw new Error("SASL: Invalid attribute pair entry");let v=y[0],x=y.substring(2);return[v,x]}))}M(c,"parseAttributePairs");function l(d){let y=c(d),v=y.get("r");if(v){if(!s(v))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce must only contain printable characters")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing");let x=y.get("s");if(x){if(!a(x))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt must be base64")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing");let E=y.get("i");if(E){if(!/^[1-9][0-9]*$/.test(E))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: invalid iteration count")}else throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: iteration missing");let N=parseInt(E,10);return{nonce:v,salt:x,iteration:N}}M(l,"parseServerFirstMessage");function u(d){let y=c(d).get("v");if(y){if(!a(y))throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature must be base64")}else throw new Error("SASL: SCRAM-SERVER-FINAL-MESSAGE: server signature is missing");return{serverSignature:y}}M(u,"parseServerFinalMessage");function p(d,y){if(!qe.isBuffer(d))throw new TypeError("first argument must be a Buffer");if(!qe.isBuffer(y))throw new TypeError("second argument must be a Buffer");if(d.length!==y.length)throw new Error("Buffer lengths must match");if(d.length===0)throw new Error("Buffers cannot be empty");return qe.from(d.map((v,x)=>d[x]^y[x]))}M(p,"xorBuffers");function f(d){return n.createHash("sha256").update(d).digest()}M(f,"sha256");function g(d,y){return n.createHmac("sha256",d).update(y).digest()}M(g,"hmacSha256");function h(d,y,v){for(var x=g(d,qe.concat([y,qe.from([0,0,0,1])])),E=x,N=0;N<v-1;N++)x=g(d,x),E=p(E,x);return E}M(h,"Hi"),t.exports={startSession:i,continueSession:r,finalizeSession:o}}),f0={};xi(f0,{join:()=>LR});function LR(...e){return e.join("/")}var MR=kr(()=>{$e(),M(LR,"join")}),p0={};xi(p0,{stat:()=>jR});function jR(e,t){t(new Error("No filesystem"))}var zR=kr(()=>{$e(),M(jR,"stat")}),h0={};xi(h0,{default:()=>BR});var BR,FR=kr(()=>{$e(),BR={}}),WR={};xi(WR,{StringDecoder:()=>VR});var Sg,VR,NZ=kr(()=>{$e(),Sg=class{constructor(t){Je(this,"td"),this.td=new TextDecoder(t)}write(t){return this.td.decode(t,{stream:!0})}end(t){return this.td.decode(t)}},M(Sg,"StringDecoder"),VR=Sg}),$Z=ut((e,t)=>{$e();var{Transform:n}=(FR(),Mn(h0)),{StringDecoder:i}=(NZ(),Mn(WR)),r=Symbol("last"),o=Symbol("decoder");function s(p,f,g){let h;if(this.overflow){if(h=this[o].write(p).split(this.matcher),h.length===1)return g();h.shift(),this.overflow=!1}else this[r]+=this[o].write(p),h=this[r].split(this.matcher);this[r]=h.pop();for(let d=0;d<h.length;d++)try{c(this,this.mapper(h[d]))}catch(y){return g(y)}if(this.overflow=this[r].length>this.maxLength,this.overflow&&!this.skipOverflow){g(new Error("maximum buffer reached"));return}g()}M(s,"transform");function a(p){if(this[r]+=this[o].end(),this[r])try{c(this,this.mapper(this[r]))}catch(f){return p(f)}p()}M(a,"flush");function c(p,f){f!==void 0&&p.push(f)}M(c,"push");function l(p){return p}M(l,"noop");function u(p,f,g){switch(p=p||/\r?\n/,f=f||l,g=g||{},arguments.length){case 1:typeof p=="function"?(f=p,p=/\r?\n/):typeof p=="object"&&!(p instanceof RegExp)&&!p[Symbol.split]&&(g=p,p=/\r?\n/);break;case 2:typeof p=="function"?(g=f,f=p,p=/\r?\n/):typeof f=="object"&&(g=f,f=l)}g=Object.assign({},g),g.autoDestroy=!0,g.transform=s,g.flush=a,g.readableObjectMode=!0;let h=new n(g);return h[r]="",h[o]=new i("utf8"),h.matcher=p,h.mapper=f,h.maxLength=g.maxLength,h.skipOverflow=g.skipOverflow||!1,h.overflow=!1,h._destroy=function(d,y){this._writableState.errorEmitted=!1,y(d)},h}M(u,"split"),t.exports=u}),CZ=ut((e,t)=>{$e();var n=(MR(),Mn(f0)),i=(FR(),Mn(h0)).Stream,r=$Z(),o=(Zh(),Mn(Zu)),s=5432,a=ct.platform==="win32",c=ct.stderr,l=56,u=7,p=61440,f=32768;function g(C){return(C&p)==f}M(g,"isRegFile");var h=["host","port","database","user","password"],d=h.length,y=h[d-1];function v(){var C=c instanceof i&&c.writable===!0;if(C){var b=Array.prototype.slice.call(arguments).concat(`
`);c.write(o.format.apply(o,b))}}M(v,"warn"),Object.defineProperty(t.exports,"isWin",{get:M(function(){return a},"get"),set:M(function(C){a=C},"set")}),t.exports.warnTo=function(C){var b=c;return c=C,b},t.exports.getFileName=function(C){var b=C||ct.env,P=b.PGPASSFILE||(a?n.join(b.APPDATA||"./","postgresql","pgpass.conf"):n.join(b.HOME||"./",".pgpass"));return P},t.exports.usePgPass=function(C,b){return Object.prototype.hasOwnProperty.call(ct.env,"PGPASSWORD")?!1:a?!0:(b=b||"<unkn>",g(C.mode)?C.mode&(l|u)?(v('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',b),!1):!0:(v('WARNING: password file "%s" is not a plain file',b),!1))};var x=t.exports.match=function(C,b){return h.slice(0,-1).reduce(function(P,$,k){return k==1&&Number(C[$]||s)===Number(b[$])?P&&!0:P&&(b[$]==="*"||b[$]===C[$])},!0)};t.exports.getPassword=function(C,b,P){var $,k=b.pipe(r());function D(S){var T=E(S);T&&N(T)&&x(C,T)&&($=T[y],k.end())}M(D,"onLine");var B=M(function(){b.destroy(),P($)},"onEnd"),J=M(function(S){b.destroy(),v("WARNING: error on reading file: %s",S),P(void 0)},"onErr");b.on("error",J),k.on("data",D).on("end",B).on("error",J)};var E=t.exports.parseLine=function(C){if(C.length<11||C.match(/^\s+#/))return null;for(var b="",P="",$=0,k=0,D=0,B={},J=!1,S=M(function(z,L,q){var V=C.substring(L,q);Object.hasOwnProperty.call(ct.env,"PGPASS_NO_DEESCAPE")||(V=V.replace(/\\([:\\])/g,"$1")),B[h[z]]=V},"addToObj"),T=0;T<C.length-1;T+=1){if(b=C.charAt(T+1),P=C.charAt(T),J=$==d-1,J){S($,k);break}T>=0&&b==":"&&P!=="\\"&&(S($,k,T+1),k=T+2,$+=1)}return B=Object.keys(B).length===d?B:null,B},N=t.exports.isValidEntry=function(C){for(var b={0:function(B){return B.length>0},1:function(B){return B==="*"?!0:(B=Number(B),isFinite(B)&&B>0&&B<9007199254740992&&Math.floor(B)===B)},2:function(B){return B.length>0},3:function(B){return B.length>0},4:function(B){return B.length>0}},P=0;P<h.length;P+=1){var $=b[P],k=C[h[P]]||"",D=$(k);if(!D)return!1}return!0}}),OZ=ut((e,t)=>{$e(),MR(),Mn(f0);var n=(zR(),Mn(p0)),i=CZ();t.exports=function(r,o){var s=i.getFileName();n.stat(s,function(a,c){if(a||!i.usePgPass(c,s))return o(void 0);var l=n.createReadStream(s);i.getPassword(r,l,o)})},t.exports.warnTo=i.warnTo}),qR={};xi(qR,{default:()=>HR});var HR,RZ=kr(()=>{$e(),HR={}}),PZ=ut((e,t)=>{$e();var n=(IR(),Mn(TR)),i=(zR(),Mn(p0));function r(o){if(o.charAt(0)==="/"){var a=o.split(" ");return{host:a[0],database:a[1]}}var s=n.parse(/ |%[^a-f0-9]|%[a-f0-9][^a-f0-9]/i.test(o)?encodeURI(o).replace(/\%25(\d\d)/g,"%$1"):o,!0),a=s.query;for(var c in a)Array.isArray(a[c])&&(a[c]=a[c][a[c].length-1]);var l=(s.auth||":").split(":");if(a.user=l[0],a.password=l.splice(1).join(":"),a.port=s.port,s.protocol=="socket:")return a.host=decodeURI(s.pathname),a.database=s.query.db,a.client_encoding=s.query.encoding,a;a.host||(a.host=s.hostname);var u=s.pathname;if(!a.host&&u&&/^%2f/i.test(u)){var p=u.split("/");a.host=decodeURIComponent(p[0]),u=p.splice(1).join("/")}switch(u&&u.charAt(0)==="/"&&(u=u.slice(1)||null),a.database=u&&decodeURI(u),(a.ssl==="true"||a.ssl==="1")&&(a.ssl=!0),a.ssl==="0"&&(a.ssl=!1),(a.sslcert||a.sslkey||a.sslrootcert||a.sslmode)&&(a.ssl={}),a.sslcert&&(a.ssl.cert=i.readFileSync(a.sslcert).toString()),a.sslkey&&(a.ssl.key=i.readFileSync(a.sslkey).toString()),a.sslrootcert&&(a.ssl.ca=i.readFileSync(a.sslrootcert).toString()),a.sslmode){case"disable":{a.ssl=!1;break}case"prefer":case"require":case"verify-ca":case"verify-full":break;case"no-verify":{a.ssl.rejectUnauthorized=!1;break}}return a}M(r,"parse"),t.exports=r,r.parse=r}),m0=ut((e,t)=>{$e();var n=(RZ(),Mn(qR)),i=Jh(),r=PZ().parse,o=M(function(p,f,g){return g===void 0?g=ct.env["PG"+p.toUpperCase()]:g===!1||(g=ct.env[g]),f[p]||g||i[p]},"val"),s=M(function(){switch(ct.env.PGSSLMODE){case"disable":return!1;case"prefer":case"require":case"verify-ca":case"verify-full":return!0;case"no-verify":return{rejectUnauthorized:!1}}return i.ssl},"readSSLConfigFromEnvironment"),a=M(function(p){return"'"+(""+p).replace(/\\/g,"\\\\").replace(/'/g,"\\'")+"'"},"quoteParamValue"),c=M(function(p,f,g){var h=f[g];h!=null&&p.push(g+"="+a(h))},"add"),l=class{constructor(f){f=typeof f=="string"?r(f):f||{},f.connectionString&&(f=Object.assign({},f,r(f.connectionString))),this.user=o("user",f),this.database=o("database",f),this.database===void 0&&(this.database=this.user),this.port=parseInt(o("port",f),10),this.host=o("host",f),Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:o("password",f)}),this.binary=o("binary",f),this.options=o("options",f),this.ssl=typeof f.ssl>"u"?s():f.ssl,typeof this.ssl=="string"&&this.ssl==="true"&&(this.ssl=!0),this.ssl==="no-verify"&&(this.ssl={rejectUnauthorized:!1}),this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this.client_encoding=o("client_encoding",f),this.replication=o("replication",f),this.isDomainSocket=!(this.host||"").indexOf("/"),this.application_name=o("application_name",f,"PGAPPNAME"),this.fallback_application_name=o("fallback_application_name",f,!1),this.statement_timeout=o("statement_timeout",f,!1),this.lock_timeout=o("lock_timeout",f,!1),this.idle_in_transaction_session_timeout=o("idle_in_transaction_session_timeout",f,!1),this.query_timeout=o("query_timeout",f,!1),f.connectionTimeoutMillis===void 0?this.connect_timeout=ct.env.PGCONNECT_TIMEOUT||0:this.connect_timeout=Math.floor(f.connectionTimeoutMillis/1e3),f.keepAlive===!1?this.keepalives=0:f.keepAlive===!0&&(this.keepalives=1),typeof f.keepAliveInitialDelayMillis=="number"&&(this.keepalives_idle=Math.floor(f.keepAliveInitialDelayMillis/1e3))}getLibpqConnectionString(f){var g=[];c(g,this,"user"),c(g,this,"password"),c(g,this,"port"),c(g,this,"application_name"),c(g,this,"fallback_application_name"),c(g,this,"connect_timeout"),c(g,this,"options");var h=typeof this.ssl=="object"?this.ssl:this.ssl?{sslmode:this.ssl}:{};if(c(g,h,"sslmode"),c(g,h,"sslca"),c(g,h,"sslkey"),c(g,h,"sslcert"),c(g,h,"sslrootcert"),this.database&&g.push("dbname="+a(this.database)),this.replication&&g.push("replication="+a(this.replication)),this.host&&g.push("host="+a(this.host)),this.isDomainSocket)return f(null,g.join(" "));this.client_encoding&&g.push("client_encoding="+a(this.client_encoding)),n.lookup(this.host,function(d,y){return d?f(d,null):(g.push("hostaddr="+a(y)),f(null,g.join(" ")))})}};M(l,"ConnectionParameters");var u=l;t.exports=u}),DZ=ut((e,t)=>{$e();var n=Kh(),i=/^([A-Za-z]+)(?: (\d+))?(?: (\d+))?/,r=class{constructor(a,c){this.command=null,this.rowCount=null,this.oid=null,this.rows=[],this.fields=[],this._parsers=void 0,this._types=c,this.RowCtor=null,this.rowAsArray=a==="array",this.rowAsArray&&(this.parseRow=this._parseRowAsArray)}addCommandComplete(a){var c;a.text?c=i.exec(a.text):c=i.exec(a.command),c&&(this.command=c[1],c[3]?(this.oid=parseInt(c[2],10),this.rowCount=parseInt(c[3],10)):c[2]&&(this.rowCount=parseInt(c[2],10)))}_parseRowAsArray(a){for(var c=new Array(a.length),l=0,u=a.length;l<u;l++){var p=a[l];p!==null?c[l]=this._parsers[l](p):c[l]=null}return c}parseRow(a){for(var c={},l=0,u=a.length;l<u;l++){var p=a[l],f=this.fields[l].name;p!==null?c[f]=this._parsers[l](p):c[f]=null}return c}addRow(a){this.rows.push(a)}addFields(a){this.fields=a,this.fields.length&&(this._parsers=new Array(a.length));for(var c=0;c<a.length;c++){var l=a[c];this._types?this._parsers[c]=this._types.getTypeParser(l.dataTypeID,l.format||"text"):this._parsers[c]=n.getTypeParser(l.dataTypeID,l.format||"text")}}};M(r,"Result");var o=r;t.exports=o}),UZ=ut((e,t)=>{$e();var{EventEmitter:n}=sa(),i=DZ(),r=Gh(),o=class extends n{constructor(c,l,u){super(),c=r.normalizeQueryConfig(c,l,u),this.text=c.text,this.values=c.values,this.rows=c.rows,this.types=c.types,this.name=c.name,this.binary=c.binary,this.portal=c.portal||"",this.callback=c.callback,this._rowMode=c.rowMode,ct.domain&&c.callback&&(this.callback=ct.domain.bind(c.callback)),this._result=new i(this._rowMode,this.types),this._results=this._result,this.isPreparedStatement=!1,this._canceledDueToError=!1,this._promise=null}requiresPreparation(){return this.name||this.rows?!0:!this.text||!this.values?!1:this.values.length>0}_checkForMultirow(){this._result.command&&(Array.isArray(this._results)||(this._results=[this._result]),this._result=new i(this._rowMode,this.types),this._results.push(this._result))}handleRowDescription(c){this._checkForMultirow(),this._result.addFields(c.fields),this._accumulateRows=this.callback||!this.listeners("row").length}handleDataRow(c){let l;if(!this._canceledDueToError){try{l=this._result.parseRow(c.fields)}catch(u){this._canceledDueToError=u;return}this.emit("row",l,this._result),this._accumulateRows&&this._result.addRow(l)}}handleCommandComplete(c,l){this._checkForMultirow(),this._result.addCommandComplete(c),this.rows&&l.sync()}handleEmptyQuery(c){this.rows&&c.sync()}handleError(c,l){if(this._canceledDueToError&&(c=this._canceledDueToError,this._canceledDueToError=!1),this.callback)return this.callback(c);this.emit("error",c)}handleReadyForQuery(c){if(this._canceledDueToError)return this.handleError(this._canceledDueToError,c);if(this.callback)try{this.callback(null,this._results)}catch(l){ct.nextTick(()=>{throw l})}this.emit("end",this._results)}submit(c){if(typeof this.text!="string"&&typeof this.name!="string")return new Error("A query must have either text or a name. Supplying neither is unsupported.");let l=c.parsedStatements[this.name];return this.text&&l&&this.text!==l?new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`):this.values&&!Array.isArray(this.values)?new Error("Query values must be an array"):(this.requiresPreparation()?this.prepare(c):c.query(this.text),null)}hasBeenParsed(c){return this.name&&c.parsedStatements[this.name]}handlePortalSuspended(c){this._getRows(c,this.rows)}_getRows(c,l){c.execute({portal:this.portal,rows:l}),l?c.flush():c.sync()}prepare(c){this.isPreparedStatement=!0,this.hasBeenParsed(c)||c.parse({text:this.text,name:this.name,types:this.types});try{c.bind({portal:this.portal,statement:this.name,values:this.values,binary:this.binary,valueMapper:r.prepareValue})}catch(l){this.handleError(l,c);return}c.describe({type:"P",name:this.portal||""}),this._getRows(c,this.rows)}handleCopyInResponse(c){c.sendCopyFail("No source stream defined")}handleCopyData(c,l){}};M(o,"Query");var s=o;t.exports=s}),KR=ut(e=>{$e(),Object.defineProperty(e,"__esModule",{value:!0}),e.NoticeMessage=e.DataRowMessage=e.CommandCompleteMessage=e.ReadyForQueryMessage=e.NotificationResponseMessage=e.BackendKeyDataMessage=e.AuthenticationMD5Password=e.ParameterStatusMessage=e.ParameterDescriptionMessage=e.RowDescriptionMessage=e.Field=e.CopyResponse=e.CopyDataMessage=e.DatabaseError=e.copyDone=e.emptyQuery=e.replicationStart=e.portalSuspended=e.noData=e.closeComplete=e.bindComplete=e.parseComplete=void 0,e.parseComplete={name:"parseComplete",length:5},e.bindComplete={name:"bindComplete",length:5},e.closeComplete={name:"closeComplete",length:5},e.noData={name:"noData",length:5},e.portalSuspended={name:"portalSuspended",length:5},e.replicationStart={name:"replicationStart",length:4},e.emptyQuery={name:"emptyQuery",length:4},e.copyDone={name:"copyDone",length:4};var t=class extends Error{constructor(T,z,L){super(T),this.length=z,this.name=L}};M(t,"DatabaseError");var n=t;e.DatabaseError=n;var i=class{constructor(T,z){this.length=T,this.chunk=z,this.name="copyData"}};M(i,"CopyDataMessage");var r=i;e.CopyDataMessage=r;var o=class{constructor(T,z,L,q){this.length=T,this.name=z,this.binary=L,this.columnTypes=new Array(q)}};M(o,"CopyResponse");var s=o;e.CopyResponse=s;var a=class{constructor(T,z,L,q,V,K,oe){this.name=T,this.tableID=z,this.columnID=L,this.dataTypeID=q,this.dataTypeSize=V,this.dataTypeModifier=K,this.format=oe}};M(a,"Field");var c=a;e.Field=c;var l=class{constructor(T,z){this.length=T,this.fieldCount=z,this.name="rowDescription",this.fields=new Array(this.fieldCount)}};M(l,"RowDescriptionMessage");var u=l;e.RowDescriptionMessage=u;var p=class{constructor(T,z){this.length=T,this.parameterCount=z,this.name="parameterDescription",this.dataTypeIDs=new Array(this.parameterCount)}};M(p,"ParameterDescriptionMessage");var f=p;e.ParameterDescriptionMessage=f;var g=class{constructor(T,z,L){this.length=T,this.parameterName=z,this.parameterValue=L,this.name="parameterStatus"}};M(g,"ParameterStatusMessage");var h=g;e.ParameterStatusMessage=h;var d=class{constructor(T,z){this.length=T,this.salt=z,this.name="authenticationMD5Password"}};M(d,"AuthenticationMD5Password");var y=d;e.AuthenticationMD5Password=y;var v=class{constructor(T,z,L){this.length=T,this.processID=z,this.secretKey=L,this.name="backendKeyData"}};M(v,"BackendKeyDataMessage");var x=v;e.BackendKeyDataMessage=x;var E=class{constructor(T,z,L,q){this.length=T,this.processId=z,this.channel=L,this.payload=q,this.name="notification"}};M(E,"NotificationResponseMessage");var N=E;e.NotificationResponseMessage=N;var C=class{constructor(T,z){this.length=T,this.status=z,this.name="readyForQuery"}};M(C,"ReadyForQueryMessage");var b=C;e.ReadyForQueryMessage=b;var P=class{constructor(T,z){this.length=T,this.text=z,this.name="commandComplete"}};M(P,"CommandCompleteMessage");var $=P;e.CommandCompleteMessage=$;var k=class{constructor(T,z){this.length=T,this.fields=z,this.name="dataRow",this.fieldCount=z.length}};M(k,"DataRowMessage");var D=k;e.DataRowMessage=D;var B=class{constructor(T,z){this.length=T,this.message=z,this.name="notice"}};M(B,"NoticeMessage");var J=B;e.NoticeMessage=J}),LZ=ut(e=>{$e(),Object.defineProperty(e,"__esModule",{value:!0}),e.Writer=void 0;var t=class{constructor(r=256){this.size=r,this.offset=5,this.headerPosition=0,this.buffer=qe.allocUnsafe(r)}ensure(r){if(this.buffer.length-this.offset<r){let o=this.buffer,s=o.length+(o.length>>1)+r;this.buffer=qe.allocUnsafe(s),o.copy(this.buffer)}}addInt32(r){return this.ensure(4),this.buffer[this.offset++]=r>>>24&255,this.buffer[this.offset++]=r>>>16&255,this.buffer[this.offset++]=r>>>8&255,this.buffer[this.offset++]=r>>>0&255,this}addInt16(r){return this.ensure(2),this.buffer[this.offset++]=r>>>8&255,this.buffer[this.offset++]=r>>>0&255,this}addCString(r){if(!r)this.ensure(1);else{let o=qe.byteLength(r);this.ensure(o+1),this.buffer.write(r,this.offset,"utf-8"),this.offset+=o}return this.buffer[this.offset++]=0,this}addString(r=""){let o=qe.byteLength(r);return this.ensure(o),this.buffer.write(r,this.offset),this.offset+=o,this}add(r){return this.ensure(r.length),r.copy(this.buffer,this.offset),this.offset+=r.length,this}join(r){if(r){this.buffer[this.headerPosition]=r;let o=this.offset-(this.headerPosition+1);this.buffer.writeInt32BE(o,this.headerPosition+1)}return this.buffer.slice(r?0:5,this.offset)}flush(r){let o=this.join(r);return this.offset=5,this.headerPosition=0,this.buffer=qe.allocUnsafe(this.size),o}};M(t,"Writer");var n=t;e.Writer=n}),MZ=ut(e=>{$e(),Object.defineProperty(e,"__esModule",{value:!0}),e.serialize=void 0;var t=LZ(),n=new t.Writer,i=M(T=>{n.addInt16(3).addInt16(0);for(let q of Object.keys(T))n.addCString(q).addCString(T[q]);n.addCString("client_encoding").addCString("UTF8");let z=n.addCString("").flush(),L=z.length+4;return new t.Writer().addInt32(L).add(z).flush()},"startup"),r=M(()=>{let T=qe.allocUnsafe(8);return T.writeInt32BE(8,0),T.writeInt32BE(80877103,4),T},"requestSsl"),o=M(T=>n.addCString(T).flush(112),"password"),s=M(function(T,z){return n.addCString(T).addInt32(qe.byteLength(z)).addString(z),n.flush(112)},"sendSASLInitialResponseMessage"),a=M(function(T){return n.addString(T).flush(112)},"sendSCRAMClientFinalMessage"),c=M(T=>n.addCString(T).flush(81),"query"),l=[],u=M(T=>{let z=T.name||"";z.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",z,z.length),console.error("This can cause conflicts and silent errors executing queries"));let L=T.types||l,q=L.length,V=n.addCString(z).addCString(T.text).addInt16(q);for(let K=0;K<q;K++)V.addInt32(L[K]);return n.flush(80)},"parse"),p=new t.Writer,f=M(function(T,z){for(let L=0;L<T.length;L++){let q=z?z(T[L],L):T[L];q==null?(n.addInt16(0),p.addInt32(-1)):q instanceof qe?(n.addInt16(1),p.addInt32(q.length),p.add(q)):(n.addInt16(0),p.addInt32(qe.byteLength(q)),p.addString(q))}},"writeValues"),g=M((T={})=>{let z=T.portal||"",L=T.statement||"",q=T.binary||!1,V=T.values||l,K=V.length;return n.addCString(z).addCString(L),n.addInt16(K),f(V,T.valueMapper),n.addInt16(K),n.add(p.flush()),n.addInt16(q?1:0),n.flush(66)},"bind"),h=qe.from([69,0,0,0,9,0,0,0,0,0]),d=M(T=>{if(!T||!T.portal&&!T.rows)return h;let z=T.portal||"",L=T.rows||0,q=qe.byteLength(z),V=4+q+1+4,K=qe.allocUnsafe(1+V);return K[0]=69,K.writeInt32BE(V,1),K.write(z,5,"utf-8"),K[q+5]=0,K.writeUInt32BE(L,K.length-4),K},"execute"),y=M((T,z)=>{let L=qe.allocUnsafe(16);return L.writeInt32BE(16,0),L.writeInt16BE(1234,4),L.writeInt16BE(5678,6),L.writeInt32BE(T,8),L.writeInt32BE(z,12),L},"cancel"),v=M((T,z)=>{let L=4+qe.byteLength(z)+1,q=qe.allocUnsafe(1+L);return q[0]=T,q.writeInt32BE(L,1),q.write(z,5,"utf-8"),q[L]=0,q},"cstringMessage"),x=n.addCString("P").flush(68),E=n.addCString("S").flush(68),N=M(T=>T.name?v(68,`${T.type}${T.name||""}`):T.type==="P"?x:E,"describe"),C=M(T=>{let z=`${T.type}${T.name||""}`;return v(67,z)},"close"),b=M(T=>n.add(T).flush(100),"copyData"),P=M(T=>v(102,T),"copyFail"),$=M(T=>qe.from([T,0,0,0,4]),"codeOnlyBuffer"),k=$(72),D=$(83),B=$(88),J=$(99),S={startup:i,password:o,requestSsl:r,sendSASLInitialResponseMessage:s,sendSCRAMClientFinalMessage:a,query:c,parse:u,bind:g,execute:d,describe:N,close:C,flush:M(()=>k,"flush"),sync:M(()=>D,"sync"),end:M(()=>B,"end"),copyData:b,copyDone:M(()=>J,"copyDone"),copyFail:P,cancel:y};e.serialize=S}),jZ=ut(e=>{$e(),Object.defineProperty(e,"__esModule",{value:!0}),e.BufferReader=void 0;var t=qe.allocUnsafe(0),n=class{constructor(o=0){this.offset=o,this.buffer=t,this.encoding="utf-8"}setBuffer(o,s){this.offset=o,this.buffer=s}int16(){let o=this.buffer.readInt16BE(this.offset);return this.offset+=2,o}byte(){let o=this.buffer[this.offset];return this.offset++,o}int32(){let o=this.buffer.readInt32BE(this.offset);return this.offset+=4,o}uint32(){let o=this.buffer.readUInt32BE(this.offset);return this.offset+=4,o}string(o){let s=this.buffer.toString(this.encoding,this.offset,this.offset+o);return this.offset+=o,s}cstring(){let o=this.offset,s=o;for(;this.buffer[s++]!==0;);return this.offset=s,this.buffer.toString(this.encoding,o,s-1)}bytes(o){let s=this.buffer.slice(this.offset,this.offset+o);return this.offset+=o,s}};M(n,"BufferReader");var i=n;e.BufferReader=i}),zZ=ut(e=>{$e(),Object.defineProperty(e,"__esModule",{value:!0}),e.Parser=void 0;var t=KR(),n=jZ(),i=1,r=4,o=i+r,s=qe.allocUnsafe(0),a=class{constructor(u){if(this.buffer=s,this.bufferLength=0,this.bufferOffset=0,this.reader=new n.BufferReader,u?.mode==="binary")throw new Error("Binary mode not supported yet");this.mode=u?.mode||"text"}parse(u,p){this.mergeBuffer(u);let f=this.bufferOffset+this.bufferLength,g=this.bufferOffset;for(;g+o<=f;){let h=this.buffer[g],d=this.buffer.readUInt32BE(g+i),y=i+d;if(y+g<=f){let v=this.handlePacket(g+o,h,d,this.buffer);p(v),g+=y}else break}g===f?(this.buffer=s,this.bufferLength=0,this.bufferOffset=0):(this.bufferLength=f-g,this.bufferOffset=g)}mergeBuffer(u){if(this.bufferLength>0){let p=this.bufferLength+u.byteLength;if(p+this.bufferOffset>this.buffer.byteLength){let f;if(p<=this.buffer.byteLength&&this.bufferOffset>=this.bufferLength)f=this.buffer;else{let g=this.buffer.byteLength*2;for(;p>=g;)g*=2;f=qe.allocUnsafe(g)}this.buffer.copy(f,0,this.bufferOffset,this.bufferOffset+this.bufferLength),this.buffer=f,this.bufferOffset=0}u.copy(this.buffer,this.bufferOffset+this.bufferLength),this.bufferLength=p}else this.buffer=u,this.bufferOffset=0,this.bufferLength=u.byteLength}handlePacket(u,p,f,g){switch(p){case 50:return t.bindComplete;case 49:return t.parseComplete;case 51:return t.closeComplete;case 110:return t.noData;case 115:return t.portalSuspended;case 99:return t.copyDone;case 87:return t.replicationStart;case 73:return t.emptyQuery;case 68:return this.parseDataRowMessage(u,f,g);case 67:return this.parseCommandCompleteMessage(u,f,g);case 90:return this.parseReadyForQueryMessage(u,f,g);case 65:return this.parseNotificationMessage(u,f,g);case 82:return this.parseAuthenticationResponse(u,f,g);case 83:return this.parseParameterStatusMessage(u,f,g);case 75:return this.parseBackendKeyData(u,f,g);case 69:return this.parseErrorMessage(u,f,g,"error");case 78:return this.parseErrorMessage(u,f,g,"notice");case 84:return this.parseRowDescriptionMessage(u,f,g);case 116:return this.parseParameterDescriptionMessage(u,f,g);case 71:return this.parseCopyInMessage(u,f,g);case 72:return this.parseCopyOutMessage(u,f,g);case 100:return this.parseCopyData(u,f,g);default:return new t.DatabaseError("received invalid response: "+p.toString(16),f,"error")}}parseReadyForQueryMessage(u,p,f){this.reader.setBuffer(u,f);let g=this.reader.string(1);return new t.ReadyForQueryMessage(p,g)}parseCommandCompleteMessage(u,p,f){this.reader.setBuffer(u,f);let g=this.reader.cstring();return new t.CommandCompleteMessage(p,g)}parseCopyData(u,p,f){let g=f.slice(u,u+(p-4));return new t.CopyDataMessage(p,g)}parseCopyInMessage(u,p,f){return this.parseCopyMessage(u,p,f,"copyInResponse")}parseCopyOutMessage(u,p,f){return this.parseCopyMessage(u,p,f,"copyOutResponse")}parseCopyMessage(u,p,f,g){this.reader.setBuffer(u,f);let h=this.reader.byte()!==0,d=this.reader.int16(),y=new t.CopyResponse(p,g,h,d);for(let v=0;v<d;v++)y.columnTypes[v]=this.reader.int16();return y}parseNotificationMessage(u,p,f){this.reader.setBuffer(u,f);let g=this.reader.int32(),h=this.reader.cstring(),d=this.reader.cstring();return new t.NotificationResponseMessage(p,g,h,d)}parseRowDescriptionMessage(u,p,f){this.reader.setBuffer(u,f);let g=this.reader.int16(),h=new t.RowDescriptionMessage(p,g);for(let d=0;d<g;d++)h.fields[d]=this.parseField();return h}parseField(){let u=this.reader.cstring(),p=this.reader.uint32(),f=this.reader.int16(),g=this.reader.uint32(),h=this.reader.int16(),d=this.reader.int32(),y=this.reader.int16()===0?"text":"binary";return new t.Field(u,p,f,g,h,d,y)}parseParameterDescriptionMessage(u,p,f){this.reader.setBuffer(u,f);let g=this.reader.int16(),h=new t.ParameterDescriptionMessage(p,g);for(let d=0;d<g;d++)h.dataTypeIDs[d]=this.reader.int32();return h}parseDataRowMessage(u,p,f){this.reader.setBuffer(u,f);let g=this.reader.int16(),h=new Array(g);for(let d=0;d<g;d++){let y=this.reader.int32();h[d]=y===-1?null:this.reader.string(y)}return new t.DataRowMessage(p,h)}parseParameterStatusMessage(u,p,f){this.reader.setBuffer(u,f);let g=this.reader.cstring(),h=this.reader.cstring();return new t.ParameterStatusMessage(p,g,h)}parseBackendKeyData(u,p,f){this.reader.setBuffer(u,f);let g=this.reader.int32(),h=this.reader.int32();return new t.BackendKeyDataMessage(p,g,h)}parseAuthenticationResponse(u,p,f){this.reader.setBuffer(u,f);let g=this.reader.int32(),h={name:"authenticationOk",length:p};switch(g){case 0:break;case 3:h.length===8&&(h.name="authenticationCleartextPassword");break;case 5:if(h.length===12){h.name="authenticationMD5Password";let d=this.reader.bytes(4);return new t.AuthenticationMD5Password(p,d)}break;case 10:{h.name="authenticationSASL",h.mechanisms=[];let d;do d=this.reader.cstring(),d&&h.mechanisms.push(d);while(d)}break;case 11:h.name="authenticationSASLContinue",h.data=this.reader.string(p-8);break;case 12:h.name="authenticationSASLFinal",h.data=this.reader.string(p-8);break;default:throw new Error("Unknown authenticationOk message type "+g)}return h}parseErrorMessage(u,p,f,g){this.reader.setBuffer(u,f);let h={},d=this.reader.string(1);for(;d!=="\0";)h[d]=this.reader.cstring(),d=this.reader.string(1);let y=h.M,v=g==="notice"?new t.NoticeMessage(p,y):new t.DatabaseError(y,p,g);return v.severity=h.S,v.code=h.C,v.detail=h.D,v.hint=h.H,v.position=h.P,v.internalPosition=h.p,v.internalQuery=h.q,v.where=h.W,v.schema=h.s,v.table=h.t,v.column=h.c,v.dataType=h.d,v.constraint=h.n,v.file=h.F,v.line=h.L,v.routine=h.R,v}};M(a,"Parser");var c=a;e.Parser=c}),JR=ut(e=>{$e(),Object.defineProperty(e,"__esModule",{value:!0}),e.DatabaseError=e.serialize=e.parse=void 0;var t=KR();Object.defineProperty(e,"DatabaseError",{enumerable:!0,get:M(function(){return t.DatabaseError},"get")});var n=MZ();Object.defineProperty(e,"serialize",{enumerable:!0,get:M(function(){return n.serialize},"get")});var i=zZ();function r(o,s){let a=new i.Parser;return o.on("data",c=>a.parse(c,s)),new Promise(c=>o.on("end",()=>c()))}M(r,"parse"),e.parse=r}),GR={};xi(GR,{connect:()=>ZR});function ZR({socket:e,servername:t}){return e.startTls(t),e}var BZ=kr(()=>{$e(),M(ZR,"connect")}),QR=ut((e,t)=>{$e();var n=(Gu(),Mn(ER)),i=sa().EventEmitter,{parse:r,serialize:o}=JR(),s=o.flush(),a=o.sync(),c=o.end(),l=class extends i{constructor(f){super(),f=f||{},this.stream=f.stream||new n.Socket,this._keepAlive=f.keepAlive,this._keepAliveInitialDelayMillis=f.keepAliveInitialDelayMillis,this.lastBuffer=!1,this.parsedStatements={},this.ssl=f.ssl||!1,this._ending=!1,this._emitMessage=!1;var g=this;this.on("newListener",function(h){h==="message"&&(g._emitMessage=!0)})}connect(f,g){var h=this;this._connecting=!0,this.stream.setNoDelay(!0),this.stream.connect(f,g),this.stream.once("connect",function(){h._keepAlive&&h.stream.setKeepAlive(!0,h._keepAliveInitialDelayMillis),h.emit("connect")});let d=M(function(y){h._ending&&(y.code==="ECONNRESET"||y.code==="EPIPE")||h.emit("error",y)},"reportStreamError");if(this.stream.on("error",d),this.stream.on("close",function(){h.emit("end")}),!this.ssl)return this.attachListeners(this.stream);this.stream.once("data",function(y){var v=y.toString("utf8");switch(v){case"S":break;case"N":return h.stream.end(),h.emit("error",new Error("The server does not support SSL connections"));default:return h.stream.end(),h.emit("error",new Error("There was an error establishing an SSL connection"))}var x=(BZ(),Mn(GR));let E={socket:h.stream};h.ssl!==!0&&(Object.assign(E,h.ssl),"key"in h.ssl&&(E.key=h.ssl.key)),n.isIP(g)===0&&(E.servername=g);try{h.stream=x.connect(E)}catch(N){return h.emit("error",N)}h.attachListeners(h.stream),h.stream.on("error",d),h.emit("sslconnect")})}attachListeners(f){f.on("end",()=>{this.emit("end")}),r(f,g=>{var h=g.name==="error"?"errorMessage":g.name;this._emitMessage&&this.emit("message",g),this.emit(h,g)})}requestSsl(){this.stream.write(o.requestSsl())}startup(f){this.stream.write(o.startup(f))}cancel(f,g){this._send(o.cancel(f,g))}password(f){this._send(o.password(f))}sendSASLInitialResponseMessage(f,g){this._send(o.sendSASLInitialResponseMessage(f,g))}sendSCRAMClientFinalMessage(f){this._send(o.sendSCRAMClientFinalMessage(f))}_send(f){return this.stream.writable?this.stream.write(f):!1}query(f){this._send(o.query(f))}parse(f){this._send(o.parse(f))}bind(f){this._send(o.bind(f))}execute(f){this._send(o.execute(f))}flush(){this.stream.writable&&this.stream.write(s)}sync(){this._ending=!0,this._send(s),this._send(a)}ref(){this.stream.ref()}unref(){this.stream.unref()}end(){if(this._ending=!0,!this._connecting||!this.stream.writable){this.stream.end();return}return this.stream.write(c,()=>{this.stream.end()})}close(f){this._send(o.close(f))}describe(f){this._send(o.describe(f))}sendCopyFromChunk(f){this._send(o.copyData(f))}endCopyFrom(){this._send(o.copyDone())}sendCopyFail(f){this._send(o.copyFail(f))}};M(l,"Connection");var u=l;t.exports=u}),FZ=ut((e,t)=>{$e();var n=sa().EventEmitter;Zh(),Mn(Zu);var i=Gh(),r=IZ(),o=OZ(),s=u0(),a=m0(),c=UZ(),l=Jh(),u=QR(),p=class extends n{constructor(h){super(),this.connectionParameters=new a(h),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;var d=h||{};this._Promise=d.Promise||Hh.Promise,this._types=new s(d.types),this._ending=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.connection=d.connection||new u({stream:d.stream,ssl:this.connectionParameters.ssl,keepAlive:d.keepAlive||!1,keepAliveInitialDelayMillis:d.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=d.binary||l.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=d.connectionTimeoutMillis||0}_errorAllQueries(h){let d=M(y=>{ct.nextTick(()=>{y.handleError(h,this.connection)})},"enqueueError");this.activeQuery&&(d(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(d),this.queryQueue.length=0}_connect(h){var d=this,y=this.connection;if(this._connectionCallback=h,this._connecting||this._connected){let v=new Error("Client has already been connected. You cannot reuse a client.");ct.nextTick(()=>{h(v)});return}this._connecting=!0,this.connectionTimeoutHandle,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{y._ending=!0,y.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis)),this.host&&this.host.indexOf("/")===0?y.connect(this.host+"/.s.PGSQL."+this.port):y.connect(this.port,this.host),y.on("connect",function(){d.ssl?y.requestSsl():y.startup(d.getStartupConf())}),y.on("sslconnect",function(){y.startup(d.getStartupConf())}),this._attachListeners(y),y.once("end",()=>{let v=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(v),this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(v):this._handleErrorEvent(v):this._connectionError||this._handleErrorEvent(v)),ct.nextTick(()=>{this.emit("end")})})}connect(h){if(h){this._connect(h);return}return new this._Promise((d,y)=>{this._connect(v=>{v?y(v):d()})})}_attachListeners(h){h.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),h.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),h.on("authenticationSASL",this._handleAuthSASL.bind(this)),h.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),h.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),h.on("backendKeyData",this._handleBackendKeyData.bind(this)),h.on("error",this._handleErrorEvent.bind(this)),h.on("errorMessage",this._handleErrorMessage.bind(this)),h.on("readyForQuery",this._handleReadyForQuery.bind(this)),h.on("notice",this._handleNotice.bind(this)),h.on("rowDescription",this._handleRowDescription.bind(this)),h.on("dataRow",this._handleDataRow.bind(this)),h.on("portalSuspended",this._handlePortalSuspended.bind(this)),h.on("emptyQuery",this._handleEmptyQuery.bind(this)),h.on("commandComplete",this._handleCommandComplete.bind(this)),h.on("parseComplete",this._handleParseComplete.bind(this)),h.on("copyInResponse",this._handleCopyInResponse.bind(this)),h.on("copyData",this._handleCopyData.bind(this)),h.on("notification",this._handleNotification.bind(this))}_checkPgPass(h){let d=this.connection;typeof this.password=="function"?this._Promise.resolve().then(()=>this.password()).then(y=>{if(y!==void 0){if(typeof y!="string"){d.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=y}else this.connectionParameters.password=this.password=null;h()}).catch(y=>{d.emit("error",y)}):this.password!==null?h():o(this.connectionParameters,y=>{y!==void 0&&(this.connectionParameters.password=this.password=y),h()})}_handleAuthCleartextPassword(h){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(h){this._checkPgPass(()=>{let d=i.postgresMd5PasswordHash(this.user,this.password,h.salt);this.connection.password(d)})}_handleAuthSASL(h){this._checkPgPass(()=>{this.saslSession=r.startSession(h.mechanisms),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)})}_handleAuthSASLContinue(h){r.continueSession(this.saslSession,this.password,h.data),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}_handleAuthSASLFinal(h){r.finalizeSession(this.saslSession,h.data),this.saslSession=null}_handleBackendKeyData(h){this.processID=h.processID,this.secretKey=h.secretKey}_handleReadyForQuery(h){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:d}=this;this.activeQuery=null,this.readyForQuery=!0,d&&d.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(h){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(h);this.emit("error",h)}}_handleErrorEvent(h){if(this._connecting)return this._handleErrorWhileConnecting(h);this._queryable=!1,this._errorAllQueries(h),this.emit("error",h)}_handleErrorMessage(h){if(this._connecting)return this._handleErrorWhileConnecting(h);let d=this.activeQuery;if(!d){this._handleErrorEvent(h);return}this.activeQuery=null,d.handleError(h,this.connection)}_handleRowDescription(h){this.activeQuery.handleRowDescription(h)}_handleDataRow(h){this.activeQuery.handleDataRow(h)}_handlePortalSuspended(h){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(h){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(h){this.activeQuery.handleCommandComplete(h,this.connection)}_handleParseComplete(h){this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(h){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(h){this.activeQuery.handleCopyData(h,this.connection)}_handleNotification(h){this.emit("notification",h)}_handleNotice(h){this.emit("notice",h)}getStartupConf(){var h=this.connectionParameters,d={user:h.user,database:h.database},y=h.application_name||h.fallback_application_name;return y&&(d.application_name=y),h.replication&&(d.replication=""+h.replication),h.statement_timeout&&(d.statement_timeout=String(parseInt(h.statement_timeout,10))),h.lock_timeout&&(d.lock_timeout=String(parseInt(h.lock_timeout,10))),h.idle_in_transaction_session_timeout&&(d.idle_in_transaction_session_timeout=String(parseInt(h.idle_in_transaction_session_timeout,10))),h.options&&(d.options=h.options),d}cancel(h,d){if(h.activeQuery===d){var y=this.connection;this.host&&this.host.indexOf("/")===0?y.connect(this.host+"/.s.PGSQL."+this.port):y.connect(this.port,this.host),y.on("connect",function(){y.cancel(h.processID,h.secretKey)})}else h.queryQueue.indexOf(d)!==-1&&h.queryQueue.splice(h.queryQueue.indexOf(d),1)}setTypeParser(h,d,y){return this._types.setTypeParser(h,d,y)}getTypeParser(h,d){return this._types.getTypeParser(h,d)}escapeIdentifier(h){return'"'+h.replace(/"/g,'""')+'"'}escapeLiteral(h){for(var d=!1,y="'",v=0;v<h.length;v++){var x=h[v];x==="'"?y+=x+x:x==="\\"?(y+=x+x,d=!0):y+=x}return y+="'",d===!0&&(y=" E"+y),y}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let h=this.activeQuery.submit(this.connection);h&&ct.nextTick(()=>{this.activeQuery.handleError(h,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(h,d,y){var v,x,E,N,C;if(h==null)throw new TypeError("Client was passed a null or undefined query");return typeof h.submit=="function"?(E=h.query_timeout||this.connectionParameters.query_timeout,x=v=h,typeof d=="function"&&(v.callback=v.callback||d)):(E=this.connectionParameters.query_timeout,v=new c(h,d,y),v.callback||(x=new this._Promise((b,P)=>{v.callback=($,k)=>$?P($):b(k)}))),E&&(C=v.callback,N=setTimeout(()=>{var b=new Error("Query read timeout");ct.nextTick(()=>{v.handleError(b,this.connection)}),C(b),v.callback=()=>{};var P=this.queryQueue.indexOf(v);P>-1&&this.queryQueue.splice(P,1),this._pulseQueryQueue()},E),v.callback=(b,P)=>{clearTimeout(N),C(b,P)}),this.binary&&!v.binary&&(v.binary=!0),v._result&&!v._result._types&&(v._result._types=this._types),this._queryable?this._ending?(ct.nextTick(()=>{v.handleError(new Error("Client was closed and is not queryable"),this.connection)}),x):(this.queryQueue.push(v),this._pulseQueryQueue(),x):(ct.nextTick(()=>{v.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),x)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(h){if(this._ending=!0,!this.connection._connecting)if(h)h();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),h)this.connection.once("end",h);else return new this._Promise(d=>{this.connection.once("end",d)})}};M(p,"Client");var f=p;f.Query=c,t.exports=f}),WZ=ut((e,t)=>{$e();var n=sa().EventEmitter,i=M(function(){},"NOOP"),r=M((h,d)=>{let y=h.findIndex(d);return y===-1?void 0:h.splice(y,1)[0]},"removeWhere"),o=class{constructor(d,y,v){this.client=d,this.idleListener=y,this.timeoutId=v}};M(o,"IdleItem");var s=o,a=class{constructor(d){this.callback=d}};M(a,"PendingItem");var c=a;function l(){throw new Error("Release called on client which has already been released to the pool.")}M(l,"throwOnDoubleRelease");function u(h,d){if(d)return{callback:d,result:void 0};let y,v,x=M(function(N,C){N?y(N):v(C)},"cb"),E=new h(function(N,C){v=N,y=C}).catch(N=>{throw Error.captureStackTrace(N),N});return{callback:x,result:E}}M(u,"promisify");function p(h,d){return M(function y(v){v.client=d,d.removeListener("error",y),d.on("error",()=>{h.log("additional client error after disconnection due to error",v)}),h._remove(d),h.emit("error",v,d)},"idleListener")}M(p,"makeIdleListener");var f=class extends n{constructor(d,y){super(),this.options=Object.assign({},d),d!=null&&"password"in d&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:d.password}),d!=null&&d.ssl&&d.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.min=this.options.min||0,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||y||Qh().Client,this.Promise=this.options.Promise||Hh.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_isAboveMin(){return this._clients.length>this.options.min}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(y=>{this._remove(y.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let d=this._pendingQueue.shift();if(this._idle.length){let y=this._idle.pop();clearTimeout(y.timeoutId);let v=y.client;v.ref&&v.ref();let x=y.idleListener;return this._acquireClient(v,d,x,!1)}if(!this._isFull())return this.newClient(d);throw new Error("unexpected condition")}_remove(d){let y=r(this._idle,v=>v.client===d);y!==void 0&&clearTimeout(y.timeoutId),this._clients=this._clients.filter(v=>v!==d),d.end(),this.emit("remove",d)}connect(d){if(this.ending){let x=new Error("Cannot use a pool after calling end on the pool");return d?d(x):this.Promise.reject(x)}let y=u(this.Promise,d),v=y.result;if(this._isFull()||this._idle.length){if(this._idle.length&&ct.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new c(y.callback)),v;let x=M((C,b,P)=>{clearTimeout(N),y.callback(C,b,P)},"queueCallback"),E=new c(x),N=setTimeout(()=>{r(this._pendingQueue,C=>C.callback===x),E.timedOut=!0,y.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return N.unref&&N.unref(),this._pendingQueue.push(E),v}return this.newClient(new c(y.callback)),v}newClient(d){let y=new this.Client(this.options);this._clients.push(y);let v=p(this,y);this.log("checking client timeout");let x,E=!1;this.options.connectionTimeoutMillis&&(x=setTimeout(()=>{this.log("ending client due to timeout"),E=!0,y.connection?y.connection.stream.destroy():y.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),y.connect(N=>{if(x&&clearTimeout(x),y.on("error",v),N)this.log("client failed to connect",N),this._clients=this._clients.filter(C=>C!==y),E&&(N=new Error("Connection terminated due to connection timeout",{cause:N})),this._pulseQueue(),d.timedOut||d.callback(N,void 0,i);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let C=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(y),this._idle.findIndex(b=>b.client===y)!==-1&&this._acquireClient(y,new c((b,P,$)=>$()),v,!1)},this.options.maxLifetimeSeconds*1e3);C.unref(),y.once("end",()=>clearTimeout(C))}return this._acquireClient(y,d,v,!0)}})}_acquireClient(d,y,v,x){x&&this.emit("connect",d),this.emit("acquire",d),d.release=this._releaseOnce(d,v),d.removeListener("error",v),y.timedOut?x&&this.options.verify?this.options.verify(d,d.release):d.release():x&&this.options.verify?this.options.verify(d,E=>{if(E)return d.release(E),y.callback(E,void 0,i);y.callback(void 0,d,d.release)}):y.callback(void 0,d,d.release)}_releaseOnce(d,y){let v=!1;return x=>{v&&l(),v=!0,this._release(d,y,x)}}_release(d,y,v){if(d.on("error",y),d._poolUseCount=(d._poolUseCount||0)+1,this.emit("release",v,d),v||this.ending||!d._queryable||d._ending||d._poolUseCount>=this.options.maxUses){d._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(d),this._pulseQueue();return}if(this._expired.has(d)){this.log("remove expired client"),this._expired.delete(d),this._remove(d),this._pulseQueue();return}let x;this.options.idleTimeoutMillis&&this._isAboveMin()&&(x=setTimeout(()=>{this.log("remove idle client"),this._remove(d)},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&x.unref()),this.options.allowExitOnIdle&&d.unref(),this._idle.push(new s(d,y,x)),this._pulseQueue()}query(d,y,v){if(typeof d=="function"){let E=u(this.Promise,d);return c0(function(){return E.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),E.result}typeof y=="function"&&(v=y,y=void 0);let x=u(this.Promise,v);return v=x.callback,this.connect((E,N)=>{if(E)return v(E);let C=!1,b=M(P=>{C||(C=!0,N.release(P),v(P))},"onError");N.once("error",b),this.log("dispatching query");try{N.query(d,y,(P,$)=>{if(this.log("query dispatched"),N.removeListener("error",b),!C)return C=!0,N.release(P),P?v(P):v(void 0,$)})}catch(P){return N.release(P),v(P)}}),x.result}end(d){if(this.log("ending"),this.ending){let v=new Error("Called end on pool more than once");return d?d(v):this.Promise.reject(v)}this.ending=!0;let y=u(this.Promise,d);return this._endCallback=y.callback,this._pulseQueue(),y.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((d,y)=>d+(this._expired.has(y)?1:0),0)}get totalCount(){return this._clients.length}};M(f,"Pool");var g=f;t.exports=g}),YR={};xi(YR,{default:()=>XR});var XR,VZ=kr(()=>{$e(),XR={}}),qZ=ut((e,t)=>{t.exports={name:"pg",version:"8.8.0",description:"PostgreSQL client - pure javascript & libpq with the same API",keywords:["database","libpq","pg","postgre","postgres","postgresql","rdbms"],homepage:"https://github.com/brianc/node-postgres",repository:{type:"git",url:"git://github.com/brianc/node-postgres.git",directory:"packages/pg"},author:"Brian Carlson <brian.m.carlson@gmail.com>",main:"./lib",dependencies:{"buffer-writer":"2.0.0","packet-reader":"1.0.0","pg-connection-string":"^2.5.0","pg-pool":"^3.5.2","pg-protocol":"^1.5.0","pg-types":"^2.1.0",pgpass:"1.x"},devDependencies:{async:"2.6.4",bluebird:"3.5.2",co:"4.6.0","pg-copy-streams":"0.3.0"},peerDependencies:{"pg-native":">=3.0.1"},peerDependenciesMeta:{"pg-native":{optional:!0}},scripts:{test:"make test-all"},files:["lib","SPONSORS.md"],license:"MIT",engines:{node:">= 8.0.0"},gitHead:"c99fb2c127ddf8d712500db2c7b9a5491a178655"}}),HZ=ut((e,t)=>{$e();var n=sa().EventEmitter,i=(Zh(),Mn(Zu)),r=Gh(),o=t.exports=function(a,c,l){n.call(this),a=r.normalizeQueryConfig(a,c,l),this.text=a.text,this.values=a.values,this.name=a.name,this.callback=a.callback,this.state="new",this._arrayMode=a.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(u){u==="row"&&(this._emitRowEvents=!0)}.bind(this))};i.inherits(o,n);var s={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};o.prototype.handleError=function(a){var c=this.native.pq.resultErrorFields();if(c)for(var l in c){var u=s[l]||l;a[u]=c[l]}this.callback?this.callback(a):this.emit("error",a),this.state="error"},o.prototype.then=function(a,c){return this._getPromise().then(a,c)},o.prototype.catch=function(a){return this._getPromise().catch(a)},o.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(a,c){this._once("end",a),this._once("error",c)}.bind(this)),this._promise)},o.prototype.submit=function(a){this.state="running";var c=this;this.native=a.native,a.native.arrayMode=this._arrayMode;var l=M(function(f,g,h){if(a.native.arrayMode=!1,c0(function(){c.emit("_done")}),f)return c.handleError(f);c._emitRowEvents&&(h.length>1?g.forEach((d,y)=>{d.forEach(v=>{c.emit("row",v,h[y])})}):g.forEach(function(d){c.emit("row",d,h)})),c.state="end",c.emit("end",h),c.callback&&c.callback(null,h)},"after");if(ct.domain&&(l=ct.domain.bind(l)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));var u=(this.values||[]).map(r.prepareValue);if(a.namedQueries[this.name]){if(this.text&&a.namedQueries[this.name]!==this.text){let f=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return l(f)}return a.native.execute(this.name,u,l)}return a.native.prepare(this.name,this.text,u.length,function(f){return f?l(f):(a.namedQueries[c.name]=c.text,c.native.execute(c.name,u,l))})}else if(this.values){if(!Array.isArray(this.values)){let f=new Error("Query values must be an array");return l(f)}var p=this.values.map(r.prepareValue);a.native.query(this.text,p,l)}else a.native.query(this.text,l)}}),KZ=ut((e,t)=>{$e();var n=(VZ(),Mn(YR)),i=u0();qZ();var r=sa().EventEmitter,o=(Zh(),Mn(Zu)),s=m0(),a=HZ(),c=t.exports=function(l){r.call(this),l=l||{},this._Promise=l.Promise||Hh.Promise,this._types=new i(l.types),this.native=new n({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;var u=this.connectionParameters=new s(l);this.user=u.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:u.password}),this.database=u.database,this.host=u.host,this.port=u.port,this.namedQueries={}};c.Query=a,o.inherits(c,r),c.prototype._errorAllQueries=function(l){let u=M(p=>{ct.nextTick(()=>{p.native=this.native,p.handleError(l)})},"enqueueError");this._hasActiveQuery()&&(u(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(u),this._queryQueue.length=0},c.prototype._connect=function(l){var u=this;if(this._connecting){ct.nextTick(()=>l(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(p,f){if(p)return l(p);u.native.connect(f,function(g){if(g)return u.native.end(),l(g);u._connected=!0,u.native.on("error",function(h){u._queryable=!1,u._errorAllQueries(h),u.emit("error",h)}),u.native.on("notification",function(h){u.emit("notification",{channel:h.relname,payload:h.extra})}),u.emit("connect"),u._pulseQueryQueue(!0),l()})})},c.prototype.connect=function(l){if(l){this._connect(l);return}return new this._Promise((u,p)=>{this._connect(f=>{f?p(f):u()})})},c.prototype.query=function(l,u,p){var f,g,h,d,y;if(l==null)throw new TypeError("Client was passed a null or undefined query");if(typeof l.submit=="function")h=l.query_timeout||this.connectionParameters.query_timeout,g=f=l,typeof u=="function"&&(l.callback=u);else if(h=this.connectionParameters.query_timeout,f=new a(l,u,p),!f.callback){let v,x;g=new this._Promise((E,N)=>{v=E,x=N}),f.callback=(E,N)=>E?x(E):v(N)}return h&&(y=f.callback,d=setTimeout(()=>{var v=new Error("Query read timeout");ct.nextTick(()=>{f.handleError(v,this.connection)}),y(v),f.callback=()=>{};var x=this._queryQueue.indexOf(f);x>-1&&this._queryQueue.splice(x,1),this._pulseQueryQueue()},h),f.callback=(v,x)=>{clearTimeout(d),y(v,x)}),this._queryable?this._ending?(f.native=this.native,ct.nextTick(()=>{f.handleError(new Error("Client was closed and is not queryable"))}),g):(this._queryQueue.push(f),this._pulseQueryQueue(),g):(f.native=this.native,ct.nextTick(()=>{f.handleError(new Error("Client has encountered a connection error and is not queryable"))}),g)},c.prototype.end=function(l){var u=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,l));var p;return l||(p=new this._Promise(function(f,g){l=M(h=>h?g(h):f(),"cb")})),this.native.end(function(){u._errorAllQueries(new Error("Connection terminated")),ct.nextTick(()=>{u.emit("end"),l&&l()})}),p},c.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"},c.prototype._pulseQueryQueue=function(l){if(this._connected&&!this._hasActiveQuery()){var u=this._queryQueue.shift();if(!u){l||this.emit("drain");return}this._activeQuery=u,u.submit(this);var p=this;u.once("_done",function(){p._pulseQueryQueue()})}},c.prototype.cancel=function(l){this._activeQuery===l?this.native.cancel(function(){}):this._queryQueue.indexOf(l)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(l),1)},c.prototype.ref=function(){},c.prototype.unref=function(){},c.prototype.setTypeParser=function(l,u,p){return this._types.setTypeParser(l,u,p)},c.prototype.getTypeParser=function(l,u){return this._types.getTypeParser(l,u)}}),Yx=ut((e,t)=>{$e(),t.exports=KZ()}),Qh=ut((e,t)=>{$e();var n=FZ(),i=Jh(),r=QR(),o=WZ(),{DatabaseError:s}=JR(),a=M(l=>{var u;return u=class extends o{constructor(p){super(p,l)}},M(u,"BoundPool"),u},"poolFactory"),c=M(function(l){this.defaults=i,this.Client=l,this.Query=this.Client.Query,this.Pool=a(this.Client),this._pools=[],this.Connection=r,this.types=Kh(),this.DatabaseError=s},"PG");typeof ct.env.NODE_PG_FORCE_NATIVE<"u"?t.exports=new c(Yx()):(t.exports=new c(n),Object.defineProperty(t.exports,"native",{configurable:!0,enumerable:!1,get(){var l=null;try{l=new c(Yx())}catch(u){if(u.code!=="MODULE_NOT_FOUND")throw u}return Object.defineProperty(t.exports,"native",{value:l}),l}}))});$e();$e();Gu();IR();$e();var JZ=Object.defineProperty,GZ=Object.defineProperties,ZZ=Object.getOwnPropertyDescriptors,Xx=Object.getOwnPropertySymbols,QZ=Object.prototype.hasOwnProperty,YZ=Object.prototype.propertyIsEnumerable,ek=M((e,t,n)=>t in e?JZ(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,"__defNormalProp"),XZ=M((e,t)=>{for(var n in t||(t={}))QZ.call(t,n)&&ek(e,n,t[n]);if(Xx)for(var n of Xx(t))YZ.call(t,n)&&ek(e,n,t[n]);return e},"__spreadValues"),eQ=M((e,t)=>GZ(e,ZZ(t)),"__spreadProps"),tQ=1008e3,tk=new Uint8Array(new Uint16Array([258]).buffer)[0]===2,nQ=new TextDecoder,g0=new TextEncoder,Rd=g0.encode("0123456789abcdef"),Pd=g0.encode("0123456789ABCDEF"),rQ=g0.encode("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"),eP=rQ.slice();eP[62]=45;eP[63]=95;var Qc,Dd;function tP(e,{alphabet:t,scratchArr:n}={}){if(!Qc)if(Qc=new Uint16Array(256),Dd=new Uint16Array(256),tk)for(let g=0;g<256;g++)Qc[g]=Rd[g&15]<<8|Rd[g>>>4],Dd[g]=Pd[g&15]<<8|Pd[g>>>4];else for(let g=0;g<256;g++)Qc[g]=Rd[g&15]|Rd[g>>>4]<<8,Dd[g]=Pd[g&15]|Pd[g>>>4]<<8;e.byteOffset%4!==0&&(e=new Uint8Array(e));let i=e.length,r=i>>>1,o=i>>>2,s=n||new Uint16Array(i),a=new Uint32Array(e.buffer,e.byteOffset,o),c=new Uint32Array(s.buffer,s.byteOffset,r),l=t==="upper"?Dd:Qc,u=0,p=0,f;if(tk)for(;u<o;)f=a[u++],c[p++]=l[f>>>8&255]<<16|l[f&255],c[p++]=l[f>>>24]<<16|l[f>>>16&255];else for(;u<o;)f=a[u++],c[p++]=l[f>>>24]<<16|l[f>>>16&255],c[p++]=l[f>>>8&255]<<16|l[f&255];for(u<<=2;u<i;)s[u]=l[e[u++]];return nQ.decode(s.subarray(0,i))}M(tP,"_toHex");function nP(e,t={}){let n="",i=e.length,r=tQ>>>1,o=Math.ceil(i/r),s=new Uint16Array(o>1?r:i);for(let a=0;a<o;a++){let c=a*r,l=c+r;n+=tP(e.subarray(c,l),eQ(XZ({},t),{scratchArr:s}))}return n}M(nP,"_toHexChunked");function rP(e,t={}){return t.alphabet!=="upper"&&typeof e.toHex=="function"?e.toHex():nP(e,t)}M(rP,"toHex");$e();var iP=class oP{constructor(t,n){this.strings=t,this.values=n}toParameterizedQuery(t={query:"",params:[]}){let{strings:n,values:i}=this;for(let r=0,o=n.length;r<o;r++)if(t.query+=n[r],r<i.length){let s=i[r];if(s instanceof cP)t.query+=s.sql;else if(s instanceof rf)if(s.queryData instanceof oP)s.queryData.toParameterizedQuery(t);else{if(s.queryData.params?.length)throw new Error("This query is not composable");t.query+=s.queryData.query}else{let{params:a}=t;a.push(s),t.query+="$"+a.length,(s instanceof qe||ArrayBuffer.isView(s))&&(t.query+="::bytea")}}return t}};M(iP,"SqlTemplate");var sP=iP,aP=class{constructor(t){this.sql=t}};M(aP,"UnsafeRawSql");var cP=aP;$e();function y0(){typeof window<"u"&&typeof document<"u"&&typeof console<"u"&&typeof console.warn=="function"&&console.warn(`          
        ************************************************************
        *                                                          *
        *  WARNING: Running SQL directly from the browser can have *
        *  security implications. Even if your database is         *
        *  protected by Row-Level Security (RLS), use it at your   *
        *  own risk. This approach is great for fast prototyping,  *
        *  but ensure proper safeguards are in place to prevent    *
        *  misuse or execution of expensive SQL queries by your    *
        *  end users.                                              *
        *                                                          *
        *  If you've assessed the risks, suppress this message     *
        *  using the disableWarningInBrowsers configuration        *
        *  parameter.                                              *
        *                                                          *
        ************************************************************`)}M(y0,"warnIfBrowser");Gu();var iQ=oa(u0()),oQ=oa(Gh()),lP=class uP extends Error{constructor(t){super(t),Je(this,"name","NeonDbError"),Je(this,"severity"),Je(this,"code"),Je(this,"detail"),Je(this,"hint"),Je(this,"position"),Je(this,"internalPosition"),Je(this,"internalQuery"),Je(this,"where"),Je(this,"schema"),Je(this,"table"),Je(this,"column"),Je(this,"dataType"),Je(this,"constraint"),Je(this,"file"),Je(this,"line"),Je(this,"routine"),Je(this,"sourceError"),"captureStackTrace"in Error&&typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,uP)}};M(lP,"NeonDbError");var $a=lP,nk="transaction() expects an array of queries, or a function returning an array of queries",sQ=["severity","code","detail","hint","position","internalPosition","internalQuery","where","schema","table","column","dataType","constraint","file","line","routine"];function dP(e){return e instanceof qe?"\\x"+rP(e):e}M(dP,"encodeBuffersAsBytea");function $y(e){let{query:t,params:n}=e instanceof sP?e.toParameterizedQuery():e;return{query:t,params:n.map(i=>dP((0,oQ.prepareValue)(i)))}}M($y,"prepareQuery");function w0(e,{arrayMode:t,fullResults:n,fetchOptions:i,isolationLevel:r,readOnly:o,deferrable:s,authToken:a,disableWarningInBrowsers:c}={}){if(!e)throw new Error("No database connection string was provided to `neon()`. Perhaps an environment variable has not been set?");let l;try{l=l0(e)}catch{throw new Error("Database connection string provided to `neon()` is not a valid URL. Connection string: "+String(e))}let{protocol:u,username:p,hostname:f,port:g,pathname:h}=l;if(u!=="postgres:"&&u!=="postgresql:"||!p||!f||!h)throw new Error("Database connection string format for `neon()` should be: postgresql://user:password@host.tld/dbname?option=value");function d(v,...x){if(!(Array.isArray(v)&&Array.isArray(v.raw)&&Array.isArray(x)))throw new Error('This function can now be called only as a tagged-template function: sql`SELECT ${value}`, not sql("SELECT $1", [value], options). For a conventional function call with value placeholders ($1, $2, etc.), use sql.query("SELECT $1", [value], options).');return new rf(y,new sP(v,x))}M(d,"templateFn"),d.query=(v,x,E)=>new rf(y,{query:v,params:x??[]},E),d.unsafe=v=>new cP(v),d.transaction=async(v,x)=>{if(typeof v=="function"&&(v=v(d)),!Array.isArray(v))throw new Error(nk);v.forEach(C=>{if(!(C instanceof rf))throw new Error(nk)});let E=v.map(C=>C.queryData),N=v.map(C=>C.opts??{});return y(E,N,x)};async function y(v,x,E){let{fetchEndpoint:N,fetchFunction:C}=Ul,b=Array.isArray(v)?{queries:v.map(V=>$y(V))}:$y(v),P=i??{},$=t??!1,k=n??!1,D=r,B=o,J=s;E!==void 0&&(E.fetchOptions!==void 0&&(P={...P,...E.fetchOptions}),E.arrayMode!==void 0&&($=E.arrayMode),E.fullResults!==void 0&&(k=E.fullResults),E.isolationLevel!==void 0&&(D=E.isolationLevel),E.readOnly!==void 0&&(B=E.readOnly),E.deferrable!==void 0&&(J=E.deferrable)),x!==void 0&&!Array.isArray(x)&&x.fetchOptions!==void 0&&(P={...P,...x.fetchOptions});let S=a;!Array.isArray(x)&&x?.authToken!==void 0&&(S=x.authToken);let T=typeof N=="function"?N(f,g,{jwtAuth:S!==void 0}):N,z={"Neon-Connection-String":e,"Neon-Raw-Text-Output":"true","Neon-Array-Mode":"true"},L=await pP(S);L&&(z.Authorization=`Bearer ${L}`),Array.isArray(v)&&(D!==void 0&&(z["Neon-Batch-Isolation-Level"]=D),B!==void 0&&(z["Neon-Batch-Read-Only"]=String(B)),J!==void 0&&(z["Neon-Batch-Deferrable"]=String(J))),c||Ul.disableWarningInBrowsers||y0();let q;try{q=await(C??fetch)(T,{method:"POST",body:JSON.stringify(b),headers:z,...P})}catch(V){let K=new $a(`Error connecting to database: ${V}`);throw K.sourceError=V,K}if(q.ok){let V=await q.json();if(Array.isArray(v)){let K=V.results;if(!Array.isArray(K))throw new $a("Neon internal error: unexpected result format");return K.map((oe,ne)=>{let X=x[ne]??{},ae=X.arrayMode??$,he=X.fullResults??k;return Cy(oe,{arrayMode:ae,fullResults:he,types:X.types})})}else{let K=x??{},oe=K.arrayMode??$,ne=K.fullResults??k;return Cy(V,{arrayMode:oe,fullResults:ne,types:K.types})}}else{let{status:V}=q;if(V===400){let K=await q.json(),oe=new $a(K.message);for(let ne of sQ)oe[ne]=K[ne]??void 0;throw oe}else{let K=await q.text();throw new $a(`Server error (HTTP status ${V}): ${K}`)}}}return M(y,"execute"),d}M(w0,"neon");var fP=class{constructor(t,n,i){this.execute=t,this.queryData=n,this.opts=i}then(t,n){return this.execute(this.queryData,this.opts).then(t,n)}catch(t){return this.execute(this.queryData,this.opts).catch(t)}finally(t){return this.execute(this.queryData,this.opts).finally(t)}};M(fP,"NeonQueryPromise");var rf=fP;function Cy(e,{arrayMode:t,fullResults:n,types:i}){let r=new iQ.default(i),o=e.fields.map(c=>c.name),s=e.fields.map(c=>r.getTypeParser(c.dataTypeID)),a=t===!0?e.rows.map(c=>c.map((l,u)=>l===null?null:s[u](l))):e.rows.map(c=>Object.fromEntries(c.map((l,u)=>[o[u],l===null?null:s[u](l)])));return n?(e.viaNeonFetch=!0,e.rowAsArray=t,e.rows=a,e._parsers=s,e._types=r,e):a}M(Cy,"processQueryResult");async function pP(e){if(typeof e=="string")return e;if(typeof e=="function")try{return await Promise.resolve(e())}catch(t){let n=new $a("Error getting auth token.");throw t instanceof Error&&(n=new $a(`Error getting auth token: ${t.message}`)),n}}M(pP,"getAuthToken");$e();var aQ=oa(Qh());$e();var cQ=oa(Qh()),hP=class extends cQ.Client{constructor(t){super(t),this.config=t}get neonConfig(){return this.connection.stream}connect(t){let{neonConfig:n}=this;n.forceDisablePgSSL&&(this.ssl=this.connection.ssl=!1),this.ssl&&n.useSecureWebSocket&&console.warn("SSL is enabled for both Postgres (e.g. ?sslmode=require in the connection string + forceDisablePgSSL = false) and the WebSocket tunnel (useSecureWebSocket = true). Double encryption will increase latency and CPU usage. It may be appropriate to disable SSL in the Postgres connection parameters or set forceDisablePgSSL = true.");let i=typeof this.config!="string"&&this.config?.host!==void 0||typeof this.config!="string"&&this.config?.connectionString!==void 0||ct.env.PGHOST!==void 0,r=ct.env.USER??ct.env.USERNAME;if(!i&&this.host==="localhost"&&this.user===r&&this.database===r&&this.password===null)throw new Error(`No database host or connection string was set, and key parameters have default values (host: localhost, user: ${r}, db: ${r}, password: null). Is an environment variable missing? Alternatively, if you intended to connect with these parameters, please set the host to 'localhost' explicitly.`);let o=super.connect(t),s=n.pipelineTLS&&this.ssl,a=n.pipelineConnect==="password";if(!s&&!n.pipelineConnect)return o;let c=this.connection;if(s&&c.on("connect",()=>c.stream.emit("data","S")),a){c.removeAllListeners("authenticationCleartextPassword"),c.removeAllListeners("readyForQuery"),c.once("readyForQuery",()=>c.on("readyForQuery",this._handleReadyForQuery.bind(this)));let l=this.ssl?"sslconnect":"connect";c.on(l,()=>{this.neonConfig.disableWarningInBrowsers||y0(),this._handleAuthCleartextPassword(),this._handleReadyForQuery()})}return o}async _handleAuthSASLContinue(t){if(typeof crypto>"u"||crypto.subtle===void 0||crypto.subtle.importKey===void 0)throw new Error("Cannot use SASL auth when `crypto.subtle` is not defined");let n=crypto.subtle,i=this.saslSession,r=this.password,o=t.data;if(i.message!=="SASLInitialResponse"||typeof r!="string"||typeof o!="string")throw new Error("SASL: protocol error");let s=Object.fromEntries(o.split(",").map(V=>{if(!/^.=/.test(V))throw new Error("SASL: Invalid attribute pair entry");let K=V[0],oe=V.substring(2);return[K,oe]})),a=s.r,c=s.s,l=s.i;if(!a||!/^[!-+--~]+$/.test(a))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: nonce missing/unprintable");if(!c||!/^(?:[a-zA-Z0-9+/]{4})*(?:[a-zA-Z0-9+/]{2}==|[a-zA-Z0-9+/]{3}=)?$/.test(c))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: salt missing/not base64");if(!l||!/^[1-9][0-9]*$/.test(l))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: missing/invalid iteration count");if(!a.startsWith(i.clientNonce))throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce does not start with client nonce");if(a.length===i.clientNonce.length)throw new Error("SASL: SCRAM-SERVER-FIRST-MESSAGE: server nonce is too short");let u=parseInt(l,10),p=qe.from(c,"base64"),f=new TextEncoder,g=f.encode(r),h=await n.importKey("raw",g,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),d=new Uint8Array(await n.sign("HMAC",h,qe.concat([p,qe.from([0,0,0,1])]))),y=d;for(var v=0;v<u-1;v++)d=new Uint8Array(await n.sign("HMAC",h,d)),y=qe.from(y.map((V,K)=>y[K]^d[K]));let x=y,E=await n.importKey("raw",x,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),N=new Uint8Array(await n.sign("HMAC",E,f.encode("Client Key"))),C=await n.digest("SHA-256",N),b="n=*,r="+i.clientNonce,P="r="+a+",s="+c+",i="+u,$="c=biws,r="+a,k=b+","+P+","+$,D=await n.importKey("raw",C,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var B=new Uint8Array(await n.sign("HMAC",D,f.encode(k))),J=qe.from(N.map((V,K)=>N[K]^B[K])),S=J.toString("base64");let T=await n.importKey("raw",x,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]),z=await n.sign("HMAC",T,f.encode("Server Key")),L=await n.importKey("raw",z,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);var q=qe.from(await n.sign("HMAC",L,f.encode(k)));i.message="SASLResponse",i.serverSignature=q.toString("base64"),i.response=$+",p="+S,this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}};M(hP,"NeonClient");var lQ=hP;Gu();var uQ=oa(m0());function mP(e,t){if(t)return{callback:t,result:void 0};let n,i,r=M(function(s,a){s?n(s):i(a)},"cb"),o=new e(function(s,a){i=s,n=a});return{callback:r,result:o}}M(mP,"promisify");var dQ=class extends aQ.Pool{constructor(){super(...arguments),Je(this,"Client",lQ),Je(this,"hasFetchUnsupportedListeners",!1),Je(this,"addListener",this.on)}on(t,n){return t!=="error"&&(this.hasFetchUnsupportedListeners=!0),super.on(t,n)}query(t,n,i){if(!Ul.poolQueryViaFetch||this.hasFetchUnsupportedListeners||typeof t=="function")return super.query(t,n,i);typeof n=="function"&&(i=n,n=void 0);let r=mP(this.Promise,i);i=r.callback;try{let o=new uQ.default(this.options),s=encodeURIComponent,a=encodeURI,c=`postgresql://${s(o.user)}:${s(o.password)}@${s(o.host)}/${a(o.database)}`,l=typeof t=="string"?t:t.text,u=n??t.values??[];w0(c,{fullResults:!0,arrayMode:t.rowMode==="array"}).query(l,u,{types:t.types??this.options?.types}).then(p=>i(void 0,p)).catch(p=>i(p))}catch(o){i(o)}return r.result}};M(dQ,"NeonPool");Gu();var Qu=oa(Qh());Qu.DatabaseError;Qu.defaults;Qu.escapeIdentifier;Qu.escapeLiteral;var Uo=Qu.types;class rk extends ra{constructor(t,n,i,r){super(),this.session=n,this.dialect=i,this.config={table:t,withList:r}}static[ie]="PgDelete";config;where(t){return this.config.where=t,this}returning(t=this.config.table[De.Symbol.Columns]){return this.config.returning=qs(t),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){const{typings:t,...n}=this.dialect.sqlToQuery(this.getSQL());return n}_prepare(t){return Wr.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,t,!0))}prepare(t){return this._prepare(t)}execute=t=>Wr.startActiveSpan("drizzle.operation",()=>this._prepare().execute(t));$dynamic(){return this}}class ik{constructor(t,n,i,r){this.table=t,this.session=n,this.dialect=i,this.withList=r}static[ie]="PgInsertBuilder";values(t){if(t=Array.isArray(t)?t:[t],t.length===0)throw new Error("values() must be called with at least one value");const n=t.map(i=>{const r={},o=this.table[De.Symbol.Columns];for(const s of Object.keys(i)){const a=i[s];r[s]=me(a,je)?a:new is(a,o[s])}return r});return new fQ(this.table,n,this.session,this.dialect,this.withList)}}class fQ extends ra{constructor(t,n,i,r,o){super(),this.session=i,this.dialect=r,this.config={table:t,values:n,withList:o}}static[ie]="PgInsert";config;returning(t=this.config.table[De.Symbol.Columns]){return this.config.returning=qs(t),this}onConflictDoNothing(t={}){if(t.target===void 0)this.config.onConflict=Z`do nothing`;else{let n="";n=Array.isArray(t.target)?t.target.map(r=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(r))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(t.target));const i=t.where?Z` where ${t.where}`:void 0;this.config.onConflict=Z`(${Z.raw(n)})${i} do nothing`}return this}onConflictDoUpdate(t){if(t.where&&(t.targetWhere||t.setWhere))throw new Error('You cannot use both "where" and "targetWhere"/"setWhere" at the same time - "where" is deprecated, use "targetWhere" or "setWhere" instead.');const n=t.where?Z` where ${t.where}`:void 0,i=t.targetWhere?Z` where ${t.targetWhere}`:void 0,r=t.setWhere?Z` where ${t.setWhere}`:void 0,o=this.dialect.buildUpdateSet(this.config.table,fR(this.config.table,t.set));let s="";return s=Array.isArray(t.target)?t.target.map(a=>this.dialect.escapeName(this.dialect.casing.getColumnCasing(a))).join(","):this.dialect.escapeName(this.dialect.casing.getColumnCasing(t.target)),this.config.onConflict=Z`(${Z.raw(s)})${i} do update set ${o}${n}${r}`,this}getSQL(){return this.dialect.buildInsertQuery(this.config)}toSQL(){const{typings:t,...n}=this.dialect.sqlToQuery(this.getSQL());return n}_prepare(t){return Wr.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,t,!0))}prepare(t){return this._prepare(t)}execute=t=>Wr.startActiveSpan("drizzle.operation",()=>this._prepare().execute(t));$dynamic(){return this}}function pQ(e){return(e.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).map(n=>n.toLowerCase()).join("_")}function hQ(e){return(e.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).reduce((n,i,r)=>{const o=r===0?i.toLowerCase():`${i[0].toUpperCase()}${i.slice(1)}`;return n+o},"")}function mQ(e){return e}class gQ{static[ie]="CasingCache";cache={};cachedTables={};convert;constructor(t){this.convert=t==="snake_case"?pQ:t==="camelCase"?hQ:mQ}getColumnCasing(t){if(!t.keyAsName)return t.name;const n=t.table[De.Symbol.Schema]??"public",i=t.table[De.Symbol.OriginalName],r=`${n}.${i}.${t.name}`;return this.cache[r]||this.cacheTable(t.table),this.cache[r]}cacheTable(t){const n=t[De.Symbol.Schema]??"public",i=t[De.Symbol.OriginalName],r=`${n}.${i}`;if(!this.cachedTables[r]){for(const o of Object.values(t[De.Symbol.Columns])){const s=`${r}.${o.name}`;this.cache[s]=this.convert(o.name)}this.cachedTables[r]=!0}}clearCache(){this.cache={},this.cachedTables={}}}class gP extends na{static[ie]="PgViewBase"}class of{static[ie]="PgDialect";casing;constructor(t){this.casing=new gQ(t?.casing)}async migrate(t,n,i){const r=typeof i=="string"?"__drizzle_migrations":i.migrationsTable??"__drizzle_migrations",o=typeof i=="string"?"drizzle":i.migrationsSchema??"drizzle",s=Z`
			CREATE TABLE IF NOT EXISTS ${Z.identifier(o)}.${Z.identifier(r)} (
				id SERIAL PRIMARY KEY,
				hash text NOT NULL,
				created_at bigint
			)
		`;await n.execute(Z`CREATE SCHEMA IF NOT EXISTS ${Z.identifier(o)}`),await n.execute(s);const c=(await n.all(Z`select id, hash, created_at from ${Z.identifier(o)}.${Z.identifier(r)} order by created_at desc limit 1`))[0];await n.transaction(async l=>{for await(const u of t)if(!c||Number(c.created_at)<u.folderMillis){for(const p of u.sql)await l.execute(Z.raw(p));await l.execute(Z`insert into ${Z.identifier(o)}.${Z.identifier(r)} ("hash", "created_at") values(${u.hash}, ${u.folderMillis})`)}})}escapeName(t){return`"${t}"`}escapeParam(t){return`$${t+1}`}escapeString(t){return`'${t.replace(/'/g,"''")}'`}buildWithCTE(t){if(!t?.length)return;const n=[Z`with `];for(const[i,r]of t.entries())n.push(Z`${Z.identifier(r._.alias)} as (${r._.sql})`),i<t.length-1&&n.push(Z`, `);return n.push(Z` `),Z.join(n)}buildDeleteQuery({table:t,where:n,returning:i,withList:r}){const o=this.buildWithCTE(r),s=i?Z` returning ${this.buildSelection(i,{isSingleTable:!0})}`:void 0,a=n?Z` where ${n}`:void 0;return Z`${o}delete from ${t}${a}${s}`}buildUpdateSet(t,n){const i=t[De.Symbol.Columns],r=Object.keys(i).filter(s=>n[s]!==void 0||i[s]?.onUpdateFn!==void 0),o=r.length;return Z.join(r.flatMap((s,a)=>{const c=i[s],l=n[s]??Z.param(c.onUpdateFn(),c),u=Z`${Z.identifier(this.casing.getColumnCasing(c))} = ${l}`;return a<o-1?[u,Z.raw(", ")]:[u]}))}buildUpdateQuery({table:t,set:n,where:i,returning:r,withList:o}){const s=this.buildWithCTE(o),a=this.buildUpdateSet(t,n),c=r?Z` returning ${this.buildSelection(r,{isSingleTable:!0})}`:void 0,l=i?Z` where ${i}`:void 0;return Z`${s}update ${t} set ${a}${l}${c}`}buildSelection(t,{isSingleTable:n=!1}={}){const i=t.length,r=t.flatMap(({field:o},s)=>{const a=[];if(me(o,je.Aliased)&&o.isSelectionField)a.push(Z.identifier(o.fieldAlias));else if(me(o,je.Aliased)||me(o,je)){const c=me(o,je.Aliased)?o.sql:o;n?a.push(new je(c.queryChunks.map(l=>me(l,Ye)?Z.identifier(this.casing.getColumnCasing(l)):l))):a.push(c),me(o,je.Aliased)&&a.push(Z` as ${Z.identifier(o.fieldAlias)}`)}else me(o,qn)&&(n?a.push(Z.identifier(this.casing.getColumnCasing(o))):a.push(o));return s<i-1&&a.push(Z`, `),a});return Z.join(r)}buildSelectQuery({withList:t,fields:n,fieldsFlat:i,where:r,having:o,table:s,joins:a,orderBy:c,groupBy:l,limit:u,offset:p,lockingClause:f,distinct:g,setOperators:h}){const d=i??qs(n);for(const z of d)if(me(z.field,qn)&&Na(z.field.table)!==(me(s,bi)?s._.alias:me(s,gP)?s[Kn].name:me(s,je)?void 0:Na(s))&&!(L=>a?.some(({alias:q})=>q===(L[De.Symbol.IsAlias]?Na(L):L[De.Symbol.BaseName])))(z.field.table)){const L=Na(z.field.table);throw new Error(`Your "${z.path.join("->")}" field references a column "${L}"."${z.field.name}", but the table "${L}" is not part of the query! Did you forget to join it?`)}const y=!a||a.length===0,v=this.buildWithCTE(t);let x;g&&(x=g===!0?Z` distinct`:Z` distinct on (${Z.join(g.on,Z`, `)})`);const E=this.buildSelection(d,{isSingleTable:y}),N=(()=>{if(me(s,De)&&s[De.Symbol.OriginalName]!==s[De.Symbol.Name]){let z=Z`${Z.identifier(s[De.Symbol.OriginalName])}`;return s[De.Symbol.Schema]&&(z=Z`${Z.identifier(s[De.Symbol.Schema])}.${z}`),Z`${z} ${Z.identifier(s[De.Symbol.Name])}`}return s})(),C=[];if(a)for(const[z,L]of a.entries()){z===0&&C.push(Z` `);const q=L.table,V=L.lateral?Z` lateral`:void 0;if(me(q,Ho)){const K=q[Ho.Symbol.Name],oe=q[Ho.Symbol.Schema],ne=q[Ho.Symbol.OriginalName],X=K===ne?void 0:L.alias;C.push(Z`${Z.raw(L.joinType)} join${V} ${oe?Z`${Z.identifier(oe)}.`:void 0}${Z.identifier(ne)}${X&&Z` ${Z.identifier(X)}`} on ${L.on}`)}else if(me(q,na)){const K=q[Kn].name,oe=q[Kn].schema,ne=q[Kn].originalName,X=K===ne?void 0:L.alias;C.push(Z`${Z.raw(L.joinType)} join${V} ${oe?Z`${Z.identifier(oe)}.`:void 0}${Z.identifier(ne)}${X&&Z` ${Z.identifier(X)}`} on ${L.on}`)}else C.push(Z`${Z.raw(L.joinType)} join${V} ${q} on ${L.on}`);z<a.length-1&&C.push(Z` `)}const b=Z.join(C),P=r?Z` where ${r}`:void 0,$=o?Z` having ${o}`:void 0;let k;c&&c.length>0&&(k=Z` order by ${Z.join(c,Z`, `)}`);let D;l&&l.length>0&&(D=Z` group by ${Z.join(l,Z`, `)}`);const B=typeof u=="object"||typeof u=="number"&&u>=0?Z` limit ${u}`:void 0,J=p?Z` offset ${p}`:void 0,S=Z.empty();if(f){const z=Z` for ${Z.raw(f.strength)}`;f.config.of&&z.append(Z` of ${Z.join(Array.isArray(f.config.of)?f.config.of:[f.config.of],Z`, `)}`),f.config.noWait?z.append(Z` no wait`):f.config.skipLocked&&z.append(Z` skip locked`),S.append(z)}const T=Z`${v}select${x} ${E} from ${N}${b}${P}${D}${$}${k}${B}${J}${S}`;return h.length>0?this.buildSetOperations(T,h):T}buildSetOperations(t,n){const[i,...r]=n;if(!i)throw new Error("Cannot pass undefined values to any set operator");return r.length===0?this.buildSetOperationQuery({leftSelect:t,setOperator:i}):this.buildSetOperations(this.buildSetOperationQuery({leftSelect:t,setOperator:i}),r)}buildSetOperationQuery({leftSelect:t,setOperator:{type:n,isAll:i,rightSelect:r,limit:o,orderBy:s,offset:a}}){const c=Z`(${t.getSQL()}) `,l=Z`(${r.getSQL()})`;let u;if(s&&s.length>0){const h=[];for(const d of s)if(me(d,Ye))h.push(Z.identifier(d.name));else if(me(d,je)){for(let y=0;y<d.queryChunks.length;y++){const v=d.queryChunks[y];me(v,Ye)&&(d.queryChunks[y]=Z.identifier(v.name))}h.push(Z`${d}`)}else h.push(Z`${d}`);u=Z` order by ${Z.join(h,Z`, `)} `}const p=typeof o=="object"||typeof o=="number"&&o>=0?Z` limit ${o}`:void 0,f=Z.raw(`${n} ${i?"all ":""}`),g=a?Z` offset ${a}`:void 0;return Z`${c}${f}${l}${u}${p}${g}`}buildInsertQuery({table:t,values:n,onConflict:i,returning:r,withList:o}){const s=[],a=t[De.Symbol.Columns],c=Object.entries(a).filter(([h,d])=>!d.shouldDisableInsert()),l=c.map(([,h])=>Z.identifier(this.casing.getColumnCasing(h)));for(const[h,d]of n.entries()){const y=[];for(const[v,x]of c){const E=d[v];if(E===void 0||me(E,is)&&E.value===void 0)if(x.defaultFn!==void 0){const N=x.defaultFn(),C=me(N,je)?N:Z.param(N,x);y.push(C)}else if(!x.default&&x.onUpdateFn!==void 0){const N=x.onUpdateFn(),C=me(N,je)?N:Z.param(N,x);y.push(C)}else y.push(Z`default`);else y.push(E)}s.push(y),h<n.length-1&&s.push(Z`, `)}const u=this.buildWithCTE(o),p=Z.join(s),f=r?Z` returning ${this.buildSelection(r,{isSingleTable:!0})}`:void 0,g=i?Z` on conflict ${i}`:void 0;return Z`${u}insert into ${t} ${l} values ${p}${g}${f}`}buildRefreshMaterializedViewQuery({view:t,concurrently:n,withNoData:i}){const r=n?Z` concurrently`:void 0,o=i?Z` with no data`:void 0;return Z`refresh materialized view${r} ${t}${o}`}prepareTyping(t){return me(t,gR)||me(t,mR)?"json":me(t,yR)?"decimal":me(t,vR)?"time":me(t,bR)||me(t,_R)?"timestamp":me(t,pR)||me(t,hR)?"date":me(t,SR)?"uuid":"none"}sqlToQuery(t,n){return t.toQuery({casing:this.casing,escapeName:this.escapeName,escapeParam:this.escapeParam,escapeString:this.escapeString,prepareTyping:this.prepareTyping,invokeSource:n})}buildRelationalQueryWithoutPK({fullSchema:t,schema:n,tableNamesMap:i,table:r,tableConfig:o,queryConfig:s,tableAlias:a,nestedQueryRelation:c,joinOn:l}){let u=[],p,f,g=[],h;const d=[];if(s===!0)u=Object.entries(o.columns).map(([x,E])=>({dbKey:E.name,tsKey:x,field:to(E,a),relationTableTsKey:void 0,isJson:!1,selection:[]}));else{const v=Object.fromEntries(Object.entries(o.columns).map(([P,$])=>[P,to($,a)]));if(s.where){const P=typeof s.where=="function"?s.where(v,Q9()):s.where;h=P&&Kf(P,a)}const x=[];let E=[];if(s.columns){let P=!1;for(const[$,k]of Object.entries(s.columns))k!==void 0&&$ in o.columns&&(!P&&k===!0&&(P=!0),E.push($));E.length>0&&(E=P?E.filter($=>s.columns?.[$]===!0):Object.keys(o.columns).filter($=>!E.includes($)))}else E=Object.keys(o.columns);for(const P of E){const $=o.columns[P];x.push({tsKey:P,value:$})}let N=[];s.with&&(N=Object.entries(s.with).filter(P=>!!P[1]).map(([P,$])=>({tsKey:P,queryConfig:$,relation:o.relations[P]})));let C;if(s.extras){C=typeof s.extras=="function"?s.extras(v,{sql:Z}):s.extras;for(const[P,$]of Object.entries(C))x.push({tsKey:P,value:lR($,a)})}for(const{tsKey:P,value:$}of x)u.push({dbKey:me($,je.Aliased)?$.fieldAlias:o.columns[P].name,tsKey:P,field:me($,qn)?to($,a):$,relationTableTsKey:void 0,isJson:!1,selection:[]});let b=typeof s.orderBy=="function"?s.orderBy(v,Y9()):s.orderBy??[];Array.isArray(b)||(b=[b]),g=b.map(P=>me(P,qn)?to(P,a):Kf(P,a)),p=s.limit,f=s.offset;for(const{tsKey:P,queryConfig:$,relation:k}of N){const D=nZ(n,i,k),B=Dl(k.referencedTable),J=i[B],S=`${a}_${P}`,T=Jn(...D.fields.map((q,V)=>Pe(to(D.references[V],S),to(q,a)))),z=this.buildRelationalQueryWithoutPK({fullSchema:t,schema:n,tableNamesMap:i,table:t[J],tableConfig:n[J],queryConfig:me(k,Hs)?$===!0?{limit:1}:{...$,limit:1}:$,tableAlias:S,joinOn:T,nestedQueryRelation:k}),L=Z`${Z.identifier(S)}.${Z.identifier("data")}`.as(P);d.push({on:Z`true`,table:new bi(z.sql,{},S),alias:S,joinType:"left",lateral:!0}),u.push({dbKey:P,tsKey:P,field:L,relationTableTsKey:J,isJson:!0,selection:z.selection})}}if(u.length===0)throw new qJ({message:`No fields selected for table "${o.tsName}" ("${a}")`});let y;if(h=Jn(l,h),c){let v=Z`json_build_array(${Z.join(u.map(({field:N,tsKey:C,isJson:b})=>b?Z`${Z.identifier(`${a}_${C}`)}.${Z.identifier("data")}`:me(N,je.Aliased)?N.sql:N),Z`, `)})`;me(c,qh)&&(v=Z`coalesce(json_agg(${v}${g.length>0?Z` order by ${Z.join(g,Z`, `)}`:void 0}), '[]'::json)`);const x=[{dbKey:"data",tsKey:"data",field:v.as("data"),isJson:!0,relationTableTsKey:o.tsName,selection:u}];p!==void 0||f!==void 0||g.length>0?(y=this.buildSelectQuery({table:bg(r,a),fields:{},fieldsFlat:[{path:[],field:Z.raw("*")}],where:h,limit:p,offset:f,orderBy:g,setOperators:[]}),h=void 0,p=void 0,f=void 0,g=[]):y=bg(r,a),y=this.buildSelectQuery({table:me(y,Ho)?y:new bi(y,{},a),fields:{},fieldsFlat:x.map(({field:N})=>({path:[],field:me(N,qn)?to(N,a):N})),joins:d,where:h,limit:p,offset:f,orderBy:g,setOperators:[]})}else y=this.buildSelectQuery({table:bg(r,a),fields:{},fieldsFlat:u.map(({field:v})=>({path:[],field:me(v,qn)?to(v,a):v})),joins:d,where:h,limit:p,offset:f,orderBy:g,setOperators:[]});return{tableTsKey:o.tsName,sql:y,selection:u}}}class gi{static[ie]="SelectionProxyHandler";config;constructor(t){this.config={...t}}get(t,n){if(n==="_")return{...t._,selectedFields:new Proxy(t._.selectedFields,this)};if(n===Kn)return{...t[Kn],selectedFields:new Proxy(t[Kn].selectedFields,this)};if(typeof n=="symbol")return t[n];const r=(me(t,bi)?t._.selectedFields:me(t,na)?t[Kn].selectedFields:t)[n];if(me(r,je.Aliased)){if(this.config.sqlAliasedBehavior==="sql"&&!r.isSelectionField)return r.sql;const o=r.clone();return o.isSelectionField=!0,o}if(me(r,je)){if(this.config.sqlBehavior==="sql")return r;throw new Error(`You tried to reference "${n}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return me(r,qn)?this.config.alias?new Proxy(r,new Hf(new Proxy(r.table,new o0(this.config.alias,this.config.replaceOriginalName??!1)))):r:typeof r!="object"||r===null?r:new Proxy(r,new gi(this.config))}}class yQ{static[ie]="TypedQueryBuilder";getSelectedFields(){return this._.selectedFields}}class ti{static[ie]="PgSelectBuilder";fields;session;dialect;withList=[];distinct;constructor(t){this.fields=t.fields,this.session=t.session,this.dialect=t.dialect,t.withList&&(this.withList=t.withList),this.distinct=t.distinct}from(t){const n=!!this.fields;let i;return this.fields?i=this.fields:me(t,bi)?i=Object.fromEntries(Object.keys(t._.selectedFields).map(r=>[r,t[r]])):me(t,gP)?i=t[Kn].selectedFields:me(t,je)?i={}:i=sG(t),new yP({table:t,fields:i,isPartialSelect:n,session:this.session,dialect:this.dialect,withList:this.withList,distinct:this.distinct})}}class wQ extends yQ{static[ie]="PgSelectQueryBuilder";_;config;joinsNotNullableMap;tableName;isPartialSelect;session;dialect;constructor({table:t,fields:n,isPartialSelect:i,session:r,dialect:o,withList:s,distinct:a}){super(),this.config={withList:s,table:t,fields:{...n},distinct:a,setOperators:[]},this.isPartialSelect=i,this.session=r,this.dialect=o,this._={selectedFields:n},this.tableName=Gx(t),this.joinsNotNullableMap=typeof this.tableName=="string"?{[this.tableName]:!0}:{}}createJoin(t){return(n,i)=>{const r=this.tableName,o=Gx(n);if(typeof o=="string"&&this.config.joins?.some(s=>s.alias===o))throw new Error(`Alias "${o}" is already used in this query`);if(!this.isPartialSelect&&(Object.keys(this.joinsNotNullableMap).length===1&&typeof r=="string"&&(this.config.fields={[r]:this.config.fields}),typeof o=="string"&&!me(n,je))){const s=me(n,bi)?n._.selectedFields:me(n,na)?n[Kn].selectedFields:n[De.Symbol.Columns];this.config.fields[o]=s}if(typeof i=="function"&&(i=i(new Proxy(this.config.fields,new gi({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.joins||(this.config.joins=[]),this.config.joins.push({on:i,table:n,joinType:t,alias:o}),typeof o=="string")switch(t){case"left":{this.joinsNotNullableMap[o]=!1;break}case"right":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[o]=!0;break}case"inner":{this.joinsNotNullableMap[o]=!0;break}case"full":{this.joinsNotNullableMap=Object.fromEntries(Object.entries(this.joinsNotNullableMap).map(([s])=>[s,!1])),this.joinsNotNullableMap[o]=!1;break}}return this}}leftJoin=this.createJoin("left");rightJoin=this.createJoin("right");innerJoin=this.createJoin("inner");fullJoin=this.createJoin("full");createSetOperator(t,n){return i=>{const r=typeof i=="function"?i(vQ()):i;if(!dR(this.getSelectedFields(),r.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return this.config.setOperators.push({type:t,isAll:n,rightSelect:r}),this}}union=this.createSetOperator("union",!1);unionAll=this.createSetOperator("union",!0);intersect=this.createSetOperator("intersect",!1);intersectAll=this.createSetOperator("intersect",!0);except=this.createSetOperator("except",!1);exceptAll=this.createSetOperator("except",!0);addSetOperators(t){return this.config.setOperators.push(...t),this}where(t){return typeof t=="function"&&(t=t(new Proxy(this.config.fields,new gi({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.where=t,this}having(t){return typeof t=="function"&&(t=t(new Proxy(this.config.fields,new gi({sqlAliasedBehavior:"sql",sqlBehavior:"sql"})))),this.config.having=t,this}groupBy(...t){if(typeof t[0]=="function"){const n=t[0](new Proxy(this.config.fields,new gi({sqlAliasedBehavior:"alias",sqlBehavior:"sql"})));this.config.groupBy=Array.isArray(n)?n:[n]}else this.config.groupBy=t;return this}orderBy(...t){if(typeof t[0]=="function"){const n=t[0](new Proxy(this.config.fields,new gi({sqlAliasedBehavior:"alias",sqlBehavior:"sql"}))),i=Array.isArray(n)?n:[n];this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=i:this.config.orderBy=i}else{const n=t;this.config.setOperators.length>0?this.config.setOperators.at(-1).orderBy=n:this.config.orderBy=n}return this}limit(t){return this.config.setOperators.length>0?this.config.setOperators.at(-1).limit=t:this.config.limit=t,this}offset(t){return this.config.setOperators.length>0?this.config.setOperators.at(-1).offset=t:this.config.offset=t,this}for(t,n={}){return this.config.lockingClause={strength:t,config:n},this}getSQL(){return this.dialect.buildSelectQuery(this.config)}toSQL(){const{typings:t,...n}=this.dialect.sqlToQuery(this.getSQL());return n}as(t){return new Proxy(new bi(this.getSQL(),this.config.fields,t),new gi({alias:t,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}getSelectedFields(){return new Proxy(this.config.fields,new gi({alias:this.tableName,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}$dynamic(){return this}}class yP extends wQ{static[ie]="PgSelect";_prepare(t){const{session:n,config:i,dialect:r,joinsNotNullableMap:o}=this;if(!n)throw new Error("Cannot execute a query on a query builder. Please use a database instance instead.");return Wr.startActiveSpan("drizzle.prepareQuery",()=>{const s=qs(i.fields),a=n.prepareQuery(r.sqlToQuery(this.getSQL()),s,t,!0);return a.joinsNotNullableMap=o,a})}prepare(t){return this._prepare(t)}execute=t=>Wr.startActiveSpan("drizzle.operation",()=>this._prepare().execute(t))}oG(yP,[ra]);function Tc(e,t){return(n,i,...r)=>{const o=[i,...r].map(s=>({type:e,isAll:t,rightSelect:s}));for(const s of o)if(!dR(n.getSelectedFields(),s.rightSelect.getSelectedFields()))throw new Error("Set operator error (union / intersect / except): selected fields are not the same or are in a different order");return n.addSetOperators(o)}}const vQ=()=>({union:bQ,unionAll:_Q,intersect:SQ,intersectAll:xQ,except:kQ,exceptAll:EQ}),bQ=Tc("union",!1),_Q=Tc("union",!0),SQ=Tc("intersect",!1),xQ=Tc("intersect",!0),kQ=Tc("except",!1),EQ=Tc("except",!0);class AQ{static[ie]="PgQueryBuilder";dialect;dialectConfig;constructor(t){this.dialect=me(t,of)?t:void 0,this.dialectConfig=me(t,of)?void 0:t}$with(t){const n=this;return{as(i){return typeof i=="function"&&(i=i(n)),new Proxy(new oR(i.getSQL(),i.getSelectedFields(),t,!0),new gi({alias:t,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}}}with(...t){const n=this;function i(s){return new ti({fields:s??void 0,session:void 0,dialect:n.getDialect(),withList:t})}function r(s){return new ti({fields:s??void 0,session:void 0,dialect:n.getDialect(),distinct:!0})}function o(s,a){return new ti({fields:a??void 0,session:void 0,dialect:n.getDialect(),distinct:{on:s}})}return{select:i,selectDistinct:r,selectDistinctOn:o}}select(t){return new ti({fields:t??void 0,session:void 0,dialect:this.getDialect()})}selectDistinct(t){return new ti({fields:t??void 0,session:void 0,dialect:this.getDialect(),distinct:!0})}selectDistinctOn(t,n){return new ti({fields:n??void 0,session:void 0,dialect:this.getDialect(),distinct:{on:t}})}getDialect(){return this.dialect||(this.dialect=new of(this.dialectConfig)),this.dialect}}class TQ extends ra{constructor(t,n,i){super(),this.session=n,this.dialect=i,this.config={view:t}}static[ie]="PgRefreshMaterializedView";config;concurrently(){if(this.config.withNoData!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.concurrently=!0,this}withNoData(){if(this.config.concurrently!==void 0)throw new Error("Cannot use concurrently and withNoData together");return this.config.withNoData=!0,this}getSQL(){return this.dialect.buildRefreshMaterializedViewQuery(this.config)}toSQL(){const{typings:t,...n}=this.dialect.sqlToQuery(this.getSQL());return n}_prepare(t){return Wr.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),void 0,t,!0))}prepare(t){return this._prepare(t)}execute=t=>Wr.startActiveSpan("drizzle.operation",()=>this._prepare().execute(t))}class ok{constructor(t,n,i,r){this.table=t,this.session=n,this.dialect=i,this.withList=r}static[ie]="PgUpdateBuilder";set(t){return new IQ(this.table,fR(this.table,t),this.session,this.dialect,this.withList)}}class IQ extends ra{constructor(t,n,i,r,o){super(),this.session=i,this.dialect=r,this.config={set:n,table:t,withList:o}}static[ie]="PgUpdate";config;where(t){return this.config.where=t,this}returning(t=this.config.table[De.Symbol.Columns]){return this.config.returning=qs(t),this}getSQL(){return this.dialect.buildUpdateQuery(this.config)}toSQL(){const{typings:t,...n}=this.dialect.sqlToQuery(this.getSQL());return n}_prepare(t){return this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,t,!0)}prepare(t){return this._prepare(t)}execute=t=>this._prepare().execute(t);$dynamic(){return this}}class Gf extends je{constructor(t){super(Gf.buildEmbeddedCount(t.source,t.filters).queryChunks),this.params=t,this.mapWith(Number),this.session=t.session,this.sql=Gf.buildCount(t.source,t.filters)}sql;static[ie]="PgCountBuilder";[Symbol.toStringTag]="PgCountBuilder";session;static buildEmbeddedCount(t,n){return Z`(select count(*) from ${t}${Z.raw(" where ").if(n)}${n})`}static buildCount(t,n){return Z`select count(*) as count from ${t}${Z.raw(" where ").if(n)}${n};`}then(t,n){return Promise.resolve(this.session.count(this.sql)).then(t,n)}catch(t){return this.then(void 0,t)}finally(t){return this.then(n=>(t?.(),n),n=>{throw t?.(),n})}}class NQ{constructor(t,n,i,r,o,s,a){this.fullSchema=t,this.schema=n,this.tableNamesMap=i,this.table=r,this.tableConfig=o,this.dialect=s,this.session=a}static[ie]="PgRelationalQueryBuilder";findMany(t){return new sk(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,t||{},"many")}findFirst(t){return new sk(this.fullSchema,this.schema,this.tableNamesMap,this.table,this.tableConfig,this.dialect,this.session,t?{...t,limit:1}:{limit:1},"first")}}class sk extends ra{constructor(t,n,i,r,o,s,a,c,l){super(),this.fullSchema=t,this.schema=n,this.tableNamesMap=i,this.table=r,this.tableConfig=o,this.dialect=s,this.session=a,this.config=c,this.mode=l}static[ie]="PgRelationalQuery";_prepare(t){return Wr.startActiveSpan("drizzle.prepareQuery",()=>{const{query:n,builtQuery:i}=this._toSQL();return this.session.prepareQuery(i,void 0,t,!0,(r,o)=>{const s=r.map(a=>Iy(this.schema,this.tableConfig,a,n.selection,o));return this.mode==="first"?s[0]:s})})}prepare(t){return this._prepare(t)}_getQuery(){return this.dialect.buildRelationalQueryWithoutPK({fullSchema:this.fullSchema,schema:this.schema,tableNamesMap:this.tableNamesMap,table:this.table,tableConfig:this.tableConfig,queryConfig:this.config,tableAlias:this.tableConfig.tsName})}getSQL(){return this._getQuery().sql}_toSQL(){const t=this._getQuery(),n=this.dialect.sqlToQuery(t.sql);return{query:t,builtQuery:n}}toSQL(){return this._toSQL().builtQuery}execute(){return Wr.startActiveSpan("drizzle.operation",()=>this._prepare().execute())}}class $Q extends ra{constructor(t,n,i,r){super(),this.execute=t,this.sql=n,this.query=i,this.mapBatchResult=r}static[ie]="PgRaw";getSQL(){return this.sql}getQuery(){return this.query}mapResult(t,n){return n?this.mapBatchResult(t):t}_prepare(){return this}isResponseInArrayMode(){return!1}}class CQ{constructor(t,n,i){if(this.dialect=t,this.session=n,this._=i?{schema:i.schema,fullSchema:i.fullSchema,tableNamesMap:i.tableNamesMap,session:n}:{schema:void 0,fullSchema:{},tableNamesMap:{},session:n},this.query={},this._.schema)for(const[r,o]of Object.entries(this._.schema))this.query[r]=new NQ(i.fullSchema,this._.schema,this._.tableNamesMap,i.fullSchema[r],o,t,n)}static[ie]="PgDatabase";query;$with(t){const n=this;return{as(i){return typeof i=="function"&&(i=i(new AQ(n.dialect))),new Proxy(new oR(i.getSQL(),i.getSelectedFields(),t,!0),new gi({alias:t,sqlAliasedBehavior:"alias",sqlBehavior:"error"}))}}}$count(t,n){return new Gf({source:t,filters:n,session:this.session})}with(...t){const n=this;function i(l){return new ti({fields:l??void 0,session:n.session,dialect:n.dialect,withList:t})}function r(l){return new ti({fields:l??void 0,session:n.session,dialect:n.dialect,withList:t,distinct:!0})}function o(l,u){return new ti({fields:u??void 0,session:n.session,dialect:n.dialect,withList:t,distinct:{on:l}})}function s(l){return new ok(l,n.session,n.dialect,t)}function a(l){return new ik(l,n.session,n.dialect,t)}function c(l){return new rk(l,n.session,n.dialect,t)}return{select:i,selectDistinct:r,selectDistinctOn:o,update:s,insert:a,delete:c}}select(t){return new ti({fields:t??void 0,session:this.session,dialect:this.dialect})}selectDistinct(t){return new ti({fields:t??void 0,session:this.session,dialect:this.dialect,distinct:!0})}selectDistinctOn(t,n){return new ti({fields:n??void 0,session:this.session,dialect:this.dialect,distinct:{on:t}})}update(t){return new ok(t,this.session,this.dialect)}insert(t){return new ik(t,this.session,this.dialect)}delete(t){return new rk(t,this.session,this.dialect)}refreshMaterializedView(t){return new TQ(t,this.session,this.dialect)}execute(t){const n=typeof t=="string"?Z.raw(t):t.getSQL(),i=this.dialect.sqlToQuery(n),r=this.session.prepareQuery(i,void 0,void 0,!1);return new $Q(()=>r.execute(),n,i,o=>r.mapResult(o,!0))}transaction(t,n){return this.session.transaction(t,n)}}class OQ{constructor(t,n){this.name=t,this.value=n}static[ie]="PgCheckBuilder";brand;build(t){return new RQ(t,this)}}class RQ{constructor(t,n){this.table=t,this.name=n.name,this.value=n.value}static[ie]="PgCheck";name;value}function gs(e,t){return new OQ(e,t)}class wP{constructor(t,n){this.unique=t,this.name=n}static[ie]="PgIndexBuilderOn";on(...t){return new xg(t.map(n=>{if(me(n,je))return n;n=n;const i=new gg(n.name,!!n.keyAsName,n.columnType,n.indexConfig);return n.indexConfig=JSON.parse(JSON.stringify(n.defaultConfig)),i}),this.unique,!1,this.name)}onOnly(...t){return new xg(t.map(n=>{if(me(n,je))return n;n=n;const i=new gg(n.name,!!n.keyAsName,n.columnType,n.indexConfig);return n.indexConfig=n.defaultConfig,i}),this.unique,!0,this.name)}using(t,...n){return new xg(n.map(i=>{if(me(i,je))return i;i=i;const r=new gg(i.name,!!i.keyAsName,i.columnType,i.indexConfig);return i.indexConfig=JSON.parse(JSON.stringify(i.defaultConfig)),r}),this.unique,!0,this.name,t)}}class xg{static[ie]="PgIndexBuilder";config;constructor(t,n,i,r,o="btree"){this.config={name:r,columns:t,unique:n,only:i,method:o}}concurrently(){return this.config.concurrently=!0,this}with(t){return this.config.with=t,this}where(t){return this.config.where=t,this}build(t){return new PQ(this.config,t)}}class PQ{static[ie]="PgIndex";config;constructor(t,n){this.config={...t,table:n}}}function ko(e){return new wP(!1,e)}function DQ(e){return new wP(!0,e)}class UQ{constructor(t){this.query=t}getQuery(){return this.query}mapResult(t,n){return t}static[ie]="PgPreparedQuery";joinsNotNullableMap}class LQ{constructor(t){this.dialect=t}static[ie]="PgSession";execute(t){return Wr.startActiveSpan("drizzle.operation",()=>Wr.startActiveSpan("drizzle.prepareQuery",()=>this.prepareQuery(this.dialect.sqlToQuery(t),void 0,void 0,!1)).execute())}all(t){return this.prepareQuery(this.dialect.sqlToQuery(t),void 0,void 0,!1).all()}async count(t){const n=await this.execute(t);return Number(n[0].count)}}const ak={arrayMode:!1,fullResults:!0},vP={arrayMode:!0,fullResults:!0};class MQ extends UQ{constructor(t,n,i,r,o,s){super(n),this.client=t,this.logger=i,this.fields=r,this._isResponseInArrayMode=o,this.customResultMapper=s}static[ie]="NeonHttpPreparedQuery";async execute(t={}){const n=vg(this.query.params,t);this.logger.logQuery(this.query.sql,n);const{fields:i,client:r,query:o,customResultMapper:s}=this;if(!i&&!s)return r(o.sql,n,ak);const a=await r(o.sql,n,vP);return this.mapResult(a)}mapResult(t){if(!this.fields&&!this.customResultMapper)return t;const n=t.rows;return this.customResultMapper?this.customResultMapper(n):n.map(i=>iG(this.fields,i,this.joinsNotNullableMap))}all(t={}){const n=vg(this.query.params,t);return this.logger.logQuery(this.query.sql,n),this.client(this.query.sql,n,ak).then(i=>i.rows)}values(t={}){const n=vg(this.query.params,t);return this.logger.logQuery(this.query.sql,n),this.client(this.query.sql,n,{arrayMode:!0,fullResults:!0}).then(i=>i.rows)}isResponseInArrayMode(){return this._isResponseInArrayMode}}class jQ extends LQ{constructor(t,n,i,r={}){super(n),this.client=t,this.schema=i,this.options=r,this.logger=r.logger??new rG}static[ie]="NeonHttpSession";logger;prepareQuery(t,n,i,r,o){return new MQ(this.client,t,this.logger,n,r,o)}async batch(t){const n=[],i=[];for(const o of t){const s=o._prepare(),a=s.getQuery();n.push(s),i.push(this.client(a.sql,a.params,{fullResults:!0,arrayMode:s.isResponseInArrayMode()}))}return(await this.client.transaction(i,vP)).map((o,s)=>n[s].mapResult(o,!0))}async query(t,n){return this.logger.logQuery(t,n),await this.client(t,n,{arrayMode:!0,fullResults:!0})}async queryObjects(t,n){return this.client(t,n,{arrayMode:!1,fullResults:!0})}async count(t){const n=await this.execute(t);return Number(n.rows[0].count)}async transaction(t,n={}){throw new Error("No transactions support in neon-http driver")}}class zQ{constructor(t,n,i={}){this.client=t,this.dialect=n,this.options=i,this.initMappers()}static[ie]="NeonDriver";createSession(t){return new jQ(this.client,this.dialect,t,{logger:this.options.logger})}initMappers(){Uo.setTypeParser(Uo.builtins.TIMESTAMPTZ,t=>t),Uo.setTypeParser(Uo.builtins.TIMESTAMP,t=>t),Uo.setTypeParser(Uo.builtins.DATE,t=>t),Uo.setTypeParser(Uo.builtins.INTERVAL,t=>t)}}class BQ extends CQ{static[ie]="NeonHttpDatabase";async batch(t){return this.session.batch(t)}}function FQ(e,t={}){const n=new of({casing:t.casing});let i;t.logger===!0?i=new nG:t.logger!==!1&&(i=t.logger);let r;if(t.schema){const c=X9(t.schema,rZ);r={fullSchema:t.schema,schema:c.tables,tableNamesMap:c.tableNamesMap}}const s=new zQ(e,n,{logger:i}).createSession(r),a=new BQ(n,s,r);return a.$client=e,a}const WQ=w0(Pr.DATABASE_URL),at=FQ(WQ),bP="aes-256-gcm";function _P(){const e=Pr.MCP_ENCRYPTION_KEY;if(!e)throw new Error("MCP_ENCRYPTION_KEY is not configured");return Buffer.from(e,"base64")}function SP(e){const t=_P(),n=OD(16),i=RD(bP,t,n),r=Buffer.concat([i.update(e,"utf8"),i.final()]),o=i.getAuthTag();return`${n.toString("base64")}:${o.toString("base64")}:${r.toString("base64")}`}function xP(e){const t=_P(),[n,i,r]=e.split(":");if(!(n&&i&&r))throw new Error("Invalid encrypted text format");const o=CD(bP,t,Buffer.from(n,"base64"));return o.setAuthTag(Buffer.from(i,"base64")),o.update(r,"base64","utf8")+o.final("utf8")}const Oy=s0({dataType:()=>"text",toDriver:e=>SP(e),fromDriver:e=>xP(e)}),ck=()=>s0({dataType:()=>"text",toDriver:e=>SP(JSON.stringify(e)),fromDriver:e=>JSON.parse(xP(e))}),Bie=mr("UserCredit",{userId:ot("userId").primaryKey().notNull().references(()=>qi.id,{onDelete:"cascade"}),credits:a0("credits").notNull().default(50)}),bl=mr("UserModelPreference",{userId:ot("userId").notNull().references(()=>qi.id,{onDelete:"cascade"}),modelId:Dt("modelId",{length:256}).notNull(),enabled:ia("enabled").notNull(),createdAt:Mt("createdAt").notNull().defaultNow(),updatedAt:Mt("updatedAt").notNull().defaultNow().$onUpdate(()=>new Date)},e=>({pk:Vh({columns:[e.userId,e.modelId]}),UserModelPreference_user_id_idx:ko("UserModelPreference_user_id_idx").on(e.userId)})),_i=mr("Project",{id:Ln("id").primaryKey().notNull().defaultRandom(),createdAt:Mt("createdAt").notNull().defaultNow(),updatedAt:Mt("updatedAt").notNull().defaultNow().$onUpdate(()=>new Date),userId:ot("userId").notNull().references(()=>qi.id,{onDelete:"cascade"}),name:ot("name").notNull(),instructions:ot("instructions").notNull().default(""),icon:Dt("icon",{length:64}).notNull().default("folder"),iconColor:Dt("iconColor",{length:32}).notNull().default("gray")},e=>({Project_user_id_idx:ko("Project_user_id_idx").on(e.userId)})),ht=mr("Chat",{id:Ln("id").primaryKey().notNull().defaultRandom(),createdAt:Mt("createdAt").notNull(),updatedAt:Mt("updatedAt").notNull().defaultNow().$onUpdate(()=>new Date),title:ot("title").notNull(),userId:ot("userId").notNull().references(()=>qi.id),visibility:Dt("visibility",{enum:["public","private"]}).notNull().default("private"),isPinned:ia("isPinned").notNull().default(!1),projectId:Ln("projectId").references(()=>_i.id,{onDelete:"set null"})}),mt=mr("Message",{id:Ln("id").primaryKey().notNull().defaultRandom(),chatId:Ln("chatId").notNull().references(()=>ht.id,{onDelete:"cascade"}),parentMessageId:Ln("parentMessageId"),role:Dt("role").notNull(),attachments:Jo("attachments").notNull(),createdAt:Mt("createdAt").notNull(),annotations:Jo("annotations"),selectedModel:Dt("selectedModel",{length:256}).default(""),selectedTool:Dt("selectedTool",{length:256}).default(""),lastContext:Jo("lastContext"),activeStreamId:Dt("activeStreamId",{length:64}),canceledAt:Mt("canceledAt")}),Un=mr("Part",{id:Ln("id").primaryKey().notNull().defaultRandom(),messageId:Ln("messageId").notNull().references(()=>mt.id,{onDelete:"cascade"}),createdAt:Mt("createdAt").notNull().defaultNow(),order:a0("order").notNull().default(0),type:Dt("type").notNull(),text_text:ot("text_text"),reasoning_text:ot("reasoning_text"),file_mediaType:Dt("file_mediaType"),file_filename:Dt("file_filename"),file_url:Dt("file_url"),source_url_sourceId:Dt("source_url_sourceId"),source_url_url:Dt("source_url_url"),source_url_title:Dt("source_url_title"),source_document_sourceId:Dt("source_document_sourceId"),source_document_mediaType:Dt("source_document_mediaType"),source_document_title:Dt("source_document_title"),source_document_filename:Dt("source_document_filename"),tool_name:Dt("tool_name"),tool_toolCallId:Dt("tool_toolCallId"),tool_state:Dt("tool_state"),tool_input:Jo("tool_input"),tool_output:Jo("tool_output"),tool_errorText:Dt("tool_errorText"),data_type:Dt("data_type"),data_blob:Jo("data_blob"),providerMetadata:Jo("providerMetadata")},e=>({Part_message_id_idx:ko("Part_message_id_idx").on(e.messageId),Part_message_id_order_idx:ko("Part_message_id_order_idx").on(e.messageId,e.order),text_chk:gs("Part_text_required_if_type_text",Z`CASE WHEN ${e.type} = 'text' THEN ${e.text_text} IS NOT NULL ELSE TRUE END`),reasoning_chk:gs("Part_reasoning_required_if_type_reasoning",Z`CASE WHEN ${e.type} = 'reasoning' THEN ${e.reasoning_text} IS NOT NULL ELSE TRUE END`),file_chk:gs("Part_file_required_if_type_file",Z`CASE WHEN ${e.type} = 'file' THEN ${e.file_mediaType} IS NOT NULL AND ${e.file_url} IS NOT NULL ELSE TRUE END`),source_url_chk:gs("Part_source_url_required_if_type_source_url",Z`CASE WHEN ${e.type} = 'source-url' THEN ${e.source_url_sourceId} IS NOT NULL AND ${e.source_url_url} IS NOT NULL ELSE TRUE END`),source_document_chk:gs("Part_source_document_required_if_type_source_document",Z`CASE WHEN ${e.type} = 'source-document' THEN ${e.source_document_sourceId} IS NOT NULL AND ${e.source_document_mediaType} IS NOT NULL AND ${e.source_document_title} IS NOT NULL ELSE TRUE END`),tool_chk:gs("Part_tool_required_if_type_tool",Z`CASE WHEN ${e.type} LIKE 'tool-%' THEN ${e.tool_toolCallId} IS NOT NULL AND ${e.tool_state} IS NOT NULL ELSE TRUE END`),data_chk:gs("Part_data_required_if_type_data",Z`CASE WHEN ${e.type} LIKE 'data-%' THEN ${e.data_type} IS NOT NULL ELSE TRUE END`)})),io=mr("Vote",{chatId:Ln("chatId").notNull().references(()=>ht.id,{onDelete:"cascade"}),messageId:Ln("messageId").notNull().references(()=>mt.id,{onDelete:"cascade"}),isUpvoted:ia("isUpvoted").notNull()},e=>({pk:Vh({columns:[e.chatId,e.messageId]})})),bt=mr("Document",{id:Ln("id").notNull().defaultRandom(),createdAt:Mt("createdAt").notNull(),title:ot("title").notNull(),content:ot("content"),kind:Dt("kind",{enum:["text","code","sheet"]}).notNull().default("text"),userId:ot("userId").notNull().references(()=>qi.id),messageId:Ln("messageId").notNull().references(()=>mt.id,{onDelete:"cascade"})},e=>({pk:Vh({columns:[e.id,e.createdAt]}),document_message_id_idx:ko("Document_message_id_idx").on(e.messageId)}));mr("Suggestion",{id:Ln("id").notNull().defaultRandom(),documentId:Ln("documentId").notNull(),documentCreatedAt:Mt("documentCreatedAt").notNull(),originalText:ot("originalText").notNull(),suggestedText:ot("suggestedText").notNull(),description:ot("description"),isResolved:ia("isResolved").notNull().default(!1),userId:ot("userId").notNull().references(()=>qi.id),createdAt:Mt("createdAt").notNull()},e=>({pk:Vh({columns:[e.id]}),documentRef:DJ({columns:[e.documentId,e.documentCreatedAt],foreignColumns:[bt.id,bt.createdAt]})}));const qi=mr("user",{id:ot("id").primaryKey(),name:ot("name").notNull(),email:ot("email").notNull().unique(),emailVerified:ia("email_verified").default(!1).notNull(),image:ot("image"),createdAt:Mt("created_at").defaultNow().notNull(),updatedAt:Mt("updated_at").defaultNow().$onUpdate(()=>new Date).notNull()}),VQ=mr("session",{id:ot("id").primaryKey(),expiresAt:Mt("expires_at").notNull(),token:ot("token").notNull().unique(),createdAt:Mt("created_at").defaultNow().notNull(),updatedAt:Mt("updated_at").$onUpdate(()=>new Date).notNull(),ipAddress:ot("ip_address"),userAgent:ot("user_agent"),userId:ot("user_id").notNull().references(()=>qi.id,{onDelete:"cascade"})}),qQ=mr("account",{id:ot("id").primaryKey(),accountId:ot("account_id").notNull(),providerId:ot("provider_id").notNull(),userId:ot("user_id").notNull().references(()=>qi.id,{onDelete:"cascade"}),accessToken:ot("access_token"),refreshToken:ot("refresh_token"),idToken:ot("id_token"),accessTokenExpiresAt:Mt("access_token_expires_at"),refreshTokenExpiresAt:Mt("refresh_token_expires_at"),scope:ot("scope"),password:ot("password"),createdAt:Mt("created_at").defaultNow().notNull(),updatedAt:Mt("updated_at").$onUpdate(()=>new Date).notNull()}),HQ=mr("verification",{id:ot("id").primaryKey(),identifier:ot("identifier").notNull(),value:ot("value").notNull(),expiresAt:Mt("expires_at").notNull(),createdAt:Mt("created_at").defaultNow().notNull(),updatedAt:Mt("updated_at").defaultNow().$onUpdate(()=>new Date).notNull()}),KQ=mr("McpConnector",{id:Ln("id").primaryKey().notNull().defaultRandom(),userId:ot("userId").references(()=>qi.id,{onDelete:"cascade"}),name:Dt("name",{length:256}).notNull(),nameId:Dt("nameId",{length:256}).notNull(),url:Oy("url").notNull(),type:Dt("type",{enum:["http","sse"]}).notNull().default("http"),oauthClientId:ot("oauthClientId"),oauthClientSecret:Oy("oauthClientSecret"),enabled:ia("enabled").notNull().default(!0),createdAt:Mt("createdAt").notNull().defaultNow(),updatedAt:Mt("updatedAt").notNull().defaultNow().$onUpdate(()=>new Date)},e=>({McpConnector_user_id_idx:ko("McpConnector_user_id_idx").on(e.userId),McpConnector_user_name_id_idx:ko("McpConnector_user_name_id_idx").on(e.userId,e.nameId),McpConnector_user_name_id_unique:DQ("McpConnector_user_name_id_unique").on(e.userId,e.nameId)})),Fie=mr("McpOAuthSession",{id:Ln("id").primaryKey().notNull().defaultRandom(),mcpConnectorId:Ln("mcpConnectorId").notNull().references(()=>KQ.id,{onDelete:"cascade"}),serverUrl:ot("serverUrl").notNull(),clientInfo:ck()("clientInfo"),tokens:ck()("tokens"),codeVerifier:Oy("codeVerifier"),state:ot("state").unique(),createdAt:Mt("createdAt").notNull().defaultNow(),updatedAt:Mt("updatedAt").notNull().defaultNow().$onUpdate(()=>new Date)},e=>({McpOAuthSession_connector_idx:ko("McpOAuthSession_connector_idx").on(e.mcpConnectorId),McpOAuthSession_state_idx:ko("McpOAuthSession_state_idx").on(e.state)})),JQ={user:qi,session:VQ,account:qQ,verification:HQ},Ry=OJ({database:oZ(at,{provider:"pg",schema:JQ}),trustedOrigins:e=>{const t=["http://localhost:5173",...Pr.APP_URL?[Pr.APP_URL]:[]];if(!e)return t;const n=new URL(e.url).origin;return Array.from(new Set([...t,n]))},secret:Pr.AUTH_SECRET,session:{cookieCache:{enabled:!0,maxAge:300}},socialProviders:(()=>{const e=Pr.AUTH_GOOGLE_ID,t=Pr.AUTH_GOOGLE_SECRET,n=Pr.AUTH_GITHUB_ID,i=Pr.AUTH_GITHUB_SECRET,r=Pr.VERCEL_APP_CLIENT_ID,o=Pr.VERCEL_APP_CLIENT_SECRET,s=typeof e=="string"&&e.length>0&&typeof t=="string"&&t.length>0?{clientId:e,clientSecret:t}:void 0,a=typeof n=="string"&&n.length>0&&typeof i=="string"&&i.length>0?{clientId:n,clientSecret:i}:void 0,c=typeof r=="string"&&r.length>0&&typeof o=="string"&&o.length>0?{clientId:r,clientSecret:o}:void 0;return{google:s,github:a,vercel:c}})()});process.env.PLAYWRIGHT_TEST_BASE_URL||process.env.PLAYWRIGHT||process.env.CI_PLAYWRIGHT;const tc=`${ke.appPrefix}/files/`;let Ud=null;const GQ="public, max-age=31536000, immutable",Zf="/api/files/";function kP(e){const i=(e.trim().replaceAll("\\","/").split("/").at(-1)?.trim()??"").replace(/[^a-zA-Z0-9._-]/g,"-");return i.length>0?i:"file"}function ZQ(e){const t=kP(e),n=t.lastIndexOf("."),i=n>0,r=i?t.slice(0,n):t,o=i?t.slice(n):"",s=crypto.randomUUID().replaceAll("-","");return`${tc}${r}-${s}${o}`}function QQ(e,t){if(t?.trim())return t;const n=e.toLowerCase();if(n.endsWith(".jpg")||n.endsWith(".jpeg"))return"image/jpeg";if(n.endsWith(".png"))return"image/png";if(n.endsWith(".gif"))return"image/gif";if(n.endsWith(".webp"))return"image/webp";if(n.endsWith(".pdf"))return"application/pdf";if(n.endsWith(".svg"))return"image/svg+xml"}function EP(e){return`${Zf}${encodeURIComponent(e)}`}function lk(e){if(!e.startsWith(Zf))return null;const t=e.slice(Zf.length).split("?")[0];if(!t)return null;try{return decodeURIComponent(t)}catch{return null}}function AP(e){const t=e.trim();if(!t)return null;if(t.startsWith(Zf))return lk(t);try{const n=new URL(t),i=lk(n.pathname);if(i)return i;const r=n.pathname,o=r.indexOf(tc);return o>=0?decodeURIComponent(r.slice(o)):null}catch{const n=t.indexOf(tc);return n>=0?t.slice(n):null}}function v0(){return Ud||(Ud=(async()=>{const e=globalThis;if(e.R2_ATTACHMENTS)return e.R2_ATTACHMENTS;try{return(await import("cloudflare:workers")).env?.R2_ATTACHMENTS??null}catch{return null}})(),Ud)}async function YQ(){const e=await v0();if(!e)throw new Error("R2_ATTACHMENTS binding is not configured");return e}async function XQ(e,t,n={}){try{const i=await YQ(),r=ZQ(e),o=kP(e),s=QQ(o,n.contentType),a=`inline; filename="${o}"`;await i.put(r,t,{httpMetadata:{cacheControl:n.cacheControl??GQ,contentDisposition:a,contentType:s}});const c=EP(r);return{contentDisposition:a,contentType:s,downloadUrl:c,pathname:r,url:c}}catch(i){throw new Error(`Failed to upload file ${e}: ${i instanceof Error?i.message:"Unknown error"}`)}}async function eY(){try{const e=await v0();if(!e)return{blobs:[],hasMore:!1};const t=[];let n;for(;;){const i=await e.list({cursor:n,prefix:tc});for(const r of i.objects)t.push({contentType:r.httpMetadata?.contentType,pathname:r.key,size:r.size,uploadedAt:r.uploaded.toISOString(),url:EP(r.key)});if(!i.truncated)return{blobs:t,hasMore:!1};if(n=i.cursor,!n)return{blobs:t,hasMore:!0}}}catch(e){throw new Error(`Failed to list files: ${e instanceof Error?e.message:"Unknown error"}`)}}async function TP(e){try{if(e.length===0)return;const t=await v0();if(!t)return;const n=e.map(i=>AP(i)).filter(i=>!!i);if(n.length===0)return;await t.delete(n)}catch(t){throw new Error(`Failed to delete ${e.length} files: ${t instanceof Error?t.message:"Unknown error"}`)}}function tY(e){try{const t=AP(e)??e,n=t.startsWith(tc)?t.substring(tc.length):t;return(decodeURIComponent(n).split("/").at(-1)??"").split("?")[0]||null}catch{return null}}function Wie(e){return{id:e.id,createdAt:e.createdAt,updatedAt:e.updatedAt,title:e.title,visibility:e.visibility,userId:e.userId,isPinned:e.isPinned,projectId:e.projectId??null}}function nY(e,t){const n=e.metadata.parentMessageId||null,i=e.metadata.selectedModel;let r;return e.metadata?.createdAt?r=e.metadata.createdAt instanceof Date?e.metadata.createdAt:new Date(e.metadata.createdAt):r=new Date,{id:e.id,chatId:t,role:e.role,attachments:[],lastContext:e.metadata?.usage||null,createdAt:r,annotations:[],parentMessageId:n,selectedModel:i,selectedTool:e.metadata?.selectedTool||null,activeStreamId:e.metadata?.activeStreamId||null,canceledAt:null}}var IP="vercel.ai.error",rY=Symbol.for(IP),uk,dk,St=class NP extends(dk=Error,uk=rY,dk){constructor({name:t,message:n,cause:i}){super(n),this[uk]=!0,this.name=t,this.cause=i}static isInstance(t){return NP.hasMarker(t,IP)}static hasMarker(t,n){const i=Symbol.for(n);return t!=null&&typeof t=="object"&&i in t&&typeof t[i]=="boolean"&&t[i]===!0}},$P="AI_APICallError",CP=`vercel.ai.error.${$P}`,iY=Symbol.for(CP),fk,pk,dr=class extends(pk=St,fk=iY,pk){constructor({message:e,url:t,requestBodyValues:n,statusCode:i,responseHeaders:r,responseBody:o,cause:s,isRetryable:a=i!=null&&(i===408||i===409||i===429||i>=500),data:c}){super({name:$P,message:e,cause:s}),this[fk]=!0,this.url=t,this.requestBodyValues=n,this.statusCode=i,this.responseHeaders=r,this.responseBody=o,this.isRetryable=a,this.data=c}static isInstance(e){return St.hasMarker(e,CP)}},OP="AI_EmptyResponseBodyError",RP=`vercel.ai.error.${OP}`,oY=Symbol.for(RP),hk,mk,sY=class extends(mk=St,hk=oY,mk){constructor({message:e="Empty response body"}={}){super({name:OP,message:e}),this[hk]=!0}static isInstance(e){return St.hasMarker(e,RP)}};function Yu(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}var PP="AI_InvalidArgumentError",DP=`vercel.ai.error.${PP}`,aY=Symbol.for(DP),gk,yk,cY=class extends(yk=St,gk=aY,yk){constructor({message:t,cause:n,argument:i}){super({name:PP,message:t,cause:n}),this[gk]=!0,this.argument=i}static isInstance(t){return St.hasMarker(t,DP)}},UP="AI_InvalidPromptError",LP=`vercel.ai.error.${UP}`,lY=Symbol.for(LP),wk,vk,Sa=class extends(vk=St,wk=lY,vk){constructor({prompt:e,message:t,cause:n}){super({name:UP,message:`Invalid prompt: ${t}`,cause:n}),this[wk]=!0,this.prompt=e}static isInstance(e){return St.hasMarker(e,LP)}},MP="AI_JSONParseError",jP=`vercel.ai.error.${MP}`,uY=Symbol.for(jP),bk,_k,Qf=class extends(_k=St,bk=uY,_k){constructor({text:e,cause:t}){super({name:MP,message:`JSON parsing failed: Text: ${e}.
Error message: ${Yu(t)}`,cause:t}),this[bk]=!0,this.text=e}static isInstance(e){return St.hasMarker(e,jP)}},zP="AI_TypeValidationError",BP=`vercel.ai.error.${zP}`,dY=Symbol.for(BP),Sk,xk,Ks=class Py extends(xk=St,Sk=dY,xk){constructor({value:t,cause:n}){super({name:zP,message:`Type validation failed: Value: ${JSON.stringify(t)}.
Error message: ${Yu(n)}`,cause:n}),this[Sk]=!0,this.value=t}static isInstance(t){return St.hasMarker(t,BP)}static wrap({value:t,cause:n}){return Py.isInstance(n)&&n.value===t?n:new Py({value:t,cause:n})}},Ll;(function(e){e.assertEqual=r=>{};function t(r){}e.assertIs=t;function n(r){throw new Error}e.assertNever=n,e.arrayToEnum=r=>{const o={};for(const s of r)o[s]=s;return o},e.getValidEnumValues=r=>{const o=e.objectKeys(r).filter(a=>typeof r[r[a]]!="number"),s={};for(const a of o)s[a]=r[a];return e.objectValues(s)},e.objectValues=r=>e.objectKeys(r).map(function(o){return r[o]}),e.objectKeys=typeof Object.keys=="function"?r=>Object.keys(r):r=>{const o=[];for(const s in r)Object.prototype.hasOwnProperty.call(r,s)&&o.push(s);return o},e.find=(r,o)=>{for(const s of r)if(o(s))return s},e.isInteger=typeof Number.isInteger=="function"?r=>Number.isInteger(r):r=>typeof r=="number"&&Number.isFinite(r)&&Math.floor(r)===r;function i(r,o=" | "){return r.map(s=>typeof s=="string"?`'${s}'`:s).join(o)}e.joinValues=i,e.jsonStringifyReplacer=(r,o)=>typeof o=="bigint"?o.toString():o})(Ll||(Ll={}));var kk;(function(e){e.mergeShapes=(t,n)=>({...t,...n})})(kk||(kk={}));Ll.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]);Ll.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Yf extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=i=>{this.issues=[...this.issues,i]},this.addIssues=(i=[])=>{this.issues=[...this.issues,...i]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}format(t){const n=t||function(o){return o.message},i={_errors:[]},r=o=>{for(const s of o.issues)if(s.code==="invalid_union")s.unionErrors.map(r);else if(s.code==="invalid_return_type")r(s.returnTypeError);else if(s.code==="invalid_arguments")r(s.argumentsError);else if(s.path.length===0)i._errors.push(n(s));else{let a=i,c=0;for(;c<s.path.length;){const l=s.path[c];c===s.path.length-1?(a[l]=a[l]||{_errors:[]},a[l]._errors.push(n(s))):a[l]=a[l]||{_errors:[]},a=a[l],c++}}};return r(this),i}static assert(t){if(!(t instanceof Yf))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Ll.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n=Object.create(null),i=[];for(const r of this.issues)if(r.path.length>0){const o=r.path[0];n[o]=n[o]||[],n[o].push(t(r))}else i.push(t(r));return{formErrors:i,fieldErrors:n}}get formErrors(){return this.flatten()}}Yf.create=e=>new Yf(e);var Ek;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t?.message})(Ek||(Ek={}));var tt;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(tt||(tt={}));class Ak extends Error{constructor(t,n){super(t),this.name="ParseError",this.type=n.type,this.field=n.field,this.value=n.value,this.line=n.line}}function kg(e){}function fY(e){if(typeof e=="function")throw new TypeError("`callbacks` must be an object, got a function instead. Did you mean `{onEvent: fn}`?");const{onEvent:t=kg,onError:n=kg,onRetry:i=kg,onComment:r}=e;let o="",s=!0,a,c="",l="";function u(d){const y=s?d.replace(/^\xEF\xBB\xBF/,""):d,[v,x]=pY(`${o}${y}`);for(const E of v)p(E);o=x,s=!1}function p(d){if(d===""){g();return}if(d.startsWith(":")){r&&r(d.slice(d.startsWith(": ")?2:1));return}const y=d.indexOf(":");if(y!==-1){const v=d.slice(0,y),x=d[y+1]===" "?2:1,E=d.slice(y+x);f(v,E,d);return}f(d,"",d)}function f(d,y,v){switch(d){case"event":l=y;break;case"data":c=`${c}${y}
`;break;case"id":a=y.includes("\0")?void 0:y;break;case"retry":/^\d+$/.test(y)?i(parseInt(y,10)):n(new Ak(`Invalid \`retry\` value: "${y}"`,{type:"invalid-retry",value:y,line:v}));break;default:n(new Ak(`Unknown field "${d.length>20?`${d.slice(0,20)}`:d}"`,{type:"unknown-field",field:d,value:y,line:v}));break}}function g(){c.length>0&&t({id:a,event:l||void 0,data:c.endsWith(`
`)?c.slice(0,-1):c}),a=void 0,c="",l=""}function h(d={}){o&&d.consume&&p(o),s=!0,a=void 0,c="",l="",o=""}return{feed:u,reset:h}}function pY(e){const t=[];let n="",i=0;for(;i<e.length;){const r=e.indexOf("\r",i),o=e.indexOf(`
`,i);let s=-1;if(r!==-1&&o!==-1?s=Math.min(r,o):r!==-1?r===e.length-1?s=-1:s=r:o!==-1&&(s=o),s===-1){n=e.slice(i);break}else{const a=e.slice(i,s);t.push(a),i=s+1,e[i-1]==="\r"&&e[i]===`
`&&i++}}return[t,n]}class hY extends TransformStream{constructor({onError:t,onRetry:n,onComment:i}={}){let r;super({start(o){r=fY({onEvent:s=>{o.enqueue(s)},onError(s){t==="terminate"?o.error(s):typeof t=="function"&&t(s)},onRetry:n,onComment:i})},transform(o){r.feed(o)}})}}function Xf(...e){return e.reduce((t,n)=>({...t,...n??{}}),{})}async function mY(e,t){if(e==null)return Promise.resolve();const n=t?.abortSignal;return new Promise((i,r)=>{if(n?.aborted){r(Tk());return}const o=setTimeout(()=>{s(),i()},e),s=()=>{clearTimeout(o),n?.removeEventListener("abort",a)},a=()=>{s(),r(Tk())};n?.addEventListener("abort",a)})}function Tk(){return new DOMException("Delay was aborted","AbortError")}function Xu(e){return Object.fromEntries([...e.headers])}var{btoa:gY,atob:yY}=globalThis;function b0(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),n=yY(t);return Uint8Array.from(n,i=>i.codePointAt(0))}function Dy(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCodePoint(e[n]);return gY(t)}var FP="AI_DownloadError",WP=`vercel.ai.error.${FP}`,wY=Symbol.for(WP),Ik,Nk,Eg=class extends(Nk=St,Ik=wY,Nk){constructor({url:e,statusCode:t,statusText:n,cause:i,message:r=i==null?`Failed to download ${e}: ${t} ${n}`:`Failed to download ${e}: ${i}`}){super({name:FP,message:r,cause:i}),this[Ik]=!0,this.url=e,this.statusCode=t,this.statusText=n}static isInstance(e){return St.hasMarker(e,WP)}},ed=({prefix:e,size:t=16,alphabet:n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:i="-"}={})=>{const r=()=>{const o=n.length,s=new Array(t);for(let a=0;a<t;a++)s[a]=n[Math.random()*o|0];return s.join("")};if(e==null)return r;if(n.includes(i))throw new cY({argument:"separator",message:`The separator "${i}" must not be part of the alphabet "${n}".`});return()=>`${e}${i}${r()}`};ed();function VP(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}function nc(e){return(e instanceof Error||e instanceof DOMException)&&(e.name==="AbortError"||e.name==="ResponseAborted"||e.name==="TimeoutError")}var vY=["fetch failed","failed to fetch"];function qP({error:e,url:t,requestBodyValues:n}){if(nc(e))return e;if(e instanceof TypeError&&vY.includes(e.message.toLowerCase())){const i=e.cause;if(i!=null)return new dr({message:`Cannot connect to API: ${i.message}`,cause:i,url:t,requestBodyValues:n,isRetryable:!0})}return e}function _0(e=globalThis){var t,n,i;return e.window?"runtime/browser":(t=e.navigator)!=null&&t.userAgent?`runtime/${e.navigator.userAgent.toLowerCase()}`:(i=(n=e.process)==null?void 0:n.versions)!=null&&i.node?`runtime/node.js/${e.process.version.substring(0)}`:e.EdgeRuntime?"runtime/vercel-edge":"runtime/unknown"}function bY(e){if(e==null)return{};const t={};if(e instanceof Headers)e.forEach((n,i)=>{t[i.toLowerCase()]=n});else{Array.isArray(e)||(e=Object.entries(e));for(const[n,i]of e)i!=null&&(t[n.toLowerCase()]=i)}return t}function td(e,...t){const n=new Headers(bY(e)),i=n.get("user-agent")||"";return n.set("user-agent",[i,...t].filter(Boolean).join(" ")),Object.fromEntries(n.entries())}var HP="4.0.0",_Y=()=>globalThis.fetch,$k=async({url:e,headers:t={},successfulResponseHandler:n,failedResponseHandler:i,abortSignal:r,fetch:o=_Y()})=>{try{const s=await o(e,{method:"GET",headers:td(t,`ai-sdk/provider-utils/${HP}`,_0()),signal:r}),a=Xu(s);if(!s.ok){let c;try{c=await i({response:s,url:e,requestBodyValues:{}})}catch(l){throw nc(l)||dr.isInstance(l)?l:new dr({message:"Failed to process error response",cause:l,statusCode:s.status,url:e,responseHeaders:a,requestBodyValues:{}})}throw c.value}try{return await n({response:s,url:e,requestBodyValues:{}})}catch(c){throw c instanceof Error&&(nc(c)||dr.isInstance(c))?c:new dr({message:"Failed to process successful response",cause:c,statusCode:s.status,url:e,responseHeaders:a,requestBodyValues:{}})}}catch(s){throw qP({error:s,url:e,requestBodyValues:{}})}};function SY({mediaType:e,url:t,supportedUrls:n}){return t=t.toLowerCase(),e=e.toLowerCase(),Object.entries(n).map(([i,r])=>{const o=i.toLowerCase();return o==="*"||o==="*/*"?{mediaTypePrefix:"",regexes:r}:{mediaTypePrefix:o.replace(/\*/,""),regexes:r}}).filter(({mediaTypePrefix:i})=>e.startsWith(i)).flatMap(({regexes:i})=>i).some(i=>i.test(t))}function sf({settingValue:e,environmentVariableName:t}){if(typeof e=="string")return e;if(!(e!=null||typeof process>"u")&&(e=process.env[t],!(e==null||typeof e!="string")))return e}var xY=/"__proto__"\s*:/,kY=/"constructor"\s*:/;function Ck(e){const t=JSON.parse(e);return t===null||typeof t!="object"||xY.test(e)===!1&&kY.test(e)===!1?t:EY(t)}function EY(e){let t=[e];for(;t.length;){const n=t;t=[];for(const i of n){if(Object.prototype.hasOwnProperty.call(i,"__proto__"))throw new SyntaxError("Object contains forbidden prototype property");if(Object.prototype.hasOwnProperty.call(i,"constructor")&&Object.prototype.hasOwnProperty.call(i.constructor,"prototype"))throw new SyntaxError("Object contains forbidden prototype property");for(const r in i){const o=i[r];o&&typeof o=="object"&&t.push(o)}}}return e}function KP(e){const{stackTraceLimit:t}=Error;try{Error.stackTraceLimit=0}catch{return Ck(e)}try{return Ck(e)}finally{Error.stackTraceLimit=t}}function af(e){if(e.type==="object"){e.additionalProperties=!1;const t=e.properties;if(t!=null)for(const n in t)t[n]=af(t[n])}return e.type==="array"&&e.items!=null&&(Array.isArray(e.items)?e.items=e.items.map(t=>af(t)):e.items=af(e.items)),e}var AY=Symbol("Let zodToJsonSchema decide on which parser to use"),Ok={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",strictUnions:!1,definitions:{},errorMessages:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},TY=e=>typeof e=="string"?{...Ok,name:e}:{...Ok,...e};function Vr(){return{}}function IY(e,t){var n,i,r;const o={type:"array"};return(n=e.type)!=null&&n._def&&((r=(i=e.type)==null?void 0:i._def)==null?void 0:r.typeName)!==tt.ZodAny&&(o.items=jt(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&(o.minItems=e.minLength.value),e.maxLength&&(o.maxItems=e.maxLength.value),e.exactLength&&(o.minItems=e.exactLength.value,o.maxItems=e.exactLength.value),o}function NY(e){const t={type:"integer",format:"int64"};if(!e.checks)return t;for(const n of e.checks)switch(n.kind){case"min":n.inclusive?t.minimum=n.value:t.exclusiveMinimum=n.value;break;case"max":n.inclusive?t.maximum=n.value:t.exclusiveMaximum=n.value;break;case"multipleOf":t.multipleOf=n.value;break}return t}function $Y(){return{type:"boolean"}}function JP(e,t){return jt(e.type._def,t)}var CY=(e,t)=>jt(e.innerType._def,t);function GP(e,t,n){const i=n??t.dateStrategy;if(Array.isArray(i))return{anyOf:i.map((r,o)=>GP(e,t,r))};switch(i){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return OY(e)}}var OY=e=>{const t={type:"integer",format:"unix-time"};for(const n of e.checks)switch(n.kind){case"min":t.minimum=n.value;break;case"max":t.maximum=n.value;break}return t};function RY(e,t){return{...jt(e.innerType._def,t),default:e.defaultValue()}}function PY(e,t){return t.effectStrategy==="input"?jt(e.schema._def,t):Vr()}function DY(e){return{type:"string",enum:Array.from(e.values)}}var UY=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function LY(e,t){const n=[jt(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),jt(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(r=>!!r),i=[];return n.forEach(r=>{if(UY(r))i.push(...r.allOf);else{let o=r;if("additionalProperties"in r&&r.additionalProperties===!1){const{additionalProperties:s,...a}=r;o=a}i.push(o)}}),i.length?{allOf:i}:void 0}function MY(e){const t=typeof e.value;return t!=="bigint"&&t!=="number"&&t!=="boolean"&&t!=="string"?{type:Array.isArray(e.value)?"array":"object"}:{type:t==="bigint"?"integer":t,const:e.value}}var Ag=void 0,fi={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(Ag===void 0&&(Ag=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Ag),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function ZP(e,t){const n={type:"string"};if(e.checks)for(const i of e.checks)switch(i.kind){case"min":n.minLength=typeof n.minLength=="number"?Math.max(n.minLength,i.value):i.value;break;case"max":n.maxLength=typeof n.maxLength=="number"?Math.min(n.maxLength,i.value):i.value;break;case"email":switch(t.emailStrategy){case"format:email":pi(n,"email",i.message,t);break;case"format:idn-email":pi(n,"idn-email",i.message,t);break;case"pattern:zod":cr(n,fi.email,i.message,t);break}break;case"url":pi(n,"uri",i.message,t);break;case"uuid":pi(n,"uuid",i.message,t);break;case"regex":cr(n,i.regex,i.message,t);break;case"cuid":cr(n,fi.cuid,i.message,t);break;case"cuid2":cr(n,fi.cuid2,i.message,t);break;case"startsWith":cr(n,RegExp(`^${Tg(i.value,t)}`),i.message,t);break;case"endsWith":cr(n,RegExp(`${Tg(i.value,t)}$`),i.message,t);break;case"datetime":pi(n,"date-time",i.message,t);break;case"date":pi(n,"date",i.message,t);break;case"time":pi(n,"time",i.message,t);break;case"duration":pi(n,"duration",i.message,t);break;case"length":n.minLength=typeof n.minLength=="number"?Math.max(n.minLength,i.value):i.value,n.maxLength=typeof n.maxLength=="number"?Math.min(n.maxLength,i.value):i.value;break;case"includes":{cr(n,RegExp(Tg(i.value,t)),i.message,t);break}case"ip":{i.version!=="v6"&&pi(n,"ipv4",i.message,t),i.version!=="v4"&&pi(n,"ipv6",i.message,t);break}case"base64url":cr(n,fi.base64url,i.message,t);break;case"jwt":cr(n,fi.jwt,i.message,t);break;case"cidr":{i.version!=="v6"&&cr(n,fi.ipv4Cidr,i.message,t),i.version!=="v4"&&cr(n,fi.ipv6Cidr,i.message,t);break}case"emoji":cr(n,fi.emoji(),i.message,t);break;case"ulid":{cr(n,fi.ulid,i.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{pi(n,"binary",i.message,t);break}case"contentEncoding:base64":{n.contentEncoding="base64";break}case"pattern:zod":{cr(n,fi.base64,i.message,t);break}}break}case"nanoid":cr(n,fi.nanoid,i.message,t)}return n}function Tg(e,t){return t.patternStrategy==="escape"?zY(e):e}var jY=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function zY(e){let t="";for(let n=0;n<e.length;n++)jY.has(e[n])||(t+="\\"),t+=e[n];return t}function pi(e,t,n,i){var r;e.format||(r=e.anyOf)!=null&&r.some(o=>o.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format}),delete e.format),e.anyOf.push({format:t,...n&&i.errorMessages&&{errorMessage:{format:n}}})):e.format=t}function cr(e,t,n,i){var r;e.pattern||(r=e.allOf)!=null&&r.some(o=>o.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern}),delete e.pattern),e.allOf.push({pattern:Rk(t,i),...n&&i.errorMessages&&{errorMessage:{pattern:n}}})):e.pattern=Rk(t,i)}function Rk(e,t){var n;if(!t.applyRegexFlags||!e.flags)return e.source;const i={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},r=i.i?e.source.toLowerCase():e.source;let o="",s=!1,a=!1,c=!1;for(let l=0;l<r.length;l++){if(s){o+=r[l],s=!1;continue}if(i.i){if(a){if(r[l].match(/[a-z]/)){c?(o+=r[l],o+=`${r[l-2]}-${r[l]}`.toUpperCase(),c=!1):r[l+1]==="-"&&((n=r[l+2])!=null&&n.match(/[a-z]/))?(o+=r[l],c=!0):o+=`${r[l]}${r[l].toUpperCase()}`;continue}}else if(r[l].match(/[a-z]/)){o+=`[${r[l]}${r[l].toUpperCase()}]`;continue}}if(i.m){if(r[l]==="^"){o+=`(^|(?<=[\r
]))`;continue}else if(r[l]==="$"){o+=`($|(?=[\r
]))`;continue}}if(i.s&&r[l]==="."){o+=a?`${r[l]}\r
`:`[${r[l]}\r
]`;continue}o+=r[l],r[l]==="\\"?s=!0:a&&r[l]==="]"?a=!1:!a&&r[l]==="["&&(a=!0)}try{new RegExp(o)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return o}function QP(e,t){var n,i,r,o,s,a;const c={type:"object",additionalProperties:(n=jt(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]}))!=null?n:t.allowedAdditionalProperties};if(((i=e.keyType)==null?void 0:i._def.typeName)===tt.ZodString&&((r=e.keyType._def.checks)!=null&&r.length)){const{type:l,...u}=ZP(e.keyType._def,t);return{...c,propertyNames:u}}else{if(((o=e.keyType)==null?void 0:o._def.typeName)===tt.ZodEnum)return{...c,propertyNames:{enum:e.keyType._def.values}};if(((s=e.keyType)==null?void 0:s._def.typeName)===tt.ZodBranded&&e.keyType._def.type._def.typeName===tt.ZodString&&((a=e.keyType._def.type._def.checks)!=null&&a.length)){const{type:l,...u}=JP(e.keyType._def,t);return{...c,propertyNames:u}}}return c}function BY(e,t){if(t.mapStrategy==="record")return QP(e,t);const n=jt(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||Vr(),i=jt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||Vr();return{type:"array",maxItems:125,items:{type:"array",items:[n,i],minItems:2,maxItems:2}}}function FY(e){const t=e.values,i=Object.keys(e.values).filter(o=>typeof t[t[o]]!="number").map(o=>t[o]),r=Array.from(new Set(i.map(o=>typeof o)));return{type:r.length===1?r[0]==="string"?"string":"number":["string","number"],enum:i}}function WY(){return{not:Vr()}}function VY(){return{type:"null"}}var Uy={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function qY(e,t){const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(i=>i._def.typeName in Uy&&(!i._def.checks||!i._def.checks.length))){const i=n.reduce((r,o)=>{const s=Uy[o._def.typeName];return s&&!r.includes(s)?[...r,s]:r},[]);return{type:i.length>1?i:i[0]}}else if(n.every(i=>i._def.typeName==="ZodLiteral"&&!i.description)){const i=n.reduce((r,o)=>{const s=typeof o._def.value;switch(s){case"string":case"number":case"boolean":return[...r,s];case"bigint":return[...r,"integer"];case"object":if(o._def.value===null)return[...r,"null"];default:return r}},[]);if(i.length===n.length){const r=i.filter((o,s,a)=>a.indexOf(o)===s);return{type:r.length>1?r:r[0],enum:n.reduce((o,s)=>o.includes(s._def.value)?o:[...o,s._def.value],[])}}}else if(n.every(i=>i._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((i,r)=>[...i,...r._def.values.filter(o=>!i.includes(o))],[])};return HY(e,t)}var HY=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((i,r)=>jt(i._def,{...t,currentPath:[...t.currentPath,"anyOf",`${r}`]})).filter(i=>!!i&&(!t.strictUnions||typeof i=="object"&&Object.keys(i).length>0));return n.length?{anyOf:n}:void 0};function KY(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return{type:[Uy[e.innerType._def.typeName],"null"]};const n=jt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function JY(e){const t={type:"number"};if(!e.checks)return t;for(const n of e.checks)switch(n.kind){case"int":t.type="integer";break;case"min":n.inclusive?t.minimum=n.value:t.exclusiveMinimum=n.value;break;case"max":n.inclusive?t.maximum=n.value:t.exclusiveMaximum=n.value;break;case"multipleOf":t.multipleOf=n.value;break}return t}function GY(e,t){const n={type:"object",properties:{}},i=[],r=e.shape();for(const s in r){let a=r[s];if(a===void 0||a._def===void 0)continue;const c=QY(a),l=jt(a._def,{...t,currentPath:[...t.currentPath,"properties",s],propertyPath:[...t.currentPath,"properties",s]});l!==void 0&&(n.properties[s]=l,c||i.push(s))}i.length&&(n.required=i);const o=ZY(e,t);return o!==void 0&&(n.additionalProperties=o),n}function ZY(e,t){if(e.catchall._def.typeName!=="ZodNever")return jt(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]});switch(e.unknownKeys){case"passthrough":return t.allowedAdditionalProperties;case"strict":return t.rejectedAdditionalProperties;case"strip":return t.removeAdditionalStrategy==="strict"?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}function QY(e){try{return e.isOptional()}catch{return!0}}var YY=(e,t)=>{var n;if(t.currentPath.toString()===((n=t.propertyPath)==null?void 0:n.toString()))return jt(e.innerType._def,t);const i=jt(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return i?{anyOf:[{not:Vr()},i]}:Vr()},XY=(e,t)=>{if(t.pipeStrategy==="input")return jt(e.in._def,t);if(t.pipeStrategy==="output")return jt(e.out._def,t);const n=jt(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),i=jt(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,i].filter(r=>r!==void 0)}};function eX(e,t){return jt(e.type._def,t)}function tX(e,t){const i={type:"array",uniqueItems:!0,items:jt(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&(i.minItems=e.minSize.value),e.maxSize&&(i.maxItems=e.maxSize.value),i}function nX(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,i)=>jt(n._def,{...t,currentPath:[...t.currentPath,"items",`${i}`]})).reduce((n,i)=>i===void 0?n:[...n,i],[]),additionalItems:jt(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,i)=>jt(n._def,{...t,currentPath:[...t.currentPath,"items",`${i}`]})).reduce((n,i)=>i===void 0?n:[...n,i],[])}}function rX(){return{not:Vr()}}function iX(){return Vr()}var oX=(e,t)=>jt(e.innerType._def,t),sX=(e,t,n)=>{switch(t){case tt.ZodString:return ZP(e,n);case tt.ZodNumber:return JY(e);case tt.ZodObject:return GY(e,n);case tt.ZodBigInt:return NY(e);case tt.ZodBoolean:return $Y();case tt.ZodDate:return GP(e,n);case tt.ZodUndefined:return rX();case tt.ZodNull:return VY();case tt.ZodArray:return IY(e,n);case tt.ZodUnion:case tt.ZodDiscriminatedUnion:return qY(e,n);case tt.ZodIntersection:return LY(e,n);case tt.ZodTuple:return nX(e,n);case tt.ZodRecord:return QP(e,n);case tt.ZodLiteral:return MY(e);case tt.ZodEnum:return DY(e);case tt.ZodNativeEnum:return FY(e);case tt.ZodNullable:return KY(e,n);case tt.ZodOptional:return YY(e,n);case tt.ZodMap:return BY(e,n);case tt.ZodSet:return tX(e,n);case tt.ZodLazy:return()=>e.getter()._def;case tt.ZodPromise:return eX(e,n);case tt.ZodNaN:case tt.ZodNever:return WY();case tt.ZodEffects:return PY(e,n);case tt.ZodAny:return Vr();case tt.ZodUnknown:return iX();case tt.ZodDefault:return RY(e,n);case tt.ZodBranded:return JP(e,n);case tt.ZodReadonly:return oX(e,n);case tt.ZodCatch:return CY(e,n);case tt.ZodPipeline:return XY(e,n);case tt.ZodFunction:case tt.ZodVoid:case tt.ZodSymbol:return;default:return(i=>{})()}},aX=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")};function jt(e,t,n=!1){var i;const r=t.seen.get(e);if(t.override){const c=(i=t.override)==null?void 0:i.call(t,e,t,r,n);if(c!==AY)return c}if(r&&!n){const c=cX(r,t);if(c!==void 0)return c}const o={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,o);const s=sX(e,e.typeName,t),a=typeof s=="function"?jt(s(),t):s;if(a&&lX(e,t,a),t.postProcess){const c=t.postProcess(a,e,t);return o.jsonSchema=a,c}return o.jsonSchema=a,a}var cX=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:aX(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((n,i)=>t.currentPath[i]===n)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),Vr()):t.$refStrategy==="seen"?Vr():void 0}},lX=(e,t,n)=>(e.description&&(n.description=e.description),n),uX=e=>{const t=TY(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([i,r])=>[r._def,{def:r._def,path:[...t.basePath,t.definitionPath,i],jsonSchema:void 0}]))}},dX=(e,t)=>{var n;const i=uX(t);let r=typeof t=="object"&&t.definitions?Object.entries(t.definitions).reduce((l,[u,p])=>{var f;return{...l,[u]:(f=jt(p._def,{...i,currentPath:[...i.basePath,i.definitionPath,u]},!0))!=null?f:Vr()}},{}):void 0;const o=typeof t=="string"?t:t?.nameStrategy==="title"?void 0:t?.name,s=(n=jt(e._def,o===void 0?i:{...i,currentPath:[...i.basePath,i.definitionPath,o]},!1))!=null?n:Vr(),a=typeof t=="object"&&t.name!==void 0&&t.nameStrategy==="title"?t.name:void 0;a!==void 0&&(s.title=a);const c=o===void 0?r?{...s,[i.definitionPath]:r}:s:{$ref:[...i.$refStrategy==="relative"?[]:i.basePath,i.definitionPath,o].join("/"),[i.definitionPath]:{...r,[o]:s}};return c.$schema="http://json-schema.org/draft-07/schema#",c},Ly=Symbol.for("vercel.ai.schema");function Ic(e){let t;return()=>(t==null&&(t=e()),t)}function Yh(e,{validate:t}={}){return{[Ly]:!0,_type:void 0,get jsonSchema(){return typeof e=="function"&&(e=e()),e},validate:t}}function fX(e){return typeof e=="object"&&e!==null&&Ly in e&&e[Ly]===!0&&"jsonSchema"in e&&"validate"in e}function Nc(e){return e==null?Yh({properties:{},additionalProperties:!1}):fX(e)?e:"~standard"in e?e["~standard"].vendor==="zod"?aa(e):pX(e):e()}function pX(e){return Yh(()=>e["~standard"].jsonSchema.input({target:"draft-07"}),{validate:async t=>{const n=await e["~standard"].validate(t);return"value"in n?{success:!0,value:n.value}:{success:!1,error:new Ks({value:t,cause:n.issues})}}})}function hX(e,t){var n;const i=(n=void 0)!=null?n:!1;return Yh(()=>dX(e,{$refStrategy:i?"root":"none"}),{validate:async r=>{const o=await e.safeParseAsync(r);return o.success?{success:!0,value:o.data}:{success:!1,error:o.error}}})}function mX(e,t){var n;const i=(n=void 0)!=null?n:!1;return Yh(()=>af(xp(e,{target:"draft-7",io:"input",reused:i?"ref":"inline"})),{validate:async r=>{const o=await Ip(e,r);return o.success?{success:!0,value:o.data}:{success:!1,error:o.error}}})}function gX(e){return"_zod"in e}function aa(e,t){return gX(e)?mX(e):hX(e)}async function yX({value:e,schema:t}){const n=await zi({value:e,schema:t});if(!n.success)throw Ks.wrap({value:e,cause:n.error});return n.value}async function zi({value:e,schema:t}){const n=Nc(t);try{if(n.validate==null)return{success:!0,value:e,rawValue:e};const i=await n.validate(e);return i.success?{success:!0,value:i.value,rawValue:e}:{success:!1,error:Ks.wrap({value:e,cause:i.error}),rawValue:e}}catch(i){return{success:!1,error:Ks.wrap({value:e,cause:i}),rawValue:e}}}async function wX({text:e,schema:t}){try{const n=KP(e);return t==null?n:yX({value:n,schema:t})}catch(n){throw Qf.isInstance(n)||Ks.isInstance(n)?n:new Qf({text:e,cause:n})}}async function Si({text:e,schema:t}){try{const n=KP(e);return t==null?{success:!0,value:n,rawValue:n}:await zi({value:n,schema:t})}catch(n){return{success:!1,error:Qf.isInstance(n)?n:new Qf({text:e,cause:n}),rawValue:void 0}}}function vX({stream:e,schema:t}){return e.pipeThrough(new TextDecoderStream).pipeThrough(new hY).pipeThrough(new TransformStream({async transform({data:n},i){n!=="[DONE]"&&i.enqueue(await Si({text:n,schema:t}))}}))}var bX=()=>globalThis.fetch,ep=async({url:e,headers:t,body:n,failedResponseHandler:i,successfulResponseHandler:r,abortSignal:o,fetch:s})=>_X({url:e,headers:{"Content-Type":"application/json",...t},body:{content:JSON.stringify(n),values:n},failedResponseHandler:i,successfulResponseHandler:r,abortSignal:o,fetch:s}),_X=async({url:e,headers:t={},body:n,successfulResponseHandler:i,failedResponseHandler:r,abortSignal:o,fetch:s=bX()})=>{try{const a=await s(e,{method:"POST",headers:td(t,`ai-sdk/provider-utils/${HP}`,_0()),body:n.content,signal:o}),c=Xu(a);if(!a.ok){let l;try{l=await r({response:a,url:e,requestBodyValues:n.values})}catch(u){throw nc(u)||dr.isInstance(u)?u:new dr({message:"Failed to process error response",cause:u,statusCode:a.status,url:e,responseHeaders:c,requestBodyValues:n.values})}throw l.value}try{return await i({response:a,url:e,requestBodyValues:n.values})}catch(l){throw l instanceof Error&&(nc(l)||dr.isInstance(l))?l:new dr({message:"Failed to process successful response",cause:l,statusCode:a.status,url:e,responseHeaders:c,requestBodyValues:n.values})}}catch(a){throw qP({error:a,url:e,requestBodyValues:n.values})}};function qie(e){return e}function Hie(e){return{...e,type:"dynamic"}}async function si(e){return typeof e=="function"&&(e=e()),Promise.resolve(e)}var rc=({errorSchema:e,errorToMessage:t,isRetryable:n})=>async({response:i,url:r,requestBodyValues:o})=>{const s=await i.text(),a=Xu(i);if(s.trim()==="")return{responseHeaders:a,value:new dr({message:i.statusText,url:r,requestBodyValues:o,statusCode:i.status,responseHeaders:a,responseBody:s,isRetryable:n?.(i)})};try{const c=await wX({text:s,schema:e});return{responseHeaders:a,value:new dr({message:t(c),url:r,requestBodyValues:o,statusCode:i.status,responseHeaders:a,responseBody:s,data:c,isRetryable:n?.(i,c)})}}catch{return{responseHeaders:a,value:new dr({message:i.statusText,url:r,requestBodyValues:o,statusCode:i.status,responseHeaders:a,responseBody:s,isRetryable:n?.(i)})}}},SX=e=>async({response:t})=>{const n=Xu(t);if(t.body==null)throw new sY({});return{responseHeaders:n,value:vX({stream:t.body,schema:e})}},Ml=e=>async({response:t,url:n,requestBodyValues:i})=>{const r=await t.text(),o=await Si({text:r,schema:e}),s=Xu(t);if(!o.success)throw new dr({message:"Invalid JSON response",cause:o.error,statusCode:t.status,responseHeaders:s,responseBody:r,url:n,requestBodyValues:i});return{responseHeaders:s,value:o.value,rawValue:o.rawValue}};function xX(e){return e?.replace(/\/$/,"")}function kX(e){return e!=null&&typeof e[Symbol.asyncIterator]=="function"}async function*EX({execute:e,input:t,options:n}){const i=e(t,n);if(kX(i)){let r;for await(const o of i)r=o,yield{type:"preliminary",output:o};yield{type:"final",output:r}}else yield{type:"final",output:await i}}var Ig,Pk;function AX(){if(Pk)return Ig;Pk=1;var e=Object.defineProperty,t=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,i=Object.prototype.hasOwnProperty,r=(u,p)=>{for(var f in p)e(u,f,{get:p[f],enumerable:!0})},o=(u,p,f,g)=>{if(p&&typeof p=="object"||typeof p=="function")for(let h of n(p))!i.call(u,h)&&h!==f&&e(u,h,{get:()=>p[h],enumerable:!(g=t(p,h))||g.enumerable});return u},s=u=>o(e({},"__esModule",{value:!0}),u),a={};r(a,{SYMBOL_FOR_REQ_CONTEXT:()=>c,getContext:()=>l}),Ig=s(a);const c=Symbol.for("@vercel/request-context");function l(){return globalThis[c]?.get?.()??{}}return Ig}var Ng,Dk;function TX(){if(Dk)return Ng;Dk=1;var e=Object.defineProperty,t=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,i=Object.prototype.hasOwnProperty,r=(p,f)=>{for(var g in f)e(p,g,{get:f[g],enumerable:!0})},o=(p,f,g,h)=>{if(f&&typeof f=="object"||typeof f=="function")for(let d of n(f))!i.call(p,d)&&d!==g&&e(p,d,{get:()=>f[d],enumerable:!(h=t(f,d))||h.enumerable});return p},s=p=>o(e({},"__esModule",{value:!0}),p),a={};r(a,{getContext:()=>c.getContext,getVercelOidcToken:()=>l,getVercelOidcTokenSync:()=>u}),Ng=s(a);var c=AX();async function l(){return""}function u(){return""}return Ng}var YP=TX(),IX="vercel.ai.gateway.error",$g=Symbol.for(IX),Uk,Lk,qr=class XP extends(Lk=Error,Uk=$g,Lk){constructor({message:t,statusCode:n=500,cause:i}){super(t),this[Uk]=!0,this.statusCode=n,this.cause=i}static isInstance(t){return XP.hasMarker(t)}static hasMarker(t){return typeof t=="object"&&t!==null&&$g in t&&t[$g]===!0}},e2="GatewayAuthenticationError",NX=`vercel.ai.gateway.error.${e2}`,Mk=Symbol.for(NX),jk,zk,S0=class t2 extends(zk=qr,jk=Mk,zk){constructor({message:t="Authentication failed",statusCode:n=401,cause:i}={}){super({message:t,statusCode:n,cause:i}),this[jk]=!0,this.name=e2,this.type="authentication_error"}static isInstance(t){return qr.hasMarker(t)&&Mk in t}static createContextualError({apiKeyProvided:t,oidcTokenProvided:n,message:i="Authentication failed",statusCode:r=401,cause:o}){let s;return t?s=`AI Gateway authentication failed: Invalid API key.

Create a new API key: https://vercel.com/d?to=%2F%5Bteam%5D%2F%7E%2Fai%2Fapi-keys

Provide via 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.`:n?s=`AI Gateway authentication failed: Invalid OIDC token.

Run 'npx vercel link' to link your project, then 'vc env pull' to fetch the token.

Alternatively, use an API key: https://vercel.com/d?to=%2F%5Bteam%5D%2F%7E%2Fai%2Fapi-keys`:s=`AI Gateway authentication failed: No authentication provided.

Option 1 - API key:
Create an API key: https://vercel.com/d?to=%2F%5Bteam%5D%2F%7E%2Fai%2Fapi-keys
Provide via 'apiKey' option or 'AI_GATEWAY_API_KEY' environment variable.

Option 2 - OIDC token:
Run 'npx vercel link' to link your project, then 'vc env pull' to fetch the token.`,new t2({message:s,statusCode:r,cause:o})}},n2="GatewayInvalidRequestError",$X=`vercel.ai.gateway.error.${n2}`,Bk=Symbol.for($X),Fk,Wk,CX=class extends(Wk=qr,Fk=Bk,Wk){constructor({message:e="Invalid request",statusCode:t=400,cause:n}={}){super({message:e,statusCode:t,cause:n}),this[Fk]=!0,this.name=n2,this.type="invalid_request_error"}static isInstance(e){return qr.hasMarker(e)&&Bk in e}},r2="GatewayRateLimitError",OX=`vercel.ai.gateway.error.${r2}`,Vk=Symbol.for(OX),qk,Hk,RX=class extends(Hk=qr,qk=Vk,Hk){constructor({message:e="Rate limit exceeded",statusCode:t=429,cause:n}={}){super({message:e,statusCode:t,cause:n}),this[qk]=!0,this.name=r2,this.type="rate_limit_exceeded"}static isInstance(e){return qr.hasMarker(e)&&Vk in e}},i2="GatewayModelNotFoundError",PX=`vercel.ai.gateway.error.${i2}`,Kk=Symbol.for(PX),DX=Ic(()=>aa(ce({modelId:W()}))),Jk,Gk,UX=class extends(Gk=qr,Jk=Kk,Gk){constructor({message:e="Model not found",statusCode:t=404,modelId:n,cause:i}={}){super({message:e,statusCode:t,cause:i}),this[Jk]=!0,this.name=i2,this.type="model_not_found",this.modelId=n}static isInstance(e){return qr.hasMarker(e)&&Kk in e}},o2="GatewayInternalServerError",LX=`vercel.ai.gateway.error.${o2}`,Zk=Symbol.for(LX),Qk,Yk,Xk=class extends(Yk=qr,Qk=Zk,Yk){constructor({message:e="Internal server error",statusCode:t=500,cause:n}={}){super({message:e,statusCode:t,cause:n}),this[Qk]=!0,this.name=o2,this.type="internal_server_error"}static isInstance(e){return qr.hasMarker(e)&&Zk in e}},s2="GatewayResponseError",MX=`vercel.ai.gateway.error.${s2}`,eE=Symbol.for(MX),tE,nE,jX=class extends(nE=qr,tE=eE,nE){constructor({message:e="Invalid response from Gateway",statusCode:t=502,response:n,validationError:i,cause:r}={}){super({message:e,statusCode:t,cause:r}),this[tE]=!0,this.name=s2,this.type="response_error",this.response=n,this.validationError=i}static isInstance(e){return qr.hasMarker(e)&&eE in e}};async function rE({response:e,statusCode:t,defaultMessage:n="Gateway request failed",cause:i,authMethod:r}){const o=await zi({value:e,schema:zX});if(!o.success)return new jX({message:`Invalid error response format: ${n}`,statusCode:t,response:e,validationError:o.error,cause:i});const s=o.value,a=s.error.type,c=s.error.message;switch(a){case"authentication_error":return S0.createContextualError({apiKeyProvided:r==="api-key",oidcTokenProvided:r==="oidc",statusCode:t,cause:i});case"invalid_request_error":return new CX({message:c,statusCode:t,cause:i});case"rate_limit_exceeded":return new RX({message:c,statusCode:t,cause:i});case"model_not_found":{const l=await zi({value:s.error.param,schema:DX});return new UX({message:c,statusCode:t,modelId:l.success?l.value.modelId:void 0,cause:i})}case"internal_server_error":return new Xk({message:c,statusCode:t,cause:i});default:return new Xk({message:c,statusCode:t,cause:i})}}var zX=Ic(()=>aa(ce({error:ce({message:W(),type:W().nullish(),param:Nt().nullish(),code:nn([W(),Lt()]).nullish()})})));function os(e,t){var n;return qr.isInstance(e)?e:dr.isInstance(e)?rE({response:BX(e),statusCode:(n=e.statusCode)!=null?n:500,defaultMessage:"Gateway request failed",cause:e,authMethod:t}):rE({response:{},statusCode:500,defaultMessage:e instanceof Error?`Gateway request failed: ${e.message}`:"Unknown Gateway error",cause:e,authMethod:t})}function BX(e){if(e.data!==void 0)return e.data;if(e.responseBody!=null)try{return JSON.parse(e.responseBody)}catch{return e.responseBody}return{}}var a2="ai-gateway-auth-method";async function ic(e){const t=await zi({value:e[a2],schema:FX});return t.success?t.value:void 0}var FX=Ic(()=>aa(nn([_e("api-key"),_e("oidc")]))),iE=class{constructor(e){this.config=e}async getAvailableModels(){try{const{value:e}=await $k({url:`${this.config.baseURL}/config`,headers:await si(this.config.headers()),successfulResponseHandler:Ml(WX),failedResponseHandler:rc({errorSchema:Hn(),errorToMessage:t=>t}),fetch:this.config.fetch});return e}catch(e){throw await os(e)}}async getCredits(){try{const e=new URL(this.config.baseURL),{value:t}=await $k({url:`${e.origin}/v1/credits`,headers:await si(this.config.headers()),successfulResponseHandler:Ml(VX),failedResponseHandler:rc({errorSchema:Hn(),errorToMessage:n=>n}),fetch:this.config.fetch});return t}catch(e){throw await os(e)}}},WX=Ic(()=>aa(ce({models:yt(ce({id:W(),name:W(),description:W().nullish(),pricing:ce({input:W(),output:W(),input_cache_read:W().nullish(),input_cache_write:W().nullish()}).transform(({input:e,output:t,input_cache_read:n,input_cache_write:i})=>({input:e,output:t,...n?{cachedInputTokens:n}:{},...i?{cacheCreationInputTokens:i}:{}})).nullish(),specification:ce({specificationVersion:_e("v3"),provider:W(),modelId:W()}),modelType:Eo(["language","embedding","image"]).nullish()}))}))),VX=Ic(()=>aa(ce({balance:W(),total_used:W()}).transform(({balance:e,total_used:t})=>({balance:e,totalUsed:t})))),qX=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v3",this.supportedUrls={"*/*":[/.*/]}}get provider(){return this.config.provider}async getArgs(e){const{abortSignal:t,...n}=e;return{args:this.maybeEncodeFileParts(n),warnings:[]}}async doGenerate(e){const{args:t,warnings:n}=await this.getArgs(e),{abortSignal:i}=e,r=await si(this.config.headers());try{const{responseHeaders:o,value:s,rawValue:a}=await ep({url:this.getUrl(),headers:Xf(r,e.headers,this.getModelConfigHeaders(this.modelId,!1),await si(this.config.o11yHeaders)),body:t,successfulResponseHandler:Ml(Hn()),failedResponseHandler:rc({errorSchema:Hn(),errorToMessage:c=>c}),...i&&{abortSignal:i},fetch:this.config.fetch});return{...s,request:{body:t},response:{headers:o,body:a},warnings:n}}catch(o){throw await os(o,await ic(r))}}async doStream(e){const{args:t,warnings:n}=await this.getArgs(e),{abortSignal:i}=e,r=await si(this.config.headers());try{const{value:o,responseHeaders:s}=await ep({url:this.getUrl(),headers:Xf(r,e.headers,this.getModelConfigHeaders(this.modelId,!0),await si(this.config.o11yHeaders)),body:t,successfulResponseHandler:SX(Hn()),failedResponseHandler:rc({errorSchema:Hn(),errorToMessage:a=>a}),...i&&{abortSignal:i},fetch:this.config.fetch});return{stream:o.pipeThrough(new TransformStream({start(a){n.length>0&&a.enqueue({type:"stream-start",warnings:n})},transform(a,c){if(a.success){const l=a.value;if(l.type==="raw"&&!e.includeRawChunks)return;l.type==="response-metadata"&&l.timestamp&&typeof l.timestamp=="string"&&(l.timestamp=new Date(l.timestamp)),c.enqueue(l)}else c.error(a.error)}})),request:{body:t},response:{headers:s}}}catch(o){throw await os(o,await ic(r))}}isFilePart(e){return e&&typeof e=="object"&&"type"in e&&e.type==="file"}maybeEncodeFileParts(e){for(const t of e.prompt)for(const n of t.content)if(this.isFilePart(n)){const i=n;if(i.data instanceof Uint8Array){const r=Uint8Array.from(i.data),o=Buffer.from(r).toString("base64");i.data=new URL(`data:${i.mediaType||"application/octet-stream"};base64,${o}`)}}return e}getUrl(){return`${this.config.baseURL}/language-model`}getModelConfigHeaders(e,t){return{"ai-language-model-specification-version":"2","ai-language-model-id":e,"ai-language-model-streaming":String(t)}}},HX=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v3",this.maxEmbeddingsPerCall=2048,this.supportsParallelCalls=!0}get provider(){return this.config.provider}async doEmbed({values:e,headers:t,abortSignal:n,providerOptions:i}){var r;const o=await si(this.config.headers());try{const{responseHeaders:s,value:a,rawValue:c}=await ep({url:this.getUrl(),headers:Xf(o,t??{},this.getModelConfigHeaders(),await si(this.config.o11yHeaders)),body:{values:e,...i?{providerOptions:i}:{}},successfulResponseHandler:Ml(KX),failedResponseHandler:rc({errorSchema:Hn(),errorToMessage:l=>l}),...n&&{abortSignal:n},fetch:this.config.fetch});return{embeddings:a.embeddings,usage:(r=a.usage)!=null?r:void 0,providerMetadata:a.providerMetadata,response:{headers:s,body:c},warnings:[]}}catch(s){throw await os(s,await ic(o))}}getUrl(){return`${this.config.baseURL}/embedding-model`}getModelConfigHeaders(){return{"ai-embedding-model-specification-version":"2","ai-model-id":this.modelId}}},KX=Ic(()=>aa(ce({embeddings:yt(yt(Lt())),usage:ce({tokens:Lt()}).nullish(),providerMetadata:rr(W(),rr(W(),Nt())).optional()}))),JX=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v3",this.maxImagesPerCall=Number.MAX_SAFE_INTEGER}get provider(){return this.config.provider}async doGenerate({prompt:e,n:t,size:n,aspectRatio:i,seed:r,providerOptions:o,headers:s,abortSignal:a}){var c;const l=await si(this.config.headers());try{const{responseHeaders:u,value:p,rawValue:f}=await ep({url:this.getUrl(),headers:Xf(l,s??{},this.getModelConfigHeaders(),await si(this.config.o11yHeaders)),body:{prompt:e,n:t,...n&&{size:n},...i&&{aspectRatio:i},...r&&{seed:r},...o&&{providerOptions:o}},successfulResponseHandler:Ml(ZX),failedResponseHandler:rc({errorSchema:Hn(),errorToMessage:g=>g}),...a&&{abortSignal:a},fetch:this.config.fetch});return{images:p.images,warnings:(c=p.warnings)!=null?c:[],providerMetadata:p.providerMetadata,response:{timestamp:new Date,modelId:this.modelId,headers:u}}}catch(u){throw os(u,await ic(l))}}getUrl(){return`${this.config.baseURL}/image-model`}getModelConfigHeaders(){return{"ai-image-model-specification-version":"2","ai-model-id":this.modelId}}},GX=ce({images:yt(Nt()).optional()}).catchall(Nt()),ZX=ce({images:yt(W()),warnings:yt(ce({type:_e("other"),message:W()})).optional(),providerMetadata:rr(W(),GX).optional()});async function QX(){var e;return(e=YP.getContext().headers)==null?void 0:e["x-vercel-id"]}var YX="3.0.0",XX="0.0.1";function eee(e={}){var t,n;let i=null,r=null;const o=(t=e.metadataCacheRefreshMillis)!=null?t:1e3*60*5;let s=0;const a=(n=xX(e.baseURL))!=null?n:"https://ai-gateway.vercel.sh/v3/ai",c=async()=>{const d=await nee(e);if(d)return td({Authorization:`Bearer ${d.token}`,"ai-gateway-protocol-version":XX,[a2]:d.authMethod,...e.headers},`ai-sdk/gateway/${YX}`);throw S0.createContextualError({apiKeyProvided:!1,oidcTokenProvided:!1,statusCode:401})},l=()=>{const d=sf({settingValue:void 0,environmentVariableName:"VERCEL_DEPLOYMENT_ID"}),y=sf({settingValue:void 0,environmentVariableName:"VERCEL_ENV"}),v=sf({settingValue:void 0,environmentVariableName:"VERCEL_REGION"});return async()=>{const x=await QX();return{...d&&{"ai-o11y-deployment-id":d},...y&&{"ai-o11y-environment":y},...v&&{"ai-o11y-region":v},...x&&{"ai-o11y-request-id":x}}}},u=d=>new qX(d,{provider:"gateway",baseURL:a,headers:c,fetch:e.fetch,o11yHeaders:l()}),p=async()=>{var d,y,v;const x=(v=(y=(d=e._internal)==null?void 0:d.currentDate)==null?void 0:y.call(d).getTime())!=null?v:Date.now();return(!i||x-s>o)&&(s=x,i=new iE({baseURL:a,headers:c,fetch:e.fetch}).getAvailableModels().then(E=>(r=E,E)).catch(async E=>{throw await os(E,await ic(await c()))})),r?Promise.resolve(r):i},f=async()=>new iE({baseURL:a,headers:c,fetch:e.fetch}).getCredits().catch(async d=>{throw await os(d,await ic(await c()))}),g=function(d){if(new.target)throw new Error("The Gateway Provider model function cannot be called with the new keyword.");return u(d)};g.specificationVersion="v3",g.getAvailableModels=p,g.getCredits=f,g.imageModel=d=>new JX(d,{provider:"gateway",baseURL:a,headers:c,fetch:e.fetch,o11yHeaders:l()}),g.languageModel=u;const h=d=>new HX(d,{provider:"gateway",baseURL:a,headers:c,fetch:e.fetch,o11yHeaders:l()});return g.embeddingModel=h,g.textEmbeddingModel=h,g}var tee=eee();async function nee(e){const t=sf({settingValue:e.apiKey,environmentVariableName:"AI_GATEWAY_API_KEY"});if(t)return{token:t,authMethod:"api-key"};try{return{token:await YP.getVercelOidcToken(),authMethod:"oidc"}}catch{return null}}var ree=typeof globalThis=="object"?globalThis:global,Is="1.9.0",oE=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;function iee(e){var t=new Set([e]),n=new Set,i=e.match(oE);if(!i)return function(){return!1};var r={major:+i[1],minor:+i[2],patch:+i[3],prerelease:i[4]};if(r.prerelease!=null)return function(c){return c===e};function o(a){return n.add(a),!1}function s(a){return t.add(a),!0}return function(c){if(t.has(c))return!0;if(n.has(c))return!1;var l=c.match(oE);if(!l)return o(c);var u={major:+l[1],minor:+l[2],patch:+l[3],prerelease:l[4]};return u.prerelease!=null||r.major!==u.major?o(c):r.major===0?r.minor===u.minor&&r.patch<=u.patch?s(c):o(c):r.minor<=u.minor?s(c):o(c)}}var oee=iee(Is),see=Is.split(".")[0],jl=Symbol.for("opentelemetry.js.api."+see),zl=ree;function x0(e,t,n,i){var r;i===void 0&&(i=!1);var o=zl[jl]=(r=zl[jl])!==null&&r!==void 0?r:{version:Is};if(!i&&o[e]){var s=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return n.error(s.stack||s.message),!1}if(o.version!==Is){var s=new Error("@opentelemetry/api: Registration of version v"+o.version+" for "+e+" does not match previously registered API v"+Is);return n.error(s.stack||s.message),!1}return o[e]=t,n.debug("@opentelemetry/api: Registered a global for "+e+" v"+Is+"."),!0}function Bl(e){var t,n,i=(t=zl[jl])===null||t===void 0?void 0:t.version;if(!(!i||!oee(i)))return(n=zl[jl])===null||n===void 0?void 0:n[e]}function k0(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+Is+".");var n=zl[jl];n&&delete n[e]}var aee=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var i=n.call(e),r,o=[],s;try{for(;(t===void 0||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(a){s={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(s)throw s.error}}return o},cee=function(e,t,n){if(n||arguments.length===2)for(var i=0,r=t.length,o;i<r;i++)(o||!(i in t))&&(o||(o=Array.prototype.slice.call(t,0,i)),o[i]=t[i]);return e.concat(o||Array.prototype.slice.call(t))},lee=(function(){function e(t){this._namespace=t.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Yc("debug",this._namespace,t)},e.prototype.error=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Yc("error",this._namespace,t)},e.prototype.info=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Yc("info",this._namespace,t)},e.prototype.warn=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Yc("warn",this._namespace,t)},e.prototype.verbose=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Yc("verbose",this._namespace,t)},e})();function Yc(e,t,n){var i=Bl("diag");if(i)return n.unshift(t),i[e].apply(i,cee([],aee(n),!1))}var Dr;(function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"})(Dr||(Dr={}));function uee(e,t){e<Dr.NONE?e=Dr.NONE:e>Dr.ALL&&(e=Dr.ALL),t=t||{};function n(i,r){var o=t[i];return typeof o=="function"&&e>=r?o.bind(t):function(){}}return{error:n("error",Dr.ERROR),warn:n("warn",Dr.WARN),info:n("info",Dr.INFO),debug:n("debug",Dr.DEBUG),verbose:n("verbose",Dr.VERBOSE)}}var dee=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var i=n.call(e),r,o=[],s;try{for(;(t===void 0||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(a){s={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(s)throw s.error}}return o},fee=function(e,t,n){if(n||arguments.length===2)for(var i=0,r=t.length,o;i<r;i++)(o||!(i in t))&&(o||(o=Array.prototype.slice.call(t,0,i)),o[i]=t[i]);return e.concat(o||Array.prototype.slice.call(t))},pee="diag",tp=(function(){function e(){function t(r){return function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];var a=Bl("diag");if(a)return a[r].apply(a,fee([],dee(o),!1))}}var n=this,i=function(r,o){var s,a,c;if(o===void 0&&(o={logLevel:Dr.INFO}),r===n){var l=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return n.error((s=l.stack)!==null&&s!==void 0?s:l.message),!1}typeof o=="number"&&(o={logLevel:o});var u=Bl("diag"),p=uee((a=o.logLevel)!==null&&a!==void 0?a:Dr.INFO,r);if(u&&!o.suppressOverrideMessage){var f=(c=new Error().stack)!==null&&c!==void 0?c:"<failed to generate stacktrace>";u.warn("Current logger will be overwritten from "+f),p.warn("Current logger will overwrite one already registered from "+f)}return x0("diag",p,n,!0)};n.setLogger=i,n.disable=function(){k0(pee,n)},n.createComponentLogger=function(r){return new lee(r)},n.verbose=t("verbose"),n.debug=t("debug"),n.info=t("info"),n.warn=t("warn"),n.error=t("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e})();function hee(e){return Symbol.for(e)}var mee=(function(){function e(t){var n=this;n._currentContext=t?new Map(t):new Map,n.getValue=function(i){return n._currentContext.get(i)},n.setValue=function(i,r){var o=new e(n._currentContext);return o._currentContext.set(i,r),o},n.deleteValue=function(i){var r=new e(n._currentContext);return r._currentContext.delete(i),r}}return e})(),gee=new mee,yee=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var i=n.call(e),r,o=[],s;try{for(;(t===void 0||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(a){s={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(s)throw s.error}}return o},wee=function(e,t,n){if(n||arguments.length===2)for(var i=0,r=t.length,o;i<r;i++)(o||!(i in t))&&(o||(o=Array.prototype.slice.call(t,0,i)),o[i]=t[i]);return e.concat(o||Array.prototype.slice.call(t))},vee=(function(){function e(){}return e.prototype.active=function(){return gee},e.prototype.with=function(t,n,i){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];return n.call.apply(n,wee([i],yee(r),!1))},e.prototype.bind=function(t,n){return n},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e})(),bee=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var i=n.call(e),r,o=[],s;try{for(;(t===void 0||t-- >0)&&!(r=i.next()).done;)o.push(r.value)}catch(a){s={error:a}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(s)throw s.error}}return o},_ee=function(e,t,n){if(n||arguments.length===2)for(var i=0,r=t.length,o;i<r;i++)(o||!(i in t))&&(o||(o=Array.prototype.slice.call(t,0,i)),o[i]=t[i]);return e.concat(o||Array.prototype.slice.call(t))},Cg="context",See=new vee,c2=(function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(t){return x0(Cg,t,tp.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(t,n,i){for(var r,o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];return(r=this._getContextManager()).with.apply(r,_ee([t,n,i],bee(o),!1))},e.prototype.bind=function(t,n){return this._getContextManager().bind(t,n)},e.prototype._getContextManager=function(){return Bl(Cg)||See},e.prototype.disable=function(){this._getContextManager().disable(),k0(Cg,tp.instance())},e})(),My;(function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"})(My||(My={}));var l2="0000000000000000",u2="00000000000000000000000000000000",xee={traceId:u2,spanId:l2,traceFlags:My.NONE},_l=(function(){function e(t){t===void 0&&(t=xee),this._spanContext=t}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(t,n){return this},e.prototype.setAttributes=function(t){return this},e.prototype.addEvent=function(t,n){return this},e.prototype.addLink=function(t){return this},e.prototype.addLinks=function(t){return this},e.prototype.setStatus=function(t){return this},e.prototype.updateName=function(t){return this},e.prototype.end=function(t){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(t,n){},e})(),E0=hee("OpenTelemetry Context Key SPAN");function A0(e){return e.getValue(E0)||void 0}function kee(){return A0(c2.getInstance().active())}function T0(e,t){return e.setValue(E0,t)}function Eee(e){return e.deleteValue(E0)}function Aee(e,t){return T0(e,new _l(t))}function d2(e){var t;return(t=A0(e))===null||t===void 0?void 0:t.spanContext()}var Tee=/^([0-9a-f]{32})$/i,Iee=/^[0-9a-f]{16}$/i;function Nee(e){return Tee.test(e)&&e!==u2}function $ee(e){return Iee.test(e)&&e!==l2}function f2(e){return Nee(e.traceId)&&$ee(e.spanId)}function Cee(e){return new _l(e)}var Og=c2.getInstance(),p2=(function(){function e(){}return e.prototype.startSpan=function(t,n,i){i===void 0&&(i=Og.active());var r=!!n?.root;if(r)return new _l;var o=i&&d2(i);return Oee(o)&&f2(o)?new _l(o):new _l},e.prototype.startActiveSpan=function(t,n,i,r){var o,s,a;if(!(arguments.length<2)){arguments.length===2?a=n:arguments.length===3?(o=n,a=i):(o=n,s=i,a=r);var c=s??Og.active(),l=this.startSpan(t,o,c),u=T0(c,l);return Og.with(u,a,void 0,l)}},e})();function Oee(e){return typeof e=="object"&&typeof e.spanId=="string"&&typeof e.traceId=="string"&&typeof e.traceFlags=="number"}var Ree=new p2,Pee=(function(){function e(t,n,i,r){this._provider=t,this.name=n,this.version=i,this.options=r}return e.prototype.startSpan=function(t,n,i){return this._getTracer().startSpan(t,n,i)},e.prototype.startActiveSpan=function(t,n,i,r){var o=this._getTracer();return Reflect.apply(o.startActiveSpan,o,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var t=this._provider.getDelegateTracer(this.name,this.version,this.options);return t?(this._delegate=t,this._delegate):Ree},e})(),Dee=(function(){function e(){}return e.prototype.getTracer=function(t,n,i){return new p2},e})(),Uee=new Dee,sE=(function(){function e(){}return e.prototype.getTracer=function(t,n,i){var r;return(r=this.getDelegateTracer(t,n,i))!==null&&r!==void 0?r:new Pee(this,t,n,i)},e.prototype.getDelegate=function(){var t;return(t=this._delegate)!==null&&t!==void 0?t:Uee},e.prototype.setDelegate=function(t){this._delegate=t},e.prototype.getDelegateTracer=function(t,n,i){var r;return(r=this._delegate)===null||r===void 0?void 0:r.getTracer(t,n,i)},e})(),np;(function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"})(np||(np={}));var Rg="trace",Lee=(function(){function e(){this._proxyTracerProvider=new sE,this.wrapSpanContext=Cee,this.isSpanContextValid=f2,this.deleteSpan=Eee,this.getSpan=A0,this.getActiveSpan=kee,this.getSpanContext=d2,this.setSpan=T0,this.setSpanContext=Aee}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(t){var n=x0(Rg,this._proxyTracerProvider,tp.instance());return n&&this._proxyTracerProvider.setDelegate(t),n},e.prototype.getTracerProvider=function(){return Bl(Rg)||this._proxyTracerProvider},e.prototype.getTracer=function(t,n){return this.getTracerProvider().getTracer(t,n)},e.prototype.disable=function(){k0(Rg,tp.instance()),this._proxyTracerProvider=new sE},e})(),Mee=Lee.getInstance(),jee=Object.defineProperty,zee=(e,t)=>{for(var n in t)jee(e,n,{get:t[n],enumerable:!0})},h2="AI_InvalidArgumentError",m2=`vercel.ai.error.${h2}`,Bee=Symbol.for(m2),g2,Ii=class extends St{constructor({parameter:e,value:t,message:n}){super({name:h2,message:`Invalid argument for parameter ${e}: ${n}`}),this[g2]=!0,this.parameter=e,this.value=t}static isInstance(e){return St.hasMarker(e,m2)}};g2=Bee;var y2="AI_InvalidToolInputError",w2=`vercel.ai.error.${y2}`,Fee=Symbol.for(w2),v2,I0=class extends St{constructor({toolInput:e,toolName:t,cause:n,message:i=`Invalid input for tool ${t}: ${Yu(n)}`}){super({name:y2,message:i,cause:n}),this[v2]=!0,this.toolInput=e,this.toolName=t}static isInstance(e){return St.hasMarker(e,w2)}};v2=Fee;var b2="AI_NoObjectGeneratedError",_2=`vercel.ai.error.${b2}`,Wee=Symbol.for(_2),S2,Yo=class extends St{constructor({message:e="No object generated.",cause:t,text:n,response:i,usage:r,finishReason:o}){super({name:b2,message:e,cause:t}),this[S2]=!0,this.text=n,this.response=i,this.usage=r,this.finishReason=o}static isInstance(e){return St.hasMarker(e,_2)}};S2=Wee;var x2="AI_NoOutputGeneratedError",k2=`vercel.ai.error.${x2}`,Vee=Symbol.for(k2),E2,qee=class extends St{constructor({message:e="No output generated.",cause:t}={}){super({name:x2,message:e,cause:t}),this[E2]=!0}static isInstance(e){return St.hasMarker(e,k2)}};E2=Vee;var A2="AI_NoSuchToolError",T2=`vercel.ai.error.${A2}`,Hee=Symbol.for(T2),I2,jy=class extends St{constructor({toolName:e,availableTools:t=void 0,message:n=`Model tried to call unavailable tool '${e}'. ${t===void 0?"No tools are available.":`Available tools: ${t.join(", ")}.`}`}){super({name:A2,message:n}),this[I2]=!0,this.toolName=e,this.availableTools=t}static isInstance(e){return St.hasMarker(e,T2)}};I2=Hee;var N2="AI_ToolCallRepairError",$2=`vercel.ai.error.${N2}`,Kee=Symbol.for($2),C2,Jee=class extends St{constructor({cause:e,originalError:t,message:n=`Error repairing tool call: ${Yu(e)}`}){super({name:N2,message:n,cause:e}),this[C2]=!0,this.originalError=t}static isInstance(e){return St.hasMarker(e,$2)}};C2=Kee;var Gee=class extends St{constructor(e){super({name:"AI_UnsupportedModelVersionError",message:`Unsupported model version ${e.version} for provider "${e.provider}" and model "${e.modelId}". AI SDK 5 only supports models that implement specification version "v2".`}),this.version=e.version,this.provider=e.provider,this.modelId=e.modelId}},O2="AI_InvalidMessageRoleError",R2=`vercel.ai.error.${O2}`,Zee=Symbol.for(R2),P2,Qee=class extends St{constructor({role:e,message:t=`Invalid message role: '${e}'. Must be one of: "system", "user", "assistant", "tool".`}){super({name:O2,message:t}),this[P2]=!0,this.role=e}static isInstance(e){return St.hasMarker(e,R2)}};P2=Zee;var D2="AI_RetryError",U2=`vercel.ai.error.${D2}`,Yee=Symbol.for(U2),L2,aE=class extends St{constructor({message:e,reason:t,errors:n}){super({name:D2,message:e}),this[L2]=!0,this.reason=t,this.errors=n,this.lastError=n[n.length-1]}static isInstance(e){return St.hasMarker(e,U2)}};L2=Yee;function Xee({warning:e,provider:t,model:n}){const i=`AI SDK Warning (${t} / ${n}):`;switch(e.type){case"unsupported":{let r=`${i} The feature "${e.feature}" is not supported.`;return e.details&&(r+=` ${e.details}`),r}case"compatibility":{let r=`${i} The feature "${e.feature}" is used in a compatibility mode.`;return e.details&&(r+=` ${e.details}`),r}case"other":return`${i} ${e.message}`;default:return`${i} ${JSON.stringify(e,null,2)}`}}var ete="AI SDK Warning System: To turn off warning logging, set the AI_SDK_LOG_WARNINGS global to false.",cE=!1,M2=e=>{if(e.warnings.length===0)return;const t=globalThis.AI_SDK_LOG_WARNINGS;if(t!==!1){if(typeof t=="function"){t(e);return}cE||(cE=!0,console.info(ete));for(const n of e.warnings)console.warn(Xee({warning:n,provider:e.provider,model:e.model}))}};function tte({provider:e,modelId:t}){M2({warnings:[{type:"compatibility",feature:"specificationVersion",details:"Using v2 specification compatibility mode. Some features may not be available."}],provider:e,model:t})}function nte(e){return e.specificationVersion==="v3"?e:(tte({provider:e.provider,modelId:e.modelId}),new Proxy(e,{get(t,n){switch(n){case"specificationVersion":return"v3";case"doGenerate":return async(...i)=>{const r=await t.doGenerate(...i);return{...r,finishReason:j2(r.finishReason),usage:z2(r.usage)}};case"doStream":return async(...i)=>{const r=await t.doStream(...i);return{...r,stream:rte(r.stream)}};default:return t[n]}}}))}function rte(e){return e.pipeThrough(new TransformStream({transform(t,n){t.type==="finish"?n.enqueue({...t,finishReason:j2(t.finishReason),usage:z2(t.usage)}):n.enqueue(t)}}))}function j2(e){return{unified:e==="unknown"?"other":e,raw:void 0}}function z2(e){return{inputTokens:{total:e.inputTokens,noCache:void 0,cacheRead:e.cachedInputTokens,cacheWrite:void 0},outputTokens:{total:e.outputTokens,text:void 0,reasoning:e.reasoningTokens}}}function lE(e){if(typeof e!="string"){if(e.specificationVersion!=="v3"&&e.specificationVersion!=="v2"){const t=e;throw new Gee({version:t.specificationVersion,provider:t.provider,modelId:t.modelId})}return nte(e)}return ite().languageModel(e)}function ite(){var e;return(e=globalThis.AI_SDK_DEFAULT_PROVIDER)!=null?e:tee}var ote=[{mediaType:"image/gif",bytesPrefix:[71,73,70]},{mediaType:"image/png",bytesPrefix:[137,80,78,71]},{mediaType:"image/jpeg",bytesPrefix:[255,216]},{mediaType:"image/webp",bytesPrefix:[82,73,70,70,null,null,null,null,87,69,66,80]},{mediaType:"image/bmp",bytesPrefix:[66,77]},{mediaType:"image/tiff",bytesPrefix:[73,73,42,0]},{mediaType:"image/tiff",bytesPrefix:[77,77,0,42]},{mediaType:"image/avif",bytesPrefix:[0,0,0,32,102,116,121,112,97,118,105,102]},{mediaType:"image/heic",bytesPrefix:[0,0,0,32,102,116,121,112,104,101,105,99]}],ste=e=>{const t=typeof e=="string"?b0(e):e,n=(t[6]&127)<<21|(t[7]&127)<<14|(t[8]&127)<<7|t[9]&127;return t.slice(n+10)};function ate(e){return typeof e=="string"&&e.startsWith("SUQz")||typeof e!="string"&&e.length>10&&e[0]===73&&e[1]===68&&e[2]===51?ste(e):e}function cte({data:e,signatures:t}){const n=ate(e),i=typeof n=="string"?b0(n.substring(0,Math.min(n.length,24))):n;for(const r of t)if(i.length>=r.bytesPrefix.length&&r.bytesPrefix.every((o,s)=>o===null||i[s]===o))return r.mediaType}var B2="6.0.1",lte=async({url:e})=>{var t;const n=e.toString();try{const i=await fetch(n,{headers:td({},`ai-sdk/${B2}`,_0())});if(!i.ok)throw new Eg({url:n,statusCode:i.status,statusText:i.statusText});return{data:new Uint8Array(await i.arrayBuffer()),mediaType:(t=i.headers.get("content-type"))!=null?t:void 0}}catch(i){throw Eg.isInstance(i)?i:new Eg({url:n,cause:i})}},ute=(e=lte)=>t=>Promise.all(t.map(async n=>n.isUrlSupportedByModel?null:e(n)));function dte(e){try{const[t,n]=e.split(",");return{mediaType:t.split(";")[0].split(":")[1],base64Content:n}}catch{return{mediaType:void 0,base64Content:void 0}}}var F2=nn([W(),js(Uint8Array),js(ArrayBuffer),Qs(e=>{var t,n;return(n=(t=globalThis.Buffer)==null?void 0:t.isBuffer(e))!=null?n:!1},{message:"Must be a Buffer"})]);function W2(e){if(e instanceof Uint8Array)return{data:e,mediaType:void 0};if(e instanceof ArrayBuffer)return{data:new Uint8Array(e),mediaType:void 0};if(typeof e=="string")try{e=new URL(e)}catch{}if(e instanceof URL&&e.protocol==="data:"){const{mediaType:t,base64Content:n}=dte(e.toString());if(t==null||n==null)throw new St({name:"InvalidDataContentError",message:`Invalid data URL format in content ${e.toString()}`});return{data:n,mediaType:t}}return{data:e,mediaType:void 0}}function fte(e){return typeof e=="string"?e:e instanceof ArrayBuffer?Dy(new Uint8Array(e)):Dy(e)}function Xh(e){return e===void 0?[]:Array.isArray(e)?e:[e]}async function pte({prompt:e,supportedUrls:t,download:n=ute()}){const i=await mte(e.messages,n,t),r=[...e.system!=null?typeof e.system=="string"?[{role:"system",content:e.system}]:Xh(e.system).map(s=>({role:"system",content:s.content,providerOptions:s.providerOptions})):[],...e.messages.map(s=>hte({message:s,downloadedAssets:i}))],o=[];for(const s of r){if(s.role!=="tool"){o.push(s);continue}const a=o.at(-1);a?.role==="tool"?a.content.push(...s.content):o.push(s)}return o}function hte({message:e,downloadedAssets:t}){const n=e.role;switch(n){case"system":return{role:"system",content:e.content,providerOptions:e.providerOptions};case"user":return typeof e.content=="string"?{role:"user",content:[{type:"text",text:e.content}],providerOptions:e.providerOptions}:{role:"user",content:e.content.map(i=>gte(i,t)).filter(i=>i.type!=="text"||i.text!==""),providerOptions:e.providerOptions};case"assistant":return typeof e.content=="string"?{role:"assistant",content:[{type:"text",text:e.content}],providerOptions:e.providerOptions}:{role:"assistant",content:e.content.filter(i=>i.type!=="text"||i.text!==""||i.providerOptions!=null).filter(i=>i.type!=="tool-approval-request").map(i=>{const r=i.providerOptions;switch(i.type){case"file":{const{data:o,mediaType:s}=W2(i.data);return{type:"file",data:o,filename:i.filename,mediaType:s??i.mediaType,providerOptions:r}}case"reasoning":return{type:"reasoning",text:i.text,providerOptions:r};case"text":return{type:"text",text:i.text,providerOptions:r};case"tool-call":return{type:"tool-call",toolCallId:i.toolCallId,toolName:i.toolName,input:i.input,providerExecuted:i.providerExecuted,providerOptions:r};case"tool-result":return{type:"tool-result",toolCallId:i.toolCallId,toolName:i.toolName,output:uE(i.output),providerOptions:r}}}),providerOptions:e.providerOptions};case"tool":return{role:"tool",content:e.content.filter(i=>i.type!=="tool-approval-response").map(i=>({type:"tool-result",toolCallId:i.toolCallId,toolName:i.toolName,output:uE(i.output),providerOptions:i.providerOptions})),providerOptions:e.providerOptions};default:{const i=n;throw new Qee({role:i})}}}async function mte(e,t,n){const i=e.filter(o=>o.role==="user").map(o=>o.content).filter(o=>Array.isArray(o)).flat().filter(o=>o.type==="image"||o.type==="file").map(o=>{var s;const a=(s=o.mediaType)!=null?s:o.type==="image"?"image/*":void 0;let c=o.type==="image"?o.image:o.data;if(typeof c=="string")try{c=new URL(c)}catch{}return{mediaType:a,data:c}}).filter(o=>o.data instanceof URL).map(o=>({url:o.data,isUrlSupportedByModel:o.mediaType!=null&&SY({url:o.data.toString(),mediaType:o.mediaType,supportedUrls:n})})),r=await t(i);return Object.fromEntries(r.map((o,s)=>o==null?null:[i[s].url.toString(),{data:o.data,mediaType:o.mediaType}]).filter(o=>o!=null))}function gte(e,t){var n;if(e.type==="text")return{type:"text",text:e.text,providerOptions:e.providerOptions};let i;const r=e.type;switch(r){case"image":i=e.image;break;case"file":i=e.data;break;default:throw new Error(`Unsupported part type: ${r}`)}const{data:o,mediaType:s}=W2(i);let a=s??e.mediaType,c=o;if(c instanceof URL){const l=t[c.toString()];l&&(c=l.data,a??(a=l.mediaType))}switch(r){case"image":return(c instanceof Uint8Array||typeof c=="string")&&(a=(n=cte({data:c,signatures:ote}))!=null?n:a),{type:"file",mediaType:a??"image/*",filename:void 0,data:c,providerOptions:e.providerOptions};case"file":{if(a==null)throw new Error("Media type is missing for file part");return{type:"file",mediaType:a,filename:e.filename,data:c,providerOptions:e.providerOptions}}}}function uE(e){return e.type!=="content"?e:{type:"content",value:e.value.map(t=>t.type!=="media"?t:t.mediaType.startsWith("image/")?{type:"image-data",data:t.data,mediaType:t.mediaType}:{type:"file-data",data:t.data,mediaType:t.mediaType})}}async function cf({toolCallId:e,input:t,output:n,tool:i,errorMode:r}){return r==="text"?{type:"error-text",value:Yu(n)}:r==="json"?{type:"error-json",value:dE(n)}:i?.toModelOutput?await i.toModelOutput({toolCallId:e,input:t,output:n}):typeof n=="string"?{type:"text",value:n}:{type:"json",value:dE(n)}}function dE(e){return e===void 0?null:e}function fE({maxOutputTokens:e,temperature:t,topP:n,topK:i,presencePenalty:r,frequencyPenalty:o,seed:s,stopSequences:a}){if(e!=null){if(!Number.isInteger(e))throw new Ii({parameter:"maxOutputTokens",value:e,message:"maxOutputTokens must be an integer"});if(e<1)throw new Ii({parameter:"maxOutputTokens",value:e,message:"maxOutputTokens must be >= 1"})}if(t!=null&&typeof t!="number")throw new Ii({parameter:"temperature",value:t,message:"temperature must be a number"});if(n!=null&&typeof n!="number")throw new Ii({parameter:"topP",value:n,message:"topP must be a number"});if(i!=null&&typeof i!="number")throw new Ii({parameter:"topK",value:i,message:"topK must be a number"});if(r!=null&&typeof r!="number")throw new Ii({parameter:"presencePenalty",value:r,message:"presencePenalty must be a number"});if(o!=null&&typeof o!="number")throw new Ii({parameter:"frequencyPenalty",value:o,message:"frequencyPenalty must be a number"});if(s!=null&&!Number.isInteger(s))throw new Ii({parameter:"seed",value:s,message:"seed must be an integer"});return{maxOutputTokens:e,temperature:t,topP:n,topK:i,presencePenalty:r,frequencyPenalty:o,stopSequences:a,seed:s}}function yte(e){return e!=null&&Object.keys(e).length>0}async function wte({tools:e,toolChoice:t,activeTools:n}){if(!yte(e))return{tools:void 0,toolChoice:void 0};const i=n!=null?Object.entries(e).filter(([o])=>n.includes(o)):Object.entries(e),r=[];for(const[o,s]of i){const a=s.type;switch(a){case void 0:case"dynamic":case"function":r.push({type:"function",name:o,description:s.description,inputSchema:await Nc(s.inputSchema).jsonSchema,...s.inputExamples!=null?{inputExamples:s.inputExamples}:{},providerOptions:s.providerOptions,...s.strict!=null?{strict:s.strict}:{}});break;case"provider":r.push({type:"provider",name:o,id:s.id,args:s.args});break;default:{const c=a;throw new Error(`Unsupported tool type: ${c}`)}}}return{tools:r,toolChoice:t==null?{type:"auto"}:typeof t=="string"?{type:t}:{type:"tool",toolName:t.toolName}}}var Fl=Uu(()=>nn([$u(),W(),Lt(),nt(),rr(W(),Fl.optional()),yt(Fl)])),yn=rr(W(),rr(W(),Fl.optional())),V2=ce({type:_e("text"),text:W(),providerOptions:yn.optional()}),vte=ce({type:_e("image"),image:nn([F2,js(URL)]),mediaType:W().optional(),providerOptions:yn.optional()}),q2=ce({type:_e("file"),data:nn([F2,js(URL)]),filename:W().optional(),mediaType:W(),providerOptions:yn.optional()}),bte=ce({type:_e("reasoning"),text:W(),providerOptions:yn.optional()}),_te=ce({type:_e("tool-call"),toolCallId:W(),toolName:W(),input:Nt(),providerOptions:yn.optional(),providerExecuted:nt().optional()}),Ste=Fp("type",[ce({type:_e("text"),value:W(),providerOptions:yn.optional()}),ce({type:_e("json"),value:Fl,providerOptions:yn.optional()}),ce({type:_e("execution-denied"),reason:W().optional(),providerOptions:yn.optional()}),ce({type:_e("error-text"),value:W(),providerOptions:yn.optional()}),ce({type:_e("error-json"),value:Fl,providerOptions:yn.optional()}),ce({type:_e("content"),value:yt(nn([ce({type:_e("text"),text:W(),providerOptions:yn.optional()}),ce({type:_e("media"),data:W(),mediaType:W()}),ce({type:_e("file-data"),data:W(),mediaType:W(),filename:W().optional(),providerOptions:yn.optional()}),ce({type:_e("file-url"),url:W(),providerOptions:yn.optional()}),ce({type:_e("file-id"),fileId:nn([W(),rr(W(),W())]),providerOptions:yn.optional()}),ce({type:_e("image-data"),data:W(),mediaType:W(),providerOptions:yn.optional()}),ce({type:_e("image-url"),url:W(),providerOptions:yn.optional()}),ce({type:_e("image-file-id"),fileId:nn([W(),rr(W(),W())]),providerOptions:yn.optional()}),ce({type:_e("custom"),providerOptions:yn.optional()})]))})]),H2=ce({type:_e("tool-result"),toolCallId:W(),toolName:W(),output:Ste,providerOptions:yn.optional()}),xte=ce({type:_e("tool-approval-request"),approvalId:W(),toolCallId:W()}),kte=ce({type:_e("tool-approval-response"),approvalId:W(),approved:nt(),reason:W().optional()}),Ete=ce({role:_e("system"),content:W(),providerOptions:yn.optional()}),Ate=ce({role:_e("user"),content:nn([W(),yt(nn([V2,vte,q2]))]),providerOptions:yn.optional()}),Tte=ce({role:_e("assistant"),content:nn([W(),yt(nn([V2,q2,bte,_te,H2,xte]))]),providerOptions:yn.optional()}),Ite=ce({role:_e("tool"),content:yt(nn([H2,kte])),providerOptions:yn.optional()}),Nte=nn([Ete,Ate,Tte,Ite]);async function $te(e){if(e.prompt==null&&e.messages==null)throw new Sa({prompt:e,message:"prompt or messages must be defined"});if(e.prompt!=null&&e.messages!=null)throw new Sa({prompt:e,message:"prompt and messages cannot be defined at the same time"});if(e.system!=null&&typeof e.system!="string"&&!Xh(e.system).every(i=>typeof i=="object"&&i!==null&&"role"in i&&i.role==="system"))throw new Sa({prompt:e,message:"system must be a string, SystemModelMessage, or array of SystemModelMessage"});let t;if(e.prompt!=null&&typeof e.prompt=="string")t=[{role:"user",content:e.prompt}];else if(e.prompt!=null&&Array.isArray(e.prompt))t=e.prompt;else if(e.messages!=null)t=e.messages;else throw new Sa({prompt:e,message:"prompt or messages must be defined"});if(t.length===0)throw new Sa({prompt:e,message:"messages must not be empty"});const n=await zi({value:t,schema:yt(Nte)});if(!n.success)throw new Sa({prompt:e,message:"The messages do not match the ModelMessage[] schema.",cause:n.error});return{messages:t,system:e.system}}function Cte(e){if(!S0.isInstance(e))return e;const t=(process==null?void 0:"production")==="production",n="https://ai-sdk.dev/unauthenticated-ai-gateway";return t?new St({name:"GatewayError",message:`Unauthenticated. Configure AI_GATEWAY_API_KEY or use a provider module. Learn more: ${n}`}):Object.assign(new Error(`\x1B[1m\x1B[31mUnauthenticated request to AI Gateway.\x1B[0m

To authenticate, set the \x1B[33mAI_GATEWAY_API_KEY\x1B[0m environment variable with your API key.

Alternatively, you can use a provider module instead of the AI Gateway.

Learn more: \x1B[34m${n}\x1B[0m

`),{name:"GatewayAuthenticationError"})}function zy({operationId:e,telemetry:t}){return{"operation.name":`${e}${t?.functionId!=null?` ${t.functionId}`:""}`,"resource.name":t?.functionId,"ai.operationId":e,"ai.telemetry.functionId":t?.functionId}}function Ote({model:e,settings:t,telemetry:n,headers:i}){var r;return{"ai.model.provider":e.provider,"ai.model.id":e.modelId,...Object.entries(t).reduce((o,[s,a])=>(o[`ai.settings.${s}`]=a,o),{}),...Object.entries((r=n?.metadata)!=null?r:{}).reduce((o,[s,a])=>(o[`ai.telemetry.metadata.${s}`]=a,o),{}),...Object.entries(i??{}).reduce((o,[s,a])=>(a!==void 0&&(o[`ai.request.headers.${s}`]=a),o),{})}}var Rte={startSpan(){return Ld},startActiveSpan(e,t,n,i){if(typeof t=="function")return t(Ld);if(typeof n=="function")return n(Ld);if(typeof i=="function")return i(Ld)}},Ld={spanContext(){return Pte},setAttribute(){return this},setAttributes(){return this},addEvent(){return this},addLink(){return this},addLinks(){return this},setStatus(){return this},updateName(){return this},end(){return this},isRecording(){return!1},recordException(){return this}},Pte={traceId:"",spanId:"",traceFlags:0};function Dte({isEnabled:e=!1,tracer:t}={}){return e?t||Mee.getTracer("ai"):Rte}async function By({name:e,tracer:t,attributes:n,fn:i,endWhenDone:r=!0}){return t.startActiveSpan(e,{attributes:await n},async o=>{try{const s=await i(o);return r&&o.end(),s}catch(s){try{K2(o,s)}finally{o.end()}throw s}})}function K2(e,t){t instanceof Error?(e.recordException({name:t.name,message:t.message,stack:t.stack}),e.setStatus({code:np.ERROR,message:t.message})):e.setStatus({code:np.ERROR})}async function Ca({telemetry:e,attributes:t}){if(e?.isEnabled!==!0)return{};const n={};for(const[i,r]of Object.entries(t))if(r!=null){if(typeof r=="object"&&"input"in r&&typeof r.input=="function"){if(e?.recordInputs===!1)continue;const o=await r.input();o!=null&&(n[i]=o);continue}if(typeof r=="object"&&"output"in r&&typeof r.output=="function"){if(e?.recordOutputs===!1)continue;const o=await r.output();o!=null&&(n[i]=o);continue}n[i]=r}return n}function Ute(e){return JSON.stringify(e.map(t=>({...t,content:typeof t.content=="string"?t.content:t.content.map(n=>n.type==="file"?{...n,data:n.data instanceof Uint8Array?fte(n.data):n.data}:n)})))}function Lte(e){return{inputTokens:e.inputTokens.total,inputTokenDetails:{noCacheTokens:e.inputTokens.noCache,cacheReadTokens:e.inputTokens.cacheRead,cacheWriteTokens:e.inputTokens.cacheWrite},outputTokens:e.outputTokens.total,outputTokenDetails:{textTokens:e.outputTokens.text,reasoningTokens:e.outputTokens.reasoning},totalTokens:hi(e.inputTokens.total,e.outputTokens.total),raw:e.raw,reasoningTokens:e.outputTokens.reasoning,cachedInputTokens:e.inputTokens.cacheRead}}function Mte(e,t){var n,i,r,o,s,a,c,l,u,p;return{inputTokens:hi(e.inputTokens,t.inputTokens),inputTokenDetails:{noCacheTokens:hi((n=e.inputTokenDetails)==null?void 0:n.noCacheTokens,(i=t.inputTokenDetails)==null?void 0:i.noCacheTokens),cacheReadTokens:hi((r=e.inputTokenDetails)==null?void 0:r.cacheReadTokens,(o=t.inputTokenDetails)==null?void 0:o.cacheReadTokens),cacheWriteTokens:hi((s=e.inputTokenDetails)==null?void 0:s.cacheWriteTokens,(a=t.inputTokenDetails)==null?void 0:a.cacheWriteTokens)},outputTokens:hi(e.outputTokens,t.outputTokens),outputTokenDetails:{textTokens:hi((c=e.outputTokenDetails)==null?void 0:c.textTokens,(l=t.outputTokenDetails)==null?void 0:l.textTokens),reasoningTokens:hi((u=e.outputTokenDetails)==null?void 0:u.reasoningTokens,(p=t.outputTokenDetails)==null?void 0:p.reasoningTokens)},totalTokens:hi(e.totalTokens,t.totalTokens),reasoningTokens:hi(e.reasoningTokens,t.reasoningTokens),cachedInputTokens:hi(e.cachedInputTokens,t.cachedInputTokens)}}function hi(e,t){return e==null&&t==null?void 0:(e??0)+(t??0)}function J2(e,t){if(e===void 0&&t===void 0)return;if(e===void 0)return t;if(t===void 0)return e;const n={...e};for(const i in t)if(Object.prototype.hasOwnProperty.call(t,i)){const r=t[i];if(r===void 0)continue;const o=i in e?e[i]:void 0,s=r!==null&&typeof r=="object"&&!Array.isArray(r)&&!(r instanceof Date)&&!(r instanceof RegExp),a=o!=null&&typeof o=="object"&&!Array.isArray(o)&&!(o instanceof Date)&&!(o instanceof RegExp);s&&a?n[i]=J2(o,r):n[i]=r}return n}function jte({error:e,exponentialBackoffDelay:t}){const n=e.responseHeaders;if(!n)return t;let i;const r=n["retry-after-ms"];if(r){const s=parseFloat(r);Number.isNaN(s)||(i=s)}const o=n["retry-after"];if(o&&i===void 0){const s=parseFloat(o);Number.isNaN(s)?i=Date.parse(o)-Date.now():i=s*1e3}return i!=null&&!Number.isNaN(i)&&0<=i&&(i<60*1e3||i<t)?i:t}var zte=({maxRetries:e=2,initialDelayInMs:t=2e3,backoffFactor:n=2,abortSignal:i}={})=>async r=>G2(r,{maxRetries:e,delayInMs:t,backoffFactor:n,abortSignal:i});async function G2(e,{maxRetries:t,delayInMs:n,backoffFactor:i,abortSignal:r},o=[]){try{return await e()}catch(s){if(nc(s)||t===0)throw s;const a=VP(s),c=[...o,s],l=c.length;if(l>t)throw new aE({message:`Failed after ${l} attempts. Last error: ${a}`,reason:"maxRetriesExceeded",errors:c});if(s instanceof Error&&dr.isInstance(s)&&s.isRetryable===!0&&l<=t)return await mY(jte({error:s,exponentialBackoffDelay:n}),{abortSignal:r}),G2(e,{maxRetries:t,delayInMs:i*n,backoffFactor:i,abortSignal:r},c);throw l===1?s:new aE({message:`Failed after ${l} attempts with non-retryable error: '${a}'`,reason:"errorNotRetryable",errors:c})}}function Bte({maxRetries:e,abortSignal:t}){if(e!=null){if(!Number.isInteger(e))throw new Ii({parameter:"maxRetries",value:e,message:"maxRetries must be an integer"});if(e<0)throw new Ii({parameter:"maxRetries",value:e,message:"maxRetries must be >= 0"})}const n=e??2;return{maxRetries:n,retry:zte({maxRetries:n,abortSignal:t})}}function Fte({messages:e}){const t=e.at(-1);if(t?.role!="tool")return{approvedToolApprovals:[],deniedToolApprovals:[]};const n={};for(const c of e)if(c.role==="assistant"&&typeof c.content!="string"){const l=c.content;for(const u of l)u.type==="tool-call"&&(n[u.toolCallId]=u)}const i={};for(const c of e)if(c.role==="assistant"&&typeof c.content!="string"){const l=c.content;for(const u of l)u.type==="tool-approval-request"&&(i[u.approvalId]=u)}const r={};for(const c of t.content)c.type==="tool-result"&&(r[c.toolCallId]=c);const o=[],s=[],a=t.content.filter(c=>c.type==="tool-approval-response");for(const c of a){const l=i[c.approvalId];if(r[l.toolCallId]!=null)continue;const u={approvalRequest:l,approvalResponse:c,toolCall:n[l.toolCallId]};c.approved?o.push(u):s.push(u)}return{approvedToolApprovals:o,deniedToolApprovals:s}}async function Wte({toolCall:e,tools:t,tracer:n,telemetry:i,messages:r,abortSignal:o,experimental_context:s,onPreliminaryToolResult:a}){const{toolName:c,toolCallId:l,input:u}=e,p=t?.[c];if(p?.execute!=null)return By({name:"ai.toolCall",attributes:Ca({telemetry:i,attributes:{...zy({operationId:"ai.toolCall",telemetry:i}),"ai.toolCall.name":c,"ai.toolCall.id":l,"ai.toolCall.args":{output:()=>JSON.stringify(u)}}}),tracer:n,fn:async f=>{let g;try{const h=EX({execute:p.execute.bind(p),input:u,options:{toolCallId:l,messages:r,abortSignal:o,experimental_context:s}});for await(const d of h)d.type==="preliminary"?a?.({...e,type:"tool-result",output:d.output,preliminary:!0}):g=d.output}catch(h){return K2(f,h),{type:"tool-error",toolCallId:l,toolName:c,input:u,error:h,dynamic:p.type==="dynamic",...e.providerMetadata!=null?{providerMetadata:e.providerMetadata}:{}}}try{f.setAttributes(await Ca({telemetry:i,attributes:{"ai.toolCall.result":{output:()=>JSON.stringify(g)}}}))}catch{}return{type:"tool-result",toolCallId:l,toolName:c,input:u,output:g,dynamic:p.type==="dynamic",...e.providerMetadata!=null?{providerMetadata:e.providerMetadata}:{}}}})}function pE(e){const t=e.filter(n=>n.type==="text");if(t.length!==0)return t.map(n=>n.text).join("")}var Vte=class{constructor({data:e,mediaType:t}){const n=e instanceof Uint8Array;this.base64Data=n?void 0:e,this.uint8ArrayData=n?e:void 0,this.mediaType=t}get base64(){return this.base64Data==null&&(this.base64Data=Dy(this.uint8ArrayData)),this.base64Data}get uint8Array(){return this.uint8ArrayData==null&&(this.uint8ArrayData=b0(this.base64Data)),this.uint8ArrayData}};async function qte({tool:e,toolCall:t,messages:n,experimental_context:i}){return e.needsApproval==null?!1:typeof e.needsApproval=="boolean"?e.needsApproval:await e.needsApproval(t.input,{toolCallId:t.toolCallId,messages:n,experimental_context:i})}var Hte={};zee(Hte,{array:()=>Gte,choice:()=>Zte,json:()=>Qte,object:()=>Jte,text:()=>Z2});function Kte(e){const t=["ROOT"];let n=-1,i=null;function r(c,l,u){switch(c){case'"':{n=l,t.pop(),t.push(u),t.push("INSIDE_STRING");break}case"f":case"t":case"n":{n=l,i=l,t.pop(),t.push(u),t.push("INSIDE_LITERAL");break}case"-":{t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=l,t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"{":{n=l,t.pop(),t.push(u),t.push("INSIDE_OBJECT_START");break}case"[":{n=l,t.pop(),t.push(u),t.push("INSIDE_ARRAY_START");break}}}function o(c,l){switch(c){case",":{t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break}case"}":{n=l,t.pop();break}}}function s(c,l){switch(c){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=l,t.pop();break}}}for(let c=0;c<e.length;c++){const l=e[c];switch(t[t.length-1]){case"ROOT":r(l,c,"FINISH");break;case"INSIDE_OBJECT_START":{switch(l){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}case"}":{n=c,t.pop();break}}break}case"INSIDE_OBJECT_AFTER_COMMA":{l==='"'&&(t.pop(),t.push("INSIDE_OBJECT_KEY"));break}case"INSIDE_OBJECT_KEY":{l==='"'&&(t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY"));break}case"INSIDE_OBJECT_AFTER_KEY":{l===":"&&(t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE"));break}case"INSIDE_OBJECT_BEFORE_VALUE":{r(l,c,"INSIDE_OBJECT_AFTER_VALUE");break}case"INSIDE_OBJECT_AFTER_VALUE":{o(l,c);break}case"INSIDE_STRING":{switch(l){case'"':{t.pop(),n=c;break}case"\\":{t.push("INSIDE_STRING_ESCAPE");break}default:n=c}break}case"INSIDE_ARRAY_START":{l==="]"?(n=c,t.pop()):(n=c,r(l,c,"INSIDE_ARRAY_AFTER_VALUE"));break}case"INSIDE_ARRAY_AFTER_VALUE":{switch(l){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=c,t.pop();break}default:{n=c;break}}break}case"INSIDE_ARRAY_AFTER_COMMA":{r(l,c,"INSIDE_ARRAY_AFTER_VALUE");break}case"INSIDE_STRING_ESCAPE":{t.pop(),n=c;break}case"INSIDE_NUMBER":{switch(l){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=c;break}case"e":case"E":case"-":case".":break;case",":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&s(l,c),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&o(l,c);break}case"}":{t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&o(l,c);break}case"]":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&s(l,c);break}default:{t.pop();break}}break}case"INSIDE_LITERAL":{const p=e.substring(i,c+1);!"false".startsWith(p)&&!"true".startsWith(p)&&!"null".startsWith(p)?(t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"?o(l,c):t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&s(l,c)):n=c;break}}}let a=e.slice(0,n+1);for(let c=t.length-1;c>=0;c--)switch(t[c]){case"INSIDE_STRING":{a+='"';break}case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":{a+="}";break}case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":{a+="]";break}case"INSIDE_LITERAL":{const u=e.substring(i,e.length);"true".startsWith(u)?a+="true".slice(u.length):"false".startsWith(u)?a+="false".slice(u.length):"null".startsWith(u)&&(a+="null".slice(u.length))}}return a}async function em(e){if(e===void 0)return{value:void 0,state:"undefined-input"};let t=await Si({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=await Si({text:Kte(e)}),t.success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"})}var Z2=()=>({responseFormat:Promise.resolve({type:"text"}),async parseCompleteOutput({text:e}){return e},async parsePartialOutput({text:e}){return{partial:e}}}),Jte=({schema:e,name:t,description:n})=>{const i=Nc(e);return{responseFormat:si(i.jsonSchema).then(r=>({type:"json",schema:r,...t!=null&&{name:t},...n!=null&&{description:n}})),async parseCompleteOutput({text:r},o){const s=await Si({text:r});if(!s.success)throw new Yo({message:"No object generated: could not parse the response.",cause:s.error,text:r,response:o.response,usage:o.usage,finishReason:o.finishReason});const a=await zi({value:s.value,schema:i});if(!a.success)throw new Yo({message:"No object generated: response did not match schema.",cause:a.error,text:r,response:o.response,usage:o.usage,finishReason:o.finishReason});return a.value},async parsePartialOutput({text:r}){const o=await em(r);switch(o.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return{partial:o.value}}}}},Gte=({element:e,name:t,description:n})=>{const i=Nc(e);return{responseFormat:si(i.jsonSchema).then(r=>{const{$schema:o,...s}=r;return{type:"json",schema:{$schema:"http://json-schema.org/draft-07/schema#",type:"object",properties:{elements:{type:"array",items:s}},required:["elements"],additionalProperties:!1},...t!=null&&{name:t},...n!=null&&{description:n}}}),async parseCompleteOutput({text:r},o){const s=await Si({text:r});if(!s.success)throw new Yo({message:"No object generated: could not parse the response.",cause:s.error,text:r,response:o.response,usage:o.usage,finishReason:o.finishReason});const a=s.value;if(a==null||typeof a!="object"||!("elements"in a)||!Array.isArray(a.elements))throw new Yo({message:"No object generated: response did not match schema.",cause:new Ks({value:a,cause:"response must be an object with an elements array"}),text:r,response:o.response,usage:o.usage,finishReason:o.finishReason});for(const c of a.elements){const l=await zi({value:c,schema:i});if(!l.success)throw new Yo({message:"No object generated: response did not match schema.",cause:l.error,text:r,response:o.response,usage:o.usage,finishReason:o.finishReason})}return a.elements},async parsePartialOutput({text:r}){const o=await em(r);switch(o.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":{const s=o.value;if(s==null||typeof s!="object"||!("elements"in s)||!Array.isArray(s.elements))return;const a=o.state==="repaired-parse"&&s.elements.length>0?s.elements.slice(0,-1):s.elements,c=[];for(const l of a){const u=await zi({value:l,schema:i});u.success&&c.push(u.value)}return{partial:c}}}}}},Zte=({options:e,name:t,description:n})=>({responseFormat:Promise.resolve({type:"json",schema:{$schema:"http://json-schema.org/draft-07/schema#",type:"object",properties:{result:{type:"string",enum:e}},required:["result"],additionalProperties:!1},...t!=null&&{name:t},...n!=null&&{description:n}}),async parseCompleteOutput({text:i},r){const o=await Si({text:i});if(!o.success)throw new Yo({message:"No object generated: could not parse the response.",cause:o.error,text:i,response:r.response,usage:r.usage,finishReason:r.finishReason});const s=o.value;if(s==null||typeof s!="object"||!("result"in s)||typeof s.result!="string"||!e.includes(s.result))throw new Yo({message:"No object generated: response did not match schema.",cause:new Ks({value:s,cause:"response must be an object that contains a choice value."}),text:i,response:r.response,usage:r.usage,finishReason:r.finishReason});return s.result},async parsePartialOutput({text:i}){const r=await em(i);switch(r.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":{const o=r.value;if(o==null||typeof o!="object"||!("result"in o)||typeof o.result!="string")return;const s=e.filter(a=>a.startsWith(o.result));return r.state==="successful-parse"?s.includes(o.result)?{partial:o.result}:void 0:s.length===1?{partial:s[0]}:void 0}}}}),Qte=({name:e,description:t}={})=>({responseFormat:Promise.resolve({type:"json",...e!=null&&{name:e},...t!=null&&{description:t}}),async parseCompleteOutput({text:n},i){const r=await Si({text:n});if(!r.success)throw new Yo({message:"No object generated: could not parse the response.",cause:r.error,text:n,response:i.response,usage:i.usage,finishReason:i.finishReason});return r.value},async parsePartialOutput({text:n}){const i=await em(n);switch(i.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return i.value===void 0?void 0:{partial:i.value}}}});async function Yte({toolCall:e,tools:t,repairToolCall:n,system:i,messages:r}){var o;try{if(t==null){if(e.providerExecuted&&e.dynamic)return await Q2(e);throw new jy({toolName:e.toolName})}try{return await hE({toolCall:e,tools:t})}catch(s){if(n==null||!(jy.isInstance(s)||I0.isInstance(s)))throw s;let a=null;try{a=await n({toolCall:e,tools:t,inputSchema:async({toolName:c})=>{const{inputSchema:l}=t[c];return await Nc(l).jsonSchema},system:i,messages:r,error:s})}catch(c){throw new Jee({cause:c,originalError:s})}if(a==null)throw s;return await hE({toolCall:a,tools:t})}}catch(s){const a=await Si({text:e.input}),c=a.success?a.value:e.input;return{type:"tool-call",toolCallId:e.toolCallId,toolName:e.toolName,input:c,dynamic:!0,invalid:!0,error:s,title:(o=t?.[e.toolName])==null?void 0:o.title,providerExecuted:e.providerExecuted,providerMetadata:e.providerMetadata}}}async function Q2(e){const t=e.input.trim()===""?{success:!0,value:{}}:await Si({text:e.input});if(t.success===!1)throw new I0({toolName:e.toolName,toolInput:e.input,cause:t.error});return{type:"tool-call",toolCallId:e.toolCallId,toolName:e.toolName,input:t.value,providerExecuted:!0,dynamic:!0,providerMetadata:e.providerMetadata}}async function hE({toolCall:e,tools:t}){const n=e.toolName,i=t[n];if(i==null){if(e.providerExecuted&&e.dynamic)return await Q2(e);throw new jy({toolName:e.toolName,availableTools:Object.keys(t)})}const r=Nc(i.inputSchema),o=e.input.trim()===""?await zi({value:{},schema:r}):await Si({text:e.input,schema:r});if(o.success===!1)throw new I0({toolName:n,toolInput:e.input,cause:o.error});return i.type==="dynamic"?{type:"tool-call",toolCallId:e.toolCallId,toolName:e.toolName,input:o.value,providerExecuted:e.providerExecuted,providerMetadata:e.providerMetadata,dynamic:!0,title:i.title}:{type:"tool-call",toolCallId:e.toolCallId,toolName:n,input:o.value,providerExecuted:e.providerExecuted,providerMetadata:e.providerMetadata,title:i.title}}var Xte=class{constructor({content:e,finishReason:t,rawFinishReason:n,usage:i,warnings:r,request:o,response:s,providerMetadata:a}){this.content=e,this.finishReason=t,this.rawFinishReason=n,this.usage=i,this.warnings=r,this.request=o,this.response=s,this.providerMetadata=a}get text(){return this.content.filter(e=>e.type==="text").map(e=>e.text).join("")}get reasoning(){return this.content.filter(e=>e.type==="reasoning")}get reasoningText(){return this.reasoning.length===0?void 0:this.reasoning.map(e=>e.text).join("")}get files(){return this.content.filter(e=>e.type==="file").map(e=>e.file)}get sources(){return this.content.filter(e=>e.type==="source")}get toolCalls(){return this.content.filter(e=>e.type==="tool-call")}get staticToolCalls(){return this.toolCalls.filter(e=>e.dynamic!==!0)}get dynamicToolCalls(){return this.toolCalls.filter(e=>e.dynamic===!0)}get toolResults(){return this.content.filter(e=>e.type==="tool-result")}get staticToolResults(){return this.toolResults.filter(e=>e.dynamic!==!0)}get dynamicToolResults(){return this.toolResults.filter(e=>e.dynamic===!0)}};function ene(e){return({steps:t})=>t.length===e}async function tne({stopConditions:e,steps:t}){return(await Promise.all(e.map(n=>n({steps:t})))).some(n=>n)}async function nne({content:e,tools:t}){const n=[],i=[];for(const o of e)if(!(o.type==="source"||(o.type==="tool-result"||o.type==="tool-error")&&!o.providerExecuted||o.type==="text"&&o.text.length===0))switch(o.type){case"text":i.push({type:"text",text:o.text,providerOptions:o.providerMetadata});break;case"reasoning":i.push({type:"reasoning",text:o.text,providerOptions:o.providerMetadata});break;case"file":i.push({type:"file",data:o.file.base64,mediaType:o.file.mediaType,providerOptions:o.providerMetadata});break;case"tool-call":i.push({type:"tool-call",toolCallId:o.toolCallId,toolName:o.toolName,input:o.input,providerExecuted:o.providerExecuted,providerOptions:o.providerMetadata});break;case"tool-result":{const s=await cf({toolCallId:o.toolCallId,input:o.input,tool:t?.[o.toolName],output:o.output,errorMode:"none"});i.push({type:"tool-result",toolCallId:o.toolCallId,toolName:o.toolName,output:s,providerOptions:o.providerMetadata});break}case"tool-error":{const s=await cf({toolCallId:o.toolCallId,input:o.input,tool:t?.[o.toolName],output:o.error,errorMode:"json"});i.push({type:"tool-result",toolCallId:o.toolCallId,toolName:o.toolName,output:s,providerOptions:o.providerMetadata});break}case"tool-approval-request":i.push({type:"tool-approval-request",approvalId:o.approvalId,toolCallId:o.toolCall.toolCallId});break}i.length>0&&n.push({role:"assistant",content:i});const r=[];for(const o of e){if(!(o.type==="tool-result"||o.type==="tool-error")||o.providerExecuted)continue;const s=await cf({toolCallId:o.toolCallId,input:o.input,tool:t?.[o.toolName],output:o.type==="tool-result"?o.output:o.error,errorMode:o.type==="tool-error"?"text":"none"});r.push({type:"tool-result",toolCallId:o.toolCallId,toolName:o.toolName,output:s,...o.providerMetadata!=null?{providerOptions:o.providerMetadata}:{}})}return r.length>0&&n.push({role:"tool",content:r}),n}var rne=ed({prefix:"aitxt",size:24});async function Kie({model:e,tools:t,toolChoice:n,system:i,prompt:r,messages:o,maxRetries:s,abortSignal:a,headers:c,stopWhen:l=ene(1),experimental_output:u,output:p=u,experimental_telemetry:f,providerOptions:g,experimental_activeTools:h,activeTools:d=h,experimental_prepareStep:y,prepareStep:v=y,experimental_repairToolCall:x,experimental_download:E,experimental_context:N,_internal:{generateId:C=rne,currentDate:b=()=>new Date}={},onStepFinish:P,onFinish:$,...k}){const D=lE(e),B=Xh(l),{maxRetries:J,retry:S}=Bte({maxRetries:s,abortSignal:a}),T=fE(k),z=td(c??{},`ai/${B2}`),L=Ote({model:D,telemetry:f,headers:z,settings:{...T,maxRetries:J}}),q=await $te({system:i,prompt:r,messages:o}),V=Dte(f);try{return await By({name:"ai.generateText",attributes:Ca({telemetry:f,attributes:{...zy({operationId:"ai.generateText",telemetry:f}),...L,"ai.model.provider":D.provider,"ai.model.id":D.modelId,"ai.prompt":{input:()=>JSON.stringify({system:i,prompt:r,messages:o})}}}),tracer:V,fn:async K=>{var oe,ne,X,ae,he,ge,pe,fe;const xe=q.messages,Ce=[],{approvedToolApprovals:Ze,deniedToolApprovals:st}=Fte({messages:xe});if(st.length>0||Ze.length>0){const Le=await mE({toolCalls:Ze.map(Oe=>Oe.toolCall),tools:t,tracer:V,telemetry:f,messages:xe,abortSignal:a,experimental_context:N}),Be=[];for(const Oe of Le){const kn=await cf({toolCallId:Oe.toolCallId,input:Oe.input,tool:t?.[Oe.toolName],output:Oe.type==="tool-result"?Oe.output:Oe.error,errorMode:Oe.type==="tool-error"?"json":"none"});Be.push({type:"tool-result",toolCallId:Oe.toolCallId,toolName:Oe.toolName,output:kn})}for(const Oe of st)Be.push({type:"tool-result",toolCallId:Oe.toolCall.toolCallId,toolName:Oe.toolCall.toolName,output:{type:"execution-denied",reason:Oe.approvalResponse.reason}});Ce.push({role:"tool",content:Be})}const Ke=fE(k);let we,Ue=[],Ct=[];const Ie=[],We=new Map;do{const Le=[...xe,...Ce],Be=await v?.({model:D,steps:Ie,stepNumber:Ie.length,messages:Le,experimental_context:N}),Oe=lE((oe=Be?.model)!=null?oe:D),kn=await pte({prompt:{system:(ne=Be?.system)!=null?ne:q.system,messages:(X=Be?.messages)!=null?X:Le},supportedUrls:await Oe.supportedUrls,download:E});N=(ae=Be?.experimental_context)!=null?ae:N;const{toolChoice:En,tools:Xt}=await wte({tools:t,toolChoice:(he=Be?.toolChoice)!=null?he:n,activeTools:(ge=Be?.activeTools)!=null?ge:d});we=await S(()=>{var ee;return By({name:"ai.generateText.doGenerate",attributes:Ca({telemetry:f,attributes:{...zy({operationId:"ai.generateText.doGenerate",telemetry:f}),...L,"ai.model.provider":Oe.provider,"ai.model.id":Oe.modelId,"ai.prompt.messages":{input:()=>Ute(kn)},"ai.prompt.tools":{input:()=>Xt?.map(de=>JSON.stringify(de))},"ai.prompt.toolChoice":{input:()=>En!=null?JSON.stringify(En):void 0},"gen_ai.system":Oe.provider,"gen_ai.request.model":Oe.modelId,"gen_ai.request.frequency_penalty":k.frequencyPenalty,"gen_ai.request.max_tokens":k.maxOutputTokens,"gen_ai.request.presence_penalty":k.presencePenalty,"gen_ai.request.stop_sequences":k.stopSequences,"gen_ai.request.temperature":(ee=k.temperature)!=null?ee:void 0,"gen_ai.request.top_k":k.topK,"gen_ai.request.top_p":k.topP}}),tracer:V,fn:async de=>{var wt,kt,Et,dt,It,Jr,Hi,ca;const ui=J2(g,Be?.providerOptions),vn=await Oe.doGenerate({...Ke,tools:Xt,toolChoice:En,responseFormat:await p?.responseFormat,prompt:kn,providerOptions:ui,abortSignal:a,headers:z}),Er={id:(kt=(wt=vn.response)==null?void 0:wt.id)!=null?kt:C(),timestamp:(dt=(Et=vn.response)==null?void 0:Et.timestamp)!=null?dt:b(),modelId:(Jr=(It=vn.response)==null?void 0:It.modelId)!=null?Jr:Oe.modelId,headers:(Hi=vn.response)==null?void 0:Hi.headers,body:(ca=vn.response)==null?void 0:ca.body};return de.setAttributes(await Ca({telemetry:f,attributes:{"ai.response.finishReason":vn.finishReason.unified,"ai.response.text":{output:()=>pE(vn.content)},"ai.response.toolCalls":{output:()=>{const gr=gE(vn.content);return gr==null?void 0:JSON.stringify(gr)}},"ai.response.id":Er.id,"ai.response.model":Er.modelId,"ai.response.timestamp":Er.timestamp.toISOString(),"ai.response.providerMetadata":JSON.stringify(vn.providerMetadata),"ai.usage.promptTokens":vn.usage.inputTokens.total,"ai.usage.completionTokens":vn.usage.outputTokens.total,"gen_ai.response.finish_reasons":[vn.finishReason.unified],"gen_ai.response.id":Er.id,"gen_ai.response.model":Er.modelId,"gen_ai.usage.input_tokens":vn.usage.inputTokens.total,"gen_ai.usage.output_tokens":vn.usage.outputTokens.total}})),{...vn,response:Er}}})});const w=await Promise.all(we.content.filter(ee=>ee.type==="tool-call").map(ee=>Yte({toolCall:ee,tools:t,repairToolCall:x,system:i,messages:Le}))),I={};for(const ee of w){if(ee.invalid)continue;const de=t?.[ee.toolName];de!=null&&(de?.onInputAvailable!=null&&await de.onInputAvailable({input:ee.input,toolCallId:ee.toolCallId,messages:Le,abortSignal:a,experimental_context:N}),await qte({tool:de,toolCall:ee,messages:Le,experimental_context:N})&&(I[ee.toolCallId]={type:"tool-approval-request",approvalId:C(),toolCall:ee}))}const U=w.filter(ee=>ee.invalid&&ee.dynamic);Ct=[];for(const ee of U)Ct.push({type:"tool-error",toolCallId:ee.toolCallId,toolName:ee.toolName,input:ee.input,error:VP(ee.error),dynamic:!0});Ue=w.filter(ee=>!ee.providerExecuted),t!=null&&Ct.push(...await mE({toolCalls:Ue.filter(ee=>!ee.invalid&&I[ee.toolCallId]==null),tools:t,tracer:V,telemetry:f,messages:Le,abortSignal:a,experimental_context:N}));for(const ee of w){if(!ee.providerExecuted)continue;const de=t?.[ee.toolName];de?.type==="provider"&&de.supportsDeferredResults&&(we.content.some(kt=>kt.type==="tool-result"&&kt.toolCallId===ee.toolCallId)||We.set(ee.toolCallId,{toolName:ee.toolName}))}for(const ee of we.content)ee.type==="tool-result"&&We.delete(ee.toolCallId);const G=one({content:we.content,toolCalls:w,toolOutputs:Ct,toolApprovalRequests:Object.values(I),tools:t});Ce.push(...await nne({content:G,tools:t}));const Q=new Xte({content:G,finishReason:we.finishReason.unified,rawFinishReason:we.finishReason.raw,usage:Lte(we.usage),warnings:we.warnings,providerMetadata:we.providerMetadata,request:(pe=we.request)!=null?pe:{},response:{...we.response,messages:structuredClone(Ce)}});M2({warnings:(fe=we.warnings)!=null?fe:[],provider:Oe.provider,model:Oe.modelId}),Ie.push(Q),await P?.(Q)}while((Ue.length>0&&Ct.length===Ue.length||We.size>0)&&!await tne({stopConditions:B,steps:Ie}));K.setAttributes(await Ca({telemetry:f,attributes:{"ai.response.finishReason":we.finishReason.unified,"ai.response.text":{output:()=>pE(we.content)},"ai.response.toolCalls":{output:()=>{const Le=gE(we.content);return Le==null?void 0:JSON.stringify(Le)}},"ai.response.providerMetadata":JSON.stringify(we.providerMetadata),"ai.usage.promptTokens":we.usage.inputTokens.total,"ai.usage.completionTokens":we.usage.outputTokens.total}}));const Ge=Ie[Ie.length-1],_t=Ie.reduce((Le,Be)=>Mte(Le,Be.usage),{inputTokens:void 0,outputTokens:void 0,totalTokens:void 0,reasoningTokens:void 0,cachedInputTokens:void 0});await $?.({finishReason:Ge.finishReason,rawFinishReason:Ge.rawFinishReason,usage:Ge.usage,content:Ge.content,text:Ge.text,reasoningText:Ge.reasoningText,reasoning:Ge.reasoning,files:Ge.files,sources:Ge.sources,toolCalls:Ge.toolCalls,staticToolCalls:Ge.staticToolCalls,dynamicToolCalls:Ge.dynamicToolCalls,toolResults:Ge.toolResults,staticToolResults:Ge.staticToolResults,dynamicToolResults:Ge.dynamicToolResults,request:Ge.request,response:Ge.response,warnings:Ge.warnings,providerMetadata:Ge.providerMetadata,steps:Ie,totalUsage:_t,experimental_context:N});let vt;return Ge.finishReason==="stop"&&(vt=await(p??Z2()).parseCompleteOutput({text:Ge.text},{response:Ge.response,usage:Ge.usage,finishReason:Ge.finishReason})),new ine({steps:Ie,totalUsage:_t,output:vt})}})}catch(K){throw Cte(K)}}async function mE({toolCalls:e,tools:t,tracer:n,telemetry:i,messages:r,abortSignal:o,experimental_context:s}){return(await Promise.all(e.map(async c=>Wte({toolCall:c,tools:t,tracer:n,telemetry:i,messages:r,abortSignal:o,experimental_context:s})))).filter(c=>c!=null)}var ine=class{constructor(e){this.steps=e.steps,this._output=e.output,this.totalUsage=e.totalUsage}get finalStep(){return this.steps[this.steps.length-1]}get content(){return this.finalStep.content}get text(){return this.finalStep.text}get files(){return this.finalStep.files}get reasoningText(){return this.finalStep.reasoningText}get reasoning(){return this.finalStep.reasoning}get toolCalls(){return this.finalStep.toolCalls}get staticToolCalls(){return this.finalStep.staticToolCalls}get dynamicToolCalls(){return this.finalStep.dynamicToolCalls}get toolResults(){return this.finalStep.toolResults}get staticToolResults(){return this.finalStep.staticToolResults}get dynamicToolResults(){return this.finalStep.dynamicToolResults}get sources(){return this.finalStep.sources}get finishReason(){return this.finalStep.finishReason}get rawFinishReason(){return this.finalStep.rawFinishReason}get warnings(){return this.finalStep.warnings}get providerMetadata(){return this.finalStep.providerMetadata}get response(){return this.finalStep.response}get request(){return this.finalStep.request}get usage(){return this.finalStep.usage}get experimental_output(){return this.output}get output(){if(this._output==null)throw new qee;return this._output}};function gE(e){const t=e.filter(n=>n.type==="tool-call");if(t.length!==0)return t.map(n=>({toolCallId:n.toolCallId,toolName:n.toolName,input:n.input}))}function one({content:e,toolCalls:t,toolOutputs:n,toolApprovalRequests:i,tools:r}){const o=[];for(const s of e)switch(s.type){case"text":case"reasoning":case"source":o.push(s);break;case"file":{o.push({type:"file",file:new Vte(s),...s.providerMetadata!=null?{providerMetadata:s.providerMetadata}:{}});break}case"tool-call":{o.push(t.find(a=>a.toolCallId===s.toolCallId));break}case"tool-result":{const a=t.find(c=>c.toolCallId===s.toolCallId);if(a==null){const c=r?.[s.toolName];if(!(c?.type==="provider"&&c.supportsDeferredResults))throw new Error(`Tool call ${s.toolCallId} not found.`);s.isError?o.push({type:"tool-error",toolCallId:s.toolCallId,toolName:s.toolName,input:void 0,error:s.result,providerExecuted:!0,dynamic:s.dynamic}):o.push({type:"tool-result",toolCallId:s.toolCallId,toolName:s.toolName,input:void 0,output:s.result,providerExecuted:!0,dynamic:s.dynamic});break}s.isError?o.push({type:"tool-error",toolCallId:s.toolCallId,toolName:s.toolName,input:a.input,error:s.result,providerExecuted:!0,dynamic:a.dynamic}):o.push({type:"tool-result",toolCallId:s.toolCallId,toolName:s.toolName,input:a.input,output:s.result,providerExecuted:!0,dynamic:a.dynamic});break}}return[...o,...n,...i]}(class extends TransformStream{constructor(){super({transform(e,t){t.enqueue(`data: ${JSON.stringify(e)}

`)},flush(e){e.enqueue(`data: [DONE]

`)}})}});function sne(e){return e.type.startsWith("data-")}function ane(e){return e.type.startsWith("tool-")}function cne(e){return e.type==="dynamic-tool"}function Y2(e){return ane(e)||cne(e)}var lne=Y2;ed({prefix:"aitxt",size:24});ed({prefix:"aiobj",size:24});ed({prefix:"aiobj",size:24});function une(e,t){if(t.length===0)return null;const n=e.indexOf(t);if(n!==-1)return n;for(let i=e.length-1;i>=0;i--){const r=e.substring(i);if(t.startsWith(r))return i}return null}function Jie({tagName:e,separator:t=`
`,startWithReasoning:n=!1}){const i=`<${e}>`,r=`</${e}>`;return{specificationVersion:"v3",wrapGenerate:async({doGenerate:o})=>{const{content:s,...a}=await o(),c=[];for(const l of s){if(l.type!=="text"){c.push(l);continue}const u=n?i+l.text:l.text,p=new RegExp(`${i}(.*?)${r}`,"gs"),f=Array.from(u.matchAll(p));if(!f.length){c.push(l);continue}const g=f.map(d=>d[1]).join(t);let h=u;for(let d=f.length-1;d>=0;d--){const y=f[d],v=h.slice(0,y.index),x=h.slice(y.index+y[0].length);h=v+(v.length>0&&x.length>0?t:"")+x}c.push({type:"reasoning",text:g}),c.push({type:"text",text:h})}return{content:c,...a}},wrapStream:async({doStream:o})=>{const{stream:s,...a}=await o(),c={};let l;return{stream:s.pipeThrough(new TransformStream({transform:(u,p)=>{if(u.type==="text-start"){l=u;return}if(u.type==="text-end"&&l&&(p.enqueue(l),l=void 0),u.type!=="text-delta"){p.enqueue(u);return}c[u.id]==null&&(c[u.id]={isFirstReasoning:!0,isFirstText:!0,afterSwitch:!1,isReasoning:n,buffer:"",idCounter:0,textId:u.id});const f=c[u.id];f.buffer+=u.delta;function g(h){if(h.length>0){const d=f.afterSwitch&&(f.isReasoning?!f.isFirstReasoning:!f.isFirstText)?t:"";f.isReasoning&&(f.afterSwitch||f.isFirstReasoning)&&p.enqueue({type:"reasoning-start",id:`reasoning-${f.idCounter}`}),f.isReasoning?p.enqueue({type:"reasoning-delta",delta:d+h,id:`reasoning-${f.idCounter}`}):(l&&(p.enqueue(l),l=void 0),p.enqueue({type:"text-delta",delta:d+h,id:f.textId})),f.afterSwitch=!1,f.isReasoning?f.isFirstReasoning=!1:f.isFirstText=!1}}do{const h=f.isReasoning?r:i,d=une(f.buffer,h);if(d==null){g(f.buffer),f.buffer="";break}if(g(f.buffer.slice(0,d)),d+h.length<=f.buffer.length)f.buffer=f.buffer.slice(d+h.length),f.isReasoning&&p.enqueue({type:"reasoning-end",id:`reasoning-${f.idCounter++}`}),f.isReasoning=!f.isReasoning,f.afterSwitch=!0;else{f.buffer=f.buffer.slice(d);break}}while(!0)}})),...a}}}}var Gie=({model:e,middleware:t,modelId:n,providerId:i})=>[...Xh(t)].reverse().reduce((r,o)=>dne({model:r,middleware:o,modelId:n,providerId:i}),e),dne=({model:e,middleware:{transformParams:t,wrapGenerate:n,wrapStream:i,overrideProvider:r,overrideModelId:o,overrideSupportedUrls:s},modelId:a,providerId:c})=>{var l,u,p;async function f({params:g,type:h}){return t?await t({params:g,type:h,model:e}):g}return{specificationVersion:"v3",provider:(l=c??r?.({model:e}))!=null?l:e.provider,modelId:(u=a??o?.({model:e}))!=null?u:e.modelId,supportedUrls:(p=s?.({model:e}))!=null?p:e.supportedUrls,async doGenerate(g){const h=await f({params:g,type:"generate"}),d=async()=>e.doGenerate(h);return n?n({doGenerate:d,doStream:async()=>e.doStream(h),params:h,model:e}):d()},async doStream(g){const h=await f({params:g,type:"stream"}),d=async()=>e.doGenerate(h),y=async()=>e.doStream(h);return i?i({doGenerate:d,doStream:y,params:h,model:e}):y()}}};const Yn=Nt().optional(),fne=ce({type:_e("text"),text:W(),state:Eo(["streaming","done"]).optional(),providerMetadata:Yn}),pne=ce({type:_e("reasoning"),text:W(),state:Eo(["streaming","done"]).optional(),providerMetadata:Yn}),hne=ce({type:_e("file"),mediaType:W(),filename:W().optional(),url:W(),providerMetadata:Yn}),mne=ce({type:_e("source-url"),sourceId:W(),url:W(),title:W().optional(),providerMetadata:Yn}),gne=ce({type:_e("source-document"),sourceId:W(),mediaType:W(),title:W(),filename:W().optional(),providerMetadata:Yn}),yne=ce({type:_e("step-start")}),wne=ce({type:W().startsWith("data-"),id:W().optional(),data:Nt()}),vne=ce({type:W().startsWith("tool-"),toolCallId:W(),state:_e("input-streaming"),providerExecuted:nt().optional(),input:Nt().optional(),output:gt().optional(),errorText:gt().optional(),approval:gt().optional()}),bne=ce({type:W().startsWith("tool-"),toolCallId:W(),state:_e("input-available"),providerExecuted:nt().optional(),input:Nt(),output:gt().optional(),errorText:gt().optional(),callProviderMetadata:Yn,approval:gt().optional()}),_ne=ce({type:W().startsWith("tool-"),toolCallId:W(),state:_e("approval-requested"),input:Nt(),providerExecuted:nt().optional(),output:gt().optional(),errorText:gt().optional(),callProviderMetadata:Yn,approval:ce({id:W(),approved:gt().optional(),reason:gt().optional()})}),Sne=ce({type:W().startsWith("tool-"),toolCallId:W(),state:_e("approval-responded"),input:Nt(),providerExecuted:nt().optional(),output:gt().optional(),errorText:gt().optional(),callProviderMetadata:Yn,approval:ce({id:W(),approved:nt(),reason:W().optional()})}),xne=ce({type:W().startsWith("tool-"),toolCallId:W(),state:_e("output-available"),providerExecuted:nt().optional(),input:Nt(),output:Nt(),errorText:gt().optional(),callProviderMetadata:Yn,preliminary:nt().optional(),approval:ce({id:W(),approved:_e(!0),reason:W().optional()}).optional()}),kne=ce({type:W().startsWith("tool-"),toolCallId:W(),state:_e("output-error"),providerExecuted:nt().optional(),input:Nt(),output:gt().optional(),errorText:W(),callProviderMetadata:Yn,approval:ce({id:W(),approved:_e(!0),reason:W().optional()}).optional()}),Ene=ce({type:W().startsWith("tool-"),toolCallId:W(),state:_e("output-denied"),providerExecuted:nt().optional(),input:Nt(),output:gt().optional(),errorText:gt().optional(),callProviderMetadata:Yn,approval:ce({id:W(),approved:_e(!1),reason:W().optional()})}),X2=nn([vne,bne,_ne,Sne,xne,kne,Ene]),Ane=ce({type:_e("dynamic-tool"),toolName:W(),toolCallId:W(),title:W().optional(),providerExecuted:nt().optional(),state:_e("input-streaming"),input:Nt().optional(),output:gt().optional(),errorText:gt().optional(),approval:gt().optional()}),Tne=ce({type:_e("dynamic-tool"),toolName:W(),toolCallId:W(),title:W().optional(),providerExecuted:nt().optional(),state:_e("input-available"),input:Nt(),output:gt().optional(),errorText:gt().optional(),callProviderMetadata:Yn,approval:gt().optional()}),Ine=ce({type:_e("dynamic-tool"),toolName:W(),toolCallId:W(),title:W().optional(),providerExecuted:nt().optional(),state:_e("approval-requested"),input:Nt(),output:gt().optional(),errorText:gt().optional(),callProviderMetadata:Yn,approval:ce({id:W(),approved:gt().optional(),reason:gt().optional()})}),Nne=ce({type:_e("dynamic-tool"),toolName:W(),toolCallId:W(),title:W().optional(),providerExecuted:nt().optional(),state:_e("approval-responded"),input:Nt(),output:gt().optional(),errorText:gt().optional(),callProviderMetadata:Yn,approval:ce({id:W(),approved:nt(),reason:W().optional()})}),$ne=ce({type:_e("dynamic-tool"),toolName:W(),toolCallId:W(),title:W().optional(),providerExecuted:nt().optional(),state:_e("output-available"),input:Nt(),output:Nt(),errorText:gt().optional(),callProviderMetadata:Yn,preliminary:nt().optional(),approval:ce({id:W(),approved:_e(!0),reason:W().optional()}).optional()}),Cne=ce({type:_e("dynamic-tool"),toolName:W(),toolCallId:W(),title:W().optional(),providerExecuted:nt().optional(),state:_e("output-error"),input:Nt(),output:gt().optional(),errorText:W(),callProviderMetadata:Yn,approval:ce({id:W(),approved:_e(!0),reason:W().optional()}).optional()}),One=ce({type:_e("dynamic-tool"),toolName:W(),toolCallId:W(),title:W().optional(),providerExecuted:nt().optional(),state:_e("output-denied"),input:Nt(),output:gt().optional(),errorText:gt().optional(),callProviderMetadata:Yn,approval:ce({id:W(),approved:_e(!1),reason:W().optional()})}),eD=nn([Ane,Tne,Ine,Nne,$ne,Cne,One]);nn([fne,pne,hne,mne,gne,yne,wne,X2,eD]);function Rne(e){return X2.safeParse(e)}function Pne(e){return eD.safeParse(e)}function Dne(e,t,n){return{messageId:e,order:t,type:n,text_text:null,reasoning_text:null,file_mediaType:null,file_filename:null,file_url:null,source_url_sourceId:null,source_url_url:null,source_url_title:null,source_document_sourceId:null,source_document_mediaType:null,source_document_title:null,source_document_filename:null,tool_name:null,tool_toolCallId:null,tool_state:null,tool_input:null,tool_output:null,tool_errorText:null,data_type:null,data_blob:null,providerMetadata:null}}function Une(e,t){const n=Rne(e);if(!n.success)return null;const i=n.data;return t.tool_name=i.type.replace("tool-",""),t.tool_toolCallId=i.toolCallId,t.tool_state=i.state,["input-available","output-available","output-error","input-streaming"].includes(i.state)&&(t.tool_input=i.input??null),i.state==="output-available"&&(t.tool_output=i.output??null),i.state==="output-error"&&(t.tool_errorText=i.errorText??null),t}function Lne(e,t){const n=Pne(e);if(!n.success)return null;const i=n.data;return t.tool_name=i.toolName,t.tool_toolCallId=i.toolCallId,t.tool_state=i.state,["input-available","output-available","output-error","input-streaming","approval-requested","approval-responded","output-denied"].includes(i.state)&&(t.tool_input=i.input??null),i.state==="output-available"&&(t.tool_output=i.output??null),i.state==="output-error"&&(t.tool_errorText=i.errorText??null),t}function Mne(e,t){if(e.type==="tool-invocation")return null;if(lne(e))return Y2(e)?Une(e,t):Lne(e,t);if(sne(e))return t.data_type=e.type,t.data_blob=e.data,t;throw new Error(`Unsupported part type: ${e.type}`)}function jne(e,t,n){const i=Dne(n,t,e.type);switch("providerMetadata"in e&&e.providerMetadata?i.providerMetadata=e.providerMetadata:"callProviderMetadata"in e&&e.callProviderMetadata&&(i.providerMetadata=e.callProviderMetadata),e.type){case"text":return i.text_text=e.text,i;case"reasoning":return i.reasoning_text=e.text,i;case"file":return i.file_mediaType=e.mediaType,i.file_filename=e.filename??null,i.file_url=e.url,i;case"source-url":return i.source_url_sourceId=e.sourceId,i.source_url_url=e.url,i.source_url_title=e.title??null,i;case"source-document":return i.source_document_sourceId=e.sourceId,i.source_document_mediaType=e.mediaType,i.source_document_title=e.title,i.source_document_filename=e.filename??null,i;case"step-start":return i;default:return Mne(e,i)}}function zne(e,t){return e.map((n,i)=>jne(n,i,t)).filter(n=>n!==null)}function Bne(e){return{type:e.type,toolCallId:e.tool_toolCallId}}function Fne(e,t){return{...t,state:"input-streaming",...e.tool_input!==null&&e.tool_input!==void 0?{input:e.tool_input}:{}}}function Wne(e,t){return{...t,state:"input-available",input:e.tool_input??null,...e.providerMetadata?{callProviderMetadata:e.providerMetadata}:{}}}function Vne(e,t){return{...t,state:"output-available",input:e.tool_input??null,output:e.tool_output??null,...e.providerMetadata?{callProviderMetadata:e.providerMetadata}:{}}}function qne(e,t){return{...t,state:"output-error",input:e.tool_input??null,errorText:e.tool_errorText??"",...e.providerMetadata?{callProviderMetadata:e.providerMetadata}:{}}}function Hne(e){if(!(e.tool_toolCallId&&e.tool_state))return null;const t=Bne(e);return e.tool_state==="input-streaming"?Fne(e,t):e.tool_state==="input-available"?Wne(e,t):e.tool_state==="output-available"?Vne(e,t):e.tool_state==="output-error"?qne(e,t):null}function Kne(e){if(!(e.tool_toolCallId&&e.tool_state&&e.tool_name))return null;const t={type:"dynamic-tool",toolName:e.tool_name,toolCallId:e.tool_toolCallId};return e.tool_state==="input-streaming"?{...t,state:"input-streaming",input:e.tool_input}:e.tool_state==="input-available"?{...t,state:"input-available",input:e.tool_input,...e.providerMetadata?{callProviderMetadata:e.providerMetadata}:{}}:e.tool_state==="output-available"?{...t,state:"output-available",input:e.tool_input,output:e.tool_output,...e.providerMetadata?{callProviderMetadata:e.providerMetadata}:{}}:e.tool_state==="output-error"?{...t,state:"output-error",input:e.tool_input,errorText:e.tool_errorText??"",...e.providerMetadata?{callProviderMetadata:e.providerMetadata}:{}}:null}function Jne(e){return e.data_type&&e.data_blob?{type:e.type,data:e.data_blob}:e.data_blob?e.data_blob:null}function Gne(e){const t={type:"source-url",sourceId:e.source_url_sourceId??"",url:e.source_url_url??""};return e.source_url_title&&(t.title=e.source_url_title),e.providerMetadata&&(t.providerMetadata=e.providerMetadata),t}function Zne(e){const t={type:"source-document",sourceId:e.source_document_sourceId??"",mediaType:e.source_document_mediaType??"",title:e.source_document_title??""};return e.source_document_filename&&(t.filename=e.source_document_filename),e.providerMetadata&&(t.providerMetadata=e.providerMetadata),t}function Qne(e){switch(e.type){case"text":return{type:"text",text:e.text_text??""};case"reasoning":{const t={type:"reasoning",text:e.reasoning_text??""};return e.providerMetadata&&(t.providerMetadata=e.providerMetadata),t}case"file":return{type:"file",mediaType:e.file_mediaType??"",...e.file_filename?{filename:e.file_filename}:{},url:e.file_url??""};case"source-url":return Gne(e);case"source-document":return Zne(e);case"step-start":return{type:"step-start"};case"dynamic-tool":return Kne(e);default:if(e.type.startsWith("tool-"))return Hne(e);if(e.type.startsWith("data-"))return Jne(e);throw new Error(`Unsupported part type: ${e.type}`)}}function Yne(e){return e.sort((n,i)=>n.order-i.order).map(Qne).filter(n=>n!==null)}const N0=ob("db:queries");async function Zie({id:e,userId:t,title:n,projectId:i}){try{return await at.insert(ht).values({id:e,createdAt:new Date,updatedAt:new Date,userId:t,title:n,projectId:i??null})}catch(r){throw console.error("Failed to save chat in database"),r}}async function Qie({id:e}){try{const t=await at.select().from(mt).where(Pe(mt.chatId,e));return t.length>0&&await tD(t),await at.delete(ht).where(Pe(ht.id,e))}catch(t){throw console.error("Failed to delete chat by id from database"),t}}async function Yie({id:e,projectId:t}){console.log("[getChatsByUserId] Starting",{userId:e,projectId:t,projectIdType:typeof t,projectIdIsNull:t===null,projectIdIsUndefined:t===void 0});try{let n=Pe(ht.userId,e);t===null?(n=Jn(Pe(ht.userId,e),uR(ht.projectId)),console.log("[getChatsByUserId] Using null project condition")):t?(n=Jn(Pe(ht.userId,e),Pe(ht.projectId,t)),console.log("[getChatsByUserId] Using specific project condition",{projectId:t})):(n=Pe(ht.userId,e),console.log("[getChatsByUserId] Using all chats condition")),console.log("[getChatsByUserId] Executing query");const i=await at.select().from(ht).where(n).orderBy(Ps(ht.updatedAt));return console.log("[getChatsByUserId] Query completed",{count:i.length,sampleChat:i[0]?{id:i[0].id,updatedAt:i[0].updatedAt,updatedAtType:typeof i[0].updatedAt}:null}),i}catch(n){throw console.error("[getChatsByUserId] Failed to get chats by user from database",{error:n,errorMessage:n instanceof Error?n.message:String(n),errorStack:n instanceof Error?n.stack:void 0,userId:e,projectId:t}),n}}async function Xie({id:e,userId:t,name:n,instructions:i="",icon:r,iconColor:o}){try{return await at.insert(_i).values({id:e,userId:t,name:n,instructions:i,...r&&{icon:r},...o&&{iconColor:o},createdAt:new Date,updatedAt:new Date})}catch(s){throw console.error("Failed to create project in database"),s}}async function eoe({userId:e}){try{return await at.select().from(_i).where(Pe(_i.userId,e)).orderBy(Ps(_i.updatedAt))}catch(t){throw console.error("Failed to get projects by user from database"),t}}async function toe({id:e}){try{const[t]=await at.select().from(_i).where(Pe(_i.id,e));return t}catch(t){throw console.error("Failed to get project by id from database"),t}}async function noe({id:e,updates:t}){try{return await at.update(_i).set({...t,updatedAt:new Date}).where(Pe(_i.id,e))}catch(n){throw console.error("Failed to update project in database"),n}}async function roe({id:e}){try{return await at.delete(_i).where(Pe(_i.id,e))}catch(t){throw console.error("Failed to delete project from database"),t}}async function ioe({id:e}){try{const[t]=await at.select().from(ht).where(Pe(ht.id,e));return t}catch(t){throw console.error("Failed to get chat by id from database"),t}}async function ooe({messages:e}){try{return e.length===0?void 0:await at.transaction(async t=>{const n=e.map(({id:o,chatId:s,message:a})=>{const c=nY(a,s);return c.id=o,c});await t.insert(mt).values(n);const i=[];for(const{id:o,message:s}of e){const a=zne(s.parts,o);i.push(...a)}i.length>0&&await t.insert(Un).values(i);const r=[...new Set(e.map(({chatId:o})=>o))];await Promise.all(r.map(o=>ere({chatId:o})))})}catch(t){throw N0.error({error:t,messageIds:e.map(n=>n.id)},"saveChatMessages failed"),t}}async function soe({chatId:e}){try{const t=await at.select().from(mt).where(Pe(mt.chatId,e)).orderBy(Ui(mt.createdAt));if(t.length===0)return[];const n=t.map(o=>o.id),i=await at.select().from(Un).where(Rs(Un.messageId,n)).orderBy(Ui(Un.messageId),Ui(Un.order)),r=new Map;for(const o of i){const s=r.get(o.messageId)??[];s.push(o),r.set(o.messageId,s)}return t.map(o=>{const s=r.get(o.id),a=s&&s.length>0?Yne(s):[];return{id:o.id,role:o.role,parts:a,metadata:{createdAt:o.createdAt,activeStreamId:o.activeStreamId,parentMessageId:o.parentMessageId,selectedModel:o.selectedModel||"",selectedTool:o.selectedTool||void 0,usage:o.lastContext}}})}catch(t){throw console.error("Failed to get all messages by chat ID",t),t}}async function aoe({chatId:e,messageId:t,type:n}){try{const[i]=await at.select().from(io).where(Jn(Pe(io.messageId,t),Pe(io.chatId,e)));return i?await at.update(io).set({isUpvoted:n==="up"}).where(Jn(Pe(io.messageId,t),Pe(io.chatId,e))):await at.insert(io).values({chatId:e,messageId:t,isUpvoted:n==="up"})}catch(i){throw console.error("Failed to upvote message in database",i),i}}async function coe({id:e}){try{return await at.select().from(io).where(Pe(io.chatId,e))}catch(t){throw console.error("Failed to get votes by chat id from database",t),t}}async function loe({id:e,title:t,kind:n,content:i,userId:r,messageId:o}){try{return await at.insert(bt).values({id:e,title:t,kind:n,content:i,userId:r,messageId:o,createdAt:new Date})}catch(s){throw console.error("Failed to save document in database",s),s}}async function Xne({id:e}){try{return await at.select().from(bt).where(Pe(bt.id,e)).orderBy(Ui(bt.createdAt))}catch(t){throw console.error("Failed to get document by id from database",t),t}}async function uoe({id:e,userId:t}){try{const n=await Xne({id:e});if(n.length===0)return[];const[i]=n;return!t||i.userId!==t?await at.select({id:bt.id,createdAt:bt.createdAt,title:bt.title,content:bt.content,kind:bt.kind,userId:bt.userId,messageId:bt.messageId,chatVisibility:ht.visibility}).from(bt).innerJoin(mt,Pe(bt.messageId,mt.id)).innerJoin(ht,Pe(mt.chatId,ht.id)).where(Jn(Pe(bt.id,e),Pe(ht.visibility,"public"))).orderBy(Ui(bt.createdAt)):n}catch(n){throw console.error("Failed to get documents by id with visibility from database"),n}}async function doe({id:e}){try{return await at.select({id:bt.id,createdAt:bt.createdAt,title:bt.title,content:bt.content,kind:bt.kind,userId:bt.userId,messageId:bt.messageId}).from(bt).innerJoin(mt,Pe(bt.messageId,mt.id)).innerJoin(ht,Pe(mt.chatId,ht.id)).where(Jn(Pe(bt.id,e),Pe(ht.visibility,"public"))).orderBy(Ui(bt.createdAt))}catch(t){throw console.error("Failed to get public documents by id from database"),t}}async function foe({id:e}){try{const[t]=await at.select().from(bt).where(Pe(bt.id,e)).orderBy(Ps(bt.createdAt));return t}catch(t){throw console.error("Failed to get document by id from database"),t}}async function poe({messageIds:e}){if(e.length===0)return[];try{return await at.select().from(bt).where(Rs(bt.messageId,e)).orderBy(Ui(bt.createdAt))}catch(t){throw console.error("Failed to get documents by message IDs from database"),t}}async function hoe({documents:e}){if(e.length!==0)try{return await at.insert(bt).values(e)}catch(t){throw console.error("Failed to save documents in database",t),t}}async function moe({id:e}){try{return await at.select().from(mt).where(Pe(mt.id,e))}catch(t){throw N0.error({error:t,messageId:e},"getMessageById failed"),t}}async function goe({chatId:e,messageId:t}){try{const[n]=await at.select().from(mt).where(Jn(Pe(mt.id,t),Pe(mt.chatId,e)));if(!n)throw new Error("Target message not found");const i=await at.select().from(mt).where(Pe(mt.chatId,e)).orderBy(Ui(mt.createdAt)),r=i.findIndex(a=>a.id===t);if(r===-1)throw new Error("Target message not found in chat");const o=i.slice(r),s=o.map(a=>a.id);if(s.length>0)return await tD(o),await at.delete(mt).where(Jn(Pe(mt.chatId,e),Rs(mt.id,s)))}catch(n){throw console.error("Failed to delete messages by chat id after message id from database"),n}}async function yoe({chatId:e,visibility:t}){try{return await at.update(ht).set({visibility:t}).where(Pe(ht.id,e))}catch(n){throw console.error("Failed to update chat visibility in database"),n}}async function woe({chatId:e,title:t}){try{return await at.update(ht).set({title:t}).where(Pe(ht.id,e))}catch(n){throw console.error("Failed to update chat title by id from database"),n}}async function voe({chatId:e,isPinned:t}){try{return await at.update(ht).set({isPinned:t}).where(Pe(ht.id,e))}catch(n){throw console.error("Failed to update chat isPinned by id from database"),n}}async function boe({messageId:e,canceledAt:t}){try{return await at.update(mt).set({canceledAt:t}).where(Pe(mt.id,e))}catch(n){throw N0.error({error:n,messageId:e},"updateMessageCanceledAt failed"),n}}async function ere({chatId:e}){try{return await at.update(ht).set({updatedAt:new Date}).where(Pe(ht.id,e))}catch(t){throw console.error("Failed to update chat updatedAt by id from database"),t}}async function tre(){try{return await at.select({attachments:mt.attachments}).from(mt)}catch(e){throw console.error("Failed to get messages with attachments from database",e),e}}function nre(){return at.select({tool_output:Un.tool_output}).from(Un).where(Pe(Un.tool_name,"generateImage"))}function rre(){return at.select({file_url:Un.file_url}).from(Un).where(Jn(Pe(Un.type,"file"),Z`${Un.file_url} is not null`))}async function ire(){try{const e=await tre(),t=await rre(),n=await nre();return[...ore(e),...sre(n),...are(t)]}catch(e){throw console.error("Failed to get attachment URLs from database",e),e}}function ore(e){const t=[];for(const n of e)if(n.attachments&&Array.isArray(n.attachments)){const i=n.attachments;for(const r of i)r.url&&t.push(r.url)}return t}function sre(e){const t=[];for(const n of e){const i=n.tool_output;i?.imageUrl&&t.push(i.imageUrl)}return t}function are(e){return e.map(t=>t.file_url).filter(t=>!!t)}async function cre({attachmentUrl:e,userId:t}){try{const n=t?Jf(Pe(ht.userId,t),Pe(ht.visibility,"public")):Pe(ht.visibility,"public"),i=Z`exists (
      select 1
      from jsonb_array_elements(
        case
          when jsonb_typeof(${mt.attachments}::jsonb) = 'array'
            then ${mt.attachments}::jsonb
          else '[]'::jsonb
        end
      ) as attachment
      where attachment->>'url' = ${e}
    )`;return(await at.select({id:ht.id}).from(mt).innerJoin(ht,Pe(mt.chatId,ht.id)).where(Jn(n,i)).limit(1)).length>0?!0:(await at.select({id:ht.id}).from(Un).innerJoin(mt,Pe(Un.messageId,mt.id)).innerJoin(ht,Pe(mt.chatId,ht.id)).where(Jn(n,Jf(Jn(Pe(Un.type,"file"),Pe(Un.file_url,e)),Jn(Pe(Un.tool_name,"generateImage"),Z`${Un.tool_output}::jsonb ->> 'imageUrl' = ${e}`)))).limit(1)).length>0}catch(n){throw console.error("Failed to check attachment visibility",n),n}}async function tD(e){try{const t=[];for(const n of e)if(n.attachments&&Array.isArray(n.attachments)){const i=n.attachments;for(const r of i)r.url&&t.push(r.url)}t.length>0&&await TP(t)}catch(t){console.error("Failed to delete attachments from file storage:",t)}}async function _oe({userId:e}){try{return await at.select().from(bl).where(Pe(bl.userId,e))}catch(t){throw console.error("Failed to get user model preferences from database",t),t}}async function Soe({userId:e,modelId:t,enabled:n}){try{await at.insert(bl).values({userId:e,modelId:t,enabled:n,createdAt:new Date,updatedAt:new Date}).onConflictDoUpdate({target:[bl.userId,bl.modelId],set:{enabled:n,updatedAt:new Date}})}catch(i){throw console.error("Failed to upsert user model preference in database",i),i}}function nD(e){return Pr.APP_URL?Pr.APP_URL:e?new URL(e.url).origin:"http://localhost:5173"}const lre=/\.(?:svg|png|jpg|jpeg|gif|webp|ico|json|webmanifest|css|js|map|woff2?|ttf|eot|otf)$/i;function ure(e){return lre.test(e)}function dre(e){return e.startsWith("/api/auth")||e==="/api/chat"||e.startsWith("/api/chat/")||e.startsWith("/api/files/")||e==="/api/cron/cleanup"}function fre(e){return e==="/sitemap.xml"||e==="/robots.txt"||e==="/manifest.webmanifest"}function pre(e){return e==="/"?!0:e.startsWith("/models")||e.startsWith("/compare")||e.startsWith("/share/")||e.startsWith("/privacy")||e.startsWith("/terms")||e.startsWith("/docs")}function yE(e){return e.startsWith("/login")||e.startsWith("/register")}function wE(e,t){return Response.redirect(new URL(e,t.url),302)}function Xc(){return new Response("Not Implemented",{status:501})}const Fy="/api/files/",hre=`${ke.appPrefix}/files/`,mre=/^bytes=(\d*)-(\d*)$/,gre=/\/$/,yre="0 * * * *",wre=14400*1e3,vre="https://chatjs.mintlify.dev/docs";function bre(){return tl.R2_ATTACHMENTS??null}function _re(e){if(!e.startsWith(Fy))return null;const t=e.slice(Fy.length).split("?")[0];if(!t)return null;try{return decodeURIComponent(t)}catch{return null}}function Sre(e,t){if(!e)return null;const n=mre.exec(e.trim());if(!n)return"invalid";const[,i,r]=n;if(!(i||r))return"invalid";if(!i&&r){const c=Number.parseInt(r,10);if(!Number.isFinite(c)||c<=0)return"invalid";const l=Math.min(c,t);return{end:t-1,length:l,start:t-l}}const o=Number.parseInt(i,10);if(!Number.isFinite(o)||o<0||o>=t)return"invalid";const s=r.length>0?Number.parseInt(r,10):Math.max(t-1,o);if(!Number.isFinite(s)||s<o)return"invalid";const a=Math.min(s,t-1);return{end:a,length:a-o+1,start:o}}function ws(e,t){return Response.json({error:t},{status:e})}function xre(e){return!!e?.startsWith(hre)}function kre({metadata:e,parsedRange:t}){const n=new Headers;return n.set("Accept-Ranges","bytes"),n.set("ETag",e.httpEtag??e.etag),n.set("Last-Modified",e.uploaded.toUTCString()),n.set("Content-Length",String(t?.length??e.size)),n.set("Cache-Control","private, no-store"),n.set("Vary","Authorization, Cookie"),e.httpMetadata?.contentDisposition&&n.set("Content-Disposition",e.httpMetadata.contentDisposition),e.httpMetadata?.contentEncoding&&n.set("Content-Encoding",e.httpMetadata.contentEncoding),e.httpMetadata?.contentLanguage&&n.set("Content-Language",e.httpMetadata.contentLanguage),e.httpMetadata?.contentType&&n.set("Content-Type",e.httpMetadata.contentType),t&&n.set("Content-Range",`bytes ${t.start}-${t.end}/${e.size}`),n}async function Ere({bucket:e,key:t,parsedRange:n}){return n?await e.get(t,{range:{length:n.length,offset:n.start}}):await e.get(t)}async function Are({request:e,userId:t}){if(e.method!=="POST")return new Response("Method Not Allowed",{status:405});if(!ke.integrations.attachments)return ws(503,"File uploads are not available");if(!t)return ws(401,"Unauthorized");if(!e.body)return new Response("Request body is empty",{status:400});const i=(await e.formData()).get("file");if(!(i instanceof Blob))return ws(400,"No file uploaded");const r=i,o=new Set(Object.keys(ke.attachments.acceptedTypes));if(r.size>ke.attachments.maxBytes)return ws(400,"File size should be less than 5MB");if(!(r.type&&o.has(r.type)))return ws(400,"Unsupported file type");const s=typeof r.name=="string"&&r.name.length>0?r.name:"file";try{const a=await XQ(s,r.stream(),{contentType:r.type}),c=tY(a.pathname);return Response.json({...a,pathname:c||s})}catch{return ws(500,"Upload failed")}}async function vE(e){return(await Ry.api.getSession({headers:e.headers}))?.user?.id??null}async function Tre({request:e,userId:t}){if(e.method!=="GET"&&e.method!=="HEAD")return new Response("Method Not Allowed",{status:405});const n=_re(new URL(e.url).pathname);if(!xre(n))return new Response("Not Found",{status:404});const i=`${Fy}${encodeURIComponent(n)}`;if(!await cre({attachmentUrl:i,userId:t}))return new Response("Forbidden",{status:403});const o=bre();if(!o)return new Response("File storage unavailable",{status:503});const s=await o.head(n);if(!s)return new Response("Not Found",{status:404});const a=Sre(e.headers.get("range"),s.size);if(a==="invalid")return new Response(null,{headers:{"Content-Range":`bytes */${s.size}`},status:416});const c=kre({metadata:s,parsedRange:a});if(e.method==="HEAD")return new Response(null,{headers:c,status:a?206:200});const l=await Ere({bucket:o,key:n,parsedRange:a});return l?.body?new Response(l.body,{headers:c,status:a?206:200}):new Response("Not Found",{status:404})}function Ire(){return tl.CRON_SECRET?.trim()||null}function Nre(e){const t=Ire();return t?e.headers.get("authorization")===`Bearer ${t}`:!1}async function $re(){const{attachments:e,imageGeneration:t}=ke.integrations;if(!(e||t))return{deletedCount:0,deletedUrls:[],skipped:!0};const n=new Date(Date.now()-wre),i=new Set(await ire()),{blobs:r}=await eY(),o=[];for(const s of r){const c=new Date(s.uploadedAt)<n,l=!i.has(s.url);c&&l&&o.push(s.url)}return o.length>0&&(await TP(o),console.log(`[TRACE] cleanup deleted ${o.length} orphaned files`)),{deletedCount:o.length,deletedUrls:o}}async function rD(){return{orphanedAttachments:await $re()}}async function Cre(e){if(e.method!=="GET")return new Response("Method Not Allowed",{status:405});if(!Nre(e))return ws(401,"Unauthorized");try{const t=await rD();return Response.json({results:t,success:!0,timestamp:new Date().toISOString()})}catch(t){return console.error("Cleanup cron job failed",t),Response.json({details:t instanceof Error?t.message:"Unknown error",error:"Cleanup failed"},{status:500})}}function Ore(e){const t=nD(e),n=new Date().toISOString(),i=['<?xml version="1.0" encoding="UTF-8"?>','<urlset xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">',"  <url>",`    <loc>${t}/</loc>`,`    <lastmod>${n}</lastmod>`,"    <changefreq>weekly</changefreq>","    <priority>1.0</priority>","  </url>","</urlset>"].join(`
`);return new Response(i,{headers:{"content-type":"application/xml; charset=utf-8"}})}function Rre(e){const n=["User-agent: *","Allow: /",`Sitemap: ${nD(e)}/sitemap.xml`].join(`
`);return new Response(n,{headers:{"content-type":"text/plain; charset=utf-8"}})}function Pre(){const e=JSON.stringify({name:ke.appName,short_name:ke.appName,description:ke.appDescription,start_url:"/",display:"standalone",background_color:"#fff",theme_color:"#fff",icons:[{src:"/icon.svg",sizes:"any",type:"image/svg+xml"}]},null,2);return new Response(e,{headers:{"content-type":"application/manifest+json; charset=utf-8"}})}function Dre(e){const t=new URL(e.url),n=new URL(vre),i="/docs",r=t.pathname.startsWith(`${i}/`)?t.pathname.slice(i.length):"";return n.pathname=`${n.pathname.replace(gre,"")}${r}`,n.search=t.search,n.toString()}function Ure(){return F.jsx("main",{className:"flex min-h-screen items-center justify-center",children:F.jsxs("div",{className:"text-center",children:[F.jsx("h1",{className:"font-semibold text-3xl",children:"Not Found"}),F.jsx("p",{className:"mt-2 text-muted-foreground text-sm",children:"The page you are looking for does not exist."})]})})}const Lre=CM([async function({request:t,ctx:n}){n.session=await Ry.api.getSession({headers:t.headers})},function({request:t,ctx:n}){const{pathname:i}=new URL(t.url);if(ure(i)||dre(i)||fre(i))return;const r=!!n.session?.user;if(r&&yE(i))return wE("/",t);if(!(yE(i)||pre(i))&&!r)return wE("/login",t)},Ft("/api/auth/*",({request:e})=>Ry.handler(e)),LE("/api",[Ft("/chat",()=>Xc()),Ft("/chat/:id/stream",()=>Xc()),Ft("/files/upload",async({request:e})=>Are({request:e,userId:await vE(e)})),Ft("/files/*",async({request:e})=>Tre({request:e,userId:await vE(e)})),Ft("/chat-model",()=>Xc()),Ft("/mcp/oauth/callback",()=>Xc()),Ft("/cron/cleanup",({request:e})=>Cre(e)),Ft("/dev-login",()=>Xc())]),Ft("/sitemap.xml",({request:e})=>Ore(e)),Ft("/robots.txt",({request:e})=>Rre(e)),Ft("/manifest.webmanifest",()=>Pre()),eM(LM,[...Ug(Wz,[Ft("/",VM),Ft("/chat/:id",zM),Ft("/share/:id",({params:e})=>F.jsx(IB,{id:e.id})),Ft("/project/:projectId",({params:e})=>F.jsx(sB,{projectId:e.projectId})),Ft("/project/:projectId/chat/:chatId",({params:e})=>F.jsx(lB,{projectId:e.projectId}))]),...Ug(Kz,[Ft("/settings",hB),Ft("/settings/models",EB),Ft("/settings/connectors",_B),Ft("/settings/connectors/:connectorId",({params:e})=>F.jsx(yB,{connectorId:e.connectorId}))]),Ft("/login",tB),Ft("/register",fB),Ft("/privacy",rB),Ft("/terms",OB),Ft("/docs",BM),Ft("/docs/*",({request:e})=>Response.redirect(Dre(e),302)),Ft("/*",Ure)])]),xoe=async e=>{if(e.cron===yre)try{const t=await rD();console.log("[TRACE] scheduled cleanup complete",{cron:e.cron,deletedCount:t.orphanedAttachments.deletedCount,skipped:!!t.orphanedAttachments.skipped})}catch(t){throw console.error("[TRACE] scheduled cleanup failed",t),t}},koe=PB,Eoe=Lre??{};export{ke as $,dr as A,Lt as B,Nt as C,_e as D,sY as E,yt as F,rr as G,aie as H,cY as I,Qf as J,Gie as K,Jie as L,tc as M,XQ as N,iv as O,soe as P,poe as Q,Zie as R,ooe as S,Ks as T,hoe as U,Qie as V,moe as W,goe as X,Kie as Y,tt as Z,Eo as _,Ry as a,Yie as a0,Wie as a1,woe as a2,voe as a3,yoe as a4,boe as a5,sb as a6,sie as a7,ob as a8,Hie as a9,Qe as aA,Zt as aB,sH as aC,t0 as aD,oi as aE,zh as aF,Hu as aG,Fh as aH,koe as aI,Eoe as aJ,xoe as aK,Yh as aa,qie as ab,St as ac,wo as ad,td as ae,_0 as af,jp as ag,vv as ah,rN as ai,Hy as aj,nD as ak,Qs as al,uoe as am,doe as an,foe as ao,loe as ap,KQ as aq,Fie as ar,Jn as as,KJ as at,Ps as au,uR as av,Z as aw,Jf as ax,Qd as ay,Cx as az,nt as b,mM as c,ioe as d,coe as e,cie as f,_oe as g,Xie as h,toe as i,eoe as j,roe as k,noe as l,at as m,Bie as n,ce as o,Pe as p,hY as q,nl as r,W as s,Ip as t,Soe as u,aoe as v,xp as w,Hn as x,YP as y,nn as z};
//# sourceMappingURL=worker-entry-DwuZrGJP.mjs.map
