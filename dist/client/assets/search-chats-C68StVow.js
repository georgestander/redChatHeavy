import{r as l,j as e}from"./client-BXVv_YeC.js";import{u as p,a as f}from"./sidebar-C0WHgcyX.js";import{C as x,a as g,b as y,c as C,d as k,e as j,M as S}from"./command-CP3kQh9u.js";import{D as w,a as _,b as M,c as D,d as v}from"./dialog-BVCtBu-i.js";import{u as L}from"./chat-sync-hooks-DcZBFnAH.js";import{s as N,a as b,i as E,b as W}from"./subWeeks-Be4u23cY.js";import{S as K}from"./search-CeF-vcTf.js";import"./button-BvmNNHkl.js";import"./index-B4KKYCLu.js";import"./utils-D-FPgC8r.js";import"./input-CaNkDFJs.js";import"./index-C-kxXg33.js";import"./createLucideIcon-CqP9863P.js";import"./index-C_VP89m5.js";import"./index-CWLAyDMs.js";import"./index-B4ZZijhN.js";import"./index-ClCXh67x.js";import"./useQuery-DtNLQT6k.js";import"./query-Cv3hDNY5.js";import"./QueryClientProvider-BboFp7b3.js";import"./useMutation-BU4p8oK4.js";import"./mutation-DaBpc3iQ.js";import"./index-BMGOATel.js";import"./credits-C6GN1dxI.js";import"./config-DrLGYCgI.js";import"./chat-id-provider-BiTIqLva.js";import"./use-navigation-QuPGD7m8.js";import"./session-provider-DBOweKPF.js";import"./auth-client-NCEzhzlD.js";import"./startOfDay-DFs_GiEJ.js";const T=o=>{const r=new Date,i=N(r),n=b(r);return o.reduce((a,t)=>{const s=new Date(t.createdAt);return E(s)?a.today.push(t):W(s)?a.yesterday.push(t):s>i?a.lastWeek.push(t):s>n?a.lastMonth.push(t):a.older.push(t),a},{today:[],yesterday:[],lastWeek:[],lastMonth:[],older:[]})},A=(o,r)=>{if(!r.trim())return o;const i=r.toLowerCase();return o.filter(n=>n.title.toLowerCase().includes(i))},B=l.memo(function({onSelectChat:r,deferredQuery:i}){const{data:n,isLoading:a}=L(),t=l.useMemo(()=>{if(!n)return null;const d=A(n,i);return T(d)},[n,i]),s=(d,u,h)=>d.length===0?null:e.jsx(k,{heading:u,children:d.map(m=>e.jsxs(j,{className:"flex cursor-pointer items-center gap-2 p-2",onSelect:()=>r(m.id),value:m.id,children:[e.jsx(S,{className:"h-4 w-4 text-muted-foreground"}),e.jsx("div",{className:"flex min-w-0 flex-1 flex-col",children:e.jsx("span",{className:"truncate font-medium",children:m.title})})]},m.id))},h),c=t&&(t.today.length>0||t.yesterday.length>0||t.lastWeek.length>0||t.lastMonth.length>0||t.older.length>0);return e.jsxs(e.Fragment,{children:[!c&&e.jsx(C,{children:a?"Loading chats...":"No chats found."}),t&&e.jsxs(e.Fragment,{children:[s(t.today,"Today","today"),s(t.yesterday,"Yesterday","yesterday"),s(t.lastWeek,"Last 7 days","lastWeek"),s(t.lastMonth,"Last 30 days","lastMonth"),s(t.older,"Older","older")]})]})});function F({open:o,onOpenChange:r,onSelectChat:i}){const[n,a]=l.useState(""),t=l.useDeferredValue(n),s=l.useCallback(d=>{r(!1),i(),a(""),window.history.pushState(null,"",`/chat/${d}`)},[r,i]),c=l.useCallback(d=>{r(d),d||a("")},[r]);return e.jsxs(w,{onOpenChange:c,open:o,children:[e.jsxs(_,{className:"sr-only",children:[e.jsx(M,{children:"Search Chats"}),e.jsx(D,{children:"Search through your chat history"})]}),e.jsx(v,{className:"overflow-hidden p-0",showCloseButton:!1,children:e.jsxs(x,{className:"**:data-[slot=command-input-wrapper]:h-12 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5",shouldFilter:!1,children:[e.jsx(g,{onValueChange:a,placeholder:"Search your chats...",value:n}),e.jsx(y,{children:o&&e.jsx(B,{deferredQuery:t,onSelectChat:s})})]})})]})}function G(){return typeof window>"u"?"Ctrl+K":navigator.platform.toUpperCase().indexOf("MAC")>=0?"Cmd+K":"Ctrl+K"}function fe(){const[o,r]=l.useState(!1),{setOpenMobile:i}=p(),[n,a]=l.useState("Ctrl+K");return l.useEffect(()=>{a(G())},[]),l.useEffect(()=>{const t=s=>{s.key==="k"&&(s.metaKey||s.ctrlKey)&&(s.preventDefault(),r(c=>!c))};return document.addEventListener("keydown",t),()=>document.removeEventListener("keydown",t)},[]),e.jsxs(e.Fragment,{children:[e.jsxs(f,{className:"w-full justify-start",onClick:()=>r(!0),tooltip:"Search chats",children:[e.jsx(K,{className:"h-4 w-4"}),e.jsx("span",{children:"Search chats"}),e.jsx("span",{className:"ml-auto text-muted-foreground text-xs",children:n})]}),o&&e.jsx(F,{onOpenChange:r,onSelectChat:()=>i(!1),open:o})]})}export{fe as SearchChatsButton};
//# sourceMappingURL=search-chats-C68StVow.js.map
