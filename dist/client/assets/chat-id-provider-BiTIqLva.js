import{r,j as C}from"./client-BXVv_YeC.js";import{b as m}from"./use-navigation-QuPGD7m8.js";import{g as h}from"./utils-D-FPgC8r.js";const I=/^\/share\/(.+)$/,f=/^\/project\/([^/]+)(?:\/chat\/(.+))?$/,v=/^\/chat\/(.+)$/;function E(o){const s=o?.match(I);if(s)return{type:"chat",id:s[1],source:"share",projectId:null};const t=o?.match(f);if(t){const n=t[1],e=t[2];return e?{type:"chat",id:e,source:"project",projectId:n}:{type:"provisional",id:null,source:"project",projectId:n}}const a=o?.match(v);return a?{type:"chat",id:a[1],source:"chat",projectId:null}:{type:"provisional",id:null,source:"home",projectId:null}}const u=r.createContext(void 0);function x({children:o}){const s=m(),[{provisionalChatId:t,confirmedChatId:a},n]=r.useState(()=>({provisionalChatId:h(),confirmedChatId:null})),e=r.useMemo(()=>E(s),[s]),i=r.useCallback(c=>{if(c!==t)throw console.error("Chat ID mismatch",c,t),new Error("Chat ID mismatch");n(p=>({...p,confirmedChatId:c}))},[t]),d=r.useCallback(()=>{const c=h();n({provisionalChatId:c,confirmedChatId:null}),window.history.pushState(null,"","/")},[]),l=r.useMemo(()=>({id:e.id??t,type:e.type,source:e.source,isPersisted:e.id!==null&&e.id!==t||a===t,confirmChatId:i,refreshChatID:d}),[e.id,e.type,e.source,t,a,i,d]);return C.jsx(u.Provider,{value:l,children:o})}function y(){const o=r.useContext(u);if(o===void 0)throw new Error("useChatId must be used within a ChatIdProvider");return o}export{x as C,E as p,y as u};
//# sourceMappingURL=chat-id-provider-BiTIqLva.js.map
