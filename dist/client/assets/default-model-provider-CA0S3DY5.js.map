{"version":3,"file":"default-model-provider-CA0S3DY5.js","sources":["../../../providers/default-model-provider.tsx"],"sourcesContent":["\"use client\";\n\nimport {\n  createContext,\n  type ReactNode,\n  useCallback,\n  useContext,\n  useMemo,\n  useState,\n} from \"react\";\nimport { toast } from \"sonner\";\nimport type { AppModelId } from \"@/lib/ai/app-models\";\n\ntype DefaultModelContextType = {\n  defaultModel: AppModelId;\n  changeModel: (modelId: AppModelId) => Promise<void>;\n};\n\nconst DefaultModelContext = createContext<DefaultModelContextType | undefined>(\n  undefined\n);\n\ntype DefaultModelClientProviderProps = {\n  children: ReactNode;\n  defaultModel: AppModelId;\n};\n\nexport function DefaultModelProvider({\n  children,\n  defaultModel: initialModel,\n}: DefaultModelClientProviderProps) {\n  const [currentModel, setCurrentModel] = useState<AppModelId>(initialModel);\n\n  const changeModel = useCallback(\n    async (modelId: AppModelId) => {\n      // Update local state immediately\n      setCurrentModel(modelId);\n\n      try {\n        // Update cookies for persistence\n        await fetch(\"/api/chat-model\", {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n          },\n          body: JSON.stringify({ model: modelId }),\n        });\n      } catch (error) {\n        console.error(\"Failed to save chat model:\", error);\n        toast.error(\"Failed to save model preference\");\n        // Revert on error\n        setCurrentModel(initialModel);\n      }\n    },\n    [initialModel]\n  );\n\n  const value = useMemo(\n    () => ({\n      defaultModel: currentModel,\n      changeModel,\n    }),\n    [currentModel, changeModel]\n  );\n\n  return (\n    <DefaultModelContext.Provider value={value}>\n      {children}\n    </DefaultModelContext.Provider>\n  );\n}\n\nexport function useDefaultModel() {\n  const context = useContext(DefaultModelContext);\n  if (context === undefined) {\n    throw new Error(\n      \"useDefaultModel must be used within a DefaultModelProvider\"\n    );\n  }\n  return context.defaultModel;\n}\n\nexport function useModelChange() {\n  const context = useContext(DefaultModelContext);\n  if (context === undefined) {\n    throw new Error(\n      \"useModelChange must be used within a DefaultModelProvider\"\n    );\n  }\n  return context.changeModel;\n}\n"],"names":["DefaultModelContext","createContext","DefaultModelProvider","children","initialModel","currentModel","setCurrentModel","useState","changeModel","useCallback","modelId","error","toast","value","useMemo","jsx","useDefaultModel","context","useContext","useModelChange"],"mappings":"oHAkBA,MAAMA,EAAsBC,EAAAA,cAC1B,MACF,EAOO,SAASC,EAAqB,CACnC,SAAAC,EACA,aAAcC,CAChB,EAAoC,CAClC,KAAM,CAACC,EAAcC,CAAe,EAAIC,EAAAA,SAAqBH,CAAY,EAEnEI,EAAcC,EAAAA,YAClB,MAAOC,GAAwB,CAE7BJ,EAAgBI,CAAO,EAEvB,GAAI,CAEF,MAAM,MAAM,kBAAmB,CAC7B,OAAQ,OACR,QAAS,CACP,eAAgB,kBAAA,EAElB,KAAM,KAAK,UAAU,CAAE,MAAOA,EAAS,CAAA,CACxC,CACH,OAASC,EAAO,CACd,QAAQ,MAAM,6BAA8BA,CAAK,EACjDC,EAAM,MAAM,iCAAiC,EAE7CN,EAAgBF,CAAY,CAC9B,CACF,EACA,CAACA,CAAY,CAAA,EAGTS,EAAQC,EAAAA,QACZ,KAAO,CACL,aAAcT,EACd,YAAAG,CAAA,GAEF,CAACH,EAAcG,CAAW,CAAA,EAG5B,OACEO,EAAAA,IAACf,EAAoB,SAApB,CAA6B,MAAAa,EAC3B,SAAAV,CAAA,CACH,CAEJ,CAEO,SAASa,GAAkB,CAChC,MAAMC,EAAUC,EAAAA,WAAWlB,CAAmB,EAC9C,GAAIiB,IAAY,OACd,MAAM,IAAI,MACR,4DAAA,EAGJ,OAAOA,EAAQ,YACjB,CAEO,SAASE,GAAiB,CAC/B,MAAMF,EAAUC,EAAAA,WAAWlB,CAAmB,EAC9C,GAAIiB,IAAY,OACd,MAAM,IAAI,MACR,2DAAA,EAGJ,OAAOA,EAAQ,WACjB"}