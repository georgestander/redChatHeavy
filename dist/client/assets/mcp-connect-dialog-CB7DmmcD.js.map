{"version":3,"file":"mcp-connect-dialog-CB7DmmcD.js","sources":["../../../node_modules/.pnpm/lucide-react@0.553.0_react@19.2.3/node_modules/lucide-react/dist/esm/icons/shield.js","../../../node_modules/.pnpm/lucide-react@0.553.0_react@19.2.3/node_modules/lucide-react/dist/esm/icons/triangle-alert.js","../../../components/get-url-without-params.ts","../../../components/settings/connector-header.tsx","../../../components/settings/mcp-connect-dialog.tsx"],"sourcesContent":["/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z\",\n      key: \"oel41y\"\n    }\n  ]\n];\nconst Shield = createLucideIcon(\"shield\", __iconNode);\n\nexport { __iconNode, Shield as default };\n//# sourceMappingURL=shield.js.map\n","/**\n * @license lucide-react v0.553.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst __iconNode = [\n  [\n    \"path\",\n    {\n      d: \"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3\",\n      key: \"wmoenq\"\n    }\n  ],\n  [\"path\", { d: \"M12 9v4\", key: \"juzpu7\" }],\n  [\"path\", { d: \"M12 17h.01\", key: \"p32p05\" }]\n];\nconst TriangleAlert = createLucideIcon(\"triangle-alert\", __iconNode);\n\nexport { __iconNode, TriangleAlert as default };\n//# sourceMappingURL=triangle-alert.js.map\n","export function getUrlWithoutParams(url: string): string {\n  try {\n    const parsed = new URL(url);\n    return `${parsed.origin}${parsed.pathname}`;\n  } catch {\n    // If it's not a valid URL, just strip everything after ?\n    const qIndex = url.indexOf(\"?\");\n    return qIndex === -1 ? url : url.slice(0, qIndex);\n  }\n}\n","\"use client\";\n\nimport { Globe } from \"lucide-react\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Favicon } from \"../favicon\";\nimport { getGoogleFaviconUrl } from \"../get-google-favicon-url\";\nimport { getUrlWithoutParams } from \"../get-url-without-params\";\n\nexport function ConnectorHeader({\n  name,\n  url,\n  type,\n  isCustom,\n  statusText,\n}: {\n  name: string;\n  url: string;\n  type: string;\n  isCustom: boolean;\n  statusText?: string;\n}) {\n  const faviconUrl = type === \"http\" ? getGoogleFaviconUrl(url) : \"\";\n\n  return (\n    <div className=\"flex min-w-0 flex-1 items-center gap-3 overflow-hidden\">\n      <div className=\"flex size-10 shrink-0 items-center justify-center rounded-lg bg-muted\">\n        {faviconUrl ? (\n          <>\n            <Favicon className=\"size-5 rounded-sm\" url={faviconUrl} />\n            <Globe className=\"hidden size-5 text-muted-foreground\" />\n          </>\n        ) : (\n          <Globe className=\"size-5 text-muted-foreground\" />\n        )}\n      </div>\n\n      <div className=\"min-w-0 flex-1 overflow-hidden\">\n        <div className=\"flex items-center gap-2 overflow-hidden\">\n          <span className=\"truncate font-medium text-sm\">{name}</span>\n          {isCustom ? (\n            <Badge\n              className=\"h-5 shrink-0 px-2 text-[10px]\"\n              variant=\"secondary\"\n            >\n              CUSTOM\n            </Badge>\n          ) : (\n            <Badge className=\"h-5 shrink-0 px-2 text-[10px]\" variant=\"outline\">\n              Built-in\n            </Badge>\n          )}\n        </div>\n        <p className=\"mt-0.5 truncate text-muted-foreground text-xs\">\n          {getUrlWithoutParams(url)}\n        </p>\n        {statusText ? (\n          <p className=\"mt-0.5 text-[11px] text-muted-foreground\">\n            {statusText}\n          </p>\n        ) : null}\n      </div>\n    </div>\n  );\n}\n","\"use client\";\n\nimport { useMutation } from \"@tanstack/react-query\";\nimport {\n  AlertTriangle,\n  ExternalLink,\n  Globe,\n  Loader2,\n  Lock,\n  Shield,\n} from \"lucide-react\";\nimport { useCallback, useMemo, useState } from \"react\";\nimport { toast } from \"sonner\";\nimport { Button } from \"@/components/ui/button\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogFooter,\n  DialogHeader,\n  DialogTitle,\n} from \"@/components/ui/dialog\";\nimport { config } from \"@/lib/config\";\nimport type { McpConnector } from \"@/lib/db/schema\";\nimport { authorize as authorizeConnector } from \"@/server/actions/mcp\";\nimport { Favicon } from \"../favicon\";\nimport { getGoogleFaviconUrl } from \"../get-google-favicon-url\";\nimport { getUrlWithoutParams } from \"../get-url-without-params\";\n\nexport function McpConnectDialog({\n  open,\n  onClose,\n  connector,\n}: {\n  open: boolean;\n  onClose: () => void;\n  connector: McpConnector | null;\n}) {\n  const [isRedirecting, setIsRedirecting] = useState(false);\n\n  const faviconUrl = useMemo(() => {\n    if (!connector) {\n      return \"\";\n    }\n    return connector.type === \"http\" ? getGoogleFaviconUrl(connector.url) : \"\";\n  }, [connector]);\n\n  const { mutateAsync: authorize, isPending } = useMutation({\n    mutationFn: authorizeConnector,\n    onError: (err) => {\n      toast.error(err.message || \"Failed to start connection\");\n    },\n  });\n\n  const handleContinue = useCallback(async () => {\n    if (!connector) {\n      return;\n    }\n    const { authorizationUrl } = await authorize({ id: connector.id });\n    // Keep spinner visible until browser navigates away\n    setIsRedirecting(true);\n    window.location.href = authorizationUrl;\n  }, [authorize, connector]);\n\n  return (\n    <Dialog onOpenChange={(o) => !o && onClose()} open={open}>\n      <DialogContent className=\"sm:max-w-md\">\n        <DialogHeader className=\"overflow-hidden\">\n          <div className=\"flex items-center gap-3 overflow-hidden\">\n            <div className=\"flex size-10 shrink-0 items-center justify-center rounded-md bg-muted\">\n              {faviconUrl ? (\n                <>\n                  <Favicon className=\"size-5 rounded-sm\" url={faviconUrl} />\n                  <Globe className=\"hidden size-5 text-muted-foreground\" />\n                </>\n              ) : (\n                <Globe className=\"size-5 text-muted-foreground\" />\n              )}\n            </div>\n            <div className=\"min-w-0 flex-1 overflow-hidden\">\n              <DialogTitle className=\"truncate\">\n                Connect {connector?.name ?? \"connector\"}\n              </DialogTitle>\n              <DialogDescription className=\"truncate\">\n                {connector?.url ? getUrlWithoutParams(connector.url) : null}\n              </DialogDescription>\n            </div>\n          </div>\n        </DialogHeader>\n\n        <div className=\"space-y-6 py-2\">\n          <div className=\"flex gap-4\">\n            <Shield className=\"mt-0.5 size-4 shrink-0 text-muted-foreground\" />\n            <div>\n              <p className=\"font-medium text-sm\">\n                Permissions always respected\n              </p>\n              <p className=\"mt-1 text-muted-foreground text-sm\">\n                {config.appName} is strictly limited to permissions you\n                explicitly set. Disable access anytime to revoke permissions.\n              </p>\n            </div>\n          </div>\n\n          <div className=\"flex gap-4\">\n            <Lock className=\"mt-0.5 size-4 shrink-0 text-muted-foreground\" />\n            <div>\n              <p className=\"font-medium text-sm\">\n                How {config.appName} uses data\n              </p>\n              <p className=\"mt-1 text-muted-foreground text-sm\">\n                By default, we do not train on your data. Data from{\" \"}\n                {connector?.name ?? \"this connector\"} may be used to provide you\n                relevant and useful information.\n              </p>\n            </div>\n          </div>\n\n          <div className=\"flex gap-4\">\n            <AlertTriangle className=\"mt-0.5 size-4 shrink-0 text-muted-foreground\" />\n            <div>\n              <p className=\"font-medium text-sm\">\n                Connectors may introduce risk\n              </p>\n              <p className=\"mt-1 text-muted-foreground text-sm\">\n                Connectors are designed to respect your privacy, but sites may\n                attempt to steal your data.\n              </p>\n            </div>\n          </div>\n        </div>\n\n        <DialogFooter className=\"mt-4 flex-col gap-3 sm:flex-col\">\n          <Button\n            className=\"w-full\"\n            disabled={isPending || isRedirecting || !connector}\n            onClick={handleContinue}\n          >\n            {isPending || isRedirecting ? (\n              <>\n                <Loader2 className=\"size-4 animate-spin\" />\n                Redirecting...\n              </>\n            ) : (\n              <>\n                Continue to {connector?.name ?? \"connector\"}\n                <ExternalLink className=\"size-4\" />\n              </>\n            )}\n          </Button>\n          <Button\n            className=\"w-full\"\n            disabled={isPending || isRedirecting}\n            onClick={onClose}\n            variant=\"ghost\"\n          >\n            Cancel\n          </Button>\n        </DialogFooter>\n      </DialogContent>\n    </Dialog>\n  );\n}\n"],"names":["__iconNode","Shield","createLucideIcon","TriangleAlert","getUrlWithoutParams","url","parsed","qIndex","ConnectorHeader","name","type","isCustom","statusText","faviconUrl","getGoogleFaviconUrl","jsxs","jsx","Fragment","Favicon","Globe","Badge","McpConnectDialog","open","onClose","connector","isRedirecting","setIsRedirecting","useState","useMemo","authorize","isPending","useMutation","authorizeConnector","err","toast","handleContinue","useCallback","authorizationUrl","Dialog","o","DialogContent","DialogHeader","DialogTitle","DialogDescription","config","Lock","AlertTriangle","DialogFooter","Button","Loader2","ExternalLink"],"mappings":"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","x_google_ignoreList":[0,1]}