{"version":3,"file":"index-BZUOGsgi.mjs","sources":["../../../node_modules/.pnpm/better-auth@1.4.18_better-sqlite3@12.6.2_drizzle-kit@0.25.0_drizzle-orm@0.34.1_@cloudflare+wo_gnuc4skgho5hqg2jqlfi6hk52u/node_modules/better-auth/dist/adapters/kysely-adapter/kysely-adapter.mjs"],"sourcesContent":["import { sql } from \"kysely\";\nimport { createAdapterFactory } from \"@better-auth/core/db/adapter\";\n\n//#region src/adapters/kysely-adapter/kysely-adapter.ts\nconst kyselyAdapter = (db, config) => {\n\tlet lazyOptions = null;\n\tconst createCustomAdapter = (db$1) => {\n\t\treturn ({ getFieldName, schema, getDefaultFieldName, getDefaultModelName, getFieldAttributes, getModelName }) => {\n\t\t\tconst selectAllJoins = (join) => {\n\t\t\t\tconst allSelects = [];\n\t\t\t\tconst allSelectsStr = [];\n\t\t\t\tif (join) for (const [joinModel, _] of Object.entries(join)) {\n\t\t\t\t\tconst fields = schema[getDefaultModelName(joinModel)]?.fields;\n\t\t\t\t\tconst [_joinModelSchema, joinModelName] = joinModel.includes(\".\") ? joinModel.split(\".\") : [void 0, joinModel];\n\t\t\t\t\tif (!fields) continue;\n\t\t\t\t\tfields.id = { type: \"string\" };\n\t\t\t\t\tfor (const [field, fieldAttr] of Object.entries(fields)) {\n\t\t\t\t\t\tallSelects.push(sql`${sql.ref(`join_${joinModelName}`)}.${sql.ref(fieldAttr.fieldName || field)} as ${sql.ref(`_joined_${joinModelName}_${fieldAttr.fieldName || field}`)}`);\n\t\t\t\t\t\tallSelectsStr.push({\n\t\t\t\t\t\t\tjoinModel,\n\t\t\t\t\t\t\tjoinModelRef: joinModelName,\n\t\t\t\t\t\t\tfieldName: fieldAttr.fieldName || field\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn {\n\t\t\t\t\tallSelectsStr,\n\t\t\t\t\tallSelects\n\t\t\t\t};\n\t\t\t};\n\t\t\tconst withReturning = async (values, builder, model, where) => {\n\t\t\t\tlet res;\n\t\t\t\tif (config?.type === \"mysql\") {\n\t\t\t\t\tawait builder.execute();\n\t\t\t\t\tconst field = values.id ? \"id\" : where.length > 0 && where[0]?.field ? where[0].field : \"id\";\n\t\t\t\t\tif (!values.id && where.length === 0) {\n\t\t\t\t\t\tres = await db$1.selectFrom(model).selectAll().orderBy(getFieldName({\n\t\t\t\t\t\t\tmodel,\n\t\t\t\t\t\t\tfield\n\t\t\t\t\t\t}), \"desc\").limit(1).executeTakeFirst();\n\t\t\t\t\t\treturn res;\n\t\t\t\t\t}\n\t\t\t\t\tconst value = values[field] || where[0]?.value;\n\t\t\t\t\tres = await db$1.selectFrom(model).selectAll().orderBy(getFieldName({\n\t\t\t\t\t\tmodel,\n\t\t\t\t\t\tfield\n\t\t\t\t\t}), \"desc\").where(getFieldName({\n\t\t\t\t\t\tmodel,\n\t\t\t\t\t\tfield\n\t\t\t\t\t}), \"=\", value).limit(1).executeTakeFirst();\n\t\t\t\t\treturn res;\n\t\t\t\t}\n\t\t\t\tif (config?.type === \"mssql\") {\n\t\t\t\t\tres = await builder.outputAll(\"inserted\").executeTakeFirst();\n\t\t\t\t\treturn res;\n\t\t\t\t}\n\t\t\t\tres = await builder.returningAll().executeTakeFirst();\n\t\t\t\treturn res;\n\t\t\t};\n\t\t\tfunction convertWhereClause(model, w) {\n\t\t\t\tif (!w) return {\n\t\t\t\t\tand: null,\n\t\t\t\t\tor: null\n\t\t\t\t};\n\t\t\t\tconst conditions = {\n\t\t\t\t\tand: [],\n\t\t\t\t\tor: []\n\t\t\t\t};\n\t\t\t\tw.forEach((condition) => {\n\t\t\t\t\tconst { field: _field, value: _value, operator = \"=\", connector = \"AND\" } = condition;\n\t\t\t\t\tconst value = _value;\n\t\t\t\t\tconst field = getFieldName({\n\t\t\t\t\t\tmodel,\n\t\t\t\t\t\tfield: _field\n\t\t\t\t\t});\n\t\t\t\t\tconst expr = (eb) => {\n\t\t\t\t\t\tconst f = `${model}.${field}`;\n\t\t\t\t\t\tif (operator.toLowerCase() === \"in\") return eb(f, \"in\", Array.isArray(value) ? value : [value]);\n\t\t\t\t\t\tif (operator.toLowerCase() === \"not_in\") return eb(f, \"not in\", Array.isArray(value) ? value : [value]);\n\t\t\t\t\t\tif (operator === \"contains\") return eb(f, \"like\", `%${value}%`);\n\t\t\t\t\t\tif (operator === \"starts_with\") return eb(f, \"like\", `${value}%`);\n\t\t\t\t\t\tif (operator === \"ends_with\") return eb(f, \"like\", `%${value}`);\n\t\t\t\t\t\tif (operator === \"eq\") return eb(f, \"=\", value);\n\t\t\t\t\t\tif (operator === \"ne\") return eb(f, \"<>\", value);\n\t\t\t\t\t\tif (operator === \"gt\") return eb(f, \">\", value);\n\t\t\t\t\t\tif (operator === \"gte\") return eb(f, \">=\", value);\n\t\t\t\t\t\tif (operator === \"lt\") return eb(f, \"<\", value);\n\t\t\t\t\t\tif (operator === \"lte\") return eb(f, \"<=\", value);\n\t\t\t\t\t\treturn eb(f, operator, value);\n\t\t\t\t\t};\n\t\t\t\t\tif (connector === \"OR\") conditions.or.push(expr);\n\t\t\t\t\telse conditions.and.push(expr);\n\t\t\t\t});\n\t\t\t\treturn {\n\t\t\t\t\tand: conditions.and.length ? conditions.and : null,\n\t\t\t\t\tor: conditions.or.length ? conditions.or : null\n\t\t\t\t};\n\t\t\t}\n\t\t\tfunction processJoinedResults(rows, joinConfig, allSelectsStr) {\n\t\t\t\tif (!joinConfig || !rows.length) return rows;\n\t\t\t\tconst groupedByMainId = /* @__PURE__ */ new Map();\n\t\t\t\tfor (const currentRow of rows) {\n\t\t\t\t\tconst mainModelFields = {};\n\t\t\t\t\tconst joinedModelFields = {};\n\t\t\t\t\tfor (const [joinModel] of Object.entries(joinConfig)) joinedModelFields[getModelName(joinModel)] = {};\n\t\t\t\t\tfor (const [key, value] of Object.entries(currentRow)) {\n\t\t\t\t\t\tconst keyStr = String(key);\n\t\t\t\t\t\tlet assigned = false;\n\t\t\t\t\t\tfor (const { joinModel, fieldName, joinModelRef } of allSelectsStr) if (keyStr === `_joined_${joinModelRef}_${fieldName}`) {\n\t\t\t\t\t\t\tjoinedModelFields[getModelName(joinModel)][getFieldName({\n\t\t\t\t\t\t\t\tmodel: joinModel,\n\t\t\t\t\t\t\t\tfield: fieldName\n\t\t\t\t\t\t\t})] = value;\n\t\t\t\t\t\t\tassigned = true;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!assigned) mainModelFields[key] = value;\n\t\t\t\t\t}\n\t\t\t\t\tconst mainId = mainModelFields.id;\n\t\t\t\t\tif (!mainId) continue;\n\t\t\t\t\tif (!groupedByMainId.has(mainId)) {\n\t\t\t\t\t\tconst entry$1 = { ...mainModelFields };\n\t\t\t\t\t\tfor (const [joinModel, joinAttr] of Object.entries(joinConfig)) entry$1[getModelName(joinModel)] = joinAttr.relation === \"one-to-one\" ? null : [];\n\t\t\t\t\t\tgroupedByMainId.set(mainId, entry$1);\n\t\t\t\t\t}\n\t\t\t\t\tconst entry = groupedByMainId.get(mainId);\n\t\t\t\t\tfor (const [joinModel, joinAttr] of Object.entries(joinConfig)) {\n\t\t\t\t\t\tconst isUnique = joinAttr.relation === \"one-to-one\";\n\t\t\t\t\t\tconst limit = joinAttr.limit ?? 100;\n\t\t\t\t\t\tconst joinedObj = joinedModelFields[getModelName(joinModel)];\n\t\t\t\t\t\tconst hasData = joinedObj && Object.keys(joinedObj).length > 0 && Object.values(joinedObj).some((value) => value !== null && value !== void 0);\n\t\t\t\t\t\tif (isUnique) entry[getModelName(joinModel)] = hasData ? joinedObj : null;\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tconst joinModelName = getModelName(joinModel);\n\t\t\t\t\t\t\tif (Array.isArray(entry[joinModelName]) && hasData) {\n\t\t\t\t\t\t\t\tif (entry[joinModelName].length >= limit) continue;\n\t\t\t\t\t\t\t\tconst idFieldName = getFieldName({\n\t\t\t\t\t\t\t\t\tmodel: joinModel,\n\t\t\t\t\t\t\t\t\tfield: \"id\"\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tconst joinedId = joinedObj[idFieldName];\n\t\t\t\t\t\t\t\tif (joinedId) {\n\t\t\t\t\t\t\t\t\tif (!entry[joinModelName].some((item) => item[idFieldName] === joinedId) && entry[joinModelName].length < limit) entry[joinModelName].push(joinedObj);\n\t\t\t\t\t\t\t\t} else if (entry[joinModelName].length < limit) entry[joinModelName].push(joinedObj);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconst result = Array.from(groupedByMainId.values());\n\t\t\t\tfor (const entry of result) for (const [joinModel, joinAttr] of Object.entries(joinConfig)) if (joinAttr.relation !== \"one-to-one\") {\n\t\t\t\t\tconst joinModelName = getModelName(joinModel);\n\t\t\t\t\tif (Array.isArray(entry[joinModelName])) {\n\t\t\t\t\t\tconst limit = joinAttr.limit ?? 100;\n\t\t\t\t\t\tif (entry[joinModelName].length > limit) entry[joinModelName] = entry[joinModelName].slice(0, limit);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tasync create({ data, model }) {\n\t\t\t\t\treturn await withReturning(data, db$1.insertInto(model).values(data), model, []);\n\t\t\t\t},\n\t\t\t\tasync findOne({ model, where, select, join }) {\n\t\t\t\t\tconst { and, or } = convertWhereClause(model, where);\n\t\t\t\t\tlet query = db$1.selectFrom((eb) => {\n\t\t\t\t\t\tlet b = eb.selectFrom(model);\n\t\t\t\t\t\tif (and) b = b.where((eb$1) => eb$1.and(and.map((expr) => expr(eb$1))));\n\t\t\t\t\t\tif (or) b = b.where((eb$1) => eb$1.or(or.map((expr) => expr(eb$1))));\n\t\t\t\t\t\treturn b.selectAll().as(\"primary\");\n\t\t\t\t\t}).selectAll(\"primary\");\n\t\t\t\t\tif (join) for (const [joinModel, joinAttr] of Object.entries(join)) {\n\t\t\t\t\t\tconst [_joinModelSchema, joinModelName] = joinModel.includes(\".\") ? joinModel.split(\".\") : [void 0, joinModel];\n\t\t\t\t\t\tquery = query.leftJoin(`${joinModel} as join_${joinModelName}`, (join$1) => join$1.onRef(`join_${joinModelName}.${joinAttr.on.to}`, \"=\", `primary.${joinAttr.on.from}`));\n\t\t\t\t\t}\n\t\t\t\t\tconst { allSelectsStr, allSelects } = selectAllJoins(join);\n\t\t\t\t\tquery = query.select(allSelects);\n\t\t\t\t\tconst res = await query.execute();\n\t\t\t\t\tif (!res || !Array.isArray(res) || res.length === 0) return null;\n\t\t\t\t\tconst row = res[0];\n\t\t\t\t\tif (join) return processJoinedResults(res, join, allSelectsStr)[0];\n\t\t\t\t\treturn row;\n\t\t\t\t},\n\t\t\t\tasync findMany({ model, where, limit, offset, sortBy, join }) {\n\t\t\t\t\tconst { and, or } = convertWhereClause(model, where);\n\t\t\t\t\tlet query = db$1.selectFrom((eb) => {\n\t\t\t\t\t\tlet b = eb.selectFrom(model);\n\t\t\t\t\t\tif (config?.type === \"mssql\") {\n\t\t\t\t\t\t\tif (offset !== void 0) {\n\t\t\t\t\t\t\t\tif (!sortBy) b = b.orderBy(getFieldName({\n\t\t\t\t\t\t\t\t\tmodel,\n\t\t\t\t\t\t\t\t\tfield: \"id\"\n\t\t\t\t\t\t\t\t}));\n\t\t\t\t\t\t\t\tb = b.offset(offset).fetch(limit || 100);\n\t\t\t\t\t\t\t} else if (limit !== void 0) b = b.top(limit);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (limit !== void 0) b = b.limit(limit);\n\t\t\t\t\t\t\tif (offset !== void 0) b = b.offset(offset);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (sortBy?.field) b = b.orderBy(`${getFieldName({\n\t\t\t\t\t\t\tmodel,\n\t\t\t\t\t\t\tfield: sortBy.field\n\t\t\t\t\t\t})}`, sortBy.direction);\n\t\t\t\t\t\tif (and) b = b.where((eb$1) => eb$1.and(and.map((expr) => expr(eb$1))));\n\t\t\t\t\t\tif (or) b = b.where((eb$1) => eb$1.or(or.map((expr) => expr(eb$1))));\n\t\t\t\t\t\treturn b.selectAll().as(\"primary\");\n\t\t\t\t\t}).selectAll(\"primary\");\n\t\t\t\t\tif (join) for (const [joinModel, joinAttr] of Object.entries(join)) {\n\t\t\t\t\t\tconst [_joinModelSchema, joinModelName] = joinModel.includes(\".\") ? joinModel.split(\".\") : [void 0, joinModel];\n\t\t\t\t\t\tquery = query.leftJoin(`${joinModel} as join_${joinModelName}`, (join$1) => join$1.onRef(`join_${joinModelName}.${joinAttr.on.to}`, \"=\", `primary.${joinAttr.on.from}`));\n\t\t\t\t\t}\n\t\t\t\t\tconst { allSelectsStr, allSelects } = selectAllJoins(join);\n\t\t\t\t\tquery = query.select(allSelects);\n\t\t\t\t\tif (sortBy?.field) query = query.orderBy(`${getFieldName({\n\t\t\t\t\t\tmodel,\n\t\t\t\t\t\tfield: sortBy.field\n\t\t\t\t\t})}`, sortBy.direction);\n\t\t\t\t\tconst res = await query.execute();\n\t\t\t\t\tif (!res) return [];\n\t\t\t\t\tif (join) return processJoinedResults(res, join, allSelectsStr);\n\t\t\t\t\treturn res;\n\t\t\t\t},\n\t\t\t\tasync update({ model, where, update: values }) {\n\t\t\t\t\tconst { and, or } = convertWhereClause(model, where);\n\t\t\t\t\tlet query = db$1.updateTable(model).set(values);\n\t\t\t\t\tif (and) query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n\t\t\t\t\tif (or) query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n\t\t\t\t\treturn await withReturning(values, query, model, where);\n\t\t\t\t},\n\t\t\t\tasync updateMany({ model, where, update: values }) {\n\t\t\t\t\tconst { and, or } = convertWhereClause(model, where);\n\t\t\t\t\tlet query = db$1.updateTable(model).set(values);\n\t\t\t\t\tif (and) query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n\t\t\t\t\tif (or) query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n\t\t\t\t\tconst res = (await query.executeTakeFirst()).numUpdatedRows;\n\t\t\t\t\treturn res > Number.MAX_SAFE_INTEGER ? Number.MAX_SAFE_INTEGER : Number(res);\n\t\t\t\t},\n\t\t\t\tasync count({ model, where }) {\n\t\t\t\t\tconst { and, or } = convertWhereClause(model, where);\n\t\t\t\t\tlet query = db$1.selectFrom(model).select(db$1.fn.count(\"id\").as(\"count\"));\n\t\t\t\t\tif (and) query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n\t\t\t\t\tif (or) query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n\t\t\t\t\tconst res = await query.execute();\n\t\t\t\t\tif (typeof res[0].count === \"number\") return res[0].count;\n\t\t\t\t\tif (typeof res[0].count === \"bigint\") return Number(res[0].count);\n\t\t\t\t\treturn parseInt(res[0].count);\n\t\t\t\t},\n\t\t\t\tasync delete({ model, where }) {\n\t\t\t\t\tconst { and, or } = convertWhereClause(model, where);\n\t\t\t\t\tlet query = db$1.deleteFrom(model);\n\t\t\t\t\tif (and) query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n\t\t\t\t\tif (or) query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n\t\t\t\t\tawait query.execute();\n\t\t\t\t},\n\t\t\t\tasync deleteMany({ model, where }) {\n\t\t\t\t\tconst { and, or } = convertWhereClause(model, where);\n\t\t\t\t\tlet query = db$1.deleteFrom(model);\n\t\t\t\t\tif (and) query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n\t\t\t\t\tif (or) query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n\t\t\t\t\tconst res = (await query.executeTakeFirst()).numDeletedRows;\n\t\t\t\t\treturn res > Number.MAX_SAFE_INTEGER ? Number.MAX_SAFE_INTEGER : Number(res);\n\t\t\t\t},\n\t\t\t\toptions: config\n\t\t\t};\n\t\t};\n\t};\n\tlet adapterOptions = null;\n\tadapterOptions = {\n\t\tconfig: {\n\t\t\tadapterId: \"kysely\",\n\t\t\tadapterName: \"Kysely Adapter\",\n\t\t\tusePlural: config?.usePlural,\n\t\t\tdebugLogs: config?.debugLogs,\n\t\t\tsupportsBooleans: config?.type === \"sqlite\" || config?.type === \"mssql\" || config?.type === \"mysql\" || !config?.type ? false : true,\n\t\t\tsupportsDates: config?.type === \"sqlite\" || config?.type === \"mssql\" || !config?.type ? false : true,\n\t\t\tsupportsJSON: config?.type === \"postgres\" ? true : false,\n\t\t\tsupportsArrays: false,\n\t\t\tsupportsUUIDs: config?.type === \"postgres\" ? true : false,\n\t\t\ttransaction: config?.transaction ? (cb) => db.transaction().execute((trx) => {\n\t\t\t\treturn cb(createAdapterFactory({\n\t\t\t\t\tconfig: adapterOptions.config,\n\t\t\t\t\tadapter: createCustomAdapter(trx)\n\t\t\t\t})(lazyOptions));\n\t\t\t}) : false\n\t\t},\n\t\tadapter: createCustomAdapter(db)\n\t};\n\tconst adapter = createAdapterFactory(adapterOptions);\n\treturn (options) => {\n\t\tlazyOptions = options;\n\t\treturn adapter(options);\n\t};\n};\n\n//#endregion\nexport { kyselyAdapter };\n//# sourceMappingURL=kysely-adapter.mjs.map"],"names":["kyselyAdapter","db","config","lazyOptions","createCustomAdapter","db$1","getFieldName","schema","getDefaultFieldName","getDefaultModelName","getFieldAttributes","getModelName","selectAllJoins","join","allSelects","allSelectsStr","joinModel","_","fields","_joinModelSchema","joinModelName","field","fieldAttr","sql","withReturning","values","builder","model","where","res","value","convertWhereClause","w","conditions","condition","_field","_value","operator","connector","expr","eb","f","processJoinedResults","rows","joinConfig","groupedByMainId","currentRow","mainModelFields","joinedModelFields","key","keyStr","assigned","fieldName","joinModelRef","mainId","entry$1","joinAttr","entry","isUnique","limit","joinedObj","hasData","idFieldName","joinedId","item","result","data","select","and","or","query","b","eb$1","join$1","row","offset","sortBy","adapterOptions","cb","trx","createAdapterFactory","adapter","options"],"mappings":"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","x_google_ignoreList":[0]}