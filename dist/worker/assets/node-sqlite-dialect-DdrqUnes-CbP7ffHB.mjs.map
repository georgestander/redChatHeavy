{"version":3,"file":"node-sqlite-dialect-DdrqUnes-CbP7ffHB.mjs","sources":["node-sqlite-dialect-DdrqUnes.mjs"],"sourcesContent":["import{aE as s,aF as n,aG as i,aH as o,aB as c}from\"./worker-entry-DwuZrGJP.mjs\";import\"node:events\";import\"cloudflare:workers\";import\"/Users/georgestander/dev/tools/chatjs/node_modules/.pnpm/rwsdk@1.0.0-beta.53_@cloudflare+vite-plugin@1.23.0_bufferutil@4.1.0_vite@7.3.1_@types+node@22_zvk7ynha23nrady3r6nbat6zha/node_modules/rwsdk/dist/__intermediate_builds/ssr/ssr_bridge.js\";import\"async_hooks\";import\"node:os\";import\"node:diagnostics_channel\";import\"fs\";import\"events\";import\"util\";import\"path\";import\"assert\";import\"node:stream\";import\"module\";import\"node:path\";import\"url\";import\"buffer\";import\"crypto\";import\"node:crypto\";var l=class{get supportsCreateIfNotExists(){return!0}get supportsTransactionalDdl(){return!1}get supportsReturning(){return!0}async acquireMigrationLock(){}async releaseMigrationLock(){}get supportsOutput(){return!0}},u=class{#e;#t=new p;#r;#a;constructor(e){this.#e={...e}}async init(){this.#r=this.#e.database,this.#a=new m(this.#r),this.#e.onCreateConnection&&await this.#e.onCreateConnection(this.#a)}async acquireConnection(){return await this.#t.lock(),this.#a}async beginTransaction(e){await e.executeQuery(s.raw(\"begin\"))}async commitTransaction(e){await e.executeQuery(s.raw(\"commit\"))}async rollbackTransaction(e){await e.executeQuery(s.raw(\"rollback\"))}async releaseConnection(){this.#t.unlock()}async destroy(){this.#r?.close()}},m=class{#e;constructor(e){this.#e=e}executeQuery(e){const{sql:r,parameters:a}=e,t=this.#e.prepare(r).all(...a);return Promise.resolve({rows:t})}async*streamQuery(){throw new Error(\"Streaming query is not supported by SQLite driver.\")}},p=class{#e;#t;async lock(){for(;await this.#e;)await this.#e;this.#e=new Promise(e=>{this.#t=e})}unlock(){const e=this.#t;this.#e=void 0,this.#t=void 0,e?.()}},h=class{#e;constructor(e){this.#e=e}async getSchemas(){return[]}async getTables(e={withInternalKyselyTables:!1}){let r=this.#e.selectFrom(\"sqlite_schema\").where(\"type\",\"=\",\"table\").where(\"name\",\"not like\",\"sqlite_%\").select(\"name\").$castTo();e.withInternalKyselyTables||(r=r.where(\"name\",\"!=\",i).where(\"name\",\"!=\",o));const a=await r.execute();return Promise.all(a.map(({name:t})=>this.#t(t)))}async getMetadata(e){return{tables:await this.getTables(e)}}async#t(e){const r=this.#e,a=(await r.selectFrom(\"sqlite_master\").where(\"name\",\"=\",e).select(\"sql\").$castTo().execute())[0]?.sql?.split(/[\\(\\),]/)?.find(t=>t.toLowerCase().includes(\"autoincrement\"))?.split(/\\s+/)?.[0]?.replace(/[\"`]/g,\"\");return{name:e,columns:(await r.selectFrom(c`pragma_table_info(${e})`.as(\"table_info\")).select([\"name\",\"type\",\"notnull\",\"dflt_value\"]).execute()).map(t=>({name:t.name,dataType:t.type,isNullable:!t.notnull,isAutoIncrementing:t.name===a,hasDefaultValue:t.dflt_value!=null})),isView:!0}}},y=class extends n{getCurrentParameterPlaceholder(){return\"?\"}getLeftIdentifierWrapper(){return'\"'}getRightIdentifierWrapper(){return'\"'}getAutoIncrement(){return\"autoincrement\"}},M=class{#e;constructor(e){this.#e={...e}}createDriver(){return new u(this.#e)}createQueryCompiler(){return new y}createAdapter(){return new l}createIntrospector(e){return new h(e)}};export{M as NodeSqliteDialect};\n//# sourceMappingURL=node-sqlite-dialect-DdrqUnes.mjs.map\n"],"names":["s","i","o","c","y","n"],"mappings":"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"}