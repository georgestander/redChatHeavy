{"version":3,"file":"project-Cwy3jbFk.mjs","sources":["../../../lib/project-icons.ts","../../../src/lib/schemas/project.ts","../../../src/server/actions/project.ts"],"sourcesContent":["// Subset of Lucide icons suitable for projects\nexport const PROJECT_ICONS = [\n  \"folder\",\n  \"briefcase\",\n  \"book\",\n  \"code\",\n  \"dollar-sign\",\n  \"graduation-cap\",\n  \"heart\",\n  \"home\",\n  \"lightbulb\",\n  \"music\",\n  \"pencil\",\n  \"plane\",\n  \"shopping-cart\",\n  \"star\",\n  \"target\",\n  \"users\",\n  \"zap\",\n  \"coffee\",\n  \"camera\",\n  \"globe\",\n  \"flask\",\n  \"chart-bar\",\n  \"calendar\",\n  \"clipboard\",\n  \"rocket\",\n] as const;\n\nexport type ProjectIconName = (typeof PROJECT_ICONS)[number];\n\nexport const PROJECT_COLORS = [\n  { name: \"gray\", value: \"#6b7280\" },\n  { name: \"red\", value: \"#ef4444\" },\n  { name: \"orange\", value: \"#f97316\" },\n  { name: \"yellow\", value: \"#eab308\" },\n  { name: \"green\", value: \"#22c55e\" },\n  { name: \"cyan\", value: \"#06b6d4\" },\n  { name: \"blue\", value: \"#3b82f6\" },\n  { name: \"purple\", value: \"#a855f7\" },\n  { name: \"pink\", value: \"#ec4899\" },\n] as const;\n\nexport type ProjectColorName = (typeof PROJECT_COLORS)[number][\"name\"];\n\n// For zod enum validation\nexport const PROJECT_COLOR_NAMES = PROJECT_COLORS.map(\n  (c) => c.name\n) as unknown as readonly [ProjectColorName, ...ProjectColorName[]];\n\nexport const DEFAULT_PROJECT_ICON: ProjectIconName = \"folder\";\nexport const DEFAULT_PROJECT_COLOR: ProjectColorName = \"gray\";\n\nexport function getColorValue(name: ProjectColorName): string {\n  return (\n    PROJECT_COLORS.find((c) => c.name === name)?.value ??\n    PROJECT_COLORS[0].value\n  );\n}\n","import { z } from \"zod\";\nimport { PROJECT_COLOR_NAMES, PROJECT_ICONS } from \"@/lib/project-icons\";\n\nexport const projectCreateInputSchema = z.object({\n  name: z.string().min(1),\n  instructions: z.string().default(\"\"),\n  icon: z.enum(PROJECT_ICONS).optional(),\n  iconColor: z.enum(PROJECT_COLOR_NAMES).optional(),\n});\n\nexport const projectGetByIdInputSchema = z.object({ id: z.string().uuid() });\n\nexport const projectUpdateInputSchema = z.object({\n  id: z.string().uuid(),\n  updates: z.object({\n    name: z.string().min(1).optional(),\n    instructions: z.string().optional(),\n    icon: z.enum(PROJECT_ICONS).optional(),\n    iconColor: z.enum(PROJECT_COLOR_NAMES).optional(),\n  }),\n});\n\nexport const projectSetInstructionsInputSchema = z.object({\n  id: z.string().uuid(),\n  instructions: z.string(),\n});\n\nexport const projectRemoveInputSchema = z.object({ id: z.string().uuid() });\n","\"use server\";\n\nimport { requestInfo } from \"rwsdk/worker\";\nimport { auth } from \"@/lib/auth\";\nimport {\n  createProject,\n  deleteProject,\n  getProjectById,\n  getProjectsByUserId,\n  updateProject,\n} from \"@/lib/db/queries\";\nimport {\n  projectCreateInputSchema,\n  projectGetByIdInputSchema,\n  projectRemoveInputSchema,\n  projectSetInstructionsInputSchema,\n  projectUpdateInputSchema,\n} from \"@/lib/schemas/project\";\nimport { generateUUID } from \"@/lib/utils\";\n\ntype ProjectRecord = NonNullable<Awaited<ReturnType<typeof getProjectById>>>;\n\nfunction serializeProject(project: ProjectRecord) {\n  return {\n    ...project,\n    createdAt:\n      project.createdAt instanceof Date\n        ? project.createdAt.toISOString()\n        : project.createdAt,\n    updatedAt:\n      project.updatedAt instanceof Date\n        ? project.updatedAt.toISOString()\n        : project.updatedAt,\n  };\n}\n\nasync function requireUserId() {\n  const session = await auth.api.getSession({\n    headers: requestInfo.request.headers,\n  });\n  const userId = session?.user?.id;\n  if (!userId) {\n    throw new Error(\"UNAUTHORIZED\");\n  }\n  return userId;\n}\n\nexport async function list() {\n  const userId = await requireUserId();\n  const projects = await getProjectsByUserId({ userId });\n  return projects.map((project) => serializeProject(project));\n}\n\nexport async function create(rawInput: unknown) {\n  const input = projectCreateInputSchema.parse(rawInput);\n  const userId = await requireUserId();\n  const id = generateUUID();\n  await createProject({\n    id,\n    userId,\n    name: input.name,\n    instructions: input.instructions,\n    icon: input.icon,\n    iconColor: input.iconColor,\n  });\n  return { id };\n}\n\nexport async function getById(rawInput: unknown) {\n  const input = projectGetByIdInputSchema.parse(rawInput);\n  const userId = await requireUserId();\n  const project = await getProjectById({ id: input.id });\n  if (!project) {\n    throw new Error(\"Project not found\");\n  }\n  if (project.userId !== userId) {\n    throw new Error(\"Project not found\");\n  }\n  return serializeProject(project);\n}\n\nexport async function update(rawInput: unknown) {\n  const input = projectUpdateInputSchema.parse(rawInput);\n  const userId = await requireUserId();\n  const project = await getProjectById({ id: input.id });\n  if (!project) {\n    throw new Error(\"Project not found\");\n  }\n  if (project.userId !== userId) {\n    throw new Error(\"Project not found\");\n  }\n  await updateProject({ id: input.id, updates: input.updates });\n  return { success: true };\n}\n\nexport async function setInstructions(rawInput: unknown) {\n  const input = projectSetInstructionsInputSchema.parse(rawInput);\n  const userId = await requireUserId();\n  const project = await getProjectById({ id: input.id });\n  if (!project) {\n    throw new Error(\"Project not found\");\n  }\n  if (project.userId !== userId) {\n    throw new Error(\"Project not found\");\n  }\n  await updateProject({\n    id: input.id,\n    updates: { instructions: input.instructions },\n  });\n  return { success: true };\n}\n\nexport async function remove(rawInput: unknown) {\n  const input = projectRemoveInputSchema.parse(rawInput);\n  const userId = await requireUserId();\n  const project = await getProjectById({ id: input.id });\n  if (!project) {\n    throw new Error(\"Project not found\");\n  }\n  if (project.userId !== userId) {\n    throw new Error(\"Project not found\");\n  }\n  await deleteProject({ id: input.id });\n  return { success: true };\n}\n"],"names":["PROJECT_ICONS","PROJECT_COLORS","PROJECT_COLOR_NAMES","c","projectCreateInputSchema","z.object","z.string","z.enum","projectGetByIdInputSchema","projectUpdateInputSchema","projectSetInstructionsInputSchema","projectRemoveInputSchema","serializeProject","project","requireUserId","userId","auth","requestInfo","list","getProjectsByUserId","create","rawInput","input","id","generateUUID","createProject","getById","getProjectById","update","updateProject","setInstructions","remove","deleteProject"],"mappings":"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"}